<?xml version="1.0" encoding="UTF-8"?><!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd"><html xmlns="http://www.w3.org/1999/xhtml" lang="en"><head><meta http-equiv="Content-Type" content="text/html;charset=UTF-8"/><link rel="stylesheet" href="../.resources/report.css" type="text/css"/><link rel="shortcut icon" href="../.resources/report.gif" type="image/gif"/><title>AddTimeRecordModel.java</title><link rel="stylesheet" href="../.resources/prettify.css" type="text/css"/><script type="text/javascript" src="../.resources/prettify.js"></script></head><body onload="window['PR_TAB_WIDTH']=4;prettyPrint()"><div class="breadcrumb" id="breadcrumb"><span class="info"><a href="../.sessions.html" class="el_session">Sessions</a></span><a href="../index.html" class="el_report">QA Code Coverage</a> &gt; <a href="index.source.html" class="el_package">com.bluepumpkin.web.am.timerecords</a> &gt; <span class="el_source">AddTimeRecordModel.java</span></div><h1>AddTimeRecordModel.java</h1><pre class="source lang-java linenums">package com.bluepumpkin.web.am.timerecords;

import com.bluepumpkin.common.datatypes.ID;
import com.bluepumpkin.common.datatypes.StringsPair;
import com.bluepumpkin.common.logging.Category;
import com.bluepumpkin.common.util.StringUtil;
import com.bluepumpkin.ejb.bbm.activity.model.Activity;
import com.bluepumpkin.ejb.bbm.activity.model.ActivityCategory;
import com.bluepumpkin.ejb.bbm.activity.model.ActivityGroup;
import com.bluepumpkin.ejb.bbm.timerecord.model.*;
import com.bluepumpkin.ejb.bbm.workresource.model.Organization;
import com.bluepumpkin.web.am.Log;
import com.bluepumpkin.web.am.l10n.AmWebBundleKey;
import com.bluepumpkin.web.am.l10n.AmWebLogBundleKey;
import com.bluepumpkin.web.am.util.JSPUtil;
import com.witness.web.uif.base.UnableToLoadDataException;
import com.witness.web.uif.jsp.HtmlButton;
import com.witness.web.uif.jsp.HtmlImage;
import com.witness.web.uif.jsp.HtmlSelect;
import com.witness.web.uif.keys.ImageFileID;
import com.witness.web.uif.keys.JavaScriptFileID;
import com.witness.web.uif.keys.PageAction;
import com.witness.web.uif.l10n.UIFWebBundleKey;
import com.witness.web.uif.pagecomponent.picker.date.DatePickerPC;
import com.witness.web.uif.pagemodel.PopupWindowPM;
import com.witness.web.uif.system.RequestContext;
import com.witness.web.uif.util.HourMinInput;
import com.witness.web.uif.util.HtmlUtil;
import com.witness.web.uif.util.TimeZoneHelper;
import com.bluepumpkin.web.bbm.activity.ActivityModelHandler;
import com.witness.web.uif.util.html.CSSUtil;

import javax.servlet.http.HttpServletRequest;
import java.util.*;

/**
 * Title:        Blue Pumpkin Software Activity Management
 * Description:  Add time record model
 * Copyright:    Copyright (c) 2001
 * Company:      Blue Pumpkin Software, Inc
 * @author       Swati Tewari
 * @version 1.0
 */

public class AddTimeRecordModel extends PopupWindowPM{

	public static final String MODEL_KEY = &quot;AddTimeRecordModel&quot;;
	public static final String ADDTR_ACTION = &quot;ADDTR_ACTION&quot;;
	public static final String INSERTTE_ACTION = &quot;INSERTTE_ACTION&quot;;
	public static final String DELETETE_ACTION = &quot;DELETETE_ACTION&quot;;
	public static final String REFRESH_ACTION = &quot;REFRESH_ACTION&quot;;
	public static final String SAVETR_ACTION = &quot;SAVE_ACTION&quot;;
	public static final String DONE_ACTION = &quot;DONE_ACTION&quot;;
	public static final String CLOSEANDSAVETR_ACTION = &quot;CLOSEANDSAVETR_ACTION&quot;;

	// Page Actions
<span class="fc" id="L57">	private static Category cat  = Log.initCategory(AddTimeRecordModel.class.getName());</span>
	private ResourceBundle m_bundle;
	private ID empId;
	private String tableContent;
	private String pageTitleText;
	private String popUpHeader;
<span class="fc" id="L63">	private ArrayList tableData = new ArrayList();</span>
<span class="fc" id="L64">	private TimeRecord timeRecord = null;</span>
<span class="fc" id="L65">	private Date date = new Date();</span>
	private String selectedID;
	private ID[] selectedIDs;
<span class="fc" id="L68">	private int curIndex = 0;</span>
	private ID orgId;
	private ID timeRecordID;
<span class="fc" id="L71">	private String timeZone = null;</span>
<span class="fc" id="L72">	private int[] durationHour = new int[]{};</span>
<span class="fc" id="L73">	private int[] durationMinute = new int[]{};</span>
	private boolean[] isPaid;
	private String[] comment;
	private int position;
<span class="fc" id="L77">	private String remarks = &quot;&quot;;</span>
<span class="fc" id="L78">	ActivityGroup activityGroup = null;</span>
<span class="fc" id="L79">	private boolean m_isInitiated = false;</span>
	private int startYear;
	private int startMonth;
	private int startDay;
	private List m_dateList;

	//activity related variables
<span class="fc" id="L86">	private ArrayList activityCategoryNameList = new ArrayList();</span>
<span class="fc" id="L87">	private ArrayList activityCategoryIDList = new ArrayList();</span>
<span class="fc" id="L88">	private ArrayList activityColl = new ArrayList();</span>
<span class="fc" id="L89">	private ID[] activityList = new ID[]{};</span>
<span class="fc" id="L90">	private ID[] activityCategory = new ID[]{};</span>

	private DatePickerPC m_dateTimePickerPC;

	/**
	 * Constructor
	 */
	public AddTimeRecordModel(RequestContext context) {
<span class="fc" id="L98">		super(context);</span>
<span class="fc" id="L99">		m_bundle = m_localizer.getBundle(AmWebBundleKey.BUNDLE_NAME);</span>

<span class="fc" id="L101">		addRequiredJavaScriptFile(JavaScriptFileID.DIALOG_PICKERS);</span>
<span class="fc" id="L102">		addRequiredJavaScriptFile(JavaScriptFileID.DATEORMAT_UTILITIES);</span>

		//--- add a DatePicker Dialog Box to the model
		// It is enclosed in a DialogBoxPageModel to provide DialogMediator support.
<span class="fc" id="L106">		m_dateTimePickerPC = new DatePickerPC(context, &quot;display&quot;);</span>
<span class="fc" id="L107">		m_dateTimePickerPC.setIsTimeEnabled(true);</span>
<span class="fc" id="L108">		addChildComponent(m_dateTimePickerPC);</span>

		//presentation
<span class="fc" id="L111">		setMinWorkAreaHeight(70);</span>
<span class="fc" id="L112">		setWorkAreaId(&quot;summaryWrapper&quot;);</span>
<span class="fc" id="L113">	}</span>

	/**
	 * Return instance of Model which is ready to be rendered
	 */
	public static AddTimeRecordModel getInstance(RequestContext context)throws Exception{
<span class="fc" id="L119">		AddTimeRecordModel model = null;</span>
		try{
<span class="fc" id="L121">			model = (AddTimeRecordModel) context.getAttribute(RequestContext.REQUEST_SCOPE,</span>
								AddTimeRecordModel.MODEL_KEY);

<span class="pc bpc" id="L124" title="1 of 2 branches missed.">			if (model==null){</span>
				//create a new model
<span class="nc" id="L126">				model = new AddTimeRecordModel(context);</span>
			}

<span class="fc" id="L129">			model.populateModel(context);</span>
<span class="nc" id="L130">		} catch (UnableToLoadDataException ex){</span>
<span class="nc" id="L131">			cat.l7dError(AmWebLogBundleKey.UNABLE_TO_LOAD_DATA, ex);</span>
<span class="fc" id="L132">		}</span>
<span class="fc" id="L133">		return model;</span>
	}

	/**
	 * Return the resource bundle associated with the page model
	 */
	public ResourceBundle getBundle() {
<span class="nc" id="L140">		return m_bundle;</span>
	}

	/**
	 * Make sure that the model is populated
	 */
	private void populateModel(RequestContext context) throws UnableToLoadDataException, Exception {
<span class="fc" id="L147">		this.setTableContent(context);</span>
<span class="fc bfc" id="L148" title="All 2 branches covered.">		if (m_isInitiated) return;</span>
<span class="fc" id="L149">		this.setPopupPageTitle();</span>
<span class="fc" id="L150">		this.getPopupHeader();</span>
<span class="fc" id="L151">		initToolbar();</span>
<span class="fc" id="L152">		m_isInitiated = true;</span>
<span class="fc" id="L153">	}</span>

	protected void initToolbar(){
<span class="pc bpc" id="L156" title="1 of 2 branches missed.">		if (this.getPageAction().equals(CLOSEANDSAVETR_ACTION)){</span>
<span class="nc" id="L157">			m_toolbar.addValidateSubmitTextButton(</span>
				CLOSEANDSAVETR_ACTION,
<span class="nc" id="L159">				i18n(m_bundle, AmWebBundleKey.CLOSESHIFT_BUTTONLABEL),</span>
				true);
		}
<span class="fc" id="L162">		m_toolbar.addValidateSubmitTextButton(</span>
				SAVETR_ACTION,
<span class="fc" id="L164">				i18n(m_common_bundle, UIFWebBundleKey.TOOLBAR_SAVE),</span>
				true);
<span class="fc" id="L166">		m_toolbar.addCloseWindowTextButton(</span>
				PageAction.CANCEL,
<span class="fc" id="L168">				i18n(m_common_bundle, UIFWebBundleKey.TOOLBAR_CANCEL),</span>
				true);
<span class="fc" id="L170">	}</span>

	//override base class;  buttons: back, forward, refresh, print, preferences, help, logout, close
	protected void initUtilityPane() {
<span class="fc" id="L174">		this.getUtilityPane().setIsRefreshEnabled(false);</span>
<span class="fc" id="L175">	}</span>

	/**
	 * set empId
	 */
	public void setEmpId(ID empId){
<span class="fc" id="L181">		this.empId = empId;</span>
<span class="fc" id="L182">	}</span>

	/**
	 * get empId
	 */
	public ID getEmpId(){
<span class="fc" id="L188">		return this.empId;</span>
	}

	/**
	 * get pageTitleText
	 */
	public String getPageTitleText(){
<span class="nc" id="L195">		return this.pageTitleText;</span>
	}

	/**
	 * set pageTitleText
	 */
	public void setPageTitleText(String pageTitleText){
<span class="nc" id="L202">		this.pageTitleText = pageTitleText;</span>
<span class="nc" id="L203">	}</span>

	/**
	 * get tableData
	 */
	public ArrayList getTableData(){
<span class="nc" id="L209">		return this.tableData;</span>
	}

	/**
	 * set tableData
	 */
	public void setTableData(ArrayList tableData){
<span class="nc" id="L216">		this.tableData = tableData;</span>
<span class="nc" id="L217">	}</span>

	/**
	 * setPopupPageTitle()
	 */
	private void setPopupPageTitle(){
<span class="fc" id="L223">		m_contentTitlePC.setPageTitle(i18n(m_bundle, AmWebBundleKey.CREATE_NEW_RECORD)</span>
<span class="fc" id="L224">			+&quot; (&quot; + TimeZoneHelper.getDisplayTimeZone(this.getTimeZone(), m_localizer) +&quot;)&quot;);</span>
<span class="fc" id="L225">	}</span>

	private void getPopupHeader(){
<span class="fc" id="L228">		StringBuffer aSb = new StringBuffer(512);</span>
<span class="fc" id="L229">		aSb.append(&quot;&lt;tr&gt;&lt;th scope=\&quot;col\&quot; class=\&quot;popupDialogTitlePane\&quot; style=\&quot;&quot; + CSSUtil.STYLE_NORMAL_LEFT_PAD10 + &quot;\&quot; nowrap&gt;\n&quot; +</span>
<span class="fc" id="L230">				i18n(m_bundle, AmWebBundleKey.TIME) +</span>
				&quot;&lt;/td&gt;&lt;th scope=\&quot;col\&quot; class=\&quot;popupDialogTitlePane\&quot; style=\&quot;&quot; + CSSUtil.STYLE_NORMAL_LEFT_PAD10 + &quot;\&quot; nowrap&gt;\n&quot; +
<span class="fc" id="L232">				i18n(m_bundle, AmWebBundleKey.ACTIVITY_TYPE) +</span>
				&quot;&lt;/td&gt;&lt;th scope=\&quot;col\&quot; class=\&quot;popupDialogTitlePane\&quot; style=\&quot;&quot; + CSSUtil.STYLE_NORMAL_LEFT_PAD10 + &quot;\&quot; nowrap&gt;\n&quot; +
<span class="fc" id="L234">				i18n(m_bundle, AmWebBundleKey.ACTIVITY) +</span>
				&quot;&lt;/td&gt;&lt;th scope=\&quot;col\&quot; class=\&quot;popupDialogTitlePane\&quot; style=\&quot;&quot; + CSSUtil.STYLE_NORMAL_LEFT_PAD10 + &quot;\&quot; nowrap&gt;\n&quot; +
<span class="fc" id="L236">				i18n(m_bundle, AmWebBundleKey.DURATION) +</span>
				&quot;&lt;/td&gt;&lt;th scope=\&quot;col\&quot; class=\&quot;popupDialogTitlePane\&quot; style=\&quot;&quot; + CSSUtil.STYLE_NORMAL_LEFT_PAD10 + &quot;\&quot; nowrap&gt;\n&quot; +
<span class="fc" id="L238">				i18n(m_bundle, AmWebBundleKey.PAYABLE) +</span>
				&quot;&lt;/td&gt;&lt;th scope=\&quot;col\&quot; class=\&quot;popupDialogTitlePane\&quot; style=\&quot;&quot; + CSSUtil.STYLE_NORMAL_LEFT_PAD10 + &quot;\&quot; nowrap&gt;\n&quot; +
<span class="fc" id="L240">				i18n(m_bundle, AmWebBundleKey.MY_NOTES) +</span>
				&quot;&lt;/td&gt;&lt;th scope=\&quot;col\&quot; class=\&quot;popupDialogTitlePane\&quot; style=\&quot;&quot; + CSSUtil.STYLE_NORMAL_LEFT_PAD10 + &quot;\&quot; nowrap&gt;\n&quot; +
<span class="fc" id="L242">				i18n(m_bundle, AmWebBundleKey.ACTION) +</span>
				&quot;&lt;/td&gt;&quot;);

<span class="fc" id="L245">		aSb.append(&quot;&lt;/tr&gt;&quot;);</span>
<span class="fc" id="L246">		this.popUpHeader = aSb.toString();</span>
<span class="fc" id="L247">	}</span>
    
    
    //508
    private HtmlButton getBtn(String imgSrc, String title, String onClick, String buttonID) 
    {
<span class="fc" id="L253">        HtmlImage image = new HtmlImage(imgSrc);</span>
<span class="fc" id="L254">        image.setAttribute(&quot;class&quot;, &quot;imgToolbarDefault&quot;);</span>
<span class="fc" id="L255">        image.setAlt(title);</span>
        
<span class="fc" id="L257">        HtmlButton button = new HtmlButton(buttonID);</span>
<span class="fc" id="L258">        button.setInnerHtml(image);</span>
<span class="fc" id="L259">        button.setAttribute(&quot;class&quot;, &quot;imgToolbarDefault&quot;);</span>
<span class="fc" id="L260">        button.appendAttribute(&quot;align&quot;, &quot;absmiddle&quot;);</span>
<span class="fc" id="L261">        button.setOnClick(onClick);</span>
<span class="fc" id="L262">        button.setAttribute(&quot;title&quot;, title);</span>
<span class="fc" id="L263">        button.setStyle(&quot;margin:0px; border:none; background-color:transparent;&quot;);</span>
        
<span class="fc" id="L265">        return button;</span>
    }     
    
    /**
     * Get the time zone offset (from GMT) of the date picker's date, based on the dialog's time zone.
     */
    public int getTimeZoneOffset()
    {
<span class="fc" id="L273">    	TimeZone tz = TimeZone.getTimeZone(this.timeZone);</span>
<span class="fc" id="L274">    	return tz.getOffset(m_dateTimePickerPC.getDate().getTime());</span>
    }

	public void setTableContent(RequestContext context) throws Exception{
<span class="fc" id="L278">		StringBuffer aSb = new StringBuffer(512);</span>

<span class="fc bfc" id="L280" title="All 2 branches covered.">		ArrayList aList = this.getTimeRecord()!=null?(ArrayList)this.getTimeRecord().getChildren():new ArrayList();</span>

<span class="fc" id="L282">		m_dateTimePickerPC.setTimeZone(TimeZone.getTimeZone(this.timeZone));</span>

<span class="fc bfc" id="L284" title="All 2 branches covered.">		if (aList.size()&gt;0){</span>
			//get date for selection
<span class="fc" id="L286">			TimeRecordEntry trEntry = (TimeRecordEntry)aList.get(0);</span>
<span class="fc" id="L287">			getDateTimePicker().setDateInputIndex(0);</span>
<span class="fc" id="L288">			getDateTimePicker().setDate(trEntry.getStartTime());</span>
<span class="fc" id="L289">			getDateTimePicker().setOnChangeJS(&quot;setTimes('0');&quot;);</span>
            
<span class="fc" id="L291">			aSb.append(&quot;&lt;tr&gt;&quot; +</span>
			&quot;&lt;th scope=\&quot;row\&quot; class=\&quot;popupDialogPane\&quot; style=\&quot;padding-left:10px\&quot; nowrap&gt;&quot;+
<span class="fc" id="L293">			getDateTimePicker().getHtmlDisplay() +</span>
			&quot;&lt;/td&gt;&quot; +
			&quot;&lt;td class=\&quot;popupDialogPane\&quot; style=\&quot;padding-left:10px\&quot;&gt;&amp;nbsp;&lt;/td&gt;&quot; +
			&quot;&lt;td class=\&quot;popupDialogPane\&quot; style=\&quot;padding-left:10px\&quot;&gt;&lt;span class=\&quot;headerText2\&quot;&gt;&quot; +
<span class="fc" id="L297">			m_localizer.i18n(m_bundle, AmWebBundleKey.START_SHIFT) +</span>
			&quot;&lt;/span&gt;&lt;/td&gt;&quot; +
			&quot;&lt;td  colspan=\&quot;3\&quot; class=\&quot;popupDialogPane\&quot; style=\&quot;padding-left:10px\&quot;&gt;&amp;nbsp;&lt;/td&gt;&quot; +
			&quot;&lt;td class=\&quot;popupDialogPane\&quot; style=\&quot;padding-left:10px\&quot;&gt;&quot; +

<span class="fc" id="L302">            getBtn(ImageFileID.ADD, </span>
<span class="fc" id="L303">                    m_localizer.i18n(m_bundle, AmWebBundleKey.INSERT_TIME_ENTRY), </span>
                    &quot;insertEntry(0);&quot;,
                    &quot;INSERT_ENTRY&quot;) +
            
			&quot;&lt;/td&gt;&quot; +
			&quot;&lt;/tr&gt;&quot;);//
		}
<span class="fc bfc" id="L310" title="All 2 branches covered.">		for (int j=0; j&lt;aList.size(); j++){</span>
<span class="fc" id="L311">			TimeRecordEntry trEntry = (TimeRecordEntry)aList.get(j);</span>

<span class="fc bfc" id="L313" title="All 2 branches covered.">			if (!trEntry.getActivityID().equals(Activity.ACTIVITY_NONE)){</span>
<span class="fc" id="L314">				getDateTimePicker().setDate(trEntry.getStartTime());</span>
<span class="fc" id="L315">				getDateTimePicker().setDateInputIndex(j+1);</span>
<span class="fc" id="L316">				getDateTimePicker().setOnChangeJS(&quot;setTimes(&quot;+(j+1)+&quot;);&quot;);</span>

<span class="fc" id="L318">				aSb.append(&quot;&lt;tr&gt;&lt;th scope=\&quot;row\&quot; class=\&quot;popupDialogPane\&quot; style=\&quot;padding-left:10px\&quot; nowrap&gt;&quot; +</span>
<span class="fc" id="L319">				&quot;&lt;span id=\&quot;&quot; + &quot;r&quot;+ String.valueOf(j)+&quot;\&quot; class=\&quot;headerTextSmall\&quot;&gt;&quot; +</span>
<span class="fc" id="L320">				getDateTimePicker().getHtmlDisplay() +</span>
				&quot;&lt;/td&gt;&lt;td class=\&quot;popupDialogPane\&quot; style=\&quot;padding-left:10px\&quot;&gt;&quot; +
<span class="fc" id="L322">				getActivityCategorySelector(j) +</span>
				&quot;&lt;/td&gt;&quot; +
				&quot;&lt;td class=\&quot;popupDialogPane\&quot; style=\&quot;padding-left:10px\&quot;&gt;&quot; +
<span class="fc" id="L325">				getActivitySelector(j, trEntry.getActivityID()) +</span>
				&quot;&lt;td class=\&quot;popupDialogPane\&quot; style=\&quot;padding-left:10px\&quot; nowrap&gt;&lt;span class=\&quot;headerText2\&quot;&gt;&quot; +
<span class="fc" id="L327">				HourMinInput.getHourMinInput(&quot;duration&quot;+String.valueOf(j), getDisplayDuration(trEntry.getDuration())[0],</span>
<span class="fc" id="L328">					getDisplayDuration(trEntry.getDuration())[1], 0, 24, &quot;adjustDate(&quot;+ String.valueOf(j) +&quot;)&quot;) +</span>
				&quot;&lt;/span&gt;&lt;/td&gt;&quot; +
				&quot;&lt;td class=\&quot;popupDialogPane\&quot; style=\&quot;padding-left:10px\&quot;&gt;&quot;);

<span class="pc bpc" id="L332" title="1 of 2 branches missed.">				String isChecked = trEntry.getPaid()?&quot;checked&quot;:&quot;&quot;;</span>
<span class="fc" id="L333">				aSb.append(&quot;&lt;input type=\&quot;checkbox\&quot; name=\&quot;payType\&quot; &quot;+</span>
				isChecked +
				&quot; onChange=\&quot;setPageDirty();\&quot;&gt;&quot; +
				&quot;&lt;input type=\&quot;hidden\&quot; name=\&quot;isPaid\&quot; value=\&quot;\&quot;&gt;&lt;/td&gt;&quot; +
				&quot;&lt;td class=\&quot;popupDialogPane\&quot; style=\&quot;padding-left:10px\&quot;&gt;&quot; +
<span class="fc" id="L338">				HtmlUtil.makeTextInput(&quot;comment&quot;, 10, 200, trEntry.getDescription(), &quot;setPageDirty();&quot;) +</span>
				&quot;&lt;/td&gt;&lt;td class=\&quot;popupDialogPane\&quot; style=\&quot;padding-left:10px\&quot;&gt;&quot; +
                
<span class="fc" id="L341">                getBtn(ImageFileID.ADD, </span>
<span class="fc" id="L342">                        m_localizer.i18n(m_bundle, AmWebBundleKey.INSERT_TIME_ENTRY), </span>
                        &quot;insertEntry(&quot; + (j+1) + &quot;);&quot;,
                        &quot;INSERT_ENTRY&quot;) +
                        
                &quot;&amp;nbsp;&quot; +
                
<span class="fc" id="L348">                getBtn(ImageFileID.DELETE, </span>
<span class="fc" id="L349">                        m_localizer.i18n(m_bundle, AmWebBundleKey.DELETE_TIME_ENTRY), </span>
                        &quot;deleteEntry(&quot; + (j+1) + &quot;);&quot;,
                        &quot;INSERT_ENTRY&quot;) +
                        
				&quot;&lt;/td&gt;&lt;/tr&gt;&quot;);
<span class="fc" id="L354">			} else {//end shift%&gt;</span>
<span class="fc" id="L355">				getDateTimePicker().setDate(trEntry.getStartTime());</span>
<span class="fc" id="L356">				getDateTimePicker().setDateInputIndex(j+1);</span>
<span class="fc" id="L357">				getDateTimePicker().setOnChangeJS(&quot;setTimes(&quot;+(j+1)+&quot;);&quot;);</span>
<span class="fc" id="L358">				aSb.append(&quot;&lt;tr&gt;&quot; +</span>
				&quot;&lt;th scope=\&quot;row\&quot; class=\&quot;popupDialogPane\&quot; style=\&quot;padding-left:10px\&quot; nowrap&gt;&quot; +
<span class="fc" id="L360">				getDateTimePicker().getHtmlDisplay() +</span>
				&quot;&lt;/td&gt;&quot; +
				&quot;&lt;td class=\&quot;popupDialogPane\&quot; style=\&quot;padding-left:10px\&quot;&gt;&amp;nbsp;&lt;/td&gt;&quot; +
				&quot;&lt;td class=\&quot;popupDialogPane\&quot; style=\&quot;padding-left:10px\&quot;&gt;&lt;span class=\&quot;headerText2\&quot;&gt;&quot; +
<span class="fc" id="L364">				m_localizer.i18n(m_bundle, AmWebBundleKey.END_SHIFT) +</span>
				&quot;&lt;/span&gt;&lt;/td&gt;&quot; +
				&quot;&lt;td class=\&quot;popupDialogPane\&quot; style=\&quot;padding-left:10px\&quot; colspan=\&quot;4\&quot;&gt;&amp;nbsp;&lt;/td&gt;&quot; +
				&quot;&lt;/tr&gt;&quot;);
			}
		}
		//add remaks
<span class="fc" id="L371">		aSb.append(&quot;&lt;tr&gt;&quot; +</span>
				&quot;&lt;td class=\&quot;popupDialogPane\&quot; style=\&quot;padding-left:10px\&quot; nowrap&gt;&quot; +
				&quot;&lt;span class=\&quot;boldTextSm\&quot;&gt;&quot; +
<span class="fc" id="L374">				i18n(m_bundle, AmWebBundleKey.COMMENTS) +</span>
				&quot;&lt;/span&gt;&quot; +
				&quot;&lt;/td&gt;&lt;td class=\&quot;popupDialogPane\&quot; style=\&quot;padding-left:10px\&quot; nowrap colspan=\&quot;6\&quot;&gt;&quot; +
<span class="fc" id="L377">				HtmlUtil.makeTextInput(&quot;remarks&quot;, 100, 200, this.getRemarks()) +</span>
				&quot;&lt;/td&gt;&lt;/tr&gt;&quot;);
<span class="fc" id="L379">		this.tableContent = aSb.toString();</span>
<span class="fc" id="L380">	}</span>

	/**
	 * getActivityCategorySelector()
	 * return HtmlSelect
	 */
	private HtmlSelect getActivityCategorySelector(int index){
<span class="fc" id="L387">		HtmlSelect activityCategorySelect = new HtmlSelect(&quot;activityCategory&quot;);</span>
<span class="fc" id="L388">		activityCategorySelect.setStyleClass(&quot;dropDown&quot;);</span>
<span class="fc" id="L389">		activityCategorySelect.setAttribute(&quot;nameIndex&quot;, &quot;&quot;+index);</span>
<span class="fc" id="L390">		activityCategorySelect.setOnChange(&quot;populateSecondaryListFromPreLoad(this, &quot; + index + &quot;);&quot;);</span>
		try {
<span class="fc" id="L392">			activityCategorySelect.setOptions(this.getActivityCategoryNameList(),</span>
<span class="fc" id="L393">				this.getActivityCategoryIDList(), this.getActivityCategory()[index].toString());</span>
<span class="nc" id="L394">		} catch (Exception ex){</span>

<span class="fc" id="L396">		}</span>
<span class="fc" id="L397">		return activityCategorySelect;</span>
	}

	/**
	 * getActivitySelector()
	 * returnHtmlSelect
	 */
	private String getActivitySelector(int index, ID activityID){
<span class="fc" id="L405">		ArrayList activityObject = (ArrayList) this.getActivityColl().get(index);</span>
<span class="fc" id="L406">		ArrayList list = new ArrayList();</span>

<span class="fc" id="L408">		ArrayList activityIDList = (ArrayList)activityObject.get(1);</span>
<span class="fc" id="L409">		ArrayList activityNameList = (ArrayList)activityObject.get(0);</span>
<span class="fc bfc" id="L410" title="All 2 branches covered.">		for (int i=0; i&lt;activityIDList.size(); i++){</span>
<span class="fc" id="L411">			list.add(new StringsPair((String)activityNameList.get(i), (String)activityIDList.get(i)));</span>
		}
<span class="fc" id="L413">		return HtmlUtil.makeSelectInput(&quot;activityList&quot;, &quot;&quot;+index,</span>
<span class="fc" id="L414">			new String[]{activityID.toString()}, &quot;activityChanged('&quot;+index+&quot;');&quot;, list, &quot;125px&quot;);</span>
	}

	/**
	 * getDisplayDuration
	 * return int[]
	 */
	private int[] getDisplayDuration(int duration){
<span class="fc" id="L422">		int[] aDuration = JSPUtil.getDisplayDuration(duration*60);</span>

<span class="fc" id="L424">		return aDuration;</span>
	}

	/**
	 * Return the JavaScript init code required by Page model.
	 *
	 * Default behavior is to retrieve sub-component JavaScript Init code
	 */
	public String getJavaScriptInitCode()
	{
		//generate string to close popup
<span class="fc" id="L435">		String template = &quot;&quot;;</span>
<span class="pc bpc" id="L436" title="1 of 4 branches missed.">		if (this.getPageAction()!=null &amp;&amp; this.getPageAction().equals(DONE_ACTION)){</span>
<span class="fc" id="L437">			setOpenerValueOnClose(&quot;selectedID&quot;, this.selectedID, true);</span>
<span class="fc" id="L438">			setOpenerValueOnClose(&quot;editIndex&quot;, String.valueOf(this.curIndex), false);</span>
<span class="fc" id="L439">            setRefreshOpenerWithAction(&quot;&quot;);</span>
<span class="fc" id="L440">			setIsCloseAfterLoad(true);</span>
		} else {
<span class="pc bpc" id="L442" title="1 of 4 branches missed.">			if (this.getPageAction()!=null &amp;&amp; this.getPageAction().equals(INSERTTE_ACTION)){</span>
<span class="fc" id="L443">            	template = &quot;setLastActivityPaid()&quot;;</span>
<span class="pc bpc" id="L444" title="2 of 4 branches missed.">			} else if (this.getPageAction()!=null &amp;&amp; this.getPageAction().equals(ADDTR_ACTION)){</span>
<span class="fc" id="L445">				template = &quot;setActivityPaid()&quot;;</span>
			}
<span class="fc" id="L447">			setWorkAreaId(&quot;summaryWrapper&quot;);</span>
<span class="fc" id="L448">			setMinWorkAreaHeight(80);</span>
		}

<span class="fc" id="L451">		StringBuffer jsInitCode = new StringBuffer(512);</span>

		// Add sub-component JavaScript code first
<span class="fc" id="L454">		jsInitCode.append(super.getJavaScriptInitCode()).append(&quot;\n&quot;);</span>

		// [now create the new mediator]
<span class="fc" id="L457">		jsInitCode.append(template);</span>

<span class="fc" id="L459">		return jsInitCode.toString();</span>
	}

	/**
	 * setActivityGroup()
	 */
	public void setActivityGroup(){
<span class="fc bfc" id="L466" title="All 2 branches covered.">		if (this.activityGroup == null){</span>
			try {
<span class="fc" id="L468">				activityGroup =	ActivityModelHandler.getActivityGroup(m_context, getOrgId(), ActivityGroup.ALL_ACTIVITYCATEGORIES);</span>
<span class="nc" id="L469">			} catch (Exception ex){</span>
<span class="nc" id="L470">				handleUnableToLoadDataError(log, ex);</span>
<span class="fc" id="L471">			}</span>
		}
<span class="fc" id="L473">	}</span>

	/**
	 * Return the custom JavaScript code for the Page model.
	 */
	public String getCustomJavaScript() {
<span class="fc" id="L479">		StringBuffer jsInitCode = new StringBuffer(512);</span>

<span class="fc" id="L481">		jsInitCode.append(&quot;\nfunction customValidateForm(){&quot;)</span>
<span class="fc" id="L482">		.append(&quot;\n\tvalidateSubmit();\n&quot;)</span>
<span class="fc" id="L483">		.append(&quot;}\n&quot;);</span>


<span class="fc" id="L486">		setActivityGroup();</span>
		//create the arrays of activity category and activities to preload into the jsp
		// Create the Primary dropdown collection
<span class="fc" id="L489">		ArrayList primary = new ArrayList();</span>

<span class="pc bpc" id="L491" title="1 of 2 branches missed.">		ArrayList activityCategories = this.activityGroup.getActivityCategories().size()&gt;0?</span>
<span class="pc" id="L492">			(ArrayList)this.activityGroup.getActivityCategories():new ArrayList();</span>

<span class="fc" id="L494">		Collection activities = null;</span>
<span class="pc bpc" id="L495" title="1 of 2 branches missed.">		activities = this.activityGroup.getActivities().size()&gt;0?</span>
<span class="pc" id="L496">			this.activityGroup.getActivities():new ArrayList();</span>

<span class="fc" id="L498">		ArrayList[] secondaryLists = new ArrayList[activityCategories.size()];</span>
<span class="fc bfc" id="L499" title="All 2 branches covered.">		for (int i=0; i&lt;activityCategories.size(); i++){</span>
<span class="fc" id="L500">			ActivityCategory activityCategory = (ActivityCategory)activityCategories.get(i);</span>
<span class="fc" id="L501">			StringsPair sp = new StringsPair(activityCategory.getID().toString(),</span>
<span class="fc" id="L502">					activityCategory.getName());</span>
<span class="fc" id="L503">			primary.add(sp);</span>

<span class="fc" id="L505">			ArrayList actList = new ArrayList();</span>
<span class="pc bpc" id="L506" title="2 of 4 branches missed.">			if (activities!=null &amp;&amp; activities.size()&gt;0){</span>
<span class="fc bfc" id="L507" title="All 2 branches covered.">				for( Iterator j = activities.iterator(); j.hasNext(); ) {</span>
<span class="fc" id="L508">					Activity activity = (Activity)j.next();</span>
<span class="fc bfc" id="L509" title="All 2 branches covered.">					if (!activityCategory.getOrganizationId().equals(new ID(Organization.ROOT_ORG_ID)) &amp;&amp;</span>
<span class="fc bfc" id="L510" title="All 2 branches covered.">							activity.getActivityCategoryId().equals(activityCategory.getID())){</span>
<span class="fc" id="L511">						StringsPair actSp = new StringsPair(activity.getID().toString(), activity.getName());</span>
<span class="fc" id="L512">						actList.add(actSp);</span>
					}
<span class="fc" id="L514">				}</span>
			}
<span class="fc" id="L516">			secondaryLists[i] = actList;</span>
		}

<span class="fc" id="L519">		jsInitCode.append(&quot;var secondaryLists;\n&quot;)</span>
<span class="fc" id="L520">		.append(&quot;secondaryLists = new Array(&quot; + primary.size() +&quot;);\n&quot;);</span>

<span class="fc bfc" id="L522" title="All 2 branches covered.">		for (int i=0; i &lt; primary.size(); i++) {</span>
<span class="fc" id="L523">			ArrayList list = secondaryLists[i];</span>
<span class="fc" id="L524">			jsInitCode.append(&quot;var secondaryList = new Array(2);\n&quot;)</span>
<span class="fc" id="L525">			.append(&quot;var secondaryValues = new Array(&quot; + list.size() +&quot;);\n&quot;)</span>
<span class="fc" id="L526">			.append(&quot;var secondaryText = new Array(&quot;+list.size() + &quot;);\n&quot;);</span>

<span class="fc bfc" id="L528" title="All 2 branches covered.">			if (list.size()&gt;0){</span>
<span class="fc bfc" id="L529" title="All 2 branches covered.">				for (int option=0; option &lt; list.size(); option++) {</span>
<span class="fc" id="L530">					jsInitCode.append(&quot;secondaryValues[&quot; +option +&quot;] = \'&quot; + ((StringsPair)list.get(option)).getKey() +&quot;\';\n&quot;)</span>
<span class="fc" id="L531">					.append(&quot;secondaryText[&quot; + option + &quot;] = \'&quot; + JSPUtil.escapeString(((StringsPair)list.get(option)).getValue(), &quot;'&quot;) + &quot;\';\n&quot;);</span>
				}
			} else {
<span class="fc" id="L534">				jsInitCode.append(&quot;secondaryValues[0] = \'-1\';\n&quot;)</span>
<span class="fc" id="L535">					.append(&quot;secondaryText[0] = \'\';\n&quot;);</span>
			}

<span class="fc" id="L538">			jsInitCode.append(&quot;secondaryList[0] = secondaryValues;\n&quot;)</span>
<span class="fc" id="L539">			.append(&quot;secondaryList[1] = secondaryText;\n&quot;)</span>
<span class="fc" id="L540">			.append(&quot;secondaryLists[&quot; + ((StringsPair)primary.get(i)).getKey() + &quot;] = secondaryList;\n&quot;);</span>
		}
        //add all activities and paid value to a new array
<span class="pc bpc" id="L543" title="2 of 4 branches missed.">		if (activities!=null &amp;&amp; activities.size()&gt;0){</span>
<span class="fc" id="L544">			jsInitCode.append(&quot;var actvitiyIDArray;\n&quot;)</span>
<span class="fc" id="L545">			.append(&quot;actvitiyIDArray = new Array(&quot; + activities.size() +&quot;);\n&quot;);</span>
<span class="fc" id="L546">			jsInitCode.append(&quot;var actvitiyPaidArray;\n&quot;)</span>
<span class="fc" id="L547">			.append(&quot;actvitiyPaidArray = new Array(&quot; + activities.size() +&quot;);\n&quot;);</span>
<span class="fc" id="L548">			int count = 0;</span>
<span class="fc bfc" id="L549" title="All 2 branches covered.">			for( Iterator j = activities.iterator(); j.hasNext(); count++) {</span>
<span class="fc" id="L550">				Activity activity = (Activity)j.next();</span>
<span class="fc" id="L551">				jsInitCode.append(&quot;actvitiyIDArray[&quot; + count +&quot;] = \'&quot; + activity.getID().toString() +&quot;\';\n&quot;);</span>
<span class="fc" id="L552">				jsInitCode.append(&quot;actvitiyPaidArray[&quot; + count +&quot;] = \'&quot; + activity.isPaid() +&quot;\';\n&quot;);</span>
			}
		}
<span class="fc" id="L555">		return jsInitCode.toString();</span>
	}

	/**
	 * processActivityGroup()
	 */
	public void processActivityGroup(){
		//get activitygroup
<span class="fc" id="L563">		setActivityGroup();</span>

<span class="fc" id="L565">		Collection actCategories = this.activityGroup.getActivityCategories();</span>
<span class="fc" id="L566">		ID aCatID = null;</span>
		//need to get available activity category if first visit
<span class="pc bpc" id="L568" title="1 of 2 branches missed.">		for( Iterator i = actCategories.iterator(); i.hasNext(); ) {</span>
<span class="fc" id="L569">			ActivityCategory activityCategoryInt = (ActivityCategory)i.next();</span>
<span class="pc bpc" id="L570" title="1 of 2 branches missed.">			if (!activityCategoryInt.getOrganizationId().equals(new ID(Organization.ROOT_ORG_ID))){</span>
<span class="fc" id="L571">				aCatID = activityCategoryInt.getID();</span>
<span class="fc" id="L572">				break;</span>
			}
<span class="nc" id="L574">		}</span>

		try {
<span class="fc" id="L577">			processActivityCategoryInfo(actCategories);</span>
<span class="fc" id="L578">			processActivityInfo(aCatID);</span>
<span class="nc" id="L579">		} catch (Exception ex){</span>
<span class="nc" id="L580">			cat.l7dError(AmWebLogBundleKey.UNABLE_TO_LOAD_DATA, ex);</span>
<span class="fc" id="L581">		}</span>
<span class="fc" id="L582">	}</span>

	/**
	 * processActivityCategoryInfo
	 * @param activityCategories
	 */
	public void processActivityCategoryInfo(Collection activityCategories)
	throws Exception{
		//put items into ArrayLists and set the model
<span class="fc bfc" id="L591" title="All 2 branches covered.">		for( Iterator i = activityCategories.iterator(); i.hasNext(); ) {</span>
<span class="fc" id="L592">			ActivityCategory activityCategory = (ActivityCategory)i.next();</span>
<span class="fc bfc" id="L593" title="All 2 branches covered.">			if (!activityCategory.getOrganizationId().equals(new ID(Organization.ROOT_ORG_ID))){</span>
<span class="fc" id="L594">				this.activityCategoryNameList.add(activityCategory.getName());</span>
<span class="fc" id="L595">				this.activityCategoryIDList.add(activityCategory.getID().toString());</span>
			}
<span class="fc" id="L597">		}</span>
<span class="fc" id="L598">	}</span>

	/**
	 * processActivityInfo
	 * @param aCatID
	 */
	public void processActivityInfo(ID aCatID)
	throws Exception{

<span class="fc bfc" id="L607" title="All 2 branches covered.">		if (this.timeRecord != null){</span>
<span class="fc bfc" id="L608" title="All 2 branches covered.">			for (int i=0; i&lt;this.getTimeRecord().getChildren().size()-1;i++){</span>
<span class="fc" id="L609">				setActivityColl(aCatID, i);</span>
			}
		} else {
<span class="fc" id="L612">			 setActivityColl(aCatID, 0);</span>
		}
<span class="fc" id="L614">	}</span>

	/**
	 * set the activity collection
	 * @param aCatID category ID
	 * @param aPosition
	 */
	private void setActivityColl(ID aCatID, int aPosition)
	throws Exception{
<span class="fc" id="L623">		ArrayList activityCollList = new ArrayList();</span>
<span class="fc" id="L624">		ArrayList activityIDList = new ArrayList();</span>
<span class="fc" id="L625">		ArrayList activityNameList = new ArrayList();</span>
<span class="pc bpc" id="L626" title="1 of 2 branches missed.">		if (this.activityCategory != null){</span>
<span class="pc bpc" id="L627" title="1 of 4 branches missed.">			if (!this.activityCategory[aPosition].equals(new ID(0)) &amp;&amp; this.activityCategory[aPosition] != null){</span>
<span class="fc" id="L628">				aCatID = new ID(this.getActivityCategory()[aPosition]);</span>
			}

			//get activities from activitygroup
<span class="fc" id="L632">			Collection activities = this.activityGroup.getActivities();</span>

<span class="pc bpc" id="L634" title="2 of 4 branches missed.">			if (activities!=null &amp;&amp; activities.size()&gt;0){</span>
<span class="fc bfc" id="L635" title="All 2 branches covered.">				for( Iterator j = activities.iterator(); j.hasNext(); ) {</span>
<span class="fc" id="L636">					Activity activity = (Activity)j.next();</span>
<span class="fc bfc" id="L637" title="All 2 branches covered.">					if (activity.getActivityCategoryId().equals(aCatID)){</span>
<span class="fc" id="L638">						activityIDList.add(activity.getID().toString());</span>
<span class="fc" id="L639">						activityNameList.add(activity.getName());</span>
					}
<span class="fc" id="L641">				}</span>
			}

<span class="pc bpc" id="L644" title="1 of 2 branches missed.">			if (activityIDList.size() == 0) {</span>
<span class="nc" id="L645">				activityIDList.add(&quot;-1&quot;);</span>
<span class="nc" id="L646">				activityNameList.add(&quot;&quot;);</span>
			}
<span class="fc" id="L648">			activityCollList.add(0 , activityIDList);</span>
<span class="fc" id="L649">			activityCollList.add(1 , activityNameList);</span>

			//set model values
<span class="fc" id="L652">			this.activityColl.add(activityCollList);</span>
		}
<span class="fc" id="L654">	}</span>

	/**
	 * set orgId
	 */
	public void setOrgId(ID orgId){
<span class="fc" id="L660">		this.orgId = orgId;</span>
<span class="fc" id="L661">	}</span>

	/**
	 * get orgId
	 */
	public ID getOrgId(){
<span class="fc" id="L667">		return this.orgId;</span>
	}

	/**
	 * set timeRecordID
	 */
	public void setTimeRecordID(ID timeRecordID){
<span class="nc" id="L674">		this.timeRecordID = timeRecordID;</span>
<span class="nc" id="L675">	}</span>

	/**
	 * get timeRecordID
	 */
	public ID getTimeRecordID(){
<span class="fc" id="L681">		return this.timeRecordID;</span>
	}

	/**
	* Set timeZone
	*/
	public void setTimeZone(String timeZone){
<span class="fc" id="L688">		this.timeZone = timeZone;</span>
<span class="fc" id="L689">	}</span>

	/**
	* Get timeZone
	*/
	public String getTimeZone(){
<span class="fc" id="L695">		return this.timeZone;</span>
	}

	/**
	* Set activityCategoryNameList
	*/
	public void setActivityCategoryColl(ArrayList activityCategoryNameList){
<span class="nc" id="L702">		this.activityCategoryNameList = activityCategoryNameList;</span>
<span class="nc" id="L703">	}</span>

	/**
	* Get activityCategoryNameList
	*/
	public ArrayList getActivityCategoryNameList(){
<span class="fc" id="L709">		return this.activityCategoryNameList;</span>
	}

	/**
	* Set activityCategoryIDList
	*/
	public void setActivityCategoryIDList(ArrayList activityCategoryIDList){
<span class="nc" id="L716">		this.activityCategoryIDList = activityCategoryIDList;</span>
<span class="nc" id="L717">	}</span>

	/**
	* Get activityCategoryIDList
	*/
	public ArrayList getActivityCategoryIDList(){
<span class="fc" id="L723">		return this.activityCategoryIDList;</span>
	}

	/**
	* Set activityColl
	*/
	public void setActivityColl(ArrayList activityColl){
<span class="nc" id="L730">		this.activityColl = activityColl;</span>
<span class="nc" id="L731">	}</span>

	/**
	* Get activityColl
	*/
	public ArrayList getActivityColl(){
<span class="fc" id="L737">		return this.activityColl;</span>
	}

	/**
	 * set activityList
	 */
	public void setActivityList(String[] actList){
<span class="fc" id="L744">		ID[] tempActCat = null;</span>
<span class="pc bpc" id="L745" title="2 of 4 branches missed.">			if (actList != null &amp;&amp; actList.length&gt;0){</span>
<span class="fc" id="L746">				tempActCat = new ID[actList.length];</span>
<span class="fc bfc" id="L747" title="All 2 branches covered.">				for (int i=0; i&lt;actList.length; i++){</span>
<span class="fc" id="L748">					tempActCat[i] = new ID(actList[i]);</span>
				}
			}
<span class="fc" id="L751">		this.activityList = tempActCat;</span>
<span class="fc" id="L752">	}</span>

	/**
	 * get activityList
	 */
	public ID[] getActivityList(){
<span class="fc" id="L758">		return this.activityList;</span>
	}

	/**
	 * set activityCategory
	 */
	public void setActivityCategory(String[] actCat){
<span class="fc" id="L765">		ID[] tempActCat = null;</span>
<span class="pc bpc" id="L766" title="2 of 4 branches missed.">		if (actCat != null &amp;&amp; actCat.length&gt;0){</span>
<span class="fc" id="L767">			tempActCat = new ID[actCat.length];</span>
<span class="fc bfc" id="L768" title="All 2 branches covered.">			for (int i=0; i&lt;actCat.length; i++){</span>
<span class="fc" id="L769">				tempActCat[i] = new ID(actCat[i]);</span>
			}
		}
<span class="fc" id="L772">		this.activityCategory = tempActCat;</span>
<span class="fc" id="L773">	}</span>

	/**
	 * get activityCategory
	 */
	public ID[] getActivityCategory(){
<span class="fc" id="L779">		return this.activityCategory;</span>
	}

	/**
	 * set timeRecord
	 */
	public void setTimeRecord(TimeRecord timeRecord){
<span class="fc" id="L786">		this.timeRecord = timeRecord;</span>
<span class="fc" id="L787">	}</span>

	/**
	 * get timeRecord
	 */
	public TimeRecord getTimeRecord(){
<span class="fc" id="L793">		return this.timeRecord;</span>
	}

	/**
	 * set date
	 */
	public void setDate(String date){
<span class="fc" id="L800">		this.date = new Date(Long.valueOf(date).longValue());</span>
<span class="fc" id="L801">	}</span>

	/**
	 * get date
	 */
	public Date getDate(){
<span class="fc" id="L807">		return this.date;</span>
	}

	/**
	 * Set Selected IDs
	 *
	 * @param ids Comma delimited IDs
	 */
	public void setSelectedIDs(String ids) {
<span class="fc" id="L816">		this.selectedIDs = StringUtil.parseIDString(ids);</span>
<span class="fc" id="L817">	}</span>

	/**
	 * Return Selected IDS in a Comman delimited IDs
	 */
	public ID[] getSelectedIDs() {
<span class="fc" id="L823">		return this.selectedIDs;</span>
	}

	/**
	 * Set Selected IDs
	 *
	 * @param selectedID Comma delimited IDs
	 */
	public void setSelectedID(String selectedID) {
<span class="fc" id="L832">		this.selectedID = selectedID;</span>
<span class="fc" id="L833">		this.setSelectedIDs(selectedID);</span>
<span class="fc" id="L834">	}</span>

	/**
	 * Return Selected IDS as a string
	 */
	public String getSelectedID() {
<span class="fc" id="L840">		return this.selectedID;</span>
	}

	/**
	* Set curIndex
	*/
	public void setCurIndex(int curIndex){
<span class="fc" id="L847">		this.curIndex = curIndex;</span>
<span class="fc" id="L848">	}</span>

	/**
	* Get curIndex
	*/
	public int getCurIndex(){
<span class="fc" id="L854">		return this.curIndex;</span>
	}

	/**
	 * set startYear
	 */
	public void setStartYear(int startYear){
<span class="fc" id="L861">		this.startYear = startYear;</span>
<span class="fc" id="L862">	}</span>

	/**
	 * get startYear
	 */
	public int getStartYear(){
<span class="fc" id="L868">		return this.startYear;</span>
	}

	/**
	 * set startMonth
	 */
	public void setStartMonth(int startMonth){
<span class="fc" id="L875">		this.startMonth = startMonth;</span>
<span class="fc" id="L876">	}</span>

	/**
	 * get startMonth
	 */
	public int getStartMonth(){
<span class="fc" id="L882">		return this.startMonth;</span>
	}

	/**
	 * set startDay
	 */
	public void setStartDay(int startDay){
<span class="fc" id="L889">		this.startDay = startDay;</span>
<span class="fc" id="L890">	}</span>

	/**
	 * get startDay
	 */
	public int getStartDay(){
<span class="fc" id="L896">		return this.startDay;</span>
	}

	/**
	 * set durationHour
	 */
	public void setDurationHour(int[] durationHour){
<span class="fc" id="L903">		this.durationHour = durationHour;</span>
<span class="fc" id="L904">	}</span>

	/**
	 * get durationHour
	 */
	public int[] getDurationHour(){
<span class="fc" id="L910">		return durationHour;</span>
	}

	/**
	 * set durationMinute
	 */
	public void setDurationMinute(int[] durationMinute){
<span class="fc" id="L917">		this.durationMinute = durationMinute;</span>
<span class="fc" id="L918">	}</span>

	/**
	 * get durationMinute
	 */
	public int[] getDurationMinute(){
<span class="fc" id="L924">		return durationMinute;</span>
	}

	/**
	 * set isPaid
	 */
	public void setIsPaid(boolean[] isPaid){
<span class="fc" id="L931">		this.isPaid = isPaid;</span>
<span class="fc" id="L932">	}</span>

	/**
	 * get isPaid
	 */
	public boolean[] getIsPaid(){
<span class="fc" id="L938">		return this.isPaid;</span>
	}

	/**
	 * set comment
	 */
	public void setComment(String[] comment){
<span class="fc" id="L945">		this.comment = comment;</span>
<span class="fc" id="L946">	}</span>

	/**
	 * get comment
	 */
	public String[] getComment(){
<span class="fc" id="L952">		return this.comment;</span>
	}

	/**
	 * set position
	 */
	public void setPosition(int position){
<span class="fc" id="L959">		this.position = position;</span>
<span class="fc" id="L960">	}</span>

	/**
	 * get position
	 */
	public int getPosition(){
<span class="fc" id="L966">		return this.position;</span>
	}

	/**
	 * set remarks
	 */
	public void setRemarks(String remarks){
<span class="fc" id="L973">		this.remarks = remarks;</span>
<span class="fc" id="L974">	}</span>

	/**
	 * get remarks
	 */
	public String getRemarks(){
<span class="fc" id="L980">		return this.remarks;</span>
	}

	/**
	 * Returns the DatePicker page component.
	 */
	 public DatePickerPC getDateTimePicker() {
<span class="fc" id="L987">		return m_dateTimePickerPC;</span>
	}

	/**
	 * Sets the DatePicker page component.
	 */
	 public boolean getUseAmPm() {
<span class="nc" id="L994">		return m_localizer.isTimeInputInAMPMFormat();</span>
	}


	/**
	 * Override extract Parameters to handle date input
	 */
	public boolean extractParameters(HttpServletRequest request, RequestContext context) {
<span class="fc" id="L1002">		boolean success = super.extractParameters(request);</span>

<span class="fc bfc" id="L1004" title="All 2 branches covered.">		if (this.timeZone!=null)</span>
<span class="fc" id="L1005">			m_dateTimePickerPC.setTimeZone(TimeZone.getTimeZone(this.timeZone));</span>

<span class="fc bfc" id="L1007" title="All 2 branches covered.">		int len = this.getComment()!=null?this.getComment().length+1:1;</span>

<span class="fc" id="L1009">		int [] durationHour = new int[len-1];</span>
<span class="fc" id="L1010">		int [] durationMinute = new int[len-1];</span>
<span class="fc bfc" id="L1011" title="All 2 branches covered.">		for (int i=0; i&lt;len;i++){</span>
<span class="fc" id="L1012">			m_dateList = m_dateTimePickerPC.getDates();</span>
		}
<span class="fc bfc" id="L1014" title="All 2 branches covered.">		for (int i=0; i&lt;len-1;i++){</span>
			try {
<span class="fc" id="L1016">				durationHour[i] = Integer.valueOf(context.getRequest().getParameter(&quot;duration&quot;+i+&quot;Hour&quot;)).intValue();</span>
<span class="nc" id="L1017">			} catch (NumberFormatException e){</span>
<span class="nc" id="L1018">				durationHour[i] = 0;</span>
<span class="fc" id="L1019">			}</span>
			try {
<span class="fc" id="L1021">				durationMinute[i] = Integer.valueOf(context.getRequest().getParameter(&quot;duration&quot;+i+&quot;Minute&quot;)).intValue();</span>
<span class="nc" id="L1022">			} catch (NumberFormatException e){</span>
<span class="nc" id="L1023">				durationMinute[i] = 0;</span>
<span class="fc" id="L1024">			}</span>
		}

<span class="fc" id="L1027">		this.setDurationHour(durationHour);</span>
<span class="fc" id="L1028">		this.setDurationMinute(durationMinute);</span>
<span class="fc" id="L1029">		return success;</span>
	}

	public List getDateList(){
<span class="fc" id="L1033">		return m_dateList;</span>
	}

	/**
	 * Return URL for HTML Form Action
	 */
	public String getFormAction() {
<span class="fc" id="L1040">		return &quot;addtimerecord&quot;;</span>
	}

	/**
	 * setHtmlDisplay
	 */
	public String getHtmlDisplay(){
		//return html for display
<span class="fc" id="L1048">		StringBuffer htmlDisplay = new StringBuffer(5000);</span>

		//start another table
<span class="fc" id="L1051">		htmlDisplay.append(&quot;&lt;div id=\&quot;summaryWrapper\&quot; style=\&quot;width:100%; overflow:auto;\&quot;&gt;&lt;table cellpadding=\&quot;0\&quot; cellspacing=\&quot;0\&quot; width=\&quot;100%\&quot; class=\&quot;popupTable\&quot;&gt;&quot;);</span>

		//get table header
<span class="fc" id="L1054">		htmlDisplay.append(popUpHeader);</span>

		//get table content
<span class="fc" id="L1057">		htmlDisplay.append(tableContent);</span>

		//end table
<span class="fc" id="L1060">		htmlDisplay.append(&quot;&lt;/table&gt;&quot;);</span>

		//end the wrapper table
<span class="fc" id="L1063">		htmlDisplay.append(&quot;&lt;/div&gt;&quot;);</span>

<span class="fc" id="L1065">		return htmlDisplay.toString();</span>
	}
}
</pre><div class="footer"><span class="right">Created with <a href="http://www.eclemma.org/jacoco">JaCoCo</a> 0.7.5.201505241946</span></div></body></html>