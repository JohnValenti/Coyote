<?xml version="1.0" encoding="UTF-8"?><!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd"><html xmlns="http://www.w3.org/1999/xhtml" lang="en"><head><meta http-equiv="Content-Type" content="text/html;charset=UTF-8"/><link rel="stylesheet" href="../.resources/report.css" type="text/css"/><link rel="shortcut icon" href="../.resources/report.gif" type="image/gif"/><title>CampaignQueueDAO.java</title><link rel="stylesheet" href="../.resources/prettify.css" type="text/css"/><script type="text/javascript" src="../.resources/prettify.js"></script></head><body onload="window['PR_TAB_WIDTH']=4;prettyPrint()"><div class="breadcrumb" id="breadcrumb"><span class="info"><a href="../.sessions.html" class="el_session">Sessions</a></span><a href="../index.html" class="el_report">QA Code Coverage</a> &gt; <a href="index.source.html" class="el_package">com.bluepumpkin.ejb.bbm.campaign.ejb</a> &gt; <span class="el_source">CampaignQueueDAO.java</span></div><h1>CampaignQueueDAO.java</h1><pre class="source lang-java linenums">package com.bluepumpkin.ejb.bbm.campaign.ejb;

/**
 * Title:        Blue Pumpkin Software Basic Business Model
 * Description:  dao object to serialize CampaignQueue object
 * Copyright:    Copyright (c) 2001
 * Company:      Blue Pumpkin Software, Inc
 * @author       lixin zhang
 * @version      1.0
 */

import java.sql.PreparedStatement;
import java.sql.ResultSet;
import java.sql.SQLException;
import java.util.*;

import com.bluepumpkin.common.datatypes.ID;
import com.bluepumpkin.common.jdmo.Jdmo;
import com.bluepumpkin.common.jdmo.JdmoConnection;
import com.bluepumpkin.common.jdmo.JdmoException;
import com.bluepumpkin.common.jdmo.JdmoRowset;
import com.bluepumpkin.common.jdmo.JdmoUtil;
import com.bluepumpkin.ejb.bbm.base.BbmFinderException;
import com.bluepumpkin.ejb.bbm.campaign.model.CampaignQueue;
import com.bluepumpkin.ejb.bbm.campaign.model.CampaignQueueFieldInfo;
import com.bluepumpkin.ejb.bbm.dao.DAOEffectivity;
import com.bluepumpkin.ejb.bbm.vo.FieldInfo;

public class CampaignQueueDAO extends DAOEffectivity&lt;CampaignQueue&gt; {

<span class="fc" id="L31">	private static FieldInfo m_fieldInfo = new CampaignQueueFieldInfo();</span>

	@Override
	protected FieldInfo getFieldInfo() {
<span class="fc" id="L35">		return m_fieldInfo;</span>
	}

	public CampaignQueueDAO() {
<span class="fc" id="L39">		super();</span>
<span class="fc" id="L40">	}</span>

	public CampaignQueueDAO(Jdmo dmo) {
<span class="nc" id="L43">		super(dmo);</span>
<span class="nc" id="L44">	}</span>

	@Override
	protected CampaignQueue createValueObject() {
<span class="nc" id="L48">		return new CampaignQueue();</span>
	}

	@Override
	protected StringBuffer getSelectStatement() {
<span class="nc" id="L53">		StringBuffer strSQL = new StringBuffer();</span>
<span class="nc" id="L54">		strSQL.append(&quot;SELECT A.ID, A.CAMPAIGNID, A.QUEUEID, A.STARTTIME, A.ENDTIME, &quot;);</span>
<span class="nc" id="L55">		strSQL.append(&quot; C.NAME CAMPAIGNNAME &quot;);</span>
<span class="nc" id="L56">		return strSQL;</span>
	}

	@Override
	protected boolean appendFromWhereStatement(StringBuffer strSQL) {
<span class="nc" id="L61">		strSQL.append(&quot; FROM QUEUECAMPAIGN A, QUEUE B, CAMPAIGN C &quot;);</span>
<span class="nc" id="L62">		strSQL.append(&quot;WHERE A.QUEUEID = B.ID AND A.CAMPAIGNID = C.ID &quot;);</span>
<span class="nc" id="L63">		return true;</span>
	}

	/**
	 * get a given campaign's queue assignments
	 *
	 * @idCampaign campaign id
	 * @dtStart, @dtEnd: the time period, null date means a open period
	 *
	 * @return a collection of CampaignQueue objects which hold the assignment
	 *         information
	 */
	public Collection&lt;CampaignQueue&gt; getCampaignQueueAssignments(ID idCampaign, ID idMedia, Date dtStart, Date dtEnd,
			boolean bIncludeCombined) throws BbmFinderException {
		try {
			// load all campaigns
<span class="fc" id="L79">			ArrayList&lt;CampaignQueue&gt; aAssignments = new ArrayList&lt;CampaignQueue&gt;();</span>

<span class="fc" id="L81">			String query = &quot;SELECT SP.SID SPID,QUEUE.SID QUEUEID,FROMDATE,TODATE FROM QUEUE,SPQUEUE,SP,CAMPAIGN&quot;;</span>
<span class="fc bfc" id="L82" title="All 2 branches covered.">			if (idMedia != null) {</span>
<span class="fc" id="L83">				query += &quot;,MEDIA&quot;;</span>
			}
<span class="fc" id="L85">			query += &quot; WHERE CAMPAIGN.SID = &quot; + JdmoUtil.asSqlLiteral(idCampaign) + &quot; AND SP.CAMPAIGNID = CAMPAIGN.ID  &quot;</span>
					+ &quot; AND SPQUEUE.SPID = SP.ID AND SPQUEUE.QUEUEID = QUEUE.ID &quot;;
<span class="pc bpc" id="L87" title="1 of 2 branches missed.">			if (dtEnd != null) {</span>
<span class="fc" id="L88">				query += &quot; AND SP.FROMDATE &lt; '&quot; + JdmoUtil.formatDBString(dtEnd) + &quot;'&quot;;</span>
			}
<span class="pc bpc" id="L90" title="1 of 2 branches missed.">			if (dtStart != null) {</span>
<span class="fc" id="L91">				query += &quot; AND SP.TODATE &gt; '&quot; + JdmoUtil.formatDBString(dtStart) + &quot;'&quot;;</span>
			}
<span class="fc bfc" id="L93" title="All 2 branches covered.">			if (idMedia != null) {</span>
<span class="fc" id="L94">				query += &quot; AND MEDIA.SID = &quot; + JdmoUtil.asSqlLiteral(idMedia) + &quot; AND QUEUE.MEDIAID = MEDIA.ID&quot;;</span>
			}

<span class="fc" id="L97">			JdmoRowset r = m_dmo.createRowset(query);</span>

			// -------------------------------------------------
			// get data and create campaigns
			// -------------------------------------------------

<span class="fc bfc" id="L103" title="All 2 branches covered.">			while (r.next()) {</span>

<span class="fc" id="L105">				ID idSP = r.getID(&quot;SPID&quot;);</span>
<span class="fc" id="L106">				ID idQueue = r.getID(&quot;QUEUEID&quot;);</span>
<span class="fc" id="L107">				Date dtStart1 = r.getTimestamp(&quot;FROMDATE&quot;);</span>
<span class="fc" id="L108">				Date dtEnd1 = r.getTimestamp(&quot;TODATE&quot;);</span>

<span class="fc" id="L110">				CampaignQueue pAssignment = new CampaignQueue();</span>
<span class="fc" id="L111">				pAssignment.setCampaignID(idCampaign);</span>
<span class="fc" id="L112">				pAssignment.setQueueID(idQueue);</span>
<span class="fc" id="L113">				pAssignment.setSPID(idSP);</span>
<span class="fc" id="L114">				pAssignment.setStartTime(dtStart1);</span>
<span class="fc" id="L115">				pAssignment.setEndTime(dtEnd1);</span>

<span class="fc" id="L117">				aAssignments.add(pAssignment);</span>
<span class="fc" id="L118">			}</span>

<span class="fc" id="L120">			r.close();</span>

<span class="fc bfc" id="L122" title="All 2 branches covered.">			if (bIncludeCombined) {</span>
<span class="fc" id="L123">				query = &quot;SELECT SP.SID SPID,MEDIA.SID MEDIAID, FROMDATE,TODATE FROM SPQUEUE,SP,CAMPAIGN,MEDIA&quot;;</span>
<span class="fc" id="L124">				query += &quot; WHERE CAMPAIGN.SID = &quot; + JdmoUtil.asSqlLiteral(idCampaign) + &quot; AND SP.CAMPAIGNID = CAMPAIGN.ID  &quot;</span>
						+ &quot; AND SPQUEUE.SPID = SP.ID AND QUEUEID IS NULL AND SPQUEUE.MEDIAID = MEDIA.ID &quot;;
<span class="pc bpc" id="L126" title="1 of 2 branches missed.">				if (dtEnd != null) {</span>
<span class="fc" id="L127">					query += &quot; AND SP.FROMDATE &lt; '&quot; + JdmoUtil.formatDBString(dtEnd) + &quot;'&quot;;</span>
				}
<span class="pc bpc" id="L129" title="1 of 2 branches missed.">				if (dtStart != null) {</span>
<span class="fc" id="L130">					query += &quot; AND SP.TODATE &gt; '&quot; + JdmoUtil.formatDBString(dtStart) + &quot;'&quot;;</span>
				}

<span class="fc" id="L133">				r = m_dmo.createRowset(query);</span>

				// -------------------------------------------------
				// get data and create campaigns
				// -------------------------------------------------

<span class="fc bfc" id="L139" title="All 2 branches covered.">				while (r.next()) {</span>

<span class="fc" id="L141">					ID idSP = r.getID(&quot;SPID&quot;);</span>
<span class="fc" id="L142">					ID idCombinedMedia = r.getID(&quot;MEDIAID&quot;);</span>
<span class="fc" id="L143">					Date dtStart1 = r.getTimestamp(&quot;FROMDATE&quot;);</span>
<span class="fc" id="L144">					Date dtEnd1 = r.getTimestamp(&quot;TODATE&quot;);</span>

<span class="fc" id="L146">					CampaignQueue pAssignment = new CampaignQueue();</span>
<span class="fc" id="L147">					pAssignment.setCampaignID(idCampaign);</span>
<span class="fc" id="L148">					pAssignment.setMediaID(idCombinedMedia);</span>
<span class="fc" id="L149">					pAssignment.setSPID(idSP);</span>
<span class="fc" id="L150">					pAssignment.setStartTime(dtStart1);</span>
<span class="fc" id="L151">					pAssignment.setEndTime(dtEnd1);</span>

<span class="fc" id="L153">					aAssignments.add(pAssignment);</span>
<span class="fc" id="L154">				}</span>

<span class="fc" id="L156">				r.close();</span>
			}
<span class="fc" id="L158">			return aAssignments;</span>

<span class="nc" id="L160">		} catch (JdmoException e) {</span>
<span class="nc" id="L161">			e.printStackTrace();</span>
<span class="nc" id="L162">			throw new BbmFinderException(e);</span>
		} finally {
<span class="pc" id="L164">			m_dmo.cleanUp();</span>
		}
	}

    /**
     * get a given campaign's queue assignments
     *
     * @idCampaign campaign id
     * @dtStart, @dtEnd: the time period, null date means a open period
     *
     * @return a collection of CampaignQueue objects which hold the assignment
     *         information
     */
    public Map&lt;ID, Collection&lt;CampaignQueue&gt;&gt; getQueueAssignmentsForGivenCampaignIDs(Collection&lt;ID&gt; campaignIDs, Date dtStart, Date dtEnd)
            throws BbmFinderException {
        try {
            // load all campaigns
<span class="nc" id="L181">            Map&lt;ID, Collection&lt;CampaignQueue&gt;&gt; campaignQueueAssignments = null;</span>


<span class="nc" id="L184">            StringBuilder query = new StringBuilder(&quot;SELECT CAMPAIGN.SID CAMPAIGN_ID,SP.SID SPID,QUEUE.SID QUEUEID,FROMDATE,TODATE FROM QUEUE,SPQUEUE,SP,CAMPAIGN&quot;);</span>

<span class="nc" id="L186">            query.append(&quot; WHERE CAMPAIGN.SID IN &quot;)</span>
<span class="nc" id="L187">                    .append(m_dmo.createInClause(campaignIDs))</span>
<span class="nc" id="L188">                    .append(&quot; AND SP.CAMPAIGNID = CAMPAIGN.ID  &quot;)</span>
<span class="nc" id="L189">                    .append(&quot; AND SPQUEUE.SPID = SP.ID AND SPQUEUE.QUEUEID = QUEUE.ID &quot;);</span>
<span class="nc bnc" id="L190" title="All 2 branches missed.">            if (dtEnd != null) {</span>
<span class="nc" id="L191">                query.append(&quot; AND SP.FROMDATE &lt; '&quot;).append(JdmoUtil.formatDBString(dtEnd)).append(&quot;'&quot;);</span>
            }
<span class="nc bnc" id="L193" title="All 2 branches missed.">            if (dtStart != null) {</span>
<span class="nc" id="L194">                query.append(&quot; AND SP.TODATE &gt; '&quot;).append(JdmoUtil.formatDBString(dtStart)).append(&quot;'&quot;);</span>
            }

<span class="nc" id="L197">            query.append(&quot; ORDER BY CAMPAIGN_ID&quot;);</span>

<span class="nc" id="L199">            JdmoRowset r = m_dmo.createRowset(query.toString());</span>

<span class="nc" id="L201">            return populateCampaignToCampaignQueueMapFromResult(r);</span>

<span class="nc" id="L203">        } catch (JdmoException e) {</span>
<span class="nc" id="L204">            throw new BbmFinderException(e);</span>
        } finally {
<span class="nc" id="L206">            m_dmo.cleanUp();</span>
        }
    }

	private Map&lt;ID, Collection&lt;CampaignQueue&gt;&gt; populateCampaignToCampaignQueueMapFromResult(JdmoRowset r) throws JdmoException {
<span class="nc" id="L211">		Map&lt;ID, Collection&lt;CampaignQueue&gt;&gt; campaignQueueAssignments = new HashMap&lt;ID, Collection&lt;CampaignQueue&gt;&gt;();</span>
<span class="nc" id="L212">		ID idCampaign = null;</span>
<span class="nc" id="L213">		ArrayList&lt;CampaignQueue&gt; aAssignments = new ArrayList&lt;CampaignQueue&gt;();</span>
		// -------------------------------------------------
		// get data and create campaigns
		// -------------------------------------------------
		try {
<span class="nc bnc" id="L218" title="All 2 branches missed.">			while (r.next()) {</span>
<span class="nc bnc" id="L219" title="All 2 branches missed.">				if (idCampaign == null) {</span>
<span class="nc" id="L220">					idCampaign = r.getID(&quot;CAMPAIGN_ID&quot;);</span>
				}

<span class="nc bnc" id="L223" title="All 4 branches missed.">				if (!idCampaign.equals(r.getID(&quot;CAMPAIGN_ID&quot;)) &amp;&amp; !campaignQueueAssignments.containsKey(idCampaign)) {</span>
<span class="nc" id="L224">					campaignQueueAssignments.put(idCampaign, aAssignments);</span>
<span class="nc" id="L225">					idCampaign = r.getID(&quot;CAMPAIGN_ID&quot;);</span>
<span class="nc" id="L226">					aAssignments = new ArrayList&lt;CampaignQueue&gt;();</span>
				}
<span class="nc" id="L228">				ID idSP = r.getID(&quot;SPID&quot;);</span>
<span class="nc" id="L229">				ID idQueue = r.getID(&quot;QUEUEID&quot;);</span>
<span class="nc" id="L230">				Date dtStart1 = r.getTimestamp(&quot;FROMDATE&quot;);</span>
<span class="nc" id="L231">				Date dtEnd1 = r.getTimestamp(&quot;TODATE&quot;);</span>

<span class="nc" id="L233">				CampaignQueue pAssignment = new CampaignQueue();</span>
<span class="nc" id="L234">				pAssignment.setCampaignID(idCampaign);</span>
<span class="nc" id="L235">				pAssignment.setQueueID(idQueue);</span>
<span class="nc" id="L236">				pAssignment.setSPID(idSP);</span>
<span class="nc" id="L237">				pAssignment.setStartTime(dtStart1);</span>
<span class="nc" id="L238">				pAssignment.setEndTime(dtEnd1);</span>

<span class="nc" id="L240">				aAssignments.add(pAssignment);</span>
<span class="nc" id="L241">			}</span>

<span class="nc bnc" id="L243" title="All 2 branches missed.">			if (idCampaign != null) {</span>
<span class="nc" id="L244">				campaignQueueAssignments.put(idCampaign, aAssignments);</span>
			}


<span class="nc" id="L248">		} catch (JdmoException e) {</span>

<span class="nc" id="L250">			throw e;</span>
		} finally {
<span class="nc bnc" id="L252" title="All 4 branches missed.">			if (r != null) {</span>
<span class="nc" id="L253">				r.close();</span>
			}
		}

<span class="nc" id="L257">		return campaignQueueAssignments;</span>
	}
	public Collection&lt;CampaignQueue&gt; getCampaignQueueAndLinkedSubQueueAssignments(ID idCampaign, ID idMedia, Date dtStart,
			Date dtEnd) throws BbmFinderException {
		try {
			// load all campaigns
<span class="fc" id="L263">			Collection&lt;CampaignQueue&gt; aCampaignAssignments = getCampaignQueueAssignments(idCampaign, idMedia, dtStart,</span>
					dtEnd, false);
			// now load the assignments from the sub Campaigns
<span class="fc" id="L266">			ArrayList&lt;CampaignQueue&gt; aAssignments = new ArrayList&lt;CampaignQueue&gt;();</span>

<span class="fc" id="L268">			String query = &quot;SELECT SP.SID SPID,QUEUE.SID QUEUEID,FROMDATE,TODATE,CAMPAIGN.SID CID FROM QUEUE,SPQUEUE,SP,CAMPAIGN&quot;;</span>
<span class="pc bpc" id="L269" title="1 of 2 branches missed.">			if (idMedia != null) {</span>
<span class="nc" id="L270">				query += &quot;,MEDIA&quot;;</span>
			}
<span class="fc" id="L272">			query += &quot; WHERE CAMPAIGN.SID IN (SELECT SID FROM CAMPAIGN WHERE PARENTCAMPAIGNID =(SELECT ID FROM CAMPAIGN WHERE SID=&quot;</span>
<span class="fc" id="L273">					+ JdmoUtil.asSqlLiteral(idCampaign)</span>
					+ &quot;)) AND SP.CAMPAIGNID = CAMPAIGN.ID  &quot;
					+ &quot; AND SPQUEUE.SPID = SP.ID AND SPQUEUE.QUEUEID = QUEUE.ID &quot;;
<span class="pc bpc" id="L276" title="1 of 2 branches missed.">			if (dtEnd != null) {</span>
<span class="fc" id="L277">				query += &quot; AND SP.FROMDATE &lt; '&quot; + JdmoUtil.formatDBString(dtEnd) + &quot;'&quot;;</span>
			}
<span class="pc bpc" id="L279" title="1 of 2 branches missed.">			if (dtStart != null) {</span>
<span class="fc" id="L280">				query += &quot; AND SP.TODATE &gt; '&quot; + JdmoUtil.formatDBString(dtStart) + &quot;'&quot;;</span>
			}
<span class="pc bpc" id="L282" title="1 of 2 branches missed.">			if (idMedia != null) {</span>
<span class="nc" id="L283">				query += &quot; AND MEDIA.SID = &quot; + JdmoUtil.asSqlLiteral(idMedia) + &quot; AND QUEUE.MEDIAID = MEDIA.ID&quot;;</span>
			}

<span class="fc" id="L286">			JdmoRowset r = m_dmo.createRowset(query);</span>

			// -------------------------------------------------
			// get data and create campaigns
			// -------------------------------------------------

<span class="fc bfc" id="L292" title="All 2 branches covered.">			while (r.next()) {</span>

<span class="fc" id="L294">				ID idSP = r.getID(&quot;SPID&quot;);</span>
<span class="fc" id="L295">				ID idQueue = r.getID(&quot;QUEUEID&quot;);</span>
<span class="fc" id="L296">				Date dtStart1 = r.getTimestamp(&quot;FROMDATE&quot;);</span>
<span class="fc" id="L297">				Date dtEnd1 = r.getTimestamp(&quot;TODATE&quot;);</span>
<span class="fc" id="L298">				ID idCampaign1 = r.getID(&quot;CID&quot;);</span>

<span class="fc" id="L300">				CampaignQueue pAssignment = new CampaignQueue();</span>
<span class="fc" id="L301">				pAssignment.setCampaignID(idCampaign1);</span>
<span class="fc" id="L302">				pAssignment.setQueueID(idQueue);</span>
<span class="fc" id="L303">				pAssignment.setSPID(idSP);</span>
<span class="fc" id="L304">				pAssignment.setStartTime(dtStart1);</span>
<span class="fc" id="L305">				pAssignment.setEndTime(dtEnd1);</span>

<span class="fc" id="L307">				aAssignments.add(pAssignment);</span>
<span class="fc" id="L308">			}</span>

<span class="fc" id="L310">			r.close();</span>
<span class="fc" id="L311">			aCampaignAssignments.addAll(aAssignments);</span>
<span class="fc" id="L312">			return aCampaignAssignments;</span>

<span class="nc" id="L314">		} catch (JdmoException e) {</span>
<span class="nc" id="L315">			e.printStackTrace();</span>
<span class="nc" id="L316">			throw new BbmFinderException(e);</span>
		} finally {
<span class="pc" id="L318">			m_dmo.cleanUp();</span>
		}
	}

	public Collection&lt;CampaignQueue&gt; getQueueCampaignAssignments(ID idQueue, Date dtStart, Date dtEnd)
			throws BbmFinderException {
		try {
			// load all campaigns
<span class="fc" id="L326">			ArrayList&lt;CampaignQueue&gt; aAssignments = new ArrayList&lt;CampaignQueue&gt;();</span>

<span class="fc" id="L328">			JdmoConnection conn = m_dmo.getConnection();</span>
<span class="fc" id="L329">			String query = &quot;SELECT SP.SID SPID,CAMPAIGN.SID CAMPAIGNID,FROMDATE,TODATE FROM QUEUE,SPQUEUE,SP,CAMPAIGN&quot;;</span>
<span class="fc" id="L330">			query += &quot; WHERE QUEUE.SID = ?  AND SP.CAMPAIGNID = CAMPAIGN.ID  &quot;</span>
					+ &quot; AND SPQUEUE.SPID = SP.ID AND SPQUEUE.QUEUEID = QUEUE.ID &quot;;
<span class="pc bpc" id="L332" title="1 of 2 branches missed.">			if (dtEnd != null) {</span>
<span class="fc" id="L333">				query += &quot; AND SP.FROMDATE &lt; ?&quot;;</span>
			}
<span class="pc bpc" id="L335" title="1 of 2 branches missed.">			if (dtStart != null) {</span>
<span class="fc" id="L336">				query += &quot; AND SP.TODATE &gt; ?&quot;;</span>
			}

<span class="fc" id="L339">			PreparedStatement pstmt = conn.prepareStatement(query);</span>
<span class="fc" id="L340">			pstmt.setInt(1, idQueue.toInt());</span>
<span class="pc bpc" id="L341" title="1 of 2 branches missed.">			if (dtEnd != null) {</span>
<span class="fc" id="L342">				pstmt.setDate(2, new java.sql.Date(dtEnd.getTime()));</span>
			}
<span class="pc bpc" id="L344" title="1 of 2 branches missed.">			if (dtStart != null) {</span>
<span class="fc" id="L345">				pstmt.setDate(3, new java.sql.Date(dtStart.getTime()));</span>
			}

<span class="fc" id="L348">			ResultSet r = pstmt.executeQuery();</span>

			// -------------------------------------------------
			// get data and create campaigns
			// -------------------------------------------------

<span class="pc bpc" id="L354" title="1 of 2 branches missed.">			while (r.next()) {</span>

<span class="nc" id="L356">				ID idSP = new ID(r.getInt(1)); // spid</span>
<span class="nc" id="L357">				ID idCampaign = new ID(r.getInt(2)); // &quot;CAMPAIGNID&quot;</span>
<span class="nc" id="L358">				Date dtStart1 = r.getTimestamp(3); // &quot;FROMDATE&quot;</span>
<span class="nc" id="L359">				Date dtEnd1 = r.getTimestamp(4); // &quot;TODATE&quot;</span>

<span class="nc" id="L361">				CampaignQueue pAssignment = new CampaignQueue();</span>
<span class="nc" id="L362">				pAssignment.setCampaignID(idCampaign);</span>
<span class="nc" id="L363">				pAssignment.setQueueID(idQueue);</span>
<span class="nc" id="L364">				pAssignment.setSPID(idSP);</span>
<span class="nc" id="L365">				pAssignment.setStartTime(dtStart1);</span>
<span class="nc" id="L366">				pAssignment.setEndTime(dtEnd1);</span>

<span class="nc" id="L368">				aAssignments.add(pAssignment);</span>
<span class="nc" id="L369">			}</span>

<span class="fc" id="L371">			r.close();</span>
<span class="fc" id="L372">			return aAssignments;</span>
<span class="nc" id="L373">		} catch (SQLException e) {</span>
<span class="nc" id="L374">			throw new BbmFinderException(e);</span>
<span class="nc" id="L375">		} catch (JdmoException e) {</span>
<span class="nc" id="L376">			e.printStackTrace();</span>
<span class="nc" id="L377">			throw new BbmFinderException(e);</span>
		} finally {
<span class="pc" id="L379">			m_dmo.cleanUp();</span>
		}
	}
}
</pre><div class="footer"><span class="right">Created with <a href="http://www.eclemma.org/jacoco">JaCoCo</a> 0.7.5.201505241946</span></div></body></html>