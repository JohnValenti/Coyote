<?xml version="1.0" encoding="UTF-8"?><!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd"><html xmlns="http://www.w3.org/1999/xhtml" lang="en"><head><meta http-equiv="Content-Type" content="text/html;charset=UTF-8"/><link rel="stylesheet" href="../.resources/report.css" type="text/css"/><link rel="shortcut icon" href="../.resources/report.gif" type="image/gif"/><title>TRDayDetailPC.java</title><link rel="stylesheet" href="../.resources/prettify.css" type="text/css"/><script type="text/javascript" src="../.resources/prettify.js"></script></head><body onload="window['PR_TAB_WIDTH']=4;prettyPrint()"><div class="breadcrumb" id="breadcrumb"><span class="info"><a href="../.sessions.html" class="el_session">Sessions</a></span><a href="../index.html" class="el_report">QA Code Coverage</a> &gt; <a href="index.source.html" class="el_package">com.bluepumpkin.web.am.timerecords</a> &gt; <span class="el_source">TRDayDetailPC.java</span></div><h1>TRDayDetailPC.java</h1><pre class="source lang-java linenums">package com.bluepumpkin.web.am.timerecords;

import java.text.MessageFormat;
import java.util.ArrayList;
import java.util.Collection;

import com.bluepumpkin.web.am.keys.AmJavaScriptFileID;
import com.witness.web.uif.keys.JavaScriptFileID;
import com.witness.web.uif.pagecomponent.CompositePC;
import com.witness.web.uif.pagecomponent.list.MultiColListPC;
import com.witness.web.uif.pagecomponent.toolbar.ToolbarPC;
import com.witness.web.uif.system.RequestContext;
import com.witness.web.uif.util.html.CSSUtil;

/**
 * Title:
 * Description:
 * Copyright:    Copyright (c) 2001
 * Company:      Blue Pumpkin Software, Inc
 * @author
 * @version 1.0
 */
public class TRDayDetailPC extends CompositePC{
	private static final String TABLE_BORDER_OPEN_TAG
		= &quot;&lt;table style=\&quot;width: 100%; &quot; + CSSUtil.STYLE_BORDER + &quot;\&quot; cellpadding=\&quot;0\&quot; cellspacing=\&quot;0\&quot;&gt;&quot;;

	private static final String ADD_CHILD_TEMPLATE = &quot;{0}.addPairChild({1}, {2}, {3}); \n&quot;;
	private static final String MAIN_TOOLBAR_NAME = &quot;_mtb&quot;;
	private MultiColListPC m_multiColListPC;
	private ToolbarPC m_mainTB_PC;
	private ToolbarPC m_toolbarPC1;
	private ToolbarPC m_toolbarPC2;
	private ToolbarPC m_toolbarExceptions;
	private ToolbarPC m_toolbarAdjustments;
	private String m_comments;
	private String m_remarkEmployeeStr;
	private int m_height;
	private boolean m_isSummary;
	private boolean m_needExpSummary;
	private String m_colspan;
	private boolean m_needExceptions;

	// Keep track of Previous Toolbars and Tables
<span class="fc" id="L44">	private ArrayList m_prevToolbars = new ArrayList();</span>
<span class="fc" id="L45">	private ArrayList m_prevLists = new ArrayList();</span>

	/**
	 * Constructor
	 *
	 * @param context The RequestContext
	 */
	public TRDayDetailPC(RequestContext context) {
<span class="fc" id="L53">		super(context);</span>

<span class="fc" id="L55">		initMultiColList();</span>
<span class="fc" id="L56">		initMainTB();</span>

<span class="fc" id="L58">		addRequiredJavaScriptFile(JavaScriptFileID.MEDIATOR_CONTAINED_LIST);</span>
<span class="fc" id="L59">		setJSMediator(AmJavaScriptFileID.MEDIATOR_TR_CONTAINED_LIST);</span>
<span class="fc" id="L60">	}</span>

	/**
	 * Initialize Main Toolbar
	 */
	private void initMainTB() {
<span class="fc" id="L66">		m_mainTB_PC = getNewToolbar();</span>
<span class="fc" id="L67">		addChildComponent(m_mainTB_PC);</span>

<span class="fc" id="L69">		ToolbarPC tmpTB = new ToolbarPC(m_context);</span>
<span class="fc" id="L70">		setFirstTB(tmpTB);</span>
<span class="fc" id="L71">		setSecondTB(tmpTB);</span>
<span class="fc" id="L72">		setExceptionsTB(tmpTB);</span>
<span class="fc" id="L73">		setAdjustmentsTB(tmpTB);</span>
<span class="fc" id="L74">	}</span>

	/**
	 * Return new Toolbar
	 */
	private ToolbarPC getNewToolbar() {
<span class="fc" id="L80">		ToolbarPC tb = new ToolbarPC(m_context);</span>
<span class="fc" id="L81">		tb.setName(getName() + MAIN_TOOLBAR_NAME);</span>
<span class="fc" id="L82">		m_prevToolbars.add(tb);</span>
<span class="fc" id="L83">		return tb;</span>
	}

	/**
	 * Return Main Toolbar
	 */
	public ToolbarPC getMainTB() {
<span class="nc" id="L90">		return m_mainTB_PC;</span>
	}

	/**
	 * Set Name
	 */
	public void setName(String name) {
<span class="fc" id="L97">		super.setName(name);</span>

<span class="fc" id="L99">		m_mainTB_PC.setName(name + MAIN_TOOLBAR_NAME);</span>
<span class="fc" id="L100">		updateListName(m_multiColListPC, name);</span>
<span class="fc" id="L101">		updateFirstToolbarName(m_toolbarPC1, name);</span>
<span class="fc" id="L102">		updateSecondToolbarName(m_toolbarPC2, name);</span>
<span class="fc" id="L103">		updateAdjustmentsToolbarName(m_toolbarAdjustments, name);</span>
<span class="fc" id="L104">		updateExceptionsToolbarName(m_toolbarExceptions, name);</span>
<span class="fc" id="L105">	}</span>

	/**
	 * Set height of the HTML display in pixesl
	 */
	public void setHeightInPixels(int height) {
<span class="nc" id="L111">		m_height = height;</span>
<span class="nc" id="L112">	}</span>

	/**
	 * Return height of the HTML display in pixesl
	 */
	public int getHeightInPixels() {
<span class="nc" id="L118">		return m_height;</span>
	}

	/**
	 * Set MultiColList
	 */
	private void initMultiColList() {
<span class="fc" id="L125">		m_multiColListPC = getNewMultiColListPC();</span>
<span class="fc" id="L126">		addChildComponent(m_multiColListPC);</span>
<span class="fc" id="L127">	}</span>

	/**
	 * Return new MultiColListPC
	 */
	private MultiColListPC getNewMultiColListPC() {
<span class="fc" id="L133">		MultiColListPC list = new MultiColListPC(m_context, false);</span>
<span class="fc" id="L134">		m_prevLists.add(list);</span>
<span class="fc" id="L135">		updateListName(list, getName());</span>
<span class="fc" id="L136">		return list;</span>
	}

	/**
	 * Return MultiColList
	 */
	public MultiColListPC getMultiColList() {
<span class="fc" id="L143">		return m_multiColListPC;</span>
	}

	/**
	 * Set the first toolbar
	 */
	public void setFirstTB(ToolbarPC firstTB) {
<span class="fc" id="L150">		m_toolbarPC1 = firstTB;</span>

<span class="fc" id="L152">		updateFirstToolbarName(m_toolbarPC1, getName());</span>
<span class="fc" id="L153">	}</span>

	/**
	 * Return the first toolbar
	 */
	public ToolbarPC getFirstTB() {
<span class="fc" id="L159">		return m_toolbarPC1;</span>
	}

	/**
	 * Set the second toolbar
	 */
	public void setSecondTB(ToolbarPC secondTB) {
<span class="fc" id="L166">		m_toolbarPC2 = secondTB;</span>

<span class="fc" id="L168">		updateSecondToolbarName(m_toolbarPC2, getName());</span>
<span class="fc" id="L169">	}</span>

	/**
	 * Return the secondst toolbar
	 */
	public ToolbarPC getSecondTB() {
<span class="fc" id="L175">		return m_toolbarPC2;</span>
	}

	/**
	 * Set the exceptions toolbar
	 */
	public void setExceptionsTB(ToolbarPC exceptionsTB) {
<span class="fc" id="L182">		m_toolbarExceptions = exceptionsTB;</span>

<span class="fc" id="L184">		updateExceptionsToolbarName(m_toolbarExceptions, getName());</span>
<span class="fc" id="L185">	}</span>

	/**
	 * Return the exceptions toolbar
	 */
	public ToolbarPC getExceptionsTB() {
<span class="nc" id="L191">		return m_toolbarExceptions;</span>
	}

	/**
	 * Set the adjustments toolbar
	 */
	public void setAdjustmentsTB(ToolbarPC exceptionsTB) {
<span class="fc" id="L198">		m_toolbarAdjustments = exceptionsTB;</span>

<span class="fc" id="L200">		updateAdjustmentsToolbarName(m_toolbarAdjustments, getName());</span>
<span class="fc" id="L201">	}</span>

	/**
	 * Return the adjustments toolbar
	 */
	public ToolbarPC getAdjustmentsTB() {
<span class="nc" id="L207">		return m_toolbarAdjustments;</span>
	}

	/**
	 * Set the comments text
	 */
	public void setComments(String comments) {
<span class="fc" id="L214">		m_comments = comments;</span>
<span class="fc" id="L215">	}</span>

	/**
	 * Return the comments
	 */
	public String getComments() {
<span class="fc" id="L221">		return m_comments;</span>
	}

	/**
	 * Set the remarkEmployeeStr
	 */
	public void setRemarkEmployeeStr(String remarkEmployeeStr) {
<span class="fc" id="L228">		m_remarkEmployeeStr = remarkEmployeeStr;</span>
<span class="fc" id="L229">	}</span>

	/**
	 * Return the remarkEmployeeStr
	 */
	public String getRemarkEmployeeStr() {
<span class="fc" id="L235">		return m_remarkEmployeeStr;</span>
	}

	/**
	 * Set boolean for summary/day detail
	 */
	public void setIsSummary(boolean isSummary) {
<span class="nc" id="L242">		m_isSummary = isSummary;</span>
<span class="nc" id="L243">	}</span>

	/**
	 * Return the isSummary
	 */
	public boolean getIsSummary() {
<span class="fc" id="L249">		return m_isSummary;</span>
	}

	/**
	 * Set boolean for need of expanded summary detail
	 */
	public void setNeedExpSummary(boolean needExpSummary) {
<span class="fc" id="L256">		m_needExpSummary = needExpSummary;</span>
<span class="fc" id="L257">	}</span>

	/**
	 * Return the needExpSummary
	 */
	public boolean getNeedExpSummary() {
<span class="fc" id="L263">		return m_needExpSummary;</span>
	}

	/**
	 * Set boolean for exceptions display
	 */
	public void setNeedExceptions(boolean needExceptions) {
<span class="nc" id="L270">		m_needExceptions = needExceptions;</span>
<span class="nc" id="L271">	}</span>

	/**
	 * Return the boolean
	 */
	public boolean getNeedExceptions() {
<span class="nc" id="L277">		return m_needExceptions;</span>
	}

	/**
	 * Set String for colspan
	 */
	public void setColspan(String colspan) {
<span class="nc" id="L284">		m_colspan = colspan;</span>
<span class="nc" id="L285">	}</span>

	/**
	 * Return the colspan
	 */
	public String getColspan() {
<span class="nc" id="L291">		return m_colspan;</span>
	}

	// Update Multi Column List  Name to be in sync with parent component
	private static void updateListName(MultiColListPC list, String parentName) {
<span class="fc" id="L296">		list.setName(parentName + &quot;_t&quot;);</span>
<span class="fc" id="L297">	}</span>

	// Update first toolbar name to be in sync with parent component
	private static void updateFirstToolbarName(ToolbarPC toolbar, String parentName) {
<span class="fc" id="L301">		toolbar.setName(parentName + MAIN_TOOLBAR_NAME);</span>
<span class="fc" id="L302">	}</span>

	// Update second toolbar name Name to be in sync with parent component
	private static void updateSecondToolbarName(ToolbarPC toolbar, String parentName) {
<span class="fc" id="L306">		toolbar.setName(parentName + MAIN_TOOLBAR_NAME);</span>
<span class="fc" id="L307">	}</span>

	// Update exceptions toolbar name Name to be in sync with parent component
	private static void updateExceptionsToolbarName(ToolbarPC toolbar, String parentName) {
<span class="fc" id="L311">		toolbar.setName(parentName + MAIN_TOOLBAR_NAME);</span>
<span class="fc" id="L312">	}</span>

	// Update adjustments toolbar name Name to be in sync with parent component
	private static void updateAdjustmentsToolbarName(ToolbarPC toolbar, String parentName) {
<span class="fc" id="L316">		toolbar.setName(parentName + MAIN_TOOLBAR_NAME);</span>
<span class="fc" id="L317">	}</span>

	/**
	 * Return JavaScript Init Code
	 */
	public String getJavaScriptInitCode() {
<span class="fc" id="L323">		return super.getCompositeJavaScriptInitCode() + &quot;\n&quot;</span>
<span class="fc" id="L324">					 + getJSChildsAssociation() + &quot;\n&quot;;</span>
	}

	/**
	 * Return the code which associates Child components
	 */
	private String getJSChildsAssociation() {
<span class="fc" id="L331">		StringBuffer sb = new StringBuffer(500);</span>
<span class="fc" id="L332">		String mediatorName = getNamePrefix()+getName();</span>
<span class="fc" id="L333">		int i=0;</span>

		// Append JS Object for Previous Components
<span class="fc bfc" id="L336" title="All 2 branches covered.">		for(i=0; i &lt; m_prevLists.size(); i++) {</span>
<span class="fc" id="L337">			MultiColListPC list = (MultiColListPC)m_prevLists.get(i);</span>
<span class="fc" id="L338">			ToolbarPC tb = (ToolbarPC)m_prevToolbars.get(i);</span>
<span class="fc" id="L339">			appendChildJSCode(sb, mediatorName, list, tb, i);</span>
		}

<span class="fc" id="L342">		return sb.toString();</span>
	}

	/**
	 * Append Child JS association code
	 */
	private void appendChildJSCode(StringBuffer sb, String mediatorName, MultiColListPC list, ToolbarPC tb, int index) {
		// Determine whether to Turn Off MutliColListPC's javascript
<span class="fc" id="L350">		Collection listModel = list.getListModel();</span>
<span class="pc bpc" id="L351" title="1 of 4 branches missed.">		if (listModel==null || listModel.isEmpty()) list.setEnabled(false);</span>

		// Create Component JS Object
<span class="fc" id="L354">		sb.append(list.getJavaScriptInitCode());</span>
<span class="fc" id="L355">		sb.append(tb.getJavaScriptInitCode());</span>

		// Associate JS Object to Mediator
<span class="fc bfc" id="L358" title="All 2 branches covered.">		String listName = list.isEnabled()?list.getName():&quot;null&quot;;</span>
<span class="fc" id="L359">		String tbName = tb.getName();</span>
<span class="fc" id="L360">		Object[] args = new Object[]{mediatorName, listName, tbName, Integer.toString(index)};</span>
<span class="fc" id="L361">		sb.append(MessageFormat.format(ADD_CHILD_TEMPLATE, args)).append(&quot;\n&quot;);</span>
<span class="fc" id="L362">	}</span>

	/**
	 * Reset Component for Reuse.
	 *
	 * NOTE: only main to be reused for same contained list
	 */
	public void resetForReUse() {
		// Create new ones
<span class="nc" id="L371">		m_multiColListPC = getNewMultiColListPC();</span>
<span class="nc" id="L372">		m_mainTB_PC = getNewToolbar();</span>

<span class="nc" id="L374">		m_remarkEmployeeStr = null;</span>
<span class="nc" id="L375">	}</span>

	/**
	 * Return Html Display
	 */
	public String getHtmlDisplay() {
<span class="fc" id="L381">		StringBuffer htmlDisplay = new StringBuffer(5000);</span>

		// Determine whether height should be set
		// String heightProperty = (getHeightInPixels()==0)?&quot;&quot;: &quot;height:&quot; + getHeightInPixels() + &quot;px;&quot;;

		// Display Table Header and Table Content
<span class="fc" id="L387">		htmlDisplay.append(&quot;&lt;table width=\&quot;100%\&quot;&gt;&lt;tr&gt;&quot;);</span>
<span class="fc" id="L388">		htmlDisplay.append(&quot;&lt;td class=\&quot;listRowMedForm\&quot;&gt;&quot;);</span>

<span class="pc bpc" id="L390" title="1 of 2 branches missed.">		if (getIsSummary()){</span>
<span class="nc" id="L391">			htmlDisplay.append(TABLE_BORDER_OPEN_TAG);</span>
<span class="nc bnc" id="L392" title="All 2 branches missed.">			if (getNeedExceptions()){</span>
<span class="nc" id="L393">				htmlDisplay.append(&quot;&lt;tr&gt;&lt;td class=\&quot;ppListExceptionsCell\&quot;&gt;&quot;);</span>
<span class="nc" id="L394">				htmlDisplay.append(getExceptionsTB());</span>
<span class="nc" id="L395">				htmlDisplay.append(&quot;&lt;/td&gt;&lt;/tr&gt;&quot;);</span>
			}
<span class="nc" id="L397">			htmlDisplay.append(&quot;&lt;tr&gt;&lt;td class=\&quot;ppListExceptionsCell\&quot;&gt;&quot;);</span>
<span class="nc" id="L398">			htmlDisplay.append(getAdjustmentsTB());</span>
<span class="nc" id="L399">			htmlDisplay.append(&quot;&lt;/td&gt;&lt;/tr&gt;&quot;);</span>
<span class="nc" id="L400">			htmlDisplay.append(&quot;&lt;/table&gt;&lt;br&gt;\n&quot;);</span>
		}

<span class="pc bpc" id="L403" title="1 of 2 branches missed.">		if (getNeedExpSummary()){//to prevent showing summary if none in summary page</span>
<span class="fc" id="L404">			htmlDisplay.append(TABLE_BORDER_OPEN_TAG);</span>
<span class="fc" id="L405">			htmlDisplay.append(&quot;&lt;tr&gt;&lt;td&gt;&quot;);</span>
<span class="fc" id="L406">			htmlDisplay.append(getMultiColList());</span>
<span class="fc" id="L407">			htmlDisplay.append(&quot;&lt;/td&gt;&lt;/tr&gt;\n&quot;);</span>
<span class="pc bpc" id="L408" title="1 of 2 branches missed.">			if (!getIsSummary()){</span>
<span class="fc" id="L409">				htmlDisplay.append(&quot;&lt;tr&gt;&lt;td&gt;&quot;);</span>
<span class="fc" id="L410">				htmlDisplay.append(getFirstTB());</span>
<span class="fc" id="L411">				htmlDisplay.append(&quot;&lt;/td&gt;&lt;/tr&gt;\n&quot;);</span>
			}

<span class="pc bpc" id="L414" title="1 of 2 branches missed.">			if (!getIsSummary()){</span>
<span class="pc bpc" id="L415" title="1 of 2 branches missed.">				if (getRemarkEmployeeStr()!=null)</span>
<span class="fc" id="L416">					htmlDisplay.append(getRemarkEmployeeStr());</span>
<span class="fc" id="L417">				htmlDisplay.append(getComments());</span>
			}

<span class="fc" id="L420">			htmlDisplay.append(&quot;&lt;tr&gt;&lt;td&gt;&quot;);</span>
<span class="fc" id="L421">			htmlDisplay.append(getSecondTB());</span>
<span class="fc" id="L422">			htmlDisplay.append(&quot;&lt;/td&gt;&lt;/tr&gt;&quot;);</span>
<span class="fc" id="L423">			htmlDisplay.append(&quot;&lt;/table&gt;&quot;);</span>
		}
<span class="fc" id="L425">		htmlDisplay.append(&quot;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&quot;);</span>

<span class="fc" id="L427">		return htmlDisplay.toString();</span>
	}
}
</pre><div class="footer"><span class="right">Created with <a href="http://www.eclemma.org/jacoco">JaCoCo</a> 0.7.5.201505241946</span></div></body></html>