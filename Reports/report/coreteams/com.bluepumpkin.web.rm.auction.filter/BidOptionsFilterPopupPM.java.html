<?xml version="1.0" encoding="UTF-8"?><!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd"><html xmlns="http://www.w3.org/1999/xhtml" lang="en"><head><meta http-equiv="Content-Type" content="text/html;charset=UTF-8"/><link rel="stylesheet" href="../.resources/report.css" type="text/css"/><link rel="shortcut icon" href="../.resources/report.gif" type="image/gif"/><title>BidOptionsFilterPopupPM.java</title><link rel="stylesheet" href="../.resources/prettify.css" type="text/css"/><script type="text/javascript" src="../.resources/prettify.js"></script></head><body onload="window['PR_TAB_WIDTH']=4;prettyPrint()"><div class="breadcrumb" id="breadcrumb"><span class="info"><a href="../.sessions.html" class="el_session">Sessions</a></span><a href="../index.html" class="el_report">QA Code Coverage</a> &gt; <a href="index.source.html" class="el_package">com.bluepumpkin.web.rm.auction.filter</a> &gt; <span class="el_source">BidOptionsFilterPopupPM.java</span></div><h1>BidOptionsFilterPopupPM.java</h1><pre class="source lang-java linenums">package com.bluepumpkin.web.rm.auction.filter;

import java.util.ArrayList;
import java.util.Arrays;
import java.util.Collection;
import java.util.Collections;
import java.util.Comparator;
import java.util.Iterator;
import java.util.List;
import java.util.ResourceBundle;

import javax.servlet.http.HttpServletRequest;

import com.bluepumpkin.common.datatypes.ID;
import com.bluepumpkin.common.datatypes.IDStringPair;
import com.bluepumpkin.common.datatypes.StringsPair;
import com.bluepumpkin.common.logging.Category;
import com.bluepumpkin.common.util.StringUtil;
import com.bluepumpkin.ejb.bbm.activity.model.Activity;
import com.bluepumpkin.ejb.bbm.activity.model.ActivityFilter;
import com.bluepumpkin.ejb.bbm.campaign.model.SchedulingPeriod;
import com.bluepumpkin.ejb.bbm.skill.model.Skill;
import com.bluepumpkin.ejb.bbm.skill.model.SkillFieldInfo;
import com.bluepumpkin.ejb.rm.base.RmHardValidationException;
import com.bluepumpkin.ejb.rm.requests.shiftbid.shiftbidauction.model.ShiftBidAuction;
import com.bluepumpkin.ejb.rm.requests.shiftbid.shiftbidrequest.model.ShiftBidder;
import com.bluepumpkin.ejb.rm.setup.settings.model.OrganizationSetting;
import com.bluepumpkin.ejb.rm.util.LicenseUtil;
import com.bluepumpkin.web.bbm.activity.ActivityModelHandler;
import com.bluepumpkin.web.bbm.l10n.BbmWebBundleKey;
import com.bluepumpkin.web.bbm.organization.OrganizationModelHandler;
import com.bluepumpkin.web.bbm.skill.SkillModelHandler;
import com.bluepumpkin.web.rm.Log;
import com.bluepumpkin.web.rm.auction.AuctionMH;
import com.bluepumpkin.web.rm.keys.RmKeys;
import com.bluepumpkin.web.rm.l10n.RmWebBundleKey;
import com.bluepumpkin.web.rm.l10n.RmWebLogBundleKey;
import com.bluepumpkin.web.rm.setup.settings.SettingsModelHandler;
import com.witness.web.uif.base.Message;
import com.witness.web.uif.keys.JavaScriptFileID;
import com.witness.web.uif.pagecomponent.DefaultNodeData;
import com.witness.web.uif.pagecomponent.assignmentbox.AssignmentBoxPC;
import com.witness.web.uif.pagecomponent.container.Collapsible2ColFormPC;
import com.witness.web.uif.pagecomponent.form.FormInputPC;
import com.witness.web.uif.pagecomponent.picker.time.TimePickerPC;
import com.witness.web.uif.pagecomponent.picker.time.TimeRangePickerPC;
import com.witness.web.uif.pagecomponent.toolbar.ToolbarUtil;
import com.witness.web.uif.pagemodel.ContainersInRowsPM;
import com.witness.web.uif.pagemodel.PageModel;
import com.witness.web.uif.pagemodel.PopupWindowPM;
import com.witness.web.uif.system.RequestContext;
import com.witness.web.uif.util.ContainerList;
import com.witness.web.uif.util.HtmlUtil;
import com.witness.web.uif.util.SortUtil;
import com.witness.web.uif.util.html.HtmlBooleanCheckbox;
import com.witness.web.uif.util.js.JSUtil;

/**
 * Title: BidOptionsFilterPopupPM Description: Model for the popup allowing the
 * user to configure a Bid Options Filter. The form will have collapsible
 * sections for grouping the main types of filtering options. Most of the
 * dropdown lists on the form will show/hide &quot;buddy&quot; elements depending on the
 * user's selection. A buddy element is just another form field (ex, an input
 * field) which is located close to the dropdown list. Copyright: Copyright (c)
 * 2005 Company: Witness Systems, Inc.
 *
 * @author Gonzalo Quintanar
 * @version 1.0
 */
public class BidOptionsFilterPopupPM extends PopupWindowPM implements ContainersInRowsPM {
	// Field Name Constants
	public static final String AUCTION_ID_FN = &quot;auctionID&quot;;
	public static final String BIDDER_ID_FN = &quot;bidderID&quot;;
	// public static final String EMPLOYEE_ID_FN = &quot;employeeID&quot;;
	// public static final String CAMPAIGN_ID_FN = &quot;campaignID&quot;;
	public static final String USE_SESSION_FILTER_FN = &quot;useSessionFilter&quot;;

	private static final String AVAIL_VAL1 = &quot;availabilityValue1&quot;;
	private static final String AVAIL_VAL2 = &quot;availabilityValue2&quot;;
	private static final String SCHED_LEN_VAL1 = &quot;scheduleLengthValue1&quot;;
	private static final String SCHED_LEN_VAL2 = &quot;scheduleLengthValue2&quot;;
	private static final String SHIFT_LEN_VAL1 = &quot;shiftLengthValue1&quot;;
	private static final String SHIFT_LEN_VAL2 = &quot;shiftLengthValue2&quot;;
	private static final String SHIFT_START_TIME = &quot;shiftStartTime&quot;;
	private static final String SHIFT_START_RANGE = &quot;shiftStartRange&quot;;
	private static final String SHIFT_END_TIME = &quot;shiftEndTime&quot;;
	private static final String SHIFT_END_RANGE = &quot;shiftEndRange&quot;;
	private static final String ACTIVITY1_LEN_VAL1 = &quot;activity1LengthValue1&quot;;
	private static final String ACTIVITY1_LEN_VAL2 = &quot;activity1LengthValue2&quot;;
	private static final String ACTIVITY2_LEN_VAL1 = &quot;activity2LengthValue1&quot;;
	private static final String ACTIVITY2_LEN_VAL2 = &quot;activity2LengthValue2&quot;;
	private static final String ACTIVITY1_START_TIME = &quot;activity1StartTime&quot;;
	private static final String ACTIVITY1_START_RANGE = &quot;activity1StartRange&quot;;
	private static final String ACTIVITY2_START_TIME = &quot;activity2StartTime&quot;;
	private static final String ACTIVITY2_START_RANGE = &quot;activity2StartRange&quot;;

	// Span Name Constants
	private static final String SHIFT_CHECKBOX_SPAN = &quot;SHIFT_CHECKBOX_SPAN&quot;;
	private static final String WP_CHECKBOX_SPAN = &quot;WP_CHECKBOX_SPAN&quot;;
	private static final String SCHED_LEN_USE_LEFT_SPAN = &quot;SCHED_LEN_USE_LEFT_SPAN&quot;;
	private static final String SCHED_LEN_USE_RIGHT_SPAN = &quot;SCHED_LEN_USE_RIGHT_SPAN&quot;;
	private static final String SHIFT_LEN_CHECKBOX_SPAN = &quot;SHIFT_LEN_CHECKBOX_SPAN&quot;;
	private static final String SHIFT_LEN_USE_LEFT_SPAN = &quot;SHIFT_LEN_USE_LEFT_SPAN&quot;;
	private static final String SHIFT_LEN_USE_RIGHT_SPAN = &quot;SHIFT_LEN_USE_RIGHT_SPAN&quot;;
	private static final String SHIFT_START_TIME_SPAN = &quot;SHIFT_START_TIME_SPAN&quot;;
	private static final String SHIFT_START_RANGE_SPAN = &quot;SHIFT_START_RANGE_SPAN&quot;;
	private static final String SHIFT_END_TIME_SPAN = &quot;SHIFT_END_TIME_SPAN&quot;;
	private static final String SHIFT_END_RANGE_SPAN = &quot;SHIFT_END_RANGE_SPAN&quot;;
	private static final String SHIFT_START_CHECKBOX_SPAN = &quot;SHIFT_START_CHECKBOX_SPAN&quot;;
	private static final String SHIFT_END_CHECKBOX_SPAN = &quot;SHIFT_END_CHECKBOX_SPAN&quot;;
	private static final String ACTIVITY1_LEN_CHECKBOX_SPAN = &quot;ACTIVITY1_LEN_CHECKBOX_SPAN&quot;;
	private static final String ACTIVITY1_LEN_USE_LEFT_SPAN = &quot;ACTIVITY1_LEN_USE_LEFT_SPAN&quot;;
	private static final String ACTIVITY1_LEN_USE_RIGHT_SPAN = &quot;ACTIVITY1_LEN_USE_RIGHT_SPAN&quot;;
	private static final String ACTIVITY2_LEN_CHECKBOX_SPAN = &quot;ACTIVITY2_LEN_CHECKBOX_SPAN&quot;;
	private static final String ACTIVITY2_LEN_USE_LEFT_SPAN = &quot;ACTIVITY2_LEN_USE_LEFT_SPAN&quot;;
	private static final String ACTIVITY2_LEN_USE_RIGHT_SPAN = &quot;ACTIVITY2_LEN_USE_RIGHT_SPAN&quot;;
	private static final String ACTIVITY1_START_TIME_SPAN = &quot;ACTIVITY1_START_TIME_SPAN&quot;;
	private static final String ACTIVITY1_START_RANGE_SPAN = &quot;ACTIVITY1_START_RANGE_SPAN&quot;;
	private static final String ACTIVITY2_START_TIME_SPAN = &quot;ACTIVITY2_START_TIME_SPAN&quot;;
	private static final String ACTIVITY2_START_RANGE_SPAN = &quot;ACTIVITY2_START_RANGE_SPAN&quot;;
	private static final String ACTIVITY1_START_CHECKBOX_SPAN = &quot;ACTIVITY1_START_CHECKBOX_SPAN&quot;;
	private static final String ACTIVITY2_START_CHECKBOX_SPAN = &quot;ACTIVITY2_START_CHECKBOX_SPAN&quot;;

	// JavaScript variable name constants
	private static final String AVAIL_VISIBLE_MAP = &quot;AVAIL_VISIBLE_MAP&quot;;
	private static final String AVAIL_INVISIBLE_MAP = &quot;AVAIL_INVISIBLE_MAP&quot;;
	private static final String SCHED_LEN_VISIBLE_MAP = &quot;SCHED_LEN_VISIBLE_MAP&quot;;
	private static final String SCHED_LEN_INVISIBLE_MAP = &quot;SCHED_LEN_INVISIBLE_MAP&quot;;
	private static final String SHIFT_LEN_VISIBLE_MAP = &quot;SHIFT_LEN_VISIBLE_MAP&quot;;
	private static final String SHIFT_LEN_INVISIBLE_MAP = &quot;SHIFT_LEN_INVISIBLE_MAP&quot;;
	private static final String SHIFT_START_VISIBLE_MAP = &quot;SHIFT_START_VISIBLE_MAP&quot;;
	private static final String SHIFT_START_INVISIBLE_MAP = &quot;SHIFT_START_INVISIBLE_MAP&quot;;
	private static final String SHIFT_END_VISIBLE_MAP = &quot;SHIFT_END_VISIBLE_MAP&quot;;
	private static final String SHIFT_END_INVISIBLE_MAP = &quot;SHIFT_END_INVISIBLE_MAP&quot;;
	private static final String ACTIVITY1_LEN_VISIBLE_MAP = &quot;ACTIVITY1_LEN_VISIBLE_MAP&quot;;
	private static final String ACTIVITY1_LEN_INVISIBLE_MAP = &quot;ACTIVITY1_LEN_INVISIBLE_MAP&quot;;
	private static final String ACTIVITY2_LEN_VISIBLE_MAP = &quot;ACTIVITY2_LEN_VISIBLE_MAP&quot;;
	private static final String ACTIVITY2_LEN_INVISIBLE_MAP = &quot;ACTIVITY2_LEN_INVISIBLE_MAP&quot;;
	private static final String ACTIVITY1_START_VISIBLE_MAP = &quot;ACTIVITY1_START_VISIBLE_MAP&quot;;
	private static final String ACTIVITY1_START_INVISIBLE_MAP = &quot;ACTIVITY1_START_INVISIBLE_MAP&quot;;
	private static final String ACTIVITY2_START_VISIBLE_MAP = &quot;ACTIVITY2_START_VISIBLE_MAP&quot;;
	private static final String ACTIVITY2_START_INVISIBLE_MAP = &quot;ACTIVITY2_START_INVISIBLE_MAP&quot;;

	// Convenience Constants
	private static final String EMPTY = &quot;&quot;;
	private static final String SPACE = &quot; &quot;;
	private static final String NBSP = HtmlUtil.NBSP;
	private static final String DDWIDTH = &quot;128px&quot;; // &quot;192px&quot;; //Width for the
													// dropdown fields
	public static final int ASSIGNMENT_BOX_ENTRIES = 10;

	// Style Constants. TBD: Can we use HtmlUtil.mergeStyles() instead of
	// creating our own?
	private static final String STYLE1 = &quot;formRowLightNoBorderBottom&quot;; // has
																		// left
																		// and
																		// right
																		// padding
	private static final String STYLE2 = &quot;formRowLightNoBorderBottom2&quot;; // No
																		// left
																		// or
																		// right
																		// padding
	private static final String STYLE3 = &quot;formRowDarkNoBorderBottom&quot;; // No left
																		// or
																		// right
																		// padding
	private static final String STYLE4 = &quot;formRowLightNoBorderBottomNoHeight&quot;; // has
																				// left
																				// and
																				// right
																				// padding

	// Field Value Constants
	private static final String UNDEFINED_FV = EMPTY + BidOptionsFilter.UNDEFINED_STR;
	private static final String EQUAL_FV = EMPTY + BidOptionsFilter.EQUAL;
	private static final String MIN_FV = EMPTY + BidOptionsFilter.MIN;
	private static final String MAX_FV = EMPTY + BidOptionsFilter.MAX;
	private static final String BETWEEN_FV = EMPTY + BidOptionsFilter.BETWEEN;
	private static final String LENGTH_USE_ACTUAL_FV = EMPTY + BidOptionsFilter.LENGTH_USE_ACTUAL;
	private static final String LENGTH_USE_PAID_TIME_FV = EMPTY + BidOptionsFilter.LENGTH_USE_PAID_TIME;
	private static final String SKILLS_MATCH_EXACT_FV = EMPTY + BidOptionsFilter.SKILLS_MATCH_EXACT;
	private static final String SKILLS_MATCH_AT_LEAST_FV = EMPTY + BidOptionsFilter.SKILLS_MATCH_AT_LEAST;
	private static final String SKILLS_MATCH_AT_MOST_FV = EMPTY + BidOptionsFilter.SKILLS_MATCH_AT_MOST;

	// Constants representing the types of dropdown lists which can have &quot;buddy&quot;
	// fields next to them
	protected static final int DD_TYPE_ID = 0;
	protected static final int DD_TYPE_LENGTH = 1;
	protected static final int DD_TYPE_TIME = 2;
	protected static final int DD_TYPE_COUNT = 3;

	// Constants for &quot;Show&quot; modes, which tell us which dropdown buddies to
	// show/hide
	private static final int SHOW_NO_BUDS = 0;
	private static final int SHOW_BUD1_ONLY = 1;
	private static final int SHOW_BUD2_ONLY = 2;
	private static final int SHOW_ALL_BUDS = 3;

	// Dropdown buddy constants
	private static final int BUDDY1_INDEX = 0;
	private static final int BUDDY2_INDEX = 1;
	private static final int BUDDY3_INDEX = 2;
	private static final int BUDDY4_INDEX = 3;
	private static final int BUDDY5_INDEX = 4;

	// Variables needed for populating the form
	private ID m_auctionID;
	private ShiftBidAuction m_auction;
<span class="nc" id="L210">	private boolean m_isWeeklyAuction = false;</span>
	private ID m_bidderID;
<span class="nc" id="L212">	private boolean m_isSupervisor = false; // is the current user a supervisor</span>
											// or an agent?
	private ShiftBidder m_bidder;
	private SchedulingPeriod m_sp;
<span class="nc" id="L216">	private boolean m_isShowBidderSkillsOnly = false;</span>

	private Collection m_shifts; // all shifts for the auction
	// private Collection m_workPatterns; //all Work Patterns for the auction
	private List&lt;StringsPair&gt; m_templates; // all Templates for the auction
	private Collection m_activities; // all Activitys for the auction
	private Collection m_skills; // all Skills in the entire system

	// The filter data structure contains all the form field values
	private BidOptionsFilter m_filter;

	// Containers and Form Fields
	protected ContainerList m_containerList;
	private Collapsible2ColFormPC m_shiftsContainerPC;
	private Collapsible2ColFormPC m_activitiesContainerPC;
	private Collapsible2ColFormPC m_skillsContainerPC;
	private FormInputPC m_inputPC;
	private TimePickerPC m_shiftStartTime;
	private TimeRangePickerPC m_shiftStartRange;
	private TimePickerPC m_shiftEndTime;
	private TimeRangePickerPC m_shiftEndRange;
	private TimePickerPC m_activity1StartTime;
	private TimeRangePickerPC m_activity1StartRange;
	private TimePickerPC m_activity2StartTime;
	private TimeRangePickerPC m_activity2StartRange;
	private AssignmentBoxPC m_skillsAssignmentBox;

	// Localization
<span class="fc" id="L244">	private static Category log = Log.initCategory(BidOptionsFilterPopupPM.class.getName());</span>
	protected ResourceBundle m_rmBundle;
	protected ResourceBundle m_bbmBundle;

	// Localized Label strings
	protected String m_anyAvailLabel;
	protected String m_anyLengthLabel;
	protected String m_anyTimeLabel;
	protected String m_atLabel;
	protected String m_equalLabel;
	protected String m_minLabel;
	protected String m_maxLabel;
	protected String m_betweenLabel;
	protected String m_notBeforeLabel;
	protected String m_notAfterLabel;
	protected String m_optionsLabel;
	protected String m_dashLabel;
	protected String m_checkBoxLabel;
	protected String m_actualShiftLengthLabel;
	protected String m_actualSchedLengthLabel;
	protected String m_paidTimeOnlyLabel;
	protected String m_hoursLabel;
	protected String m_hoursAriaLabel;
	protected String m_skillsMatchAnyLabel;
	protected String m_skillsMatchExactlyLabel;
	protected String m_skillsMatchAtLeastLabel;
	protected String m_skillsMatchAtMostLabel;
	protected String m_skillsForShiftLabel;
	protected String m_assignBoxHeaderLabel;
	protected String m_assignBoxLeftLabel;
	protected String m_assignBoxRightLabel;
	protected String m_noneLabel;
	protected String m_lengthExampleLabel;
<span class="nc" id="L277">	private boolean isCloseAfterLoadCustomize = false;</span>

	// ///////////////////////////////////////////////////////
	// Standard Page Model Methods
	// ///////////////////////////////////////////////////////

	/**
	 * Return an instance of the model that is ready for rendering
	 */
	public static PageModel getInstance(RequestContext context) throws Exception {
<span class="nc" id="L287">		return getInstance(context, BidOptionsFilterPopupPM.class);</span>
	}

	/**
	 * Constructor
	 */
	public BidOptionsFilterPopupPM(RequestContext context) {
<span class="nc" id="L294">		super(context);</span>

		// Create the container list
<span class="nc" id="L297">		m_containerList = new ContainerList(this, 3);</span>

		// Initialize resource bundles
<span class="nc" id="L300">		m_rmBundle = m_localizer.getBundle(RmWebBundleKey.BUNDLE_NAME);</span>
<span class="nc" id="L301">		m_bbmBundle = m_localizer.getBundle(BbmWebBundleKey.BUNDLE_NAME);</span>

		// Initialize label strings
<span class="nc" id="L304">		initLabels();</span>

		// Initialize our filter data structure with default values
<span class="nc" id="L307">		m_filter = new BidOptionsFilter();</span>

		// Initialize our m_isSupervisor member variable (must be done before
		// initFormFields())
<span class="nc" id="L311">		setIsSupervisor();</span>

		// Initialize form fields
<span class="nc" id="L314">		initFormFields(context);</span>
<span class="nc" id="L315">	}</span>

	/**
	 * Read the parameters from the request, and set our fields accordingly.
	 */
	@Override
	public boolean extractParameters(HttpServletRequest request) {
		// Let the framework do all of the automatic parameter extractions
<span class="nc" id="L323">		boolean success = super.extractParameters(request);</span>

		// Some of out parameters require special handling
		try {
			// If one parameter is extractable, then they all must be.
<span class="nc bnc" id="L328" title="All 2 branches missed.">			if (m_shiftStartTime.hasValueToExtract(request)) {</span>
<span class="nc" id="L329">				extractShiftStartParams();</span>
<span class="nc" id="L330">				extractShiftEndParams();</span>
<span class="nc" id="L331">				extractActivity1StartParams();</span>
<span class="nc" id="L332">				extractActivity2StartParams();</span>
<span class="nc bnc" id="L333" title="All 2 branches missed.">				if (isShowSkillsSection()) {</span>
<span class="nc" id="L334">					extractSkillsParams();</span>
				}
			} else {
				// Load the filter from the session
<span class="nc" id="L338">				m_filter = (BidOptionsFilter) m_context.getAttribute(RequestContext.SESSION_SCOPE,</span>
						RmKeys.BID_OPTIONS_FILTER);
<span class="nc bnc" id="L340" title="All 2 branches missed.">				if (m_filter == null) {</span>
<span class="nc" id="L341">					m_filter = new BidOptionsFilter();</span>
				}
			}
<span class="nc" id="L344">		} catch (Exception e) {</span>
<span class="nc" id="L345">			log.l7dError(RmWebLogBundleKey.EXTRACT_PARAM_FAILED, e);</span>
<span class="nc" id="L346">		}</span>
<span class="nc" id="L347">		return success;</span>
	}

	/**
	 * Initialize Model with Data. This is called AFTER extractParameters(),
	 * which means our m_auctionID will be set already.
	 */
	@Override
	protected void initializeModel() {
<span class="nc" id="L356">		boolean byEmplType = false;</span>
<span class="nc" id="L357">		OrganizationSetting orgSettings = null;</span>
<span class="nc" id="L358">		boolean hasRMAdvanceLicense = false;</span>

<span class="nc bnc" id="L360" title="All 2 branches missed.">		if (m_isInitialized) {</span>
<span class="nc" id="L361">			return;</span>
		} else {
<span class="nc" id="L363">			m_isInitialized = true;</span>
		}

		try {
			// Determine whether current auction is a full period auction or a
			// shift auction
<span class="nc" id="L369">			m_auction = AuctionMH.getAuction(m_auctionID);</span>
<span class="nc" id="L370">			m_isWeeklyAuction = m_auction.getIsFullPeriodSchedule();</span>

<span class="nc" id="L372">			m_bidder = AuctionMH.getShiftBidderByID(m_bidderID);</span>
<span class="nc" id="L373">			m_sp = BidOptionsFilterUtil.getSP(m_context, m_auction);</span>
<span class="nc" id="L374">			m_isShowBidderSkillsOnly = BidOptionsFilterUtil.isShowBidderSkillsOnly(m_context, m_sp,</span>
<span class="nc" id="L375">					m_bidder.getEmployeeID());</span>

			// Get Organization ID's linked to the auction's SP
<span class="nc" id="L378">			Collection orgIDs = BidOptionsFilterUtil.getOrgIDs(m_context, m_auction);</span>

			// Get Activities
<span class="nc" id="L381">			ActivityFilter activityFilter = new ActivityFilter();</span>
<span class="nc" id="L382">			activityFilter.setUsedInShiftEvent(true); // we do want to see shift</span>
														// activities
<span class="nc" id="L384">			activityFilter.setUsedInShift(false); // we don't want to see</span>
													// primary activities
<span class="nc" id="L386">			activityFilter.setActivityId(Activity.ACTIVITY_NONE.toString(), ActivityFilter.OP_NOT_IN_LIST);</span>

<span class="nc" id="L388">			m_activities = ActivityModelHandler.getActivities(m_context, orgIDs, activityFilter, true);</span>
<span class="nc bnc" id="L389" title="All 2 branches missed.">			if (m_activities == null) {</span>
<span class="nc" id="L390">				m_activities = Collections.emptyList();</span>
			}

<span class="nc" id="L393">			Comparator&lt;IDStringPair&gt; iDStringPairComparator = new Comparator&lt;IDStringPair&gt;() {</span>
				@Override
				public int compare(IDStringPair pairA, IDStringPair pairB) {
<span class="nc" id="L396">					return pairA.getString().compareToIgnoreCase(pairB.getString());</span>
				}
			};

			// Get Users Org ID
<span class="nc" id="L401">			ID orgID = OrganizationModelHandler.getEmployeeOrgID(m_context, m_bidder.getEmployeeID());</span>

			// Get Filter by Employee Type Setting
<span class="nc" id="L404">			hasRMAdvanceLicense = LicenseUtil.isAdvancedRMLicense();</span>
<span class="nc bnc" id="L405" title="All 2 branches missed.">			if (hasRMAdvanceLicense) {</span>
<span class="nc" id="L406">				orgSettings = SettingsModelHandler.getSettings(orgID);</span>
<span class="nc" id="L407">				byEmplType = orgSettings.getFilterBidOptionsByEmpType();</span>
			}

			// Determine OrgID for filtering
<span class="nc bnc" id="L411" title="All 2 branches missed.">			if (!m_auction.getBidsOnlyWithinOrg()) {</span>
<span class="nc" id="L412">				orgID = null;</span>
			}

			// Get Org List
<span class="nc bnc" id="L416" title="All 2 branches missed.">			Collection&lt;ID&gt; schedulesOrgIDs = orgID == null ? new ArrayList&lt;&gt;() : Arrays.asList(orgID);</span>

			// Get Templates
<span class="nc" id="L419">			m_templates = toStringPair(AuctionMH.getTemplateNames(m_auctionID, schedulesOrgIDs, m_bidderID, byEmplType));</span>
<span class="nc" id="L420">			addAnyLabel(m_templates);</span>

			// Get Shifts
<span class="nc" id="L423">			m_shifts = AuctionMH.getShiftIDNamePairs(orgIDs);</span>
<span class="nc" id="L424">			SortUtil.sort(m_shifts, iDStringPairComparator);</span>

			// Get skills
<span class="nc bnc" id="L427" title="All 2 branches missed.">			if (m_sp.getSkillBased()) {</span>
<span class="nc" id="L428">				m_skills = SkillModelHandler.getAvailableSkillsInOrg(m_context, orgIDs); // ID=string,</span>
																							// SID=int
<span class="nc" id="L430">				convertSkillStringIDsToIntIDs(m_skills);</span>
			}
<span class="nc" id="L432">		} catch (RmHardValidationException ex) {</span>
<span class="nc" id="L433">			Message msg = handleUnableToLoadDataErrorAndLogAsDebug(log, ex);</span>
<span class="nc" id="L434">			msg.setAssociatedMessage(ex.getLocalizedMessage(m_localizer, m_context.getViewingTimeZone()));</span>
<span class="nc" id="L435">		} catch (Exception ex) {</span>
<span class="nc" id="L436">			handleUnableToLoadDataError(log, ex);</span>
		} finally {
<span class="nc" id="L438">			initContentTitle();</span>
<span class="nc" id="L439">			initContent();</span>
<span class="nc" id="L440">			initToolbar();</span>
<span class="nc" id="L441">		}</span>
<span class="nc" id="L442">	}</span>

	/**
	 * Given a collection of Skills that use the DE Sting ID's in the skill.ID
	 * field and the SID's in the skill.SID field, copy the SID's into the ID
	 * field.
	 *
	 * @param skills
	 */
	protected void convertSkillStringIDsToIntIDs(Collection skills) {
<span class="nc bnc" id="L452" title="All 2 branches missed.">		if (skills != null) {</span>
<span class="nc bnc" id="L453" title="All 2 branches missed.">			for (Iterator it = skills.iterator(); it.hasNext();) {</span>
<span class="nc" id="L454">				Skill skill = (Skill) it.next();</span>
<span class="nc" id="L455">				skill.setIDStr(skill.getID().toString());</span>
<span class="nc" id="L456">				skill.setID(skill.getFieldValueID(SkillFieldInfo.SKILL_SID));</span>
<span class="nc" id="L457">			}</span>
		}
<span class="nc" id="L459">	}</span>

	/**
	 * Initialize Component For Display
	 */
	@Override
	public void initForDisplay() {
<span class="nc bnc" id="L466" title="All 2 branches missed.">		if (m_isInitializedForDisplay) {</span>
<span class="nc" id="L467">			return;</span>
		} else {
<span class="nc" id="L469">			super.initForDisplay();</span>

<span class="nc" id="L471">			addRequiredJavaScriptFile(JavaScriptFileID.MEDIATOR_WORKPANE);</span>
<span class="nc" id="L472">			addRequiredJavaScriptFile(JavaScriptFileID.MEDIATOR_WORKPANE_GENERIC);</span>
		}
<span class="nc" id="L474">	}</span>

	/**
	 * Prepare content title for rendering
	 */
	private void initContentTitle() {
<span class="nc" id="L480">		String pageTitle = i18n(m_rmBundle, RmWebBundleKey.RM_SA_FILTER_EDIT_FILTER);</span>
<span class="nc" id="L481">		m_contentTitlePC.setPageTitle(pageTitle);</span>

<span class="nc" id="L483">		String name = EMPTY;</span>
<span class="nc bnc" id="L484" title="All 2 branches missed.">		if (!m_isSupervisor) {</span>
<span class="nc" id="L485">			name = i18n(m_rmBundle, RmWebBundleKey.RM_MYSCHEDULE_BIDS);</span>
		} else {
<span class="nc" id="L487">			name = i18n(m_rmBundle, RmWebBundleKey.RM_SA_BID_OPTIONS);</span>
		}
<span class="nc" id="L489">		m_contentTitlePC.setItemName(name);</span>
<span class="nc" id="L490">	}</span>

	/**
	 * Initialize Content
	 */
	protected void initContent() {
		// Initialize the collapsible form containers
<span class="nc" id="L497">		initShiftsAndSchedulesContainer();</span>
<span class="nc" id="L498">		initActivitiesContainer();</span>

<span class="nc bnc" id="L500" title="All 2 branches missed.">		if (isShowSkillsSection()) {</span>
<span class="nc" id="L501">			initSkillsContainer();</span>
		}
<span class="nc" id="L503">	}</span>

	/**
	 * Initialize Toolbar
	 */
	@Override
	protected void initToolbar() {
<span class="nc" id="L510">		ToolbarUtil.addSaveBtn(m_toolbar, true);</span>
<span class="nc" id="L511">		m_toolbar.addConfirmSubmitTextButton(&quot;CLEAR_ACTION&quot;, i18n(m_rmBundle, RmWebBundleKey.TOOLBAR_CLEAR), true);</span>
<span class="nc" id="L512">		ToolbarUtil.addCloseWindowCancelBtn(m_toolbar, true);</span>
<span class="nc" id="L513">	}</span>

	/**
	 * Validates the Page Component TBD: Consider using ComponentValidator
	 * instead. PageComponent.addValidator(ComponentValidator validator)
	 */
	@Override
	public boolean validate() {
<span class="nc" id="L521">		boolean success = super.validate();</span>
<span class="nc bnc" id="L522" title="All 2 branches missed.">		success = success</span>
<span class="nc bnc" id="L523" title="All 2 branches missed.">				&amp;&amp; validateDDInputInts(m_filter.getInt(&quot;availability&quot;), m_filter.getInt(&quot;availabilityValue1&quot;),</span>
<span class="nc" id="L524">						m_filter.getInt(&quot;availabilityValue2&quot;), RmWebBundleKey.RM_SA_FILTER_AVAILABILITY);</span>
<span class="nc bnc" id="L525" title="All 2 branches missed.">		success = success</span>
<span class="nc bnc" id="L526" title="All 2 branches missed.">				&amp;&amp; validateDDInputFloats(m_filter.getInt(&quot;scheduleLengthType&quot;),</span>
<span class="nc" id="L527">						m_filter.getFloat(&quot;scheduleLengthValue1&quot;), m_filter.getFloat(&quot;scheduleLengthValue2&quot;),</span>
						RmWebBundleKey.RM_SA_FILTER_SCHEDULE_LENGTH);
<span class="nc bnc" id="L529" title="All 2 branches missed.">		success = success</span>
<span class="nc bnc" id="L530" title="All 2 branches missed.">				&amp;&amp; validateDDInputFloats(m_filter.getInt(&quot;shiftLengthType&quot;), m_filter.getFloat(&quot;shiftLengthValue1&quot;),</span>
<span class="nc" id="L531">						m_filter.getFloat(&quot;shiftLengthValue2&quot;), RmWebBundleKey.RM_SA_FILTER_SHIFT_LENGTH);</span>
<span class="nc bnc" id="L532" title="All 2 branches missed.">		success = success</span>
<span class="nc bnc" id="L533" title="All 2 branches missed.">				&amp;&amp; validateDDInputFloats(m_filter.getInt(&quot;activity1LengthType&quot;),</span>
<span class="nc" id="L534">						m_filter.getFloat(&quot;activity1LengthValue1&quot;), m_filter.getFloat(&quot;activity1LengthValue2&quot;),</span>
						RmWebBundleKey.RM_SA_FILTER_ACTIVITY_LENGTH);
<span class="nc bnc" id="L536" title="All 2 branches missed.">		success = success</span>
<span class="nc bnc" id="L537" title="All 2 branches missed.">				&amp;&amp; validateDDInputFloats(m_filter.getInt(&quot;activity2LengthType&quot;),</span>
<span class="nc" id="L538">						m_filter.getFloat(&quot;activity2LengthValue1&quot;), m_filter.getFloat(&quot;activity2LengthValue2&quot;),</span>
						RmWebBundleKey.RM_SA_FILTER_ACTIVITY_LENGTH);
<span class="nc" id="L540">		return success;</span>
	}

	/**
	 * Get custom JavaScript code to be included in the page. This is where we
	 * will define our variables which contain arrays of buddy elements (or
	 * spans containing the buddy elements) to be shown or hidden depending on
	 * the corresponding dropdown selectedIndex. The JavaScript function which
	 * needs these arrays is FormUtil.js showDDBuddyElems(eSelectField,
	 * shownMap, hiddenMap)
	 */
	@Override
	public String getCustomJavaScript() {
<span class="nc" id="L553">		StringBuffer sb = new StringBuffer(1000);</span>
<span class="nc" id="L554">		sb.append(super.getCustomJavaScript()).append(&quot;\n&quot;);</span>

		// Availability
<span class="nc" id="L557">		sb.append(createBuddyVisibilityMap(DD_TYPE_LENGTH, AVAIL_VISIBLE_MAP, AVAIL_INVISIBLE_MAP, new String[] {</span>
				AVAIL_VAL1, AVAIL_VAL2 }));

		// Schedule Length
<span class="nc bnc" id="L561" title="All 2 branches missed.">		if (m_isWeeklyAuction) {</span>
<span class="nc" id="L562">			sb.append(createBuddyVisibilityMap(DD_TYPE_LENGTH, SCHED_LEN_VISIBLE_MAP, SCHED_LEN_INVISIBLE_MAP,</span>
					new String[] { SCHED_LEN_VAL1, SCHED_LEN_VAL2, SCHED_LEN_USE_LEFT_SPAN, SCHED_LEN_USE_RIGHT_SPAN }));
		}

		// Shift Length
<span class="nc bnc" id="L567" title="All 2 branches missed.">		sb.append(createBuddyVisibilityMap(DD_TYPE_LENGTH, SHIFT_LEN_VISIBLE_MAP, SHIFT_LEN_INVISIBLE_MAP,</span>
				new String[] { SHIFT_LEN_VAL1, SHIFT_LEN_VAL2, m_isWeeklyAuction ? SHIFT_LEN_CHECKBOX_SPAN : &quot;&quot;,
						SHIFT_LEN_USE_LEFT_SPAN, SHIFT_LEN_USE_RIGHT_SPAN }));

		// Shift Start
<span class="nc bnc" id="L572" title="All 2 branches missed.">		sb.append(createBuddyVisibilityMap(DD_TYPE_TIME, SHIFT_START_VISIBLE_MAP, SHIFT_START_INVISIBLE_MAP,</span>
				new String[] { SHIFT_START_TIME_SPAN, SHIFT_START_RANGE_SPAN,
						m_isWeeklyAuction ? SHIFT_START_CHECKBOX_SPAN : &quot;&quot; }));

		// Shift end
<span class="nc bnc" id="L577" title="All 2 branches missed.">		sb.append(createBuddyVisibilityMap(DD_TYPE_TIME, SHIFT_END_VISIBLE_MAP, SHIFT_END_INVISIBLE_MAP, new String[] {</span>
				SHIFT_END_TIME_SPAN, SHIFT_END_RANGE_SPAN, m_isWeeklyAuction ? SHIFT_END_CHECKBOX_SPAN : &quot;&quot; }));

		// Activity 1 Length
<span class="nc bnc" id="L581" title="All 2 branches missed.">		sb.append(createBuddyVisibilityMap(DD_TYPE_LENGTH, ACTIVITY1_LEN_VISIBLE_MAP, ACTIVITY1_LEN_INVISIBLE_MAP,</span>
				new String[] { ACTIVITY1_LEN_VAL1, ACTIVITY1_LEN_VAL2,
						m_isWeeklyAuction ? ACTIVITY1_LEN_CHECKBOX_SPAN : &quot;&quot; }));

		// Activity 1 Start
<span class="nc bnc" id="L586" title="All 2 branches missed.">		sb.append(createBuddyVisibilityMap(DD_TYPE_TIME, ACTIVITY1_START_VISIBLE_MAP, ACTIVITY1_START_INVISIBLE_MAP,</span>
				new String[] { ACTIVITY1_START_TIME_SPAN, ACTIVITY1_START_RANGE_SPAN,
						m_isWeeklyAuction ? ACTIVITY1_START_CHECKBOX_SPAN : &quot;&quot; }));

		// Activity 2 Length
<span class="nc bnc" id="L591" title="All 2 branches missed.">		sb.append(createBuddyVisibilityMap(DD_TYPE_LENGTH, ACTIVITY2_LEN_VISIBLE_MAP, ACTIVITY2_LEN_INVISIBLE_MAP,</span>
				new String[] { ACTIVITY2_LEN_VAL1, ACTIVITY2_LEN_VAL2,
						m_isWeeklyAuction ? ACTIVITY2_LEN_CHECKBOX_SPAN : &quot;&quot; }));

		// Activity 2 Start
<span class="nc bnc" id="L596" title="All 2 branches missed.">		sb.append(createBuddyVisibilityMap(DD_TYPE_TIME, ACTIVITY2_START_VISIBLE_MAP, ACTIVITY2_START_INVISIBLE_MAP,</span>
				new String[] { ACTIVITY2_START_TIME_SPAN, ACTIVITY2_START_RANGE_SPAN,
						m_isWeeklyAuction ? ACTIVITY2_START_CHECKBOX_SPAN : &quot;&quot; }));

<span class="nc" id="L600">		return sb.toString();</span>
	}

	// ///////////////////////////////////////////////////////
	// Helper methods needed during initialization
	// ///////////////////////////////////////////////////////

	/**
	 * Tells us whether or not to show the skills section in the form.
	 *
	 * @return true if we should show the skills section, false otherwise.
	 */
	private boolean isShowSkillsSection() {
<span class="nc bnc" id="L613" title="All 2 branches missed.">		if (m_sp == null) {</span>
			// Model has not yet been iniialized. Get info from the session.
<span class="nc" id="L615">			String isSkilledSP = (String) m_context.getAttribute(RequestContext.SESSION_SCOPE,</span>
					BidOptionsFilterUtil.IS_SKILLED_SP_KEY);
<span class="nc bnc" id="L617" title="All 4 branches missed.">			if ((isSkilledSP != null) &amp;&amp; isSkilledSP.equals(&quot;true&quot;)) {</span>
<span class="nc" id="L618">				return true;</span>
			}
<span class="nc bnc" id="L620" title="All 2 branches missed.">		} else if (m_sp.getSkillBased()) {</span>
<span class="nc" id="L621">			return true;</span>
		}
<span class="nc" id="L623">		return false;</span>
	}

	/**
	 * Validates a dropdown field and its integer buddy input fields.
	 *
	 * @param ddVal
	 *            The id of the selected value in the dropdown list
	 * @param val1
	 *            The first input field (for the min vlaue)
	 * @param val1
	 *            The second input field (for the max vlaue)
	 * @param fieldName
	 *            The resource bundle key to use for localizing name of field
	 */
	private boolean validateDDInputInts(int ddVal, int val1, int val2, String fieldNameKey) {
<span class="nc" id="L639">		boolean success = true;</span>
<span class="nc bnc" id="L640" title="All 3 branches missed.">		switch (ddVal) {</span>
		case BidOptionsFilter.EQUAL:
		case BidOptionsFilter.MIN:
		case BidOptionsFilter.MAX:
<span class="nc bnc" id="L644" title="All 2 branches missed.">			if (val1 == BidOptionsFilter.UNDEFINED_INT) {</span>
<span class="nc" id="L645">				String fieldName = i18n(m_rmBundle, fieldNameKey);</span>
<span class="nc" id="L646">				addPageMessage(Message.ERROR_TYPE, RmWebBundleKey.RM_SA_FILTER_INVALID_FIELD,</span>
						RmWebBundleKey.BUNDLE_NAME, new String[] { fieldName });
<span class="nc" id="L648">				success = false;</span>
<span class="nc" id="L649">			}</span>
			break;
		case BidOptionsFilter.BETWEEN:
<span class="nc bnc" id="L652" title="All 4 branches missed.">			if ((val1 == BidOptionsFilter.UNDEFINED_INT) || (val2 == BidOptionsFilter.UNDEFINED_INT)) {</span>
<span class="nc" id="L653">				String fieldName = i18n(m_rmBundle, fieldNameKey);</span>
<span class="nc" id="L654">				addPageMessage(Message.ERROR_TYPE, RmWebBundleKey.RM_SA_FILTER_INVALID_FIELDS,</span>
						RmWebBundleKey.BUNDLE_NAME, new String[] { fieldName });
<span class="nc" id="L656">				success = false;</span>
<span class="nc bnc" id="L657" title="All 2 branches missed.">			} else if (val2 &lt; val1) {</span>
<span class="nc" id="L658">				String fieldName = i18n(m_rmBundle, fieldNameKey);</span>
<span class="nc" id="L659">				addPageMessage(Message.ERROR_TYPE, RmWebBundleKey.RM_SA_FILTER_INVALID_RANGE,</span>
						RmWebBundleKey.BUNDLE_NAME, new String[] { fieldName });
<span class="nc" id="L661">				success = false;</span>
			}
			break;
		}
<span class="nc" id="L665">		return success;</span>
	}

	/**
	 * Validates a dropdown field and its float buddy input fields.
	 *
	 * @param ddVal
	 *            The id of the selected value in the dropdown list
	 * @param val1
	 *            The first input field (for the min vlaue)
	 * @param val1
	 *            The second input field (for the max vlaue)
	 * @param fieldName
	 *            The resource bundle key to use for localizing name of field
	 */
	private boolean validateDDInputFloats(int ddVal, float val1, float val2, String fieldNameKey) {
<span class="nc" id="L681">		boolean success = true;</span>
<span class="nc bnc" id="L682" title="All 3 branches missed.">		switch (ddVal) {</span>
		case BidOptionsFilter.EQUAL:
		case BidOptionsFilter.MIN:
		case BidOptionsFilter.MAX:
<span class="nc bnc" id="L686" title="All 2 branches missed.">			if (val1 == BidOptionsFilter.UNDEFINED_FLOAT) {</span>
<span class="nc" id="L687">				String fieldName = i18n(m_rmBundle, fieldNameKey);</span>
<span class="nc" id="L688">				addPageMessage(Message.ERROR_TYPE, RmWebBundleKey.RM_SA_FILTER_INVALID_FIELD,</span>
						RmWebBundleKey.BUNDLE_NAME, new String[] { fieldName });
<span class="nc" id="L690">				success = false;</span>
<span class="nc" id="L691">			}</span>
			break;
		case BidOptionsFilter.BETWEEN:
<span class="nc bnc" id="L694" title="All 4 branches missed.">			if ((val1 == BidOptionsFilter.UNDEFINED_FLOAT) || (val2 == BidOptionsFilter.UNDEFINED_FLOAT)) {</span>
<span class="nc" id="L695">				String fieldName = i18n(m_rmBundle, fieldNameKey);</span>
<span class="nc" id="L696">				addPageMessage(Message.ERROR_TYPE, RmWebBundleKey.RM_SA_FILTER_INVALID_FIELDS,</span>
						RmWebBundleKey.BUNDLE_NAME, new String[] { fieldName });
<span class="nc" id="L698">				success = false;</span>
<span class="nc bnc" id="L699" title="All 2 branches missed.">			} else if (val2 &lt; val1) {</span>
<span class="nc" id="L700">				String fieldName = i18n(m_rmBundle, fieldNameKey);</span>
<span class="nc" id="L701">				addPageMessage(Message.ERROR_TYPE, RmWebBundleKey.RM_SA_FILTER_INVALID_RANGE,</span>
						RmWebBundleKey.BUNDLE_NAME, new String[] { fieldName });
<span class="nc" id="L703">				success = false;</span>
			}
			break;
		}
<span class="nc" id="L707">		return success;</span>
	}

	// ///////////////////////////////////////////////////////
	// Methods for the &quot;Shifts and Schedules&quot; container
	// ///////////////////////////////////////////////////////

	/**
	 * Add the &quot;Shifts and Schedules&quot; container to the page.
	 */
	private void initShiftsAndSchedulesContainer() {
<span class="nc" id="L718">		m_shiftsContainerPC = createFormPC(&quot;shiftsContainer&quot;);</span>
<span class="nc" id="L719">		String title = i18n(m_rmBundle, RmWebBundleKey.RM_SA_FILTER_SHIFTS_SCHEDULES);</span>
<span class="nc" id="L720">		m_shiftsContainerPC.setTitle(title);</span>

		// Add accessibility support to the container
<span class="nc bnc" id="L723" title="All 2 branches missed.">		if (isAccessibilityComplianceMode()) {</span>
<span class="nc" id="L724">			m_shiftsContainerPC.setWrapperAriaLabel(title + i18n(m_rmBundle, RmWebBundleKey.RM_SA_FILTER_REGION_DESC));</span>
		}

		// Template (Work Pattern) Row
<span class="nc" id="L728">		createWorkPatternRow();</span>

		// Availability Row
<span class="nc" id="L731">		createAvailabilityRow();</span>

		// Schedule Length Row
<span class="nc bnc" id="L734" title="All 2 branches missed.">		if (m_isWeeklyAuction) {</span>
<span class="nc" id="L735">			createScheduleLengthRow();</span>
		}

		// Shift Name Row
<span class="nc" id="L739">		createShiftNameRow();</span>

		// Shift Length Row
<span class="nc" id="L742">		createShiftLengthRow();</span>

		// Shifts Starting Row
<span class="nc" id="L745">		createShiftsStartingRow();</span>

		// Shifts Ending Row
<span class="nc" id="L748">		createShiftsEndingRow();</span>
<span class="nc" id="L749">	}</span>

	private void createWorkPatternRow() {
		// Create the &quot;Work Pattern&quot; drop down

<span class="nc" id="L754">		String title = i18n(m_rmBundle, RmWebBundleKey.RM_SA_FILTER_WORK_PATTERN);</span>
<span class="nc" id="L755">		String dropDown = BidOptionsFilterUtil.makeSelectInput(BidOptionsFilter.TEMPLATE_NAME,</span>
<span class="nc" id="L756">				m_filter.getString(BidOptionsFilter.TEMPLATE_NAME),</span>
				JSUtil.ON_CHANGE, m_templates, DDWIDTH, title);

		// Put it all together
<span class="nc" id="L760">		String rightRow = BidOptionsFilterUtil.wrapInTable1Row2Col(STYLE1, new String[] { dropDown, &quot;&quot; });</span>
<span class="nc" id="L761">		m_shiftsContainerPC.addRow(title, rightRow);</span>
<span class="nc" id="L762">	}</span>

	private void addAnyLabel(List&lt;StringsPair&gt; values) {
<span class="nc" id="L765">		String anyLabel = i18n(m_rmBundle, RmWebBundleKey.RM_SA_FILTER_ANY_TEMPLATE);</span>
<span class="nc" id="L766">		values.add(0, new StringsPair(UNDEFINED_FV, anyLabel));</span>
<span class="nc" id="L767">	}</span>

	private static List&lt;StringsPair&gt; toStringPair(List&lt;String&gt; values) {
<span class="nc" id="L770">		List&lt;StringsPair&gt; result = new ArrayList&lt;StringsPair&gt;(values.size());</span>
<span class="nc bnc" id="L771" title="All 2 branches missed.">		for (String val : values) {</span>
<span class="nc" id="L772">			result.add(new StringsPair(val, val));</span>
<span class="nc" id="L773">		}</span>
<span class="nc" id="L774">		return result;</span>
	}

	private void createAvailabilityRow() {
		// Create the &quot;Availability&quot; drop down
<span class="nc" id="L779">		String title = i18n(m_rmBundle, RmWebBundleKey.RM_SA_FILTER_AVAILABILITY);</span>
<span class="nc" id="L780">		String onChangeJS = JSUtil.ON_CHANGE + &quot;showDDBuddyElems(this, AVAIL_VISIBLE_MAP, AVAIL_INVISIBLE_MAP)&quot;;</span>
<span class="nc" id="L781">		String dropDown = BidOptionsFilterUtil.makeSelectInput(&quot;availability&quot;, EMPTY + m_filter.getInt(&quot;availability&quot;),</span>
<span class="nc" id="L782">				onChangeJS, getMinMaxDDOptions(m_anyAvailLabel, m_equalLabel, m_minLabel, m_maxLabel, m_betweenLabel),</span>
				DDWIDTH, title);

		// Create the first buddy field
<span class="nc" id="L786">		resetInputPC(AVAIL_VAL1, FormInputPC.TYPE_INTEGER);</span>
<span class="nc" id="L787">		m_inputPC.setInputFieldDesc(RmWebBundleKey.RM_SA_FILTER_AVAILABILITY, RmWebBundleKey.BUNDLE_NAME);</span>
<span class="nc" id="L788">		m_inputPC.setInputValue(getInputValue(m_filter.getInt(&quot;availabilityValue1&quot;)));</span>
<span class="nc" id="L789">		String bud1Style = getBuddyStyle(DD_TYPE_LENGTH, m_filter.getInt(&quot;availability&quot;), BUDDY1_INDEX);</span>
<span class="nc" id="L790">		m_inputPC.setStyle(bud1Style);</span>
<span class="nc" id="L791">		m_inputPC.setTitle(i18n(m_rmBundle, RmWebBundleKey.RM_SA_FILTER_NUMBER_OF_OPTIONS));</span>
<span class="nc" id="L792">		m_inputPC.initForDisplay();</span>
<span class="nc" id="L793">		String input1 = m_inputPC.getHtmlDisplay();</span>

		// Create the second buddy field
<span class="nc" id="L796">		resetInputPC(AVAIL_VAL2, FormInputPC.TYPE_INTEGER);</span>
<span class="nc" id="L797">		m_inputPC.setInputFieldDesc(RmWebBundleKey.RM_SA_FILTER_AVAILABILITY, RmWebBundleKey.BUNDLE_NAME);</span>
<span class="nc" id="L798">		m_inputPC.setInputValue(getInputValue(m_filter.getInt(&quot;availabilityValue2&quot;)));</span>
<span class="nc" id="L799">		String bud2Style = getBuddyStyle(DD_TYPE_LENGTH, m_filter.getInt(&quot;availability&quot;), BUDDY2_INDEX);</span>
<span class="nc" id="L800">		m_inputPC.setStyle(bud2Style);</span>
<span class="nc" id="L801">		m_inputPC.setTitle(i18n(m_rmBundle, RmWebBundleKey.RM_SA_FILTER_MAX_NUMBER_OF_OPTIONS));</span>
<span class="nc" id="L802">		m_inputPC.initForDisplay();</span>
<span class="nc" id="L803">		String input2 = m_inputPC.getHtmlDisplay();</span>

		// Aggregate the elements into the inputs row
<span class="nc" id="L806">		String inputsRow = input1 + NBSP</span>
<span class="nc" id="L807">				+ BidOptionsFilterUtil.wrapInSpan(m_dashLabel, AVAIL_VAL2 + &quot;_label&quot;, bud2Style) + NBSP + input2 + NBSP</span>
<span class="nc" id="L808">				+ BidOptionsFilterUtil.wrapInSpan(m_optionsLabel, AVAIL_VAL1 + &quot;_label&quot;, bud1Style);</span>

		// Put it all together
<span class="nc" id="L811">		String rightRow = BidOptionsFilterUtil.wrapInTable1Row2Col(STYLE1, new String[] { dropDown, inputsRow });</span>
<span class="nc" id="L812">		m_shiftsContainerPC.addRow(title, rightRow);</span>
<span class="nc" id="L813">	}</span>

	private void createScheduleLengthRow() {
		// Create the &quot;Schedule Length&quot; drop down
<span class="nc" id="L817">		String title = i18n(m_rmBundle, RmWebBundleKey.RM_SA_FILTER_SCHEDULE_LENGTH);</span>
<span class="nc" id="L818">		String onChangeJS = JSUtil.ON_CHANGE + &quot;showDDBuddyElems(this, SCHED_LEN_VISIBLE_MAP, SCHED_LEN_INVISIBLE_MAP)&quot;;</span>
<span class="nc" id="L819">		String dropDown = BidOptionsFilterUtil.makeSelectInput(&quot;scheduleLengthType&quot;,</span>
<span class="nc" id="L820">				EMPTY + m_filter.getInt(&quot;scheduleLengthType&quot;), onChangeJS,</span>
<span class="nc" id="L821">				getMinMaxDDOptions(m_anyLengthLabel, m_equalLabel, m_minLabel, m_maxLabel, m_betweenLabel), DDWIDTH,</span>
				title);

		// Create the first buddy field
<span class="nc" id="L825">		resetInputPC(SCHED_LEN_VAL1, FormInputPC.TYPE_NUMERIC);</span>
<span class="nc" id="L826">		m_inputPC.setInputFieldDesc(RmWebBundleKey.RM_SA_FILTER_SCHEDULE_LENGTH, RmWebBundleKey.BUNDLE_NAME);</span>
<span class="nc" id="L827">		m_inputPC.setInputValue(getInputValue(m_filter.getFloat(&quot;scheduleLengthValue1&quot;)));</span>
<span class="nc" id="L828">		String bud1Style = getBuddyStyle(DD_TYPE_LENGTH, m_filter.getInt(&quot;scheduleLengthType&quot;), BUDDY1_INDEX);</span>
<span class="nc" id="L829">		m_inputPC.setStyle(bud1Style);</span>
<span class="nc" id="L830">		m_inputPC.setTitle(i18n(m_rmBundle, RmWebBundleKey.RM_SA_FILTER_NUMBER_OF_HOURS));</span>
<span class="nc" id="L831">		m_inputPC.setAriaLabel(m_hoursAriaLabel);</span>
<span class="nc" id="L832">		m_inputPC.initForDisplay();</span>
<span class="nc" id="L833">		String input1 = m_inputPC.getHtmlDisplay();</span>

		// Create the second buddy field
<span class="nc" id="L836">		resetInputPC(SCHED_LEN_VAL2, FormInputPC.TYPE_NUMERIC);</span>
<span class="nc" id="L837">		m_inputPC.setInputFieldDesc(RmWebBundleKey.RM_SA_FILTER_SCHEDULE_LENGTH, RmWebBundleKey.BUNDLE_NAME);</span>
<span class="nc" id="L838">		m_inputPC.setInputValue(getInputValue(m_filter.getFloat(&quot;scheduleLengthValue2&quot;)));</span>
<span class="nc" id="L839">		String bud2Style = getBuddyStyle(DD_TYPE_LENGTH, m_filter.getInt(&quot;scheduleLengthType&quot;), BUDDY2_INDEX);</span>
<span class="nc" id="L840">		m_inputPC.setStyle(bud2Style);</span>
<span class="nc" id="L841">		m_inputPC.setTitle(i18n(m_rmBundle, RmWebBundleKey.RM_SA_FILTER_MAX_NUMBER_OF_HOURS));</span>
<span class="nc" id="L842">		m_inputPC.initForDisplay();</span>
<span class="nc" id="L843">		String input2 = m_inputPC.getHtmlDisplay();</span>

		// Aggregate the elements into the inputs column
<span class="nc" id="L846">		String inputsCol = input1 + NBSP</span>
<span class="nc" id="L847">				+ BidOptionsFilterUtil.wrapInSpan(m_dashLabel, SCHED_LEN_VAL2 + &quot;_label&quot;, bud2Style) + NBSP + input2</span>
<span class="nc" id="L848">				+ NBSP + BidOptionsFilterUtil.wrapInSpan(m_hoursLabel, SCHED_LEN_VAL1 + &quot;_label&quot;, bud1Style);</span>

		// Create the &quot;Actual Length/Paid Time Only&quot; Radio Button Row
<span class="nc" id="L851">		String defaultVal = EMPTY + m_filter.getInt(&quot;scheduleLengthUse&quot;);</span>

<span class="nc" id="L853">		String bud3Style = getBuddyStyle(DD_TYPE_LENGTH, m_filter.getInt(&quot;scheduleLengthType&quot;), BUDDY3_INDEX);</span>
<span class="nc" id="L854">		String leftStereo = BidOptionsFilterUtil.createRadio(&quot;scheduleLengthUse&quot;, LENGTH_USE_ACTUAL_FV,</span>
				m_actualSchedLengthLabel, defaultVal);
<span class="nc" id="L856">		String buddy3 = BidOptionsFilterUtil.wrapInSpan(leftStereo, SCHED_LEN_USE_LEFT_SPAN, bud3Style);</span>

<span class="nc" id="L858">		String bud4Style = getBuddyStyle(DD_TYPE_LENGTH, m_filter.getInt(&quot;scheduleLengthType&quot;), BUDDY4_INDEX);</span>
<span class="nc" id="L859">		String rightStereo = BidOptionsFilterUtil.createRadio(&quot;scheduleLengthUse&quot;, LENGTH_USE_PAID_TIME_FV,</span>
				m_paidTimeOnlyLabel, defaultVal);
<span class="nc" id="L861">		String buddy4 = BidOptionsFilterUtil.wrapInSpan(rightStereo, SCHED_LEN_USE_RIGHT_SPAN, bud4Style);</span>

		// Put it all together
<span class="nc" id="L864">		String rightRow = BidOptionsFilterUtil.wrapInTable2Row2Col(STYLE4, new String[] { dropDown, inputsCol, buddy3,</span>
				buddy4 });
<span class="nc" id="L866">		m_shiftsContainerPC.addRow(title, rightRow);</span>
<span class="nc" id="L867">	}</span>

	private void createShiftNameRow() {
		// Create the &quot;Shift Name&quot; drop down
<span class="nc" id="L871">		String title = i18n(m_rmBundle, RmWebBundleKey.RM_SA_FILTER_SHIFT_NAME);</span>
<span class="nc" id="L872">		String buddyList = BidOptionsFilterUtil.toJSArray(new String[] { SHIFT_CHECKBOX_SPAN });</span>
<span class="nc" id="L873">		String onChangeJS = JSUtil.ON_CHANGE;</span>
<span class="nc bnc" id="L874" title="All 2 branches missed.">		if (m_isWeeklyAuction) {</span>
<span class="nc" id="L875">			onChangeJS += &quot;showSimpleDDBuddyElems(this, &quot; + buddyList + &quot;)&quot;;</span>
		}
<span class="nc" id="L877">		String anyLabel = i18n(m_rmBundle, RmWebBundleKey.RM_SA_FILTER_ANY_SHIFT);</span>
<span class="nc" id="L878">		String dropDown = BidOptionsFilterUtil.makeSelectInput(&quot;shiftId&quot;, m_filter.getIDString(&quot;shiftId&quot;), onChangeJS,</span>
<span class="nc" id="L879">				getStringsPairDDOptions(m_shifts, anyLabel), DDWIDTH, title);</span>

		// Add the &quot;Match All shifts in schedule&quot; checkbox
<span class="nc" id="L882">		String buddy = &quot;&quot;;</span>
<span class="nc bnc" id="L883" title="All 2 branches missed.">		if (m_isWeeklyAuction) {</span>
<span class="nc" id="L884">			String checkBox = HtmlBooleanCheckbox.makeInput(&quot;shiftIdMatchAll&quot;, m_checkBoxLabel, JSUtil.ON_CHANGE,</span>
<span class="nc" id="L885">					m_filter.getBool(&quot;shiftIdMatchAll&quot;), false);</span>
<span class="nc" id="L886">			String budStyle = getBuddyStyle(DD_TYPE_ID, idToInteger(m_filter.getID(&quot;shiftId&quot;)), BUDDY1_INDEX);</span>
<span class="nc" id="L887">			buddy = BidOptionsFilterUtil.wrapInSpan(checkBox, SHIFT_CHECKBOX_SPAN, budStyle);</span>
		}

		// Put it all together
<span class="nc" id="L891">		String rightRow = BidOptionsFilterUtil.wrapInTable1Row2Col(STYLE1, new String[] { dropDown, buddy });</span>

<span class="nc" id="L893">		m_shiftsContainerPC.addRow(title, rightRow);</span>

<span class="nc" id="L895">	}</span>

	private void createShiftLengthRow() {
		// Create the &quot;Shift Length&quot; drop down
<span class="nc" id="L899">		String title = i18n(m_rmBundle, RmWebBundleKey.RM_SA_FILTER_SHIFT_LENGTH);</span>
<span class="nc" id="L900">		String onChangeJS = JSUtil.ON_CHANGE + &quot;showDDBuddyElems(this, SHIFT_LEN_VISIBLE_MAP, SHIFT_LEN_INVISIBLE_MAP)&quot;;</span>
<span class="nc" id="L901">		String dropDown = BidOptionsFilterUtil.makeSelectInput(&quot;shiftLengthType&quot;,</span>
<span class="nc" id="L902">				EMPTY + m_filter.getInt(&quot;shiftLengthType&quot;), onChangeJS,</span>
<span class="nc" id="L903">				getMinMaxDDOptions(m_anyLengthLabel, m_equalLabel, m_minLabel, m_maxLabel, m_betweenLabel), DDWIDTH,</span>
				title);

		// Create the first buddy field
<span class="nc" id="L907">		resetInputPC(SHIFT_LEN_VAL1, FormInputPC.TYPE_NUMERIC);</span>
<span class="nc" id="L908">		m_inputPC.setInputFieldDesc(RmWebBundleKey.RM_SA_FILTER_SHIFT_LENGTH, RmWebBundleKey.BUNDLE_NAME);</span>
<span class="nc" id="L909">		m_inputPC.setInputValue(getInputValue(m_filter.getFloat(&quot;shiftLengthValue1&quot;)));</span>
<span class="nc" id="L910">		String bud1Style = getBuddyStyle(DD_TYPE_LENGTH, m_filter.getInt(&quot;shiftLengthType&quot;), BUDDY1_INDEX);</span>
<span class="nc" id="L911">		m_inputPC.setStyle(bud1Style);</span>
<span class="nc" id="L912">		m_inputPC.setTitle(i18n(m_rmBundle, RmWebBundleKey.RM_SA_FILTER_NUMBER_OF_HOURS));</span>
<span class="nc" id="L913">		m_inputPC.setAriaLabel(m_hoursAriaLabel);</span>
<span class="nc" id="L914">		m_inputPC.initForDisplay();</span>
<span class="nc" id="L915">		String input1 = m_inputPC.getHtmlDisplay();</span>

		// Create the second buddy field
<span class="nc" id="L918">		resetInputPC(SHIFT_LEN_VAL2, FormInputPC.TYPE_NUMERIC);</span>
<span class="nc" id="L919">		m_inputPC.setInputFieldDesc(RmWebBundleKey.RM_SA_FILTER_SHIFT_LENGTH, RmWebBundleKey.BUNDLE_NAME);</span>
<span class="nc" id="L920">		m_inputPC.setInputValue(getInputValue(m_filter.getFloat(&quot;shiftLengthValue2&quot;)));</span>
<span class="nc" id="L921">		String bud2Style = getBuddyStyle(DD_TYPE_LENGTH, m_filter.getInt(&quot;shiftLengthType&quot;), BUDDY2_INDEX);</span>
<span class="nc" id="L922">		m_inputPC.setStyle(bud2Style);</span>
<span class="nc" id="L923">		m_inputPC.setTitle(i18n(m_rmBundle, RmWebBundleKey.RM_SA_FILTER_MAX_NUMBER_OF_HOURS));</span>
<span class="nc" id="L924">		m_inputPC.initForDisplay();</span>
<span class="nc" id="L925">		String input2 = m_inputPC.getHtmlDisplay();</span>

		// Aggregate the elements into the inputs column
<span class="nc" id="L928">		String inputsCol = input1 + NBSP</span>
<span class="nc" id="L929">				+ BidOptionsFilterUtil.wrapInSpan(m_dashLabel, SHIFT_LEN_VAL2 + &quot;_label&quot;, bud2Style) + NBSP + input2</span>
<span class="nc" id="L930">				+ NBSP + BidOptionsFilterUtil.wrapInSpan(m_hoursLabel, SHIFT_LEN_VAL1 + &quot;_label&quot;, bud1Style);</span>

		// Add the &quot;Match All shifts in schedule&quot; checkbox
<span class="nc" id="L933">		String buddy3 = &quot;&quot;;</span>
<span class="nc bnc" id="L934" title="All 2 branches missed.">		if (m_isWeeklyAuction) {</span>
<span class="nc" id="L935">			String bud3Style = getBuddyStyle(DD_TYPE_LENGTH, m_filter.getInt(&quot;shiftLengthType&quot;), BUDDY3_INDEX);</span>
<span class="nc" id="L936">			String checkBox = HtmlBooleanCheckbox.makeInput(&quot;shiftLengthMatchAll&quot;, m_checkBoxLabel, JSUtil.ON_CHANGE,</span>
<span class="nc" id="L937">					m_filter.getBool(&quot;shiftLengthMatchAll&quot;), false);</span>
<span class="nc" id="L938">			buddy3 = BidOptionsFilterUtil.wrapInSpan(checkBox, SHIFT_LEN_CHECKBOX_SPAN, bud3Style);</span>
		}

		// Create the &quot;Actual Length/Paid Time Only&quot; Radio Button Row
<span class="nc" id="L942">		String defaultVal = EMPTY + m_filter.getInt(&quot;shiftLengthUse&quot;);</span>

<span class="nc" id="L944">		String bud4Style = getBuddyStyle(DD_TYPE_LENGTH, m_filter.getInt(&quot;shiftLengthType&quot;), BUDDY4_INDEX);</span>
<span class="nc" id="L945">		String leftStereo = BidOptionsFilterUtil.createRadio(&quot;shiftLengthUse&quot;, LENGTH_USE_ACTUAL_FV,</span>
				m_actualShiftLengthLabel, defaultVal);
<span class="nc" id="L947">		String buddy4 = BidOptionsFilterUtil.wrapInSpan(leftStereo, SHIFT_LEN_USE_LEFT_SPAN, bud4Style);</span>

<span class="nc" id="L949">		String bud5Style = getBuddyStyle(DD_TYPE_LENGTH, m_filter.getInt(&quot;shiftLengthType&quot;), BUDDY5_INDEX);</span>
<span class="nc" id="L950">		String rightStereo = BidOptionsFilterUtil.createRadio(&quot;shiftLengthUse&quot;, LENGTH_USE_PAID_TIME_FV,</span>
				m_paidTimeOnlyLabel, defaultVal);
<span class="nc" id="L952">		String buddy5 = BidOptionsFilterUtil.wrapInSpan(rightStereo, SHIFT_LEN_USE_RIGHT_SPAN, bud5Style);</span>

		// Put it all together
<span class="nc" id="L955">		String rightRow = BidOptionsFilterUtil.wrapInTable3Row2Col(STYLE4, new String[] { dropDown, inputsCol, buddy4,</span>
				buddy5, buddy3 });

<span class="nc" id="L958">		m_shiftsContainerPC.addRow(title, rightRow);</span>
<span class="nc" id="L959">	}</span>

	private void createShiftsStartingRow() {
		// Create the &quot;Shift Starting&quot; drop down
<span class="nc" id="L963">		String title = i18n(m_rmBundle, RmWebBundleKey.RM_SA_FILTER_SHIFT_START);</span>
<span class="nc" id="L964">		String onChangeJS = JSUtil.ON_CHANGE</span>
				+ &quot;showDDBuddyElems(this, SHIFT_START_VISIBLE_MAP, SHIFT_START_INVISIBLE_MAP)&quot;;
<span class="nc" id="L966">		String dropDown = BidOptionsFilterUtil.makeSelectInput(&quot;shiftStartType&quot;,</span>
<span class="nc" id="L967">				EMPTY + m_filter.getInt(&quot;shiftStartType&quot;), onChangeJS,</span>
<span class="nc" id="L968">				getMinMaxDDOptions(m_anyTimeLabel, m_atLabel, m_notBeforeLabel, m_notAfterLabel, m_betweenLabel),</span>
				DDWIDTH, title);

		// Add the TimePickerPC buddy
<span class="nc" id="L972">		String bud1Style = getBuddyStyle(DD_TYPE_TIME, m_filter.getInt(&quot;shiftStartType&quot;), BUDDY1_INDEX);</span>
<span class="nc" id="L973">		m_shiftStartTime.setTime(getTime(m_filter.getInt(&quot;shiftStart1&quot;)) * 60); // seconds</span>
<span class="nc" id="L974">		String buddy1 = BidOptionsFilterUtil.wrapInSpan(m_shiftStartTime.getHtmlDisplay(), SHIFT_START_TIME_SPAN,</span>
				bud1Style);

		// Add the TimeRangePickerPC buddy
<span class="nc" id="L978">		String bud2Style = getBuddyStyle(DD_TYPE_TIME, m_filter.getInt(&quot;shiftStartType&quot;), BUDDY2_INDEX);</span>
<span class="nc" id="L979">		m_shiftStartRange.getStartTimePickerPC().setTime(getTime(m_filter.getInt(&quot;shiftStart1&quot;)) * 60); // seconds</span>
<span class="nc" id="L980">		m_shiftStartRange.getEndTimePickerPC().setTime(getTime(m_filter.getInt(&quot;shiftStart2&quot;)) * 60); // seconds</span>
<span class="nc" id="L981">		String buddy2 = BidOptionsFilterUtil.wrapInSpan(m_shiftStartRange.getHtmlDisplay(), SHIFT_START_RANGE_SPAN,</span>
				bud2Style);

		// Add the &quot;Match All shifts in schedule&quot; checkbox
<span class="nc" id="L985">		String buddy3 = &quot;&quot;;</span>
<span class="nc bnc" id="L986" title="All 2 branches missed.">		if (m_isWeeklyAuction) {</span>
<span class="nc" id="L987">			String bud3Style = getBuddyStyle(DD_TYPE_TIME, m_filter.getInt(&quot;shiftStartType&quot;), BUDDY3_INDEX);</span>
<span class="nc" id="L988">			String checkBox = HtmlBooleanCheckbox.makeInput(&quot;shiftStartMatchAll&quot;, m_checkBoxLabel, JSUtil.ON_CHANGE,</span>
<span class="nc" id="L989">					m_filter.getBool(&quot;shiftStartMatchAll&quot;), false);</span>
<span class="nc" id="L990">			buddy3 = BidOptionsFilterUtil.wrapInSpan(checkBox, SHIFT_START_CHECKBOX_SPAN, bud3Style);</span>
		}

		// Put it all together
<span class="nc" id="L994">		String rightRow = BidOptionsFilterUtil.wrapInTable1Row3Col(STYLE1, new String[] { dropDown, buddy1 + buddy2,</span>
				buddy3 });
<span class="nc" id="L996">		m_shiftsContainerPC.addRow(title, rightRow);</span>

<span class="nc" id="L998">	}</span>

	private void createShiftsEndingRow() {
		// Create the &quot;Shift Starting&quot; drop down
<span class="nc" id="L1002">		String title = i18n(m_rmBundle, RmWebBundleKey.RM_SA_FILTER_SHIFT_END);</span>
<span class="nc" id="L1003">		String onChangeJS = JSUtil.ON_CHANGE + &quot;showDDBuddyElems(this, SHIFT_END_VISIBLE_MAP, SHIFT_END_INVISIBLE_MAP)&quot;;</span>
<span class="nc" id="L1004">		String dropDown = BidOptionsFilterUtil.makeSelectInput(&quot;shiftEndType&quot;, EMPTY + m_filter.getInt(&quot;shiftEndType&quot;),</span>
				onChangeJS,
<span class="nc" id="L1006">				getMinMaxDDOptions(m_anyTimeLabel, m_atLabel, m_notBeforeLabel, m_notAfterLabel, m_betweenLabel),</span>
				DDWIDTH, title);

		// Add the TimePickerPC buddy
<span class="nc" id="L1010">		String bud1Style = getBuddyStyle(DD_TYPE_TIME, m_filter.getInt(&quot;shiftEndType&quot;), BUDDY1_INDEX);</span>
<span class="nc" id="L1011">		m_shiftEndTime.setTime(getTime(m_filter.getInt(&quot;shiftEnd1&quot;)) * 60); // seconds</span>
<span class="nc" id="L1012">		String buddy1 = BidOptionsFilterUtil</span>
<span class="nc" id="L1013">				.wrapInSpan(m_shiftEndTime.getHtmlDisplay(), SHIFT_END_TIME_SPAN, bud1Style);</span>

		// Add the TimeRangePickerPC buddy
<span class="nc" id="L1016">		String bud2Style = getBuddyStyle(DD_TYPE_TIME, m_filter.getInt(&quot;shiftEndType&quot;), BUDDY2_INDEX);</span>
<span class="nc" id="L1017">		m_shiftEndRange.getStartTimePickerPC().setTime(getTime(m_filter.getInt(&quot;shiftEnd1&quot;)) * 60); // seconds</span>
<span class="nc" id="L1018">		m_shiftEndRange.getEndTimePickerPC().setTime(getTime(m_filter.getInt(&quot;shiftEnd2&quot;)) * 60); // seconds</span>
<span class="nc" id="L1019">		String buddy2 = BidOptionsFilterUtil.wrapInSpan(m_shiftEndRange.getHtmlDisplay(), SHIFT_END_RANGE_SPAN,</span>
				bud2Style);

		// Add the &quot;Match All shifts in schedule&quot; checkbox
<span class="nc" id="L1023">		String buddy3 = &quot;&quot;;</span>
<span class="nc bnc" id="L1024" title="All 2 branches missed.">		if (m_isWeeklyAuction) {</span>
<span class="nc" id="L1025">			String bud3Style = getBuddyStyle(DD_TYPE_TIME, m_filter.getInt(&quot;shiftEndType&quot;), BUDDY3_INDEX);</span>
<span class="nc" id="L1026">			String checkBox = HtmlBooleanCheckbox.makeInput(&quot;shiftEndMatchAll&quot;, m_checkBoxLabel, JSUtil.ON_CHANGE,</span>
<span class="nc" id="L1027">					m_filter.getBool(&quot;shiftEndMatchAll&quot;), false);</span>
<span class="nc" id="L1028">			buddy3 = BidOptionsFilterUtil.wrapInSpan(checkBox, SHIFT_END_CHECKBOX_SPAN, bud3Style);</span>
		}

		// Put it all together
<span class="nc" id="L1032">		String rightRow = BidOptionsFilterUtil.wrapInTable1Row3Col(STYLE1, new String[] { dropDown, buddy1 + buddy2,</span>
				buddy3 });
<span class="nc" id="L1034">		m_shiftsContainerPC.addRow(title, rightRow);</span>
<span class="nc" id="L1035">	}</span>

	// ///////////////////////////////////////////////////////
	// Methods for the &quot;Activities&quot; container
	// ///////////////////////////////////////////////////////

	/**
	 * Add the &quot;Activities&quot; container to the page.
	 */
	private void initActivitiesContainer() {
<span class="nc" id="L1045">		m_activitiesContainerPC = createFormPC(&quot;activitiesContainer&quot;);</span>
<span class="nc" id="L1046">		String title = i18n(m_rmBundle, RmWebBundleKey.RM_SA_FILTER_ACTIVITIES);</span>
<span class="nc" id="L1047">		m_activitiesContainerPC.setTitle(title);</span>
		// Add accessibility support to the container
<span class="nc bnc" id="L1049" title="All 2 branches missed.">		if (isAccessibilityComplianceMode()) {</span>
<span class="nc" id="L1050">			m_activitiesContainerPC.setWrapperAriaLabel(title + i18n(m_rmBundle, RmWebBundleKey.RM_SA_FILTER_REGION_DESC));</span>
		}

		// First Activity Row
<span class="nc" id="L1054">		String activity1NameRow = createActivity1NameRow();</span>
<span class="nc" id="L1055">		String activity1LengthRow = createActivity1LengthRow();</span>
<span class="nc" id="L1056">		String activity1StartRow = createActivity1StartRow();</span>
<span class="nc" id="L1057">		String activity1Group = BidOptionsFilterUtil.wrapInTable4Row1Col(STYLE2, new String[] { activity1NameRow,</span>
				activity1LengthRow, activity1StartRow, NBSP });

<span class="nc" id="L1060">		String rowHeader1 = getActivityRowHeader(); // m_filter.getInt(&quot;activity1LengthType&quot;),</span>
													// ACTIVITY1_LENGTH_EXAMPLE);
<span class="nc" id="L1062">		m_activitiesContainerPC.addRow(rowHeader1, activity1Group);</span>

		// Second Activity Row
<span class="nc" id="L1065">		String activity2NameRow = createActivity2NameRow();</span>
<span class="nc" id="L1066">		String activity2LengthRow = createActivity2LengthRow();</span>
<span class="nc" id="L1067">		String activity2StartRow = createActivity2StartRow();</span>
<span class="nc" id="L1068">		String activity2Group = BidOptionsFilterUtil.wrapInTable3Row1Col(STYLE2, new String[] { activity2NameRow,</span>
				activity2LengthRow, activity2StartRow });

<span class="nc" id="L1071">		String rowHeader2 = getActivityRowHeader(); // m_filter.getInt(&quot;activity2LengthType&quot;),</span>
													// ACTIVITY2_LENGTH_EXAMPLE);
<span class="nc" id="L1073">		m_activitiesContainerPC.addRow(rowHeader2, activity2Group);</span>
<span class="nc" id="L1074">	}</span>

	private String createActivity1NameRow() {
		// Create the &quot;Activity Name&quot; drop down
<span class="nc" id="L1078">		String title = i18n(m_rmBundle, RmWebBundleKey.RM_SA_FILTER_FIRST_ACTIVITY_NAME);</span>
<span class="nc" id="L1079">		String buddyList = BidOptionsFilterUtil.toJSArray(new String[] { &quot;ACTIVITY1_ID_CHECKBOX_SPAN&quot; });</span>
<span class="nc" id="L1080">		String onChangeJS = JSUtil.ON_CHANGE;</span>
<span class="nc bnc" id="L1081" title="All 2 branches missed.">		if (m_isWeeklyAuction) {</span>
<span class="nc" id="L1082">			onChangeJS += &quot;showSimpleDDBuddyElems(this, &quot; + buddyList + &quot;)&quot;;</span>
		}
<span class="nc" id="L1084">		String dropDown = BidOptionsFilterUtil.makeSelectInput(&quot;activity1Id&quot;, m_filter.getIDString(&quot;activity1Id&quot;),</span>
<span class="nc" id="L1085">				onChangeJS, getActivityDDOptions(), DDWIDTH, title);</span>

		// Add the &quot;Match All shifts in schedule&quot; checkbox
<span class="nc" id="L1088">		String buddy = &quot;&quot;;</span>
<span class="nc bnc" id="L1089" title="All 2 branches missed.">		if (m_isWeeklyAuction) {</span>
<span class="nc" id="L1090">			String synchJS = getCheckboxSynchJS(&quot;activity1LengthMatchAll&quot;, &quot;activity1StartMatchAll&quot;);</span>
<span class="nc" id="L1091">			String checkBox = HtmlBooleanCheckbox.makeInput(&quot;activity1IdMatchAll&quot;, m_checkBoxLabel, synchJS,</span>
<span class="nc" id="L1092">					m_filter.getBool(&quot;activity1IdMatchAll&quot;), false);</span>
<span class="nc" id="L1093">			String budStyle = getBuddyStyle(DD_TYPE_ID, idToInteger(m_filter.getID(&quot;activity1Id&quot;)), BUDDY1_INDEX);</span>
<span class="nc" id="L1094">			buddy = BidOptionsFilterUtil.wrapInSpan(checkBox, &quot;ACTIVITY1_ID_CHECKBOX_SPAN&quot;, budStyle);</span>
		}

		// Put it all together
<span class="nc" id="L1098">		return BidOptionsFilterUtil.wrapInTable1Row2Col(STYLE1, new String[] { dropDown, buddy });</span>
	}

	private String createActivity1LengthRow() {
		// Create the &quot;Activity1 Length&quot; drop down
<span class="nc" id="L1103">		String lengthLabel = i18n(m_rmBundle, RmWebBundleKey.RM_SA_FILTER_ACTIVITY_LENGTH);</span>
<span class="nc" id="L1104">		String onChangeJS = JSUtil.ON_CHANGE</span>
				+ &quot;showDDBuddyElems(this, ACTIVITY1_LEN_VISIBLE_MAP, ACTIVITY1_LEN_INVISIBLE_MAP)&quot;;
<span class="nc" id="L1106">		String dropDown = BidOptionsFilterUtil.makeSelectInput(&quot;activity1LengthType&quot;,</span>
<span class="nc" id="L1107">				EMPTY + m_filter.getInt(&quot;activity1LengthType&quot;), onChangeJS,</span>
<span class="nc" id="L1108">				getMinMaxDDOptions(m_anyLengthLabel, m_equalLabel, m_minLabel, m_maxLabel, m_betweenLabel), DDWIDTH,</span>
				lengthLabel);

		// Create the first buddy field
<span class="nc" id="L1112">		resetInputPC(ACTIVITY1_LEN_VAL1, FormInputPC.TYPE_NUMERIC);</span>
<span class="nc" id="L1113">		m_inputPC.setInputFieldDesc(RmWebBundleKey.RM_SA_FILTER_ACTIVITY_LENGTH, RmWebBundleKey.BUNDLE_NAME);</span>
<span class="nc" id="L1114">		m_inputPC.setInputValue(getInputValue(m_filter.getFloat(&quot;activity1LengthValue1&quot;)));</span>
<span class="nc" id="L1115">		String bud1Style = getBuddyStyle(DD_TYPE_LENGTH, m_filter.getInt(&quot;activity1LengthType&quot;), BUDDY1_INDEX);</span>
<span class="nc" id="L1116">		m_inputPC.setStyle(bud1Style);</span>
<span class="nc" id="L1117">		m_inputPC.setTitle(i18n(m_rmBundle, RmWebBundleKey.RM_SA_FILTER_NUMBER_OF_HOURS));</span>
<span class="nc" id="L1118">		m_inputPC.setAriaLabel(m_hoursAriaLabel);</span>
<span class="nc" id="L1119">		m_inputPC.initForDisplay();</span>
<span class="nc" id="L1120">		String input1 = m_inputPC.getHtmlDisplay();</span>

		// Create the second buddy field
<span class="nc" id="L1123">		resetInputPC(ACTIVITY1_LEN_VAL2, FormInputPC.TYPE_NUMERIC);</span>
<span class="nc" id="L1124">		m_inputPC.setInputFieldDesc(RmWebBundleKey.RM_SA_FILTER_ACTIVITY_LENGTH, RmWebBundleKey.BUNDLE_NAME);</span>
<span class="nc" id="L1125">		m_inputPC.setInputValue(getInputValue(m_filter.getFloat(&quot;activity1LengthValue2&quot;)));</span>
<span class="nc" id="L1126">		String bud2Style = getBuddyStyle(DD_TYPE_LENGTH, m_filter.getInt(&quot;activity1LengthType&quot;), BUDDY2_INDEX);</span>
<span class="nc" id="L1127">		m_inputPC.setStyle(bud2Style);</span>
<span class="nc" id="L1128">		m_inputPC.setTitle(i18n(m_rmBundle, RmWebBundleKey.RM_SA_FILTER_MAX_NUMBER_OF_HOURS));</span>
<span class="nc" id="L1129">		m_inputPC.initForDisplay();</span>
<span class="nc" id="L1130">		String input2 = m_inputPC.getHtmlDisplay();</span>

		// Aggregate the elements into the inputs column
<span class="nc" id="L1133">		String inputsCol = input1 + NBSP</span>
<span class="nc" id="L1134">				+ BidOptionsFilterUtil.wrapInSpan(m_dashLabel, ACTIVITY1_LEN_VAL2 + &quot;_label&quot;, bud2Style) + NBSP</span>
				+ input2 + NBSP
<span class="nc" id="L1136">				+ BidOptionsFilterUtil.wrapInSpan(m_hoursLabel, ACTIVITY1_LEN_VAL1 + &quot;_label&quot;, bud1Style);</span>

		// Add the &quot;Match All shifts in schedule&quot; checkbox
<span class="nc" id="L1139">		String buddy3 = &quot;&quot;;</span>
<span class="nc bnc" id="L1140" title="All 2 branches missed.">		if (m_isWeeklyAuction) {</span>
<span class="nc" id="L1141">			String bud3Style = getBuddyStyle(DD_TYPE_LENGTH, m_filter.getInt(&quot;activity1LengthType&quot;), BUDDY3_INDEX);</span>
<span class="nc" id="L1142">			String synchJS = getCheckboxSynchJS(&quot;activity1IdMatchAll&quot;, &quot;activity1StartMatchAll&quot;);</span>
<span class="nc" id="L1143">			String checkBox = HtmlBooleanCheckbox.makeInput(&quot;activity1LengthMatchAll&quot;, m_checkBoxLabel, synchJS,</span>
<span class="nc" id="L1144">					m_filter.getBool(&quot;activity1LengthMatchAll&quot;), false);</span>
<span class="nc" id="L1145">			buddy3 = BidOptionsFilterUtil.wrapInSpan(checkBox, ACTIVITY1_LEN_CHECKBOX_SPAN, bud3Style);</span>
		}

		// Put it all together
<span class="nc" id="L1149">		return BidOptionsFilterUtil.wrapInTable2Row2Col(STYLE4, new String[] { dropDown, inputsCol, buddy3, &quot;&quot; });</span>
	}

	private String createActivity1StartRow() {
		// Create the &quot;Start&quot; drop down
<span class="nc" id="L1154">		String startLabel = i18n(m_rmBundle, RmWebBundleKey.RM_SA_FILTER_ACTIVITY_START);</span>
<span class="nc" id="L1155">		String onChangeJS = JSUtil.ON_CHANGE</span>
				+ &quot;showDDBuddyElems(this, ACTIVITY1_START_VISIBLE_MAP, ACTIVITY1_START_INVISIBLE_MAP)&quot;;
<span class="nc" id="L1157">		String dropDown = BidOptionsFilterUtil.makeSelectInput(&quot;activity1StartType&quot;,</span>
<span class="nc" id="L1158">				EMPTY + m_filter.getInt(&quot;activity1StartType&quot;), onChangeJS,</span>
<span class="nc" id="L1159">				getMinMaxDDOptions(m_anyTimeLabel, m_atLabel, m_notBeforeLabel, m_notAfterLabel, m_betweenLabel),</span>
				DDWIDTH, startLabel);

		// Add the TimePickerPC buddy
<span class="nc" id="L1163">		String bud1Style = getBuddyStyle(DD_TYPE_TIME, m_filter.getInt(&quot;activity1StartType&quot;), BUDDY1_INDEX);</span>
<span class="nc" id="L1164">		m_activity1StartTime.setTime(getTime(m_filter.getInt(&quot;activity1Start1&quot;)) * 60); // seconds</span>
<span class="nc" id="L1165">		String buddy1 = BidOptionsFilterUtil.wrapInSpan(m_activity1StartTime.getHtmlDisplay(),</span>
				ACTIVITY1_START_TIME_SPAN, bud1Style);

		// Add the TimeRangePickerPC buddy
<span class="nc" id="L1169">		String bud2Style = getBuddyStyle(DD_TYPE_TIME, m_filter.getInt(&quot;activity1StartType&quot;), BUDDY2_INDEX);</span>
<span class="nc" id="L1170">		m_activity1StartRange.getStartTimePickerPC().setTime(getTime(m_filter.getInt(&quot;activity1Start1&quot;)) * 60); // seconds</span>
<span class="nc" id="L1171">		m_activity1StartRange.getEndTimePickerPC().setTime(getTime(m_filter.getInt(&quot;activity1Start2&quot;)) * 60); // seconds</span>
<span class="nc" id="L1172">		String buddy2 = BidOptionsFilterUtil.wrapInSpan(m_activity1StartRange.getHtmlDisplay(),</span>
				ACTIVITY1_START_RANGE_SPAN, bud2Style);

		// Add the &quot;Match All shifts in schedule&quot; checkbox
<span class="nc" id="L1176">		String buddy3 = &quot;&quot;;</span>
<span class="nc bnc" id="L1177" title="All 2 branches missed.">		if (m_isWeeklyAuction) {</span>
<span class="nc" id="L1178">			String bud3Style = getBuddyStyle(DD_TYPE_TIME, m_filter.getInt(&quot;activity1StartType&quot;), BUDDY3_INDEX);</span>
<span class="nc" id="L1179">			String synchJS = getCheckboxSynchJS(&quot;activity1IdMatchAll&quot;, &quot;activity1LengthMatchAll&quot;);</span>
<span class="nc" id="L1180">			String checkBox = HtmlBooleanCheckbox.makeInput(&quot;activity1StartMatchAll&quot;, m_checkBoxLabel, synchJS,</span>
<span class="nc" id="L1181">					m_filter.getBool(&quot;activity1StartMatchAll&quot;), false);</span>
<span class="nc" id="L1182">			buddy3 = BidOptionsFilterUtil.wrapInSpan(checkBox, ACTIVITY1_START_CHECKBOX_SPAN, bud3Style);</span>
		}

		// Put it all together
<span class="nc" id="L1186">		return BidOptionsFilterUtil.wrapInTable1Row3Col(STYLE1, new String[] { dropDown, buddy1 + buddy2, buddy3 });</span>
	}

	private String createActivity2NameRow() {
		// Create the &quot;Activity Name&quot; drop down
<span class="nc" id="L1191">		String title = i18n(m_rmBundle, RmWebBundleKey.RM_SA_FILTER_SECOND_ACTIVITY_NAME);</span>
<span class="nc" id="L1192">		String buddyList = BidOptionsFilterUtil.toJSArray(new String[] { &quot;ACTIVITY2_ID_CHECKBOX_SPAN&quot; });</span>
<span class="nc" id="L1193">		String onChangeJS = JSUtil.ON_CHANGE;</span>
<span class="nc bnc" id="L1194" title="All 2 branches missed.">		if (m_isWeeklyAuction) {</span>
<span class="nc" id="L1195">			onChangeJS += &quot;showSimpleDDBuddyElems(this, &quot; + buddyList + &quot;)&quot;;</span>
		}
<span class="nc" id="L1197">		String dropDown = BidOptionsFilterUtil.makeSelectInput(&quot;activity2Id&quot;, m_filter.getIDString(&quot;activity2Id&quot;),</span>
<span class="nc" id="L1198">				onChangeJS, getActivityDDOptions(), DDWIDTH, title);</span>

		// Add the &quot;Match All shifts in schedule&quot; checkbox
<span class="nc" id="L1201">		String buddy = &quot;&quot;;</span>
<span class="nc bnc" id="L1202" title="All 2 branches missed.">		if (m_isWeeklyAuction) {</span>
<span class="nc" id="L1203">			String synchJS = getCheckboxSynchJS(&quot;activity2LengthMatchAll&quot;, &quot;activity2StartMatchAll&quot;);</span>
<span class="nc" id="L1204">			String checkBox = HtmlBooleanCheckbox.makeInput(&quot;activity2IdMatchAll&quot;, m_checkBoxLabel, synchJS,</span>
<span class="nc" id="L1205">					m_filter.getBool(&quot;activity2IdMatchAll&quot;), false);</span>
<span class="nc" id="L1206">			String budStyle = getBuddyStyle(DD_TYPE_ID, idToInteger(m_filter.getID(&quot;activity2Id&quot;)), BUDDY1_INDEX);</span>
<span class="nc" id="L1207">			buddy = BidOptionsFilterUtil.wrapInSpan(checkBox, &quot;ACTIVITY2_ID_CHECKBOX_SPAN&quot;, budStyle);</span>
		}

		// Put it all together
<span class="nc" id="L1211">		return BidOptionsFilterUtil.wrapInTable1Row2Col(STYLE1, new String[] { dropDown, buddy });</span>

	}

	private String createActivity2LengthRow() {
		// Create the &quot;Activity2 Length&quot; drop down
<span class="nc" id="L1217">		String lengthLabel = i18n(m_rmBundle, RmWebBundleKey.RM_SA_FILTER_ACTIVITY_LENGTH);</span>
<span class="nc" id="L1218">		String onChangeJS = JSUtil.ON_CHANGE</span>
				+ &quot;showDDBuddyElems(this, ACTIVITY2_LEN_VISIBLE_MAP, ACTIVITY2_LEN_INVISIBLE_MAP)&quot;;
<span class="nc" id="L1220">		String dropDown = BidOptionsFilterUtil.makeSelectInput(&quot;activity2LengthType&quot;,</span>
<span class="nc" id="L1221">				EMPTY + m_filter.getInt(&quot;activity2LengthType&quot;), onChangeJS,</span>
<span class="nc" id="L1222">				getMinMaxDDOptions(m_anyLengthLabel, m_equalLabel, m_minLabel, m_maxLabel, m_betweenLabel), DDWIDTH,</span>
				lengthLabel);

		// Create the first buddy field
<span class="nc" id="L1226">		resetInputPC(ACTIVITY2_LEN_VAL1, FormInputPC.TYPE_NUMERIC);</span>
<span class="nc" id="L1227">		m_inputPC.setInputFieldDesc(RmWebBundleKey.RM_SA_FILTER_ACTIVITY_LENGTH, RmWebBundleKey.BUNDLE_NAME);</span>
<span class="nc" id="L1228">		m_inputPC.setInputValue(getInputValue(m_filter.getFloat(&quot;activity2LengthValue1&quot;)));</span>
<span class="nc" id="L1229">		String bud1Style = getBuddyStyle(DD_TYPE_LENGTH, m_filter.getInt(&quot;activity2LengthType&quot;), BUDDY1_INDEX);</span>
<span class="nc" id="L1230">		m_inputPC.setStyle(bud1Style);</span>
<span class="nc" id="L1231">		m_inputPC.setTitle(i18n(m_rmBundle, RmWebBundleKey.RM_SA_FILTER_NUMBER_OF_HOURS));</span>
<span class="nc" id="L1232">		m_inputPC.setAriaLabel(m_hoursAriaLabel);</span>
<span class="nc" id="L1233">		m_inputPC.initForDisplay();</span>
<span class="nc" id="L1234">		String input1 = m_inputPC.getHtmlDisplay();</span>

		// Create the second buddy field
<span class="nc" id="L1237">		resetInputPC(ACTIVITY2_LEN_VAL2, FormInputPC.TYPE_NUMERIC);</span>
<span class="nc" id="L1238">		m_inputPC.setInputFieldDesc(RmWebBundleKey.RM_SA_FILTER_ACTIVITY_LENGTH, RmWebBundleKey.BUNDLE_NAME);</span>
<span class="nc" id="L1239">		m_inputPC.setInputValue(getInputValue(m_filter.getFloat(&quot;activity2LengthValue2&quot;)));</span>
<span class="nc" id="L1240">		String bud2Style = getBuddyStyle(DD_TYPE_LENGTH, m_filter.getInt(&quot;activity2LengthType&quot;), BUDDY2_INDEX);</span>
<span class="nc" id="L1241">		m_inputPC.setStyle(bud2Style);</span>
<span class="nc" id="L1242">		m_inputPC.setTitle(i18n(m_rmBundle, RmWebBundleKey.RM_SA_FILTER_MAX_NUMBER_OF_HOURS));</span>
<span class="nc" id="L1243">		m_inputPC.initForDisplay();</span>
<span class="nc" id="L1244">		String input2 = m_inputPC.getHtmlDisplay();</span>

		// Aggregate the elements into the inputs column
<span class="nc" id="L1247">		String inputsCol = input1 + NBSP</span>
<span class="nc" id="L1248">				+ BidOptionsFilterUtil.wrapInSpan(m_dashLabel, ACTIVITY2_LEN_VAL2 + &quot;_label&quot;, bud2Style) + NBSP</span>
				+ input2 + NBSP
<span class="nc" id="L1250">				+ BidOptionsFilterUtil.wrapInSpan(m_hoursLabel, ACTIVITY2_LEN_VAL1 + &quot;_label&quot;, bud1Style);</span>

		// Add the &quot;Match All shifts in schedule&quot; checkbox
<span class="nc" id="L1253">		String buddy3 = &quot;&quot;;</span>
<span class="nc bnc" id="L1254" title="All 2 branches missed.">		if (m_isWeeklyAuction) {</span>
<span class="nc" id="L1255">			String bud3Style = getBuddyStyle(DD_TYPE_LENGTH, m_filter.getInt(&quot;activity2LengthType&quot;), BUDDY3_INDEX);</span>
<span class="nc" id="L1256">			String synchJS = getCheckboxSynchJS(&quot;activity2IdMatchAll&quot;, &quot;activity2StartMatchAll&quot;);</span>
<span class="nc" id="L1257">			String checkBox = HtmlBooleanCheckbox.makeInput(&quot;activity2LengthMatchAll&quot;, m_checkBoxLabel, synchJS,</span>
<span class="nc" id="L1258">					m_filter.getBool(&quot;activity2LengthMatchAll&quot;), false);</span>
<span class="nc" id="L1259">			buddy3 = BidOptionsFilterUtil.wrapInSpan(checkBox, ACTIVITY2_LEN_CHECKBOX_SPAN, bud3Style);</span>
		}

		// Put it all together
<span class="nc" id="L1263">		return BidOptionsFilterUtil.wrapInTable2Row2Col(STYLE4, new String[] { dropDown, inputsCol, buddy3, &quot;&quot; });</span>
	}

	private String createActivity2StartRow() {
		// Create the &quot;Start&quot; drop down
<span class="nc" id="L1268">		String startLabel = i18n(m_rmBundle, RmWebBundleKey.RM_SA_FILTER_ACTIVITY_START);</span>
<span class="nc" id="L1269">		String onChangeJS = JSUtil.ON_CHANGE</span>
				+ &quot;showDDBuddyElems(this, ACTIVITY2_START_VISIBLE_MAP, ACTIVITY2_START_INVISIBLE_MAP)&quot;;
<span class="nc" id="L1271">		String dropDown = BidOptionsFilterUtil.makeSelectInput(&quot;activity2StartType&quot;,</span>
<span class="nc" id="L1272">				EMPTY + m_filter.getInt(&quot;activity2StartType&quot;), onChangeJS,</span>
<span class="nc" id="L1273">				getMinMaxDDOptions(m_anyTimeLabel, m_atLabel, m_notBeforeLabel, m_notAfterLabel, m_betweenLabel),</span>
				DDWIDTH, startLabel);

		// Add the TimePickerPC buddy
<span class="nc" id="L1277">		String bud1Style = getBuddyStyle(DD_TYPE_TIME, m_filter.getInt(&quot;activity2StartType&quot;), BUDDY1_INDEX);</span>
<span class="nc" id="L1278">		m_activity2StartTime.setTime(getTime(m_filter.getInt(&quot;activity2Start1&quot;)) * 60); // seconds</span>
<span class="nc" id="L1279">		String buddy1 = BidOptionsFilterUtil.wrapInSpan(m_activity2StartTime.getHtmlDisplay(),</span>
				ACTIVITY2_START_TIME_SPAN, bud1Style);

		// Add the TimeRangePickerPC buddy
<span class="nc" id="L1283">		String bud2Style = getBuddyStyle(DD_TYPE_TIME, m_filter.getInt(&quot;activity2StartType&quot;), BUDDY2_INDEX);</span>
<span class="nc" id="L1284">		m_activity2StartRange.getStartTimePickerPC().setTime(getTime(m_filter.getInt(&quot;activity2Start1&quot;)) * 60); // seconds</span>
<span class="nc" id="L1285">		m_activity2StartRange.getEndTimePickerPC().setTime(getTime(m_filter.getInt(&quot;activity2Start2&quot;)) * 60); // seconds</span>
<span class="nc" id="L1286">		String buddy2 = BidOptionsFilterUtil.wrapInSpan(m_activity2StartRange.getHtmlDisplay(),</span>
				ACTIVITY2_START_RANGE_SPAN, bud2Style);

		// Add the &quot;Match All shifts in schedule&quot; checkbox
<span class="nc" id="L1290">		String buddy3 = &quot;&quot;;</span>
<span class="nc bnc" id="L1291" title="All 2 branches missed.">		if (m_isWeeklyAuction) {</span>
<span class="nc" id="L1292">			String bud3Style = getBuddyStyle(DD_TYPE_TIME, m_filter.getInt(&quot;activity2StartType&quot;), BUDDY3_INDEX);</span>
<span class="nc" id="L1293">			String synchJS = getCheckboxSynchJS(&quot;activity2IdMatchAll&quot;, &quot;activity2LengthMatchAll&quot;);</span>
<span class="nc" id="L1294">			String checkBox = HtmlBooleanCheckbox.makeInput(&quot;activity2StartMatchAll&quot;, m_checkBoxLabel, synchJS,</span>
<span class="nc" id="L1295">					m_filter.getBool(&quot;activity2StartMatchAll&quot;), false);</span>
<span class="nc" id="L1296">			buddy3 = BidOptionsFilterUtil.wrapInSpan(checkBox, ACTIVITY2_START_CHECKBOX_SPAN, bud3Style);</span>
		}

		// Put it all together
<span class="nc" id="L1300">		return BidOptionsFilterUtil.wrapInTable1Row3Col(STYLE1, new String[] { dropDown, buddy1 + buddy2, buddy3 });</span>
	}

	/**
	 * Get the row header string to use for the &quot;Activity&quot; row, which consists
	 * of three subrows (activity name, length, and start).
	 *
	 * @return The activity row header string.
	 */
	private String getActivityRowHeader() // int activityLengthType, String
											// lengthExampleBuddyElem)
	{
<span class="nc" id="L1312">		StringBuffer sb = new StringBuffer(100);</span>
<span class="nc" id="L1313">		String nameLabel = i18n(m_rmBundle, RmWebBundleKey.RM_SA_FILTER_ACTIVITY_NAME);</span>

<span class="nc" id="L1315">		String lengthLabel = i18n(m_rmBundle, RmWebBundleKey.RM_SA_FILTER_ACTIVITY_LENGTH);</span>

		// String style = getBuddyStyle(DD_TYPE_LENGTH, activityLengthType,
		// BUDDY3_INDEX);
		// lengthLabel +=
		// BidOptionsFilterUtil.wrapInSpan(NBSP+m_lengthExampleLabel,
		// lengthExampleBuddyElem, style);

<span class="nc" id="L1323">		String startLabel = i18n(m_rmBundle, RmWebBundleKey.RM_SA_FILTER_ACTIVITY_START);</span>
<span class="nc" id="L1324">		return BidOptionsFilterUtil.wrapInTable3Row1Col(STYLE3, new String[] { nameLabel, lengthLabel, startLabel });</span>
	}

	// ///////////////////////////////////////////////////////
	// Methods for the &quot;Skills&quot; container
	// ///////////////////////////////////////////////////////

	/**
	 * Add the &quot;Skills&quot; container to the page.
	 */
	private void initSkillsContainer() {
<span class="nc" id="L1335">		m_skillsContainerPC = createFormPC(&quot;skillsContainer&quot;);</span>
<span class="nc bnc" id="L1336" title="All 2 branches missed.">		if (isAccessibilityComplianceMode()) {</span>
<span class="nc" id="L1337">			m_skillsContainerPC.setWrapperAriaLabel(m_skillsForShiftLabel);</span>
		}
<span class="nc" id="L1339">		String title = i18n(m_rmBundle, RmWebBundleKey.RM_SA_FILTER_SKILLS);</span>
<span class="nc" id="L1340">		m_skillsContainerPC.setTitle(title);</span>

		// Skills Name Row
<span class="nc" id="L1343">		m_skillsContainerPC.addRow(m_skillsForShiftLabel, createSkillsRow());</span>
<span class="nc" id="L1344">	}</span>

	private String createSkillsRow() {
		// Create the &quot;Skill Names&quot; Assignment Box
<span class="nc" id="L1348">		initSkillsAssignmentBox();</span>

		// Create the &quot;Exactly These Skills/At Least These Skills&quot; Radio Button
		// Row
<span class="nc" id="L1352">		String defaultVal = EMPTY + m_filter.getInt(&quot;skillsMatchType&quot;);</span>
<span class="nc" id="L1353">		String radio1 = BidOptionsFilterUtil.createRadio(&quot;skillsMatchType&quot;, SKILLS_MATCH_AT_LEAST_FV,</span>
				m_skillsMatchAtLeastLabel, defaultVal);
<span class="nc" id="L1355">		String radio2 = BidOptionsFilterUtil.createRadio(&quot;skillsMatchType&quot;, SKILLS_MATCH_AT_MOST_FV,</span>
				m_skillsMatchAtMostLabel, defaultVal);
<span class="nc" id="L1357">		String radio3 = BidOptionsFilterUtil.createRadio(&quot;skillsMatchType&quot;, SKILLS_MATCH_EXACT_FV,</span>
				m_skillsMatchExactlyLabel, defaultVal);

		// Put it all together
<span class="nc" id="L1361">		String assignmentBoxString = BidOptionsFilterUtil.wrapInTable4Row1Col(STYLE2, new String[] {</span>
<span class="nc" id="L1362">				m_skillsAssignmentBox.getHtmlDisplay(), radio1, radio2, radio3 });</span>

<span class="nc bnc" id="L1364" title="All 2 branches missed.">		if (m_isShowBidderSkillsOnly) {</span>
			// we'll just list the bidder's skills in plain text
<span class="nc" id="L1366">			assignmentBoxString = BidOptionsFilterUtil.wrapInSpan(assignmentBoxString, &quot;HIDDEN_ASSIGN_BOX&quot;,</span>
					&quot;display:none&quot;);
<span class="nc" id="L1368">			assignmentBoxString += SPACE + getSkillNames(m_skillsMatchAtMostLabel);</span>
		}
<span class="nc" id="L1370">		return assignmentBoxString;</span>
	}

	/**
	 * Get an HTML plain text list of skill names which are selected in the
	 * filter. This list is unmodifiable.
	 */
	private String getSkillNames(String descriptionLabel) {
<span class="nc" id="L1378">		StringBuffer skillNames = new StringBuffer(100);</span>

<span class="nc" id="L1380">		skillNames.append(descriptionLabel).append(&quot;:&quot;);</span>

<span class="nc" id="L1382">		Collection skills = m_skillsAssignmentBox.getRightListPC().getData();</span>
<span class="nc bnc" id="L1383" title="All 4 branches missed.">		if ((skills != null) &amp;&amp; (skills.size() &gt; 0)) {</span>
<span class="nc" id="L1384">			skillNames.append(&quot;&lt;UL&gt;&quot;);</span>
<span class="nc bnc" id="L1385" title="All 2 branches missed.">			for (Iterator it = skills.iterator(); it.hasNext();) {</span>
<span class="nc" id="L1386">				DefaultNodeData node = (DefaultNodeData) it.next();</span>
<span class="nc" id="L1387">				skillNames.append(&quot;&lt;LI&gt;&quot;).append(node.getName());</span>
<span class="nc" id="L1388">			}</span>
<span class="nc" id="L1389">			skillNames.append(&quot;&lt;/UL&gt;&quot;);</span>
		} else {
<span class="nc" id="L1391">			skillNames.append(&quot;&lt;UL&gt;&lt;LI&gt;&quot;).append(m_noneLabel).append(&quot;&lt;/LI&gt;&quot;);</span>
		}
<span class="nc" id="L1393">		return skillNames.toString();</span>
	}

	/**
	 * Initialize the Skills Assignment box, and populate it with data.
	 */
	private void initSkillsAssignmentBox() {
		// m_skillsAssignmentBox.setHeaderTitle(m_assignBoxHeaderLabel);
<span class="nc" id="L1401">		m_skillsAssignmentBox.setLeftTitle(m_assignBoxLeftLabel + &quot;:&quot;);</span>
<span class="nc" id="L1402">		m_skillsAssignmentBox.setRightTitle(m_assignBoxRightLabel + &quot;:&quot;);</span>
<span class="nc" id="L1403">		m_skillsAssignmentBox.setItemCount(ASSIGNMENT_BOX_ENTRIES);</span>
<span class="nc" id="L1404">		m_skillsAssignmentBox.setMultiRowSelectable(true);</span>
<span class="nc" id="L1405">		m_skillsAssignmentBox.setShowMoveButtons(false); // the order of skills</span>
															// is meaningless

		try {
			// Get the list of skills already mapped by the user
<span class="nc" id="L1410">			ArrayList mappedSkillsList = new ArrayList(0);</span>
<span class="nc" id="L1411">			Collection mappedSkillIDsList = m_filter.getList(&quot;skills&quot;);</span>
<span class="nc bnc" id="L1412" title="All 2 branches missed.">			if (mappedSkillIDsList == null) {</span>
<span class="nc" id="L1413">				mappedSkillIDsList = new ArrayList(0);</span>
			} else {
<span class="nc" id="L1415">				mappedSkillsList = new ArrayList(SkillModelHandler.getSkillsByIDs(mappedSkillIDsList)); // ID=int,</span>
																										// SID=null
<span class="nc" id="L1417">				ArrayList mappedSkillsNodes = makeSkillAssignmentNodeList(mappedSkillsList);</span>
<span class="nc" id="L1418">				m_skillsAssignmentBox.getRightListPC().setData(mappedSkillsNodes);</span>
			}

			// Get the list of skills not yet mapped by the user
<span class="nc" id="L1422">			ArrayList availableSkillsList = getAvailableSkillsList();</span>
<span class="nc" id="L1423">			availableSkillsList.removeAll(mappedSkillsList);</span>

			// Sort the reduced list of skills
<span class="nc" id="L1426">			Comparator skillsComparator = new Comparator() {</span>
				@Override
				public int compare(Object skillA, Object skillB) {
<span class="nc" id="L1429">					return ((Skill) skillA).getName().compareToIgnoreCase(((Skill) skillB).getName());</span>
				}
			};
<span class="nc" id="L1432">			Collections.sort(availableSkillsList, skillsComparator);</span>

<span class="nc" id="L1434">			ArrayList availableSkillsNodes = makeSkillAssignmentNodeList(availableSkillsList);</span>
<span class="nc" id="L1435">			m_skillsAssignmentBox.getLeftListPC().setData(availableSkillsNodes);</span>
<span class="nc" id="L1436">		} catch (Exception ex) {</span>
<span class="nc" id="L1437">			handleUnableToLoadDataError(log, ex);</span>
<span class="nc" id="L1438">		}</span>
<span class="nc" id="L1439">	}</span>

	// ///////////////////////////////////////////////////////
	// Getter methods (get the values of the form fields)
	// ///////////////////////////////////////////////////////

	/**
	 * Get the filter object containing the values of all the form fields.
	 */
	public BidOptionsFilter getFilter() {
<span class="nc" id="L1449">		return m_filter;</span>
	}

	// ///////////////////////////////////////////////////////
	// Setter methods called automatically by super.extractParameters()
	// ///////////////////////////////////////////////////////

	// Shift
	public void setShiftId(String id) {
<span class="nc bnc" id="L1458" title="All 2 branches missed.">		if (id.equals(BidOptionsFilter.UNDEFINED_STR)) {</span>
<span class="nc" id="L1459">			m_filter.remove(&quot;shiftId&quot;);</span>
		} else {
<span class="nc" id="L1461">			m_filter.put(&quot;shiftId&quot;, new ID(Integer.parseInt(id)));</span>
		}
<span class="nc" id="L1463">	}</span>

	public void setShiftIdMatchAll(boolean value) {
<span class="nc" id="L1466">		m_filter.put(&quot;shiftIdMatchAll&quot;, new Boolean(value));</span>
<span class="nc" id="L1467">	}</span>

	// Work Pattern
	public void setTemplateName(String id) {
<span class="nc bnc" id="L1471" title="All 2 branches missed.">		if (id.equals(BidOptionsFilter.UNDEFINED_STR)) {</span>
<span class="nc" id="L1472">			m_filter.remove(BidOptionsFilter.TEMPLATE_NAME);</span>
		} else {
<span class="nc" id="L1474">			m_filter.put(BidOptionsFilter.TEMPLATE_NAME, id);</span>
		}
<span class="nc" id="L1476">	}</span>

	// Availability
	public void setAvailability(int value) {
<span class="nc" id="L1480">		m_filter.put(&quot;availability&quot;, new Integer(value));</span>
<span class="nc" id="L1481">	}</span>

	public void setAvailabilityValue1(int value) {
<span class="nc" id="L1484">		m_filter.put(&quot;availabilityValue1&quot;, new Integer(value));</span>
<span class="nc" id="L1485">	}</span>

	public void setAvailabilityValue2(int value) {
<span class="nc" id="L1488">		m_filter.put(&quot;availabilityValue2&quot;, new Integer(value));</span>
<span class="nc" id="L1489">	}</span>

	// Schedule Length
	public void setScheduleLengthType(int value) {
<span class="nc" id="L1493">		m_filter.put(&quot;scheduleLengthType&quot;, new Integer(value));</span>
<span class="nc" id="L1494">	}</span>

	public void setScheduleLengthValue1(float value) {
<span class="nc" id="L1497">		m_filter.put(&quot;scheduleLengthValue1&quot;, new Float(value));</span>
<span class="nc" id="L1498">	}</span>

	public void setScheduleLengthValue2(float value) {
<span class="nc" id="L1501">		m_filter.put(&quot;scheduleLengthValue2&quot;, new Float(value));</span>
<span class="nc" id="L1502">	}</span>

	public void setScheduleLengthUse(int value) {
<span class="nc" id="L1505">		m_filter.put(&quot;scheduleLengthUse&quot;, new Integer(value));</span>
<span class="nc" id="L1506">	}</span>

	// Shift Length
	public void setShiftLengthType(int value) {
<span class="nc" id="L1510">		m_filter.put(&quot;shiftLengthType&quot;, new Integer(value));</span>
<span class="nc" id="L1511">	}</span>

	public void setShiftLengthValue1(float value) {
<span class="nc" id="L1514">		m_filter.put(&quot;shiftLengthValue1&quot;, new Float(value));</span>
<span class="nc" id="L1515">	}</span>

	public void setShiftLengthValue2(float value) {
<span class="nc" id="L1518">		m_filter.put(&quot;shiftLengthValue2&quot;, new Float(value));</span>
<span class="nc" id="L1519">	}</span>

	public void setShiftLengthUse(int value) {
<span class="nc" id="L1522">		m_filter.put(&quot;shiftLengthUse&quot;, new Integer(value));</span>
<span class="nc" id="L1523">	}</span>

	public void setShiftLengthMatchAll(boolean value) {
<span class="nc" id="L1526">		m_filter.put(&quot;shiftLengthMatchAll&quot;, new Boolean(value));</span>
<span class="nc" id="L1527">	}</span>

	// Shift Start
	public void setShiftStartType(int value) {
<span class="nc" id="L1531">		m_filter.put(&quot;shiftStartType&quot;, new Integer(value));</span>
<span class="nc" id="L1532">	}</span>

	public void setShiftStartMatchAll(boolean value) {
<span class="nc" id="L1535">		m_filter.put(&quot;shiftStartMatchAll&quot;, new Boolean(value));</span>
<span class="nc" id="L1536">	}</span>

	// Shift End
	public void setShiftEndType(int value) {
<span class="nc" id="L1540">		m_filter.put(&quot;shiftEndType&quot;, new Integer(value));</span>
<span class="nc" id="L1541">	}</span>

	public void setShiftEndMatchAll(boolean value) {
<span class="nc" id="L1544">		m_filter.put(&quot;shiftEndMatchAll&quot;, new Boolean(value));</span>
<span class="nc" id="L1545">	}</span>

	// Activity1
	public void setActivity1Id(String id) {
<span class="nc bnc" id="L1549" title="All 2 branches missed.">		if (id.equals(BidOptionsFilter.UNDEFINED_STR)) {</span>
<span class="nc" id="L1550">			m_filter.remove(&quot;activity1Id&quot;);</span>
		} else {
<span class="nc" id="L1552">			m_filter.put(&quot;activity1Id&quot;, new ID(Integer.parseInt(id)));</span>
		}
<span class="nc" id="L1554">	}</span>

	public void setActivity1LengthType(int value) {
<span class="nc" id="L1557">		m_filter.put(&quot;activity1LengthType&quot;, new Integer(value));</span>
<span class="nc" id="L1558">	}</span>

	public void setActivity1LengthValue1(float value) {
<span class="nc" id="L1561">		m_filter.put(&quot;activity1LengthValue1&quot;, new Float(value));</span>
<span class="nc" id="L1562">	}</span>

	public void setActivity1LengthValue2(float value) {
<span class="nc" id="L1565">		m_filter.put(&quot;activity1LengthValue2&quot;, new Float(value));</span>
<span class="nc" id="L1566">	}</span>

	public void setActivity1LengthMatchAll(boolean value) {
<span class="nc" id="L1569">		m_filter.put(&quot;activity1LengthMatchAll&quot;, new Boolean(value));</span>
<span class="nc" id="L1570">	}</span>

	public void setActivity1StartType(int value) {
<span class="nc" id="L1573">		m_filter.put(&quot;activity1StartType&quot;, new Integer(value));</span>
<span class="nc" id="L1574">	}</span>

	public void setActivity1IdMatchAll(boolean value) {
<span class="nc" id="L1577">		m_filter.put(&quot;activity1IdMatchAll&quot;, new Boolean(value));</span>
<span class="nc" id="L1578">	}</span>

	public void setActivity1StartMatchAll(boolean value) {
<span class="nc" id="L1581">		m_filter.put(&quot;activity1StartMatchAll&quot;, new Boolean(value));</span>
<span class="nc" id="L1582">	}</span>

	// Activity2
	public void setActivity2Id(String id) {
<span class="nc bnc" id="L1586" title="All 2 branches missed.">		if (id.equals(BidOptionsFilter.UNDEFINED_STR)) {</span>
<span class="nc" id="L1587">			m_filter.remove(&quot;activity2Id&quot;);</span>
		} else {
<span class="nc" id="L1589">			m_filter.put(&quot;activity2Id&quot;, new ID(Integer.parseInt(id)));</span>
		}
<span class="nc" id="L1591">	}</span>

	public void setActivity2LengthType(int value) {
<span class="nc" id="L1594">		m_filter.put(&quot;activity2LengthType&quot;, new Integer(value));</span>
<span class="nc" id="L1595">	}</span>

	public void setActivity2LengthValue1(float value) {
<span class="nc" id="L1598">		m_filter.put(&quot;activity2LengthValue1&quot;, new Float(value));</span>
<span class="nc" id="L1599">	}</span>

	public void setActivity2LengthValue2(float value) {
<span class="nc" id="L1602">		m_filter.put(&quot;activity2LengthValue2&quot;, new Float(value));</span>
<span class="nc" id="L1603">	}</span>

	public void setActivity2LengthMatchAll(boolean value) {
<span class="nc" id="L1606">		m_filter.put(&quot;activity2LengthMatchAll&quot;, new Boolean(value));</span>
<span class="nc" id="L1607">	}</span>

	public void setActivity2StartType(int value) {
<span class="nc" id="L1610">		m_filter.put(&quot;activity2StartType&quot;, new Integer(value));</span>
<span class="nc" id="L1611">	}</span>

	public void setActivity2IdMatchAll(boolean value) {
<span class="nc" id="L1614">		m_filter.put(&quot;activity2IdMatchAll&quot;, new Boolean(value));</span>
<span class="nc" id="L1615">	}</span>

	public void setActivity2StartMatchAll(boolean value) {
<span class="nc" id="L1618">		m_filter.put(&quot;activity2StartMatchAll&quot;, new Boolean(value));</span>
<span class="nc" id="L1619">	}</span>

	// Skills
	public void setSkillsMatchType(int value) {
<span class="nc" id="L1623">		m_filter.put(&quot;skillsMatchType&quot;, new Integer(value));</span>
<span class="nc" id="L1624">	}</span>

	public void setAuctionID(int id) {
<span class="nc" id="L1627">		m_auctionID = new ID(id);</span>
<span class="nc" id="L1628">	}</span>

	public void setBidderID(int id) {
<span class="nc" id="L1631">		m_bidderID = new ID(id);</span>
<span class="nc" id="L1632">	}</span>

	public int getAuctionID() {
<span class="nc bnc" id="L1635" title="All 2 branches missed.">		return (m_auctionID == null) ? -1 : m_auctionID.toInt();</span>
	}

	public int getBidderID() {
<span class="nc bnc" id="L1639" title="All 2 branches missed.">		return (m_bidderID == null) ? -1 : m_bidderID.toInt();</span>
	}

	// ///////////////////////////////////////////////////////
	// Setter methods called manually after super.extractParameters()
	// ///////////////////////////////////////////////////////

	/**
	 * Extract Shift Start Time / Shift Start Range parameters from the form. We
	 * use the shiftStartType value (which was auto-extracted) to determine
	 * which, if any, of the shiftStartType, shiftStart1, shiftStart2 parameters
	 * need to be stored in the filter for display.
	 */
	private void extractShiftStartParams() {
<span class="nc" id="L1653">		int shiftStartType = m_filter.getInt(&quot;shiftStartType&quot;);</span>

<span class="nc bnc" id="L1655" title="All 6 branches missed.">		if ((shiftStartType == BidOptionsFilter.EQUAL) || (shiftStartType == BidOptionsFilter.MIN)</span>
				|| (shiftStartType == BidOptionsFilter.MAX)) {
<span class="nc" id="L1657">			m_filter.put(&quot;shiftStart1&quot;, new Integer(m_shiftStartTime.getTimeInMinutes()));</span>
<span class="nc bnc" id="L1658" title="All 2 branches missed.">		} else if (shiftStartType == BidOptionsFilter.BETWEEN) {</span>
<span class="nc" id="L1659">			m_filter.put(&quot;shiftStart1&quot;, new Integer(m_shiftStartRange.getStartTimePickerPC().getTimeInMinutes()));</span>
<span class="nc" id="L1660">			m_filter.put(&quot;shiftStart2&quot;, new Integer(m_shiftStartRange.getEndTimePickerPC().getTimeInMinutes()));</span>
<span class="nc bnc" id="L1661" title="All 2 branches missed.">		} else if (shiftStartType == BidOptionsFilter.UNDEFINED_INT) {</span>
<span class="nc" id="L1662">			m_filter.remove(&quot;shiftStartType&quot;);</span>
<span class="nc" id="L1663">			m_filter.remove(&quot;shiftStart1&quot;);</span>
<span class="nc" id="L1664">			m_filter.remove(&quot;shiftStart2&quot;);</span>
		}
<span class="nc" id="L1666">	}</span>

	/**
	 * Extract Shift End Time / Shift End Range parameters from the form. We use
	 * the shiftEndType value (which was auto-extracted) to determine which, if
	 * any, of the shiftEndType, shiftEnd1, shiftEnd2 parameters need to be
	 * stored in the filter for display.
	 */
	private void extractShiftEndParams() {
<span class="nc" id="L1675">		int shiftEndType = m_filter.getInt(&quot;shiftEndType&quot;);</span>

<span class="nc bnc" id="L1677" title="All 6 branches missed.">		if ((shiftEndType == BidOptionsFilter.EQUAL) || (shiftEndType == BidOptionsFilter.MIN)</span>
				|| (shiftEndType == BidOptionsFilter.MAX)) {
<span class="nc" id="L1679">			m_filter.put(&quot;shiftEnd1&quot;, new Integer(m_shiftEndTime.getTimeInMinutes()));</span>
<span class="nc bnc" id="L1680" title="All 2 branches missed.">		} else if (shiftEndType == BidOptionsFilter.BETWEEN) {</span>
<span class="nc" id="L1681">			m_filter.put(&quot;shiftEnd1&quot;, new Integer(m_shiftEndRange.getStartTimePickerPC().getTimeInMinutes()));</span>
<span class="nc" id="L1682">			m_filter.put(&quot;shiftEnd2&quot;, new Integer(m_shiftEndRange.getEndTimePickerPC().getTimeInMinutes()));</span>
<span class="nc bnc" id="L1683" title="All 2 branches missed.">		} else if (shiftEndType == BidOptionsFilter.UNDEFINED_INT) {</span>
<span class="nc" id="L1684">			m_filter.remove(&quot;shiftEndType&quot;);</span>
<span class="nc" id="L1685">			m_filter.remove(&quot;shiftEnd1&quot;);</span>
<span class="nc" id="L1686">			m_filter.remove(&quot;shiftEnd2&quot;);</span>
		}
<span class="nc" id="L1688">	}</span>

	/**
	 * Extract Activity1 Start Time / Activity1 Start Range parameters from the
	 * form. We use the activity1StartType value (which was auto-extracted) to
	 * determine which, if any, of the activity1StartType, activity1Start1,
	 * activity1Start2 parameters need to be stored in the filter for display.
	 */
	private void extractActivity1StartParams() {
<span class="nc" id="L1697">		int activity1StartType = m_filter.getInt(&quot;activity1StartType&quot;);</span>

<span class="nc bnc" id="L1699" title="All 6 branches missed.">		if ((activity1StartType == BidOptionsFilter.EQUAL) || (activity1StartType == BidOptionsFilter.MIN)</span>
				|| (activity1StartType == BidOptionsFilter.MAX)) {
<span class="nc" id="L1701">			m_filter.put(&quot;activity1Start1&quot;, new Integer(m_activity1StartTime.getTimeInMinutes()));</span>
<span class="nc bnc" id="L1702" title="All 2 branches missed.">		} else if (activity1StartType == BidOptionsFilter.BETWEEN) {</span>
<span class="nc" id="L1703">			m_filter.put(&quot;activity1Start1&quot;,</span>
<span class="nc" id="L1704">					new Integer(m_activity1StartRange.getStartTimePickerPC().getTimeInMinutes()));</span>
<span class="nc" id="L1705">			m_filter.put(&quot;activity1Start2&quot;, new Integer(m_activity1StartRange.getEndTimePickerPC().getTimeInMinutes()));</span>
<span class="nc bnc" id="L1706" title="All 2 branches missed.">		} else if (activity1StartType == BidOptionsFilter.UNDEFINED_INT) {</span>
<span class="nc" id="L1707">			m_filter.remove(&quot;activity1StartType&quot;);</span>
<span class="nc" id="L1708">			m_filter.remove(&quot;activity1Start1&quot;);</span>
<span class="nc" id="L1709">			m_filter.remove(&quot;activity1Start2&quot;);</span>
		}
<span class="nc" id="L1711">	}</span>

	/**
	 * Extract Activity2 Start Time / Activity2 Start Range parameters from the
	 * form. We use the activity2StartType value (which was auto-extracted) to
	 * determine which, if any, of the activity2StartType, activity2Start1,
	 * activity2Start2 parameters need to be stored in the filter for display.
	 */
	private void extractActivity2StartParams() {
<span class="nc" id="L1720">		int activity2StartType = m_filter.getInt(&quot;activity2StartType&quot;);</span>

<span class="nc bnc" id="L1722" title="All 6 branches missed.">		if ((activity2StartType == BidOptionsFilter.EQUAL) || (activity2StartType == BidOptionsFilter.MIN)</span>
				|| (activity2StartType == BidOptionsFilter.MAX)) {
<span class="nc" id="L1724">			m_filter.put(&quot;activity2Start1&quot;, new Integer(m_activity2StartTime.getTimeInMinutes()));</span>
<span class="nc bnc" id="L1725" title="All 2 branches missed.">		} else if (activity2StartType == BidOptionsFilter.BETWEEN) {</span>
<span class="nc" id="L1726">			m_filter.put(&quot;activity2Start1&quot;,</span>
<span class="nc" id="L1727">					new Integer(m_activity2StartRange.getStartTimePickerPC().getTimeInMinutes()));</span>
<span class="nc" id="L1728">			m_filter.put(&quot;activity2Start2&quot;, new Integer(m_activity2StartRange.getEndTimePickerPC().getTimeInMinutes()));</span>
<span class="nc bnc" id="L1729" title="All 2 branches missed.">		} else if (activity2StartType == BidOptionsFilter.UNDEFINED_INT) {</span>
<span class="nc" id="L1730">			m_filter.remove(&quot;activity2StartType&quot;);</span>
<span class="nc" id="L1731">			m_filter.remove(&quot;activity2Start1&quot;);</span>
<span class="nc" id="L1732">			m_filter.remove(&quot;activity2Start2&quot;);</span>
		}
<span class="nc" id="L1734">	}</span>

	/**
	 * Extract the Skills selection from the AssignmentBox component in the
	 * form. Use the extracted list of skills from the assignment list and the
	 * skillsMatchType value (which was also auto-extracted) to determine which
	 * skills to store in the filter for display on the page.
	 */
	private void extractSkillsParams() {
<span class="nc" id="L1743">		ID[] idsRight = m_skillsAssignmentBox.getRightListPC().getExtractedListIDsAsIDArray();</span>
<span class="nc bnc" id="L1744" title="All 2 branches missed.">		if (idsRight != null) // &amp;&amp; (idsRight.length &gt; 0))</span>
		{
<span class="nc" id="L1746">			ArrayList idList = new ArrayList(idsRight.length);</span>
<span class="nc" id="L1747">			addToList(idList, idsRight);</span>
<span class="nc bnc" id="L1748" title="All 2 branches missed.">			if (idList.isEmpty()) {</span>
				// Special case when no skills have been selected.
<span class="nc" id="L1750">				int skillsMatchType = m_filter.getInt(&quot;skillsMatchType&quot;);</span>
<span class="nc bnc" id="L1751" title="All 4 branches missed.">				if ((skillsMatchType == BidOptionsFilter.SKILLS_MATCH_EXACT)</span>
						|| (skillsMatchType == BidOptionsFilter.SKILLS_MATCH_AT_MOST)) {
					// User wants to search for all options which require no
					// skills.
<span class="nc" id="L1755">					m_filter.put(&quot;skills&quot;, idList);</span>
<span class="nc bnc" id="L1756" title="All 2 branches missed.">				} else if (skillsMatchType == BidOptionsFilter.SKILLS_MATCH_AT_LEAST) {</span>
					// &quot;At least no skills&quot; means match any options. So, we do
					// not filter by skills.
<span class="nc" id="L1759">					m_filter.remove(&quot;skills&quot;);</span>
				}
<span class="nc" id="L1761">			} else {</span>
<span class="nc" id="L1762">				m_filter.put(&quot;skills&quot;, idList);</span>
			}
<span class="nc" id="L1764">		} else {</span>
<span class="nc" id="L1765">			m_filter.remove(&quot;skills&quot;);</span>
		}
<span class="nc" id="L1767">	}</span>

	// ///////////////////////////////////////////////////////
	// Container Support Methods
	// ///////////////////////////////////////////////////////

	/**
	 * Add a collapsible form container to the page.
	 *
	 * @param name
	 *            The name of the container
	 * @return The container object.
	 */
	private Collapsible2ColFormPC createFormPC(String name) {
<span class="nc" id="L1781">		Collapsible2ColFormPC formPC = new Collapsible2ColFormPC(m_context);</span>
<span class="nc" id="L1782">		formPC.setName(name);</span>
<span class="nc" id="L1783">		formPC.setIsBorderEnabled(true);</span>
<span class="nc" id="L1784">		m_containerList.add(formPC);</span>
<span class="nc" id="L1785">		return formPC;</span>
	}

	/**
	 * Return List of Containers Note: Items in the Collection will be treated
	 * either as Page Components or just basic Objects.
	 */
	@Override
	public Collection getContainers() {
<span class="nc" id="L1794">		return m_containerList;</span>
	}

	// ///////////////////////////////////////////////////////
	// Helper Methods
	// ///////////////////////////////////////////////////////

	/**
	 * Convert an integer to a String value, to be displayed in an input field.
	 */
	private String getInputValue(int val) {
<span class="nc bnc" id="L1805" title="All 2 branches missed.">		if (val == BidOptionsFilter.UNDEFINED_INT) {</span>
<span class="nc" id="L1806">			return EMPTY;</span>
		}
<span class="nc" id="L1808">		return EMPTY + val;</span>
	}

	/**
	 * Convert a float to a String value, to be displayed in an input field.
	 */
	private String getInputValue(float val) {
<span class="nc bnc" id="L1815" title="All 2 branches missed.">		if (val == BidOptionsFilter.UNDEFINED_FLOAT) {</span>
<span class="nc" id="L1816">			return EMPTY;</span>
		}
<span class="nc" id="L1818">		return EMPTY + val;</span>
	}

	/**
	 * Reset our global m_inputPC page component, so it can be reused.
	 *
	 * @param name
	 *            The name of the input element.
	 * @param type
	 *            the type of input field (ex: FormInputPC.TYPE_INTEGER)
	 */
	private void resetInputPC(String name, int type) {
<span class="nc" id="L1830">		m_inputPC.reset();</span>
<span class="nc" id="L1831">		m_inputPC.setIsRequired(false); // TBD: we may need special validation</span>
<span class="nc" id="L1832">		m_inputPC.setInputType(type);</span>
<span class="nc" id="L1833">		m_inputPC.setLowerLimit(0);</span>
<span class="nc" id="L1834">		m_inputPC.setInputFN(name);</span>
<span class="nc" id="L1835">	}</span>

	/**
	 * Reset a TimePickerPC page component
	 */
	private void resetTimePickerPC(TimePickerPC picker, String name) {
<span class="nc" id="L1841">		picker.reset();</span>
<span class="nc" id="L1842">		picker.setTimeInterval(1);</span>
		// m_timePickerPC.setIsInputValueOptional(true);
<span class="nc" id="L1844">		picker.setOnChangeJS(JSUtil.ON_CHANGE);</span>
<span class="nc" id="L1845">		picker.setInputFieldName(name);</span>
<span class="nc" id="L1846">		picker.setTitle(i18n(m_rmBundle, RmWebBundleKey.RM_SA_FILTER_SET_TIME));</span>
<span class="nc" id="L1847">	}</span>

	/**
	 * Reset a TimeRangePickerPC page component
	 */
	private void resetTimeRangePickerPC(TimeRangePickerPC picker) {
<span class="nc" id="L1853">		picker.reset();</span>
<span class="nc" id="L1854">		picker.setTimeInterval(1);</span>
		// m_timePickerPC.setIsInputValueOptional(true);
<span class="nc" id="L1856">		picker.setOnChangeJS(JSUtil.ON_CHANGE);</span>
<span class="nc" id="L1857">		picker.setTitles(i18n(m_rmBundle, RmWebBundleKey.RM_SA_FILTER_SET_TIME),</span>
<span class="nc" id="L1858">				i18n(m_rmBundle, RmWebBundleKey.RM_SA_FILTER_SET_MAX_TIME));</span>
<span class="nc" id="L1859">	}</span>

	/**
	 * Create a drop down options list containing &quot;Any&quot;, &quot;Equal&quot;, &quot;Min&quot;, &quot;Max&quot;,
	 * and &quot;Between&quot; options.
	 *
	 * @param anyLabel
	 *            The label for the &quot;Any&quot; option
	 * @return The list of StringsPair options.
	 */
	private List getMinMaxDDOptions(String anyLabel, String equalLabel, String minLabel, String maxLabel,
			String betweenLabel) {
<span class="nc" id="L1871">		ArrayList list = new ArrayList(4);</span>
<span class="nc" id="L1872">		list.add(new StringsPair(&quot;&quot; + ddIndexToVal(0), ddIndexToLabel(0, anyLabel, equalLabel, minLabel, maxLabel,</span>
				betweenLabel)));
<span class="nc" id="L1874">		list.add(new StringsPair(&quot;&quot; + ddIndexToVal(1), ddIndexToLabel(1, anyLabel, equalLabel, minLabel, maxLabel,</span>
				betweenLabel)));
<span class="nc" id="L1876">		list.add(new StringsPair(&quot;&quot; + ddIndexToVal(2), ddIndexToLabel(2, anyLabel, equalLabel, minLabel, maxLabel,</span>
				betweenLabel)));
<span class="nc" id="L1878">		list.add(new StringsPair(&quot;&quot; + ddIndexToVal(3), ddIndexToLabel(3, anyLabel, equalLabel, minLabel, maxLabel,</span>
				betweenLabel)));
<span class="nc" id="L1880">		list.add(new StringsPair(&quot;&quot; + ddIndexToVal(4), ddIndexToLabel(4, anyLabel, equalLabel, minLabel, maxLabel,</span>
				betweenLabel)));
<span class="nc" id="L1882">		return list;</span>
	}

	/**
	 * Return the &quot;Show&quot; mode to use for initially displaying a &quot;buddy&quot; form
	 * element. The element to be shown/hidden is a &quot;buddy&quot; of a dropdown list.
	 *
	 * @param ddType
	 *            The type of dropdown which has the buddy. Should be either
	 *            DD_TYPE_ID, DD_TYPE_LENGTH or DD_TYPE_TIME.
	 * @param selectedID
	 *            The dropdown's currently selected ID (not the index). This
	 *            tells us which of the buddies should be hidden or shown.
	 * @return One of: SHOW_NO_BUDS, SHOW_BUD1_ONLY, SHOW_BUD2_ONLY,
	 *         SHOW_ALL_BUDS
	 */
	private int getShowMode(int ddType, Integer selectedID) {
<span class="nc" id="L1899">		int showMode = SHOW_NO_BUDS;</span>
<span class="nc bnc" id="L1900" title="All 2 branches missed.">		if (selectedID == null) {</span>
<span class="nc" id="L1901">			return SHOW_NO_BUDS;</span>
		}
<span class="nc" id="L1903">		int selectedInt = selectedID.intValue();</span>
<span class="nc bnc" id="L1904" title="All 4 branches missed.">		switch (ddType) {</span>
		case DD_TYPE_ID:
<span class="nc bnc" id="L1906" title="All 2 branches missed.">			switch (selectedInt) {</span>
			case BidOptionsFilter.UNDEFINED_INT:
<span class="nc" id="L1908">				showMode = SHOW_NO_BUDS;</span>
<span class="nc" id="L1909">				break;</span>
			default:
<span class="nc" id="L1911">				showMode = SHOW_ALL_BUDS;</span>
<span class="nc" id="L1912">				break;</span>
			}
			break;
		case DD_TYPE_LENGTH:
<span class="nc bnc" id="L1916" title="All 4 branches missed.">			switch (selectedInt) {</span>
			case BidOptionsFilter.UNDEFINED_INT:
<span class="nc" id="L1918">				showMode = SHOW_NO_BUDS;</span>
<span class="nc" id="L1919">				break;</span>
			case BidOptionsFilter.EQUAL:
			case BidOptionsFilter.MIN:
			case BidOptionsFilter.MAX:
<span class="nc" id="L1923">				showMode = SHOW_BUD1_ONLY;</span>
<span class="nc" id="L1924">				break;</span>
			case BidOptionsFilter.BETWEEN:
<span class="nc" id="L1926">				showMode = SHOW_ALL_BUDS;</span>
				break;
			}
<span class="nc" id="L1929">			break;</span>
		case DD_TYPE_TIME:
<span class="nc bnc" id="L1931" title="All 4 branches missed.">			switch (selectedInt) {</span>
			case BidOptionsFilter.UNDEFINED_INT:
<span class="nc" id="L1933">				showMode = SHOW_NO_BUDS;</span>
<span class="nc" id="L1934">				break;</span>
			case BidOptionsFilter.EQUAL:
			case BidOptionsFilter.MIN:
			case BidOptionsFilter.MAX:
<span class="nc" id="L1938">				showMode = SHOW_BUD1_ONLY;</span>
<span class="nc" id="L1939">				break;</span>
			case BidOptionsFilter.BETWEEN:
<span class="nc" id="L1941">				showMode = SHOW_BUD2_ONLY;</span>
				break;
			}
			break;
		}
<span class="nc" id="L1946">		return showMode;</span>
	}

	/**
	 * Determine whether a dropdown's &quot;buddy&quot; field should be shown or hidden.
	 * The field to be shown/hidden is a &quot;buddy&quot; of a dropdown list.
	 *
	 * @param ddType
	 *            The type of dropdown which has the buddy. Should be either
	 *            DD_TYPE_ID, DD_TYPE_LENGTH or DD_TYPE_TIME.
	 * @param selectedID
	 *            The dropdown's currently selected ID (not the index). This
	 *            tells us which of the buddies should be hidden or shown.
	 * @param buddyIndex
	 *            The index of the buddy field to check. One of: BUDDY1_INDEX,
	 *            BUDDY2_INDEX, BUDDY3_INDEX, etc.. Note: buddy3 and greater are
	 *            shown whenever buddy1 OR buddy2 are shown.
	 * @return true: buddy should be shown. false: buddy should be hidden.
	 */
	private boolean isShowBuddy(int ddType, Integer selectedID, int buddyIndex) {
<span class="nc" id="L1966">		int showMode = getShowMode(ddType, selectedID);</span>
<span class="nc" id="L1967">		boolean bShow = false;</span>

<span class="nc bnc" id="L1969" title="All 5 branches missed.">		switch (showMode) {</span>
		case SHOW_NO_BUDS:
<span class="nc" id="L1971">			bShow = false;</span>
<span class="nc" id="L1972">			break;</span>
		case SHOW_BUD1_ONLY:
<span class="nc bnc" id="L1974" title="All 4 branches missed.">			bShow = (buddyIndex == BUDDY1_INDEX) || (buddyIndex &gt;= BUDDY3_INDEX);</span>
<span class="nc" id="L1975">			break;</span>
		case SHOW_BUD2_ONLY:
<span class="nc bnc" id="L1977" title="All 4 branches missed.">			bShow = (buddyIndex == BUDDY2_INDEX) || (buddyIndex &gt;= BUDDY3_INDEX);</span>
<span class="nc" id="L1978">			break;</span>
		case SHOW_ALL_BUDS:
<span class="nc" id="L1980">			bShow = true;</span>
			break;
		}
<span class="nc" id="L1983">		return bShow;</span>
	}

	/**
	 * Return the style string to use for initially displaying a &quot;buddy&quot; form
	 * field. The field whose style will be set is called a &quot;buddy&quot; of a
	 * dropdown list.
	 *
	 * @param ddType
	 *            The type of dropdown which has the buddy. Should be either
	 *            DD_TYPE_ID, DD_TYPE_LENGTH or DD_TYPE_TIME.
	 * @param selectedID
	 *            The dropdown's currently selected ID (not the index). This
	 *            tells us which of the buddies should be hidden or shown.
	 * @param buddyIndex
	 *            The index of the buddy field to check. One of: BUDDY1_INDEX,
	 *            BUDDY2_INDEX, BUDDY3_INDEX, etc.
	 * @return the style string to use for initially displaying a &quot;buddy&quot; form
	 *         field.
	 */
	private String getBuddyStyle(int ddType, Integer selectedID, int buddyIndex) {
<span class="nc" id="L2004">		String style = &quot;&quot;; // visible</span>
<span class="nc bnc" id="L2005" title="All 2 branches missed.">		if (!isShowBuddy(ddType, selectedID, buddyIndex)) {</span>
<span class="nc" id="L2006">			style = &quot;display:none; &quot;; // hidden</span>
		}
<span class="nc" id="L2008">		return style;</span>
	}

	private String getBuddyStyle(int ddType, int selectedID, int buddyIndex) {
<span class="nc" id="L2012">		return getBuddyStyle(ddType, new Integer(selectedID), buddyIndex);</span>
	}

	/**
	 * Given an element's index in a dropdown options list, return the
	 * corresponding value.
	 *
	 * @param index
	 *            The 0-based options list index
	 * @return
	 */
	private int ddIndexToVal(int index) {
<span class="nc" id="L2024">		int val = BidOptionsFilter.UNDEFINED_INT;</span>
<span class="nc bnc" id="L2025" title="All 6 branches missed.">		switch (index) {</span>
		case 0:
<span class="nc" id="L2027">			val = BidOptionsFilter.UNDEFINED_INT;</span>
<span class="nc" id="L2028">			break;</span>
		case 1:
<span class="nc" id="L2030">			val = BidOptionsFilter.EQUAL;</span>
<span class="nc" id="L2031">			break;</span>
		case 2:
<span class="nc" id="L2033">			val = BidOptionsFilter.MAX;</span>
<span class="nc" id="L2034">			break;</span>
		case 3:
<span class="nc" id="L2036">			val = BidOptionsFilter.MIN;</span>
<span class="nc" id="L2037">			break;</span>
		case 4:
<span class="nc" id="L2039">			val = BidOptionsFilter.BETWEEN;</span>
			break;
		}
<span class="nc" id="L2042">		return val;</span>
	}

	/**
	 * Given an element's index in a dropdown options list, return the
	 * corresponding label.
	 *
	 * @param index
	 *            The 0-based options list index
	 * @param anyLabel
	 *            The label to use for the &quot;Any&quot; (or &quot;I don't care&quot;) option.
	 * @return
	 */
	private String ddIndexToLabel(int index, String anyLabel, String equalLabel, String minLabel, String maxLabel,
			String betweenLabel) {
<span class="nc" id="L2057">		String label = &quot;&quot;;</span>
<span class="nc bnc" id="L2058" title="All 6 branches missed.">		switch (index) {</span>
		case 0:
<span class="nc" id="L2060">			label = anyLabel;</span>
<span class="nc" id="L2061">			break;</span>
		case 1:
<span class="nc" id="L2063">			label = equalLabel;</span>
<span class="nc" id="L2064">			break;</span>
		case 2:
<span class="nc" id="L2066">			label = maxLabel;</span>
<span class="nc" id="L2067">			break;</span>
		case 3:
<span class="nc" id="L2069">			label = minLabel;</span>
<span class="nc" id="L2070">			break;</span>
		case 4:
<span class="nc" id="L2072">			label = betweenLabel;</span>
			break;
		}
<span class="nc" id="L2075">		return label;</span>
	}

	/**
	 * Create a String containing the JavaScript array data which is used by the
	 * showDDBuddyElems() JavaScript function to show/hide &quot;buddies&quot; of the
	 * various dropdown components on the page. The outter arrays are for
	 * looking up the selectedIndex of the dropdown. The inner arrays are lists
	 * of &quot;buddies&quot; of the selectedIndex, which should be either shown or hidden
	 * whenever the dropdown is on that selectedIndex. Note: This method should
	 * probably call ddIndexToVal() so that there is only a single place where
	 * the dropdown options order is defined. (ANY, EQUAL, MAX, MIN, BETWEEN)
	 *
	 * @param ddType
	 *            The type of dropdown which has the buddy. Should be either
	 *            DD_TYPE_LENGTH or DD_TYPE_TIME.
	 * @param showName
	 *            Name of the global JS variable to hold a 2d array of buddies
	 *            to show.
	 * @param hideName
	 *            Name of the global JS variable to hold a 2d array of buddies
	 *            to hide.
	 * @param buds
	 *            An array of buddy element names. All buds with an index &gt;= 2
	 *            will be shown whenever the first or second bud are shown.
	 * @return String containing the custom JavaScript for the 2-dimentional
	 *         show/hide arrrays.
	 */
	private String createBuddyVisibilityMap(int ddType, String showName, String hideName, String buds[]) {
<span class="nc" id="L2104">		StringBuffer sb = new StringBuffer(1000);</span>

<span class="nc" id="L2106">		int numBuds = buds.length;</span>

		// create a list containing all buddies except the first one
<span class="nc" id="L2109">		ArrayList noBud1List = new ArrayList(numBuds - 1);</span>
<span class="nc bnc" id="L2110" title="All 2 branches missed.">		for (int i = 1; i &lt; numBuds; i++) {</span>
<span class="nc" id="L2111">			noBud1List.add(buds[i]);</span>
		}

		// create a list containing all buddies except the second one
<span class="nc" id="L2115">		ArrayList noBud2List = new ArrayList(numBuds);</span>
<span class="nc bnc" id="L2116" title="All 2 branches missed.">		for (int i = 0; i &lt; numBuds; i++) {</span>
<span class="nc" id="L2117">			noBud2List.add(buds[i]);</span>
		}

		// remove second buddy from list
<span class="nc bnc" id="L2121" title="All 2 branches missed.">		if (numBuds &gt; 1) {</span>
<span class="nc" id="L2122">			noBud2List.remove(1);</span>
		}

		// Create the arrays of Shown and Hidden elements
<span class="nc bnc" id="L2126" title="All 2 branches missed.">		if (ddType == DD_TYPE_LENGTH) {</span>
<span class="nc" id="L2127">			String showArrayAny[] = {}; // no buds</span>
<span class="nc" id="L2128">			String showArrayEqu[] = (String[]) noBud2List.toArray(new String[numBuds - 1]); // {bud1,</span>
																							// bud3,
																							// bud4,
																							// bud5,
																							// ...};
<span class="nc" id="L2133">			String showArrayMax[] = showArrayEqu;</span>
<span class="nc" id="L2134">			String showArrayMin[] = showArrayEqu;</span>
<span class="nc" id="L2135">			String showArrayBtw[] = buds; // all buds</span>
<span class="nc" id="L2136">			String showArray[][] = { showArrayAny, showArrayEqu, showArrayMax, showArrayMin, showArrayBtw };</span>

<span class="nc" id="L2138">			String hideArrayAny[] = buds; // all buds</span>
<span class="nc" id="L2139">			String hideArrayEqu[] = { buds[1] }; // second bud</span>
<span class="nc" id="L2140">			String hideArrayMax[] = { buds[1] };</span>
<span class="nc" id="L2141">			String hideArrayMin[] = { buds[1] };</span>
<span class="nc" id="L2142">			String hideArrayBtw[] = {}; // no buds</span>
<span class="nc" id="L2143">			String hideArray[][] = { hideArrayAny, hideArrayEqu, hideArrayMax, hideArrayMin, hideArrayBtw };</span>

<span class="nc" id="L2145">			constructJSArray(showName, showArray, sb);</span>
<span class="nc" id="L2146">			constructJSArray(hideName, hideArray, sb);</span>
<span class="nc bnc" id="L2147" title="All 2 branches missed.">		} else if (ddType == DD_TYPE_TIME) {</span>
<span class="nc" id="L2148">			String showArrayAny[] = {}; // no buds</span>
<span class="nc" id="L2149">			String showArrayEqu[] = (String[]) noBud2List.toArray(new String[numBuds - 1]); // {bud1,</span>
																							// bud3,
																							// bud4,
																							// bud5,
																							// ...};
<span class="nc" id="L2154">			String showArrayMax[] = showArrayEqu;</span>
<span class="nc" id="L2155">			String showArrayMin[] = showArrayEqu;</span>
<span class="nc" id="L2156">			String showArrayBtw[] = (String[]) noBud1List.toArray(new String[numBuds - 1]); // {bud2,</span>
																							// bud3,
																							// bud4,
																							// bud5,
																							// ...};
<span class="nc" id="L2161">			String showArray[][] = { showArrayAny, showArrayEqu, showArrayMax, showArrayMin, showArrayBtw };</span>

<span class="nc" id="L2163">			String hideArrayAny[] = buds; // all buds</span>
<span class="nc" id="L2164">			String hideArrayEqu[] = { buds[1] }; // second bud</span>
<span class="nc" id="L2165">			String hideArrayMax[] = { buds[1] };</span>
<span class="nc" id="L2166">			String hideArrayMin[] = { buds[1] };</span>
<span class="nc" id="L2167">			String hideArrayBtw[] = { buds[0] }; // first bud</span>
<span class="nc" id="L2168">			String hideArray[][] = { hideArrayAny, hideArrayEqu, hideArrayMax, hideArrayMin, hideArrayBtw };</span>

<span class="nc" id="L2170">			constructJSArray(showName, showArray, sb);</span>
<span class="nc" id="L2171">			constructJSArray(hideName, hideArray, sb);</span>
		}
<span class="nc" id="L2173">		return sb.toString();</span>
	}

	/**
	 * Construct a 2-D JavaScript array and store in a StringBuffer. The array
	 * lists which buddy elements should be shown or hidden for a particular
	 * dropdown option.
	 *
	 * @param arrayName
	 *            The name to give to the JavaScript array we are creating.
	 * @param values
	 *            The Java array storing the buddy element names.
	 * @param sb
	 *            The StringBuffer to append our JavaScript array initialization
	 *            to.
	 */
	private void constructJSArray(String arrayName, String[][] values, StringBuffer sb) {
<span class="nc" id="L2190">		sb.append(&quot;var &quot;).append(arrayName).append(&quot; = [];\n&quot;);</span>
<span class="nc" id="L2191">		sb.append(arrayName).append(&quot;[0] = &quot;).append(BidOptionsFilterUtil.toJSArray(values[0])).append(&quot;;\n&quot;);</span>
<span class="nc" id="L2192">		sb.append(arrayName).append(&quot;[1] = &quot;).append(BidOptionsFilterUtil.toJSArray(values[1])).append(&quot;;\n&quot;);</span>
<span class="nc" id="L2193">		sb.append(arrayName).append(&quot;[2] = &quot;).append(BidOptionsFilterUtil.toJSArray(values[2])).append(&quot;;\n&quot;);</span>
<span class="nc" id="L2194">		sb.append(arrayName).append(&quot;[3] = &quot;).append(BidOptionsFilterUtil.toJSArray(values[3])).append(&quot;;\n&quot;);</span>
<span class="nc" id="L2195">		sb.append(arrayName).append(&quot;[4] = &quot;).append(BidOptionsFilterUtil.toJSArray(values[4])).append(&quot;;\n\n&quot;);</span>
<span class="nc" id="L2196">	}</span>

	/**
	 * An unelegant way to get the onClick JavaScript for synchronizing
	 * checkboxes.
	 *
	 * @param name1
	 *            the name of the first checkbox to synchonize
	 * @param name2
	 *            the name of the second checkbox to synchonize
	 * @return The JavaScript to call in a checkbox's onClick handler in order
	 *         for two other checkboxes to be synchronized with it's setting.
	 */
	private String getCheckboxSynchJS(String name1, String name2) {
		/*
		 * 508 Radio button form element names have the following format:
		 * name_true_0 //the radio button name_true_0_hidden //the hidden field
		 * for the radio button
		 *
		 * String synchJS = &quot;document.getElementById('&quot; + name1 +
		 * &quot;_true_0').value=this.checked;&quot;; synchJS +=
		 * &quot;document.getElementById('&quot; + name1 +
		 * &quot;_true_0').checked=this.checked;&quot;; synchJS +=
		 * &quot;document.getElementById('&quot; + name1 +
		 * &quot;_true_0_hidden').value=this.checked;&quot;;
		 *
		 * synchJS += &quot;document.getElementById('&quot; + name2 +
		 * &quot;_true_0').value=this.checked;&quot;; synchJS +=
		 * &quot;document.getElementById('&quot; + name2 +
		 * &quot;_true_0').checked=this.checked;&quot;; synchJS +=
		 * &quot;document.getElementById('&quot; + name2 +
		 * &quot;_true_0_hidden').value=this.checked;&quot;;
		 *
		 * synchJS += JSUtil.ON_CHANGE; return synchJS;
		 */

<span class="nc" id="L2232">		String synchJS = &quot;&quot;;</span>
<span class="nc" id="L2233">		synchJS += &quot;DOM2.getElementByIdOrName('bChk_&quot; + name1 + &quot;_true_0').value=this.checked;&quot;;</span>
<span class="nc" id="L2234">		synchJS += &quot;DOM2.getElementByIdOrName('bChk_&quot; + name1 + &quot;_true_0').checked=this.checked;&quot;;</span>
<span class="nc" id="L2235">		synchJS += &quot;DOM2.getElementByIdOrName('&quot; + name1 + &quot;_true_0').value=this.checked;&quot;;</span>
<span class="nc" id="L2236">		synchJS += &quot;DOM2.getElementByIdOrName('&quot; + name1 + &quot;_true_0').checked=this.checked;&quot;;</span>

<span class="nc" id="L2238">		synchJS += &quot;DOM2.getElementByIdOrName('bChk_&quot; + name2 + &quot;_true_0').value=this.checked;&quot;;</span>
<span class="nc" id="L2239">		synchJS += &quot;DOM2.getElementByIdOrName('bChk_&quot; + name2 + &quot;_true_0').checked=this.checked;&quot;;</span>
<span class="nc" id="L2240">		synchJS += &quot;DOM2.getElementByIdOrName('&quot; + name2 + &quot;_true_0').value=this.checked;&quot;;</span>
<span class="nc" id="L2241">		synchJS += &quot;DOM2.getElementByIdOrName('&quot; + name2 + &quot;_true_0').checked=this.checked;&quot;;</span>

<span class="nc" id="L2243">		synchJS += JSUtil.ON_CHANGE;</span>
<span class="nc" id="L2244">		return synchJS;</span>
	}

	/**
	 * Get the time to initialize a TimePickerPC with.
	 *
	 * @param time
	 *            The time as stored in the filter object.
	 * @return The time to display in the TimePickerPC input.
	 */
	private int getTime(int time) {
<span class="nc bnc" id="L2255" title="All 2 branches missed.">		if (time == BidOptionsFilter.UNDEFINED_INT) {</span>
<span class="nc" id="L2256">			return 0;</span>
		}
<span class="nc" id="L2258">		return time;</span>
	}

	/**
	 * Convert an ID to an Integer
	 */
	private Integer idToInteger(ID id) {
<span class="nc bnc" id="L2265" title="All 2 branches missed.">		if (id == null) {</span>
<span class="nc" id="L2266">			return null;</span>
		}
<span class="nc" id="L2268">		return new Integer(id.toInt());</span>
	}

	/**
	 * Add each Object from an array to an ArrayList.
	 *
	 * @param list
	 *            The ArrayList to receive the objects.
	 * @param ids
	 *            The array or Objects.
	 */
	private void addToList(ArrayList list, Object ids[]) {
<span class="nc bnc" id="L2280" title="All 4 branches missed.">		if ((list != null) &amp;&amp; (ids != null)) {</span>
<span class="nc bnc" id="L2281" title="All 2 branches missed.">			for (int i = 0; i &lt; ids.length; i++) {</span>
<span class="nc" id="L2282">				list.add(ids[i]);</span>
			}
		}
<span class="nc" id="L2285">	}</span>

	/**
	 * Initialize our member variable label strings.
	 */
	private void initLabels() {
<span class="nc" id="L2291">		m_anyAvailLabel = i18n(m_rmBundle, RmWebBundleKey.RM_SA_FILTER_ANY_AVAILABILITY);</span>
<span class="nc" id="L2292">		m_anyLengthLabel = i18n(m_rmBundle, RmWebBundleKey.RM_SA_FILTER_ANY_LENGTH);</span>
<span class="nc" id="L2293">		m_anyTimeLabel = i18n(m_rmBundle, RmWebBundleKey.RM_SA_FILTER_ANY_TIME);</span>
<span class="nc" id="L2294">		m_atLabel = i18n(m_rmBundle, RmWebBundleKey.RM_SA_FILTER_AT);</span>
<span class="nc" id="L2295">		m_equalLabel = i18n(m_rmBundle, RmWebBundleKey.RM_SA_FILTER_EQUAL_TO);</span>
<span class="nc" id="L2296">		m_minLabel = i18n(m_rmBundle, RmWebBundleKey.RM_SA_FILTER_NO_LESS_THAN);</span>
<span class="nc" id="L2297">		m_maxLabel = i18n(m_rmBundle, RmWebBundleKey.RM_SA_FILTER_NO_MORE_THAN);</span>
<span class="nc" id="L2298">		m_betweenLabel = i18n(m_rmBundle, RmWebBundleKey.RM_SA_FILTER_BETWEEN);</span>
<span class="nc" id="L2299">		m_notBeforeLabel = i18n(m_rmBundle, RmWebBundleKey.RM_SA_FILTER_NOT_BEFORE);</span>
<span class="nc" id="L2300">		m_notAfterLabel = i18n(m_rmBundle, RmWebBundleKey.RM_SA_FILTER_NOT_AFTER);</span>
<span class="nc" id="L2301">		m_optionsLabel = i18n(m_rmBundle, RmWebBundleKey.RM_SA_FILTER_OPTIONS);</span>
<span class="nc" id="L2302">		m_dashLabel = &quot;-&quot;;</span>
<span class="nc" id="L2303">		m_checkBoxLabel = i18n(m_rmBundle, RmWebBundleKey.RM_SA_FILTER_MATCH_ALL_SHIFTS);</span>
<span class="nc" id="L2304">		m_actualShiftLengthLabel = i18n(m_rmBundle, RmWebBundleKey.RM_SA_FILTER_ACTUAL_SHIFT_LENGTH);</span>
<span class="nc" id="L2305">		m_actualSchedLengthLabel = i18n(m_rmBundle, RmWebBundleKey.RM_SA_FILTER_ACTUAL_SCHEDULE_LENGTH);</span>
<span class="nc" id="L2306">		m_paidTimeOnlyLabel = i18n(m_rmBundle, RmWebBundleKey.RM_SA_FILTER_PAID_TIME_ONLY);</span>
<span class="nc" id="L2307">		m_skillsMatchAnyLabel = i18n(m_rmBundle, RmWebBundleKey.RM_SA_FILTER_SKILLS_ANY);</span>
<span class="nc" id="L2308">		m_skillsMatchExactlyLabel = i18n(m_rmBundle, RmWebBundleKey.RM_SA_FILTER_SKILLS_EXACTLY);</span>
<span class="nc" id="L2309">		m_skillsMatchAtLeastLabel = i18n(m_rmBundle, RmWebBundleKey.RM_SA_FILTER_SKILLS_MINIMUM);</span>
<span class="nc" id="L2310">		m_skillsMatchAtMostLabel = i18n(m_rmBundle, RmWebBundleKey.RM_SA_FILTER_SKILLS_MAXIMUM);</span>
<span class="nc" id="L2311">		m_skillsForShiftLabel = i18n(m_rmBundle, RmWebBundleKey.RM_SA_FILTER_SKILLS_FOR_SHIFT);</span>
<span class="nc" id="L2312">		m_assignBoxHeaderLabel = i18n(m_rmBundle, RmWebBundleKey.RM_SA_FILTER_SKILLS);</span>
<span class="nc" id="L2313">		m_assignBoxLeftLabel = i18n(m_rmBundle, RmWebBundleKey.RM_SA_FILTER_ASSIGN_BOX_LEFT);</span>
<span class="nc" id="L2314">		m_assignBoxRightLabel = i18n(m_rmBundle, RmWebBundleKey.RM_SA_FILTER_ASSIGN_BOX_RIGHT);</span>
<span class="nc" id="L2315">		m_noneLabel = i18n(m_rmBundle, RmWebBundleKey.RM_SA_FILTER_NONE);</span>
<span class="nc" id="L2316">		m_lengthExampleLabel = i18n(m_rmBundle, RmWebBundleKey.RM_SA_FILTER_LENGTH_EXAMPLE);</span>
<span class="nc" id="L2317">		m_hoursLabel = i18n(m_rmBundle, RmWebBundleKey.RM_SA_FILTER_HOURS) + NBSP + m_lengthExampleLabel;</span>
<span class="nc" id="L2318">		m_hoursAriaLabel = i18n(m_rmBundle, RmWebBundleKey.RM_SA_FILTER_NUMBER_OF_HOURS) + &quot; &quot; + m_lengthExampleLabel;</span>
<span class="nc" id="L2319">	}</span>

	/**
	 * Initialize our member variable form fields. Note: All of the other form
	 * fields are constructed as needed.
	 */
	private void initFormFields(RequestContext context) {
<span class="nc" id="L2326">		m_inputPC = new FormInputPC(context);</span>
<span class="nc" id="L2327">		addChildComponent(m_inputPC);</span>

		// Shift Start Time
<span class="nc" id="L2330">		m_shiftStartTime = new TimePickerPC(m_context);</span>
<span class="nc" id="L2331">		resetTimePickerPC(m_shiftStartTime, SHIFT_START_TIME);</span>
<span class="nc" id="L2332">		addChildComponent(m_shiftStartTime);</span>

		// Shift Start Range
<span class="nc" id="L2335">		m_shiftStartRange = new TimeRangePickerPC(m_context, SHIFT_START_RANGE);</span>
<span class="nc" id="L2336">		resetTimeRangePickerPC(m_shiftStartRange);</span>
<span class="nc" id="L2337">		addChildComponent(m_shiftStartRange);</span>

		// Shift End Time
<span class="nc" id="L2340">		m_shiftEndTime = new TimePickerPC(m_context);</span>
<span class="nc" id="L2341">		resetTimePickerPC(m_shiftEndTime, SHIFT_END_TIME);</span>
<span class="nc" id="L2342">		addChildComponent(m_shiftEndTime);</span>

		// Shift End Range
<span class="nc" id="L2345">		m_shiftEndRange = new TimeRangePickerPC(m_context, SHIFT_END_RANGE);</span>
<span class="nc" id="L2346">		resetTimeRangePickerPC(m_shiftEndRange);</span>
<span class="nc" id="L2347">		addChildComponent(m_shiftEndRange);</span>

		// Activity1 Start Time
<span class="nc" id="L2350">		m_activity1StartTime = new TimePickerPC(m_context);</span>
<span class="nc" id="L2351">		resetTimePickerPC(m_activity1StartTime, ACTIVITY1_START_TIME);</span>
<span class="nc" id="L2352">		addChildComponent(m_activity1StartTime);</span>

		// Activity1 Start Range
<span class="nc" id="L2355">		m_activity1StartRange = new TimeRangePickerPC(m_context, ACTIVITY1_START_RANGE);</span>
<span class="nc" id="L2356">		resetTimeRangePickerPC(m_activity1StartRange);</span>
<span class="nc" id="L2357">		addChildComponent(m_activity1StartRange);</span>

		// Activity2 Start Time
<span class="nc" id="L2360">		m_activity2StartTime = new TimePickerPC(m_context);</span>
<span class="nc" id="L2361">		resetTimePickerPC(m_activity2StartTime, ACTIVITY2_START_TIME);</span>
<span class="nc" id="L2362">		addChildComponent(m_activity2StartTime);</span>

		// Activity2 Start Range
<span class="nc" id="L2365">		m_activity2StartRange = new TimeRangePickerPC(m_context, ACTIVITY2_START_RANGE);</span>
<span class="nc" id="L2366">		resetTimeRangePickerPC(m_activity2StartRange);</span>
<span class="nc" id="L2367">		addChildComponent(m_activity2StartRange);</span>

		// Skills Assignment Box
<span class="nc bnc" id="L2370" title="All 2 branches missed.">		if (isShowSkillsSection()) {</span>
<span class="nc" id="L2371">			m_skillsAssignmentBox = new AssignmentBoxPC(context);</span>
<span class="nc bnc" id="L2372" title="All 2 branches missed.">			if (isAccessibilityComplianceMode()) {</span>
<span class="nc" id="L2373">				m_skillsAssignmentBox.setWrapperRegion(false);</span>
<span class="nc" id="L2374">				m_skillsAssignmentBox.setUseWrapper(false);</span>
			}
<span class="nc" id="L2376">			m_skillsAssignmentBox.setName(&quot;skills_assignmentbox&quot;);</span>
<span class="nc" id="L2377">			addChildComponent(m_skillsAssignmentBox);</span>
		}
<span class="nc" id="L2379">	}</span>

	/**
	 * Create a list of DefaultNodeData nodes for use in an AssignmentBox's left
	 * or right lists.
	 *
	 * @param itemIDs
	 *            ID's to put in the nodes
	 * @param itemNames
	 *            Names corresponding to the IDs
	 * @param itemDescs
	 *            Descriptions corresponding to the IDs
	 * @return A list of DefaultNodeData nodes
	 */
	private ArrayList makeAssignmentNodeList(ArrayList itemIDs, ArrayList itemNames, ArrayList itemDescs) {
<span class="nc" id="L2394">		ArrayList nodes = new ArrayList(10);</span>
<span class="nc bnc" id="L2395" title="All 6 branches missed.">		if ((itemIDs != null) &amp;&amp; (itemNames != null) &amp;&amp; (itemDescs != null)) {</span>
<span class="nc bnc" id="L2396" title="All 2 branches missed.">			if (itemIDs.size() &gt; 0) {</span>
<span class="nc bnc" id="L2397" title="All 4 branches missed.">				if ((itemIDs.size() == itemNames.size()) &amp;&amp; (itemIDs.size() == itemDescs.size())) {</span>
<span class="nc" id="L2398">					nodes = new ArrayList(itemIDs.size());</span>
<span class="nc" id="L2399">					for (Iterator itIDs = itemIDs.iterator(), itNames = itemNames.iterator(), itDescs = itemDescs</span>
<span class="nc bnc" id="L2400" title="All 2 branches missed.">							.iterator(); itIDs.hasNext();) {</span>
<span class="nc" id="L2401">						DefaultNodeData node = new DefaultNodeData(((ID) itIDs.next()).toString(),</span>
<span class="nc" id="L2402">								(String) itNames.next(), StringUtil.convertEmptyStringToNBSP((String) itDescs.next()));</span>
<span class="nc" id="L2403">						nodes.add(node);</span>
<span class="nc" id="L2404">					}</span>
				}
			}
		}
<span class="nc" id="L2408">		return nodes;</span>
	}

	/**
	 * Create a list of Skill DefaultNodeData nodes for use in an
	 * AssignmentBox's left or right lists.
	 *
	 * @param items
	 *            Objects (with id's, names, descriptions) to put in the list.
	 * @return A list of DefaultNodeData nodes
	 */
	private ArrayList makeSkillAssignmentNodeList(Collection items) {
<span class="nc" id="L2420">		ArrayList nodes = new ArrayList(10);</span>
<span class="nc bnc" id="L2421" title="All 2 branches missed.">		if (items != null) {</span>
<span class="nc bnc" id="L2422" title="All 2 branches missed.">			if (items.size() &gt; 0) {</span>
<span class="nc" id="L2423">				nodes = new ArrayList(items.size());</span>
<span class="nc bnc" id="L2424" title="All 2 branches missed.">				for (Iterator it = items.iterator(); it.hasNext();) {</span>
<span class="nc" id="L2425">					Skill skill = (Skill) it.next();</span>

<span class="nc" id="L2427">					ID skillSID = skill.getFieldValueID(SkillFieldInfo.SKILL_SID);</span>
<span class="nc bnc" id="L2428" title="All 2 branches missed.">					if (skillSID == null) {</span>
<span class="nc" id="L2429">						skillSID = skill.getID();</span>
					}

<span class="nc" id="L2432">					DefaultNodeData node = new DefaultNodeData(skillSID.toString(), skill.getName(),</span>
<span class="nc" id="L2433">							StringUtil.convertEmptyStringToNBSP(skill.getDescription()));</span>
<span class="nc" id="L2434">					nodes.add(node);</span>
<span class="nc" id="L2435">				}</span>
			}
		}
<span class="nc" id="L2438">		return nodes;</span>
	}

	/**
	 * Determine whether current user is a supervisor. We need this information
	 * in order to determine which content title to show.
	 */
	private void setIsSupervisor() {
<span class="nc" id="L2446">		m_isSupervisor = false;</span>
		try {
<span class="nc" id="L2448">			m_isSupervisor = BidOptionsFilterUtil.isSupervisor(m_context);</span>
<span class="nc" id="L2449">		} catch (Exception ex) {</span>
<span class="nc" id="L2450">			handleUnableToLoadDataError(log, ex);</span>
<span class="nc" id="L2451">		}</span>
<span class="nc" id="L2452">	}</span>

	/**
	 * Get the list of StringsPair options for a dropdown selector.
	 *
	 * @param idStringPairs
	 *            A collection of IDStringPair's to be converted to
	 *            StringsPair's.
	 * @return the list of StringsPair options for the Template Name dropdown
	 *         selector.
	 */
	private List&lt;StringsPair&gt; getStringsPairDDOptions(Collection&lt;IDStringPair&gt; idStringPairs, String anyLabel) {
<span class="nc" id="L2464">		List&lt;StringsPair&gt; list = new ArrayList&lt;StringsPair&gt;(20);</span>
<span class="nc" id="L2465">		list.add(new StringsPair(UNDEFINED_FV, anyLabel));</span>

<span class="nc bnc" id="L2467" title="All 2 branches missed.">		for (IDStringPair idStringPair : idStringPairs) {</span>
<span class="nc" id="L2468">			list.add(new StringsPair(idStringPair.getID().toString(), idStringPair.getString()));</span>
<span class="nc" id="L2469">		}</span>
<span class="nc" id="L2470">		return list;</span>
	}

	/**
	 * Get the list of StringsPair options for the Activity Name dropdown
	 * selector.
	 *
	 * @return the list of StringsPair options for the Activity Name dropdown
	 *         selector.
	 */
	private List getActivityDDOptions() {
<span class="nc" id="L2481">		String anyLabel = i18n(m_rmBundle, RmWebBundleKey.RM_SA_FILTER_ANY_ACTIVITY);</span>
<span class="nc" id="L2482">		ArrayList list = new ArrayList(20);</span>
<span class="nc" id="L2483">		list.add(new StringsPair(UNDEFINED_FV, anyLabel));</span>
<span class="nc bnc" id="L2484" title="All 2 branches missed.">		for (Iterator it = m_activities.iterator(); it.hasNext();) {</span>
<span class="nc" id="L2485">			Activity activity = (Activity) it.next();</span>
<span class="nc" id="L2486">			list.add(new StringsPair(activity.getID().toString(), activity.getName()));</span>
<span class="nc" id="L2487">		}</span>
<span class="nc" id="L2488">		return list;</span>
	}

	/**
	 * Get the list of skills
	 */
	private ArrayList getAvailableSkillsList() {
<span class="nc bnc" id="L2495" title="All 2 branches missed.">		if (m_skills != null) {</span>
<span class="nc" id="L2496">			return new ArrayList(m_skills);</span>
		}
<span class="nc" id="L2498">		return new ArrayList(0);</span>
	}
	public boolean isCloseAfterLoadCustomize() {
<span class="nc" id="L2501">		return isCloseAfterLoadCustomize;</span>
	}

	public void setCloseAfterLoadCustomize(boolean isCloseAfterLoadCustomize) {
<span class="nc" id="L2505">		this.isCloseAfterLoadCustomize = isCloseAfterLoadCustomize;</span>
<span class="nc" id="L2506">	}</span>
	@Override
	public String getJavaScriptInitCode() {
<span class="nc" id="L2509">		StringBuffer jsInit = new StringBuffer(1000);</span>
<span class="nc" id="L2510">		jsInit.append(super.getJavaScriptInitCode());</span>
<span class="nc bnc" id="L2511" title="All 2 branches missed.">		if(isCloseAfterLoadCustomize()){</span>
<span class="nc" id="L2512">			jsInit.append(super.getJSBeforeClose() );</span>
<span class="nc" id="L2513">			jsInit.append(&quot;\nwindow.notifyOpener=true;\n&quot;);</span>
<span class="nc" id="L2514">			jsInit.append(&quot;if(is.chrome)\n&quot;);</span>
<span class="nc" id="L2515">			jsInit.append(&quot;    handleUnload(window);\n&quot;);</span>
<span class="nc" id="L2516">			jsInit.append(&quot;window.close();\n&quot;);</span>
		}
<span class="nc" id="L2518">		return jsInit.toString();</span>
	}
}
</pre><div class="footer"><span class="right">Created with <a href="http://www.eclemma.org/jacoco">JaCoCo</a> 0.7.5.201505241946</span></div></body></html>