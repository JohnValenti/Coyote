<?xml version="1.0" encoding="UTF-8"?><!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd"><html xmlns="http://www.w3.org/1999/xhtml" lang="en"><head><meta http-equiv="Content-Type" content="text/html;charset=UTF-8"/><link rel="stylesheet" href="../.resources/report.css" type="text/css"/><link rel="shortcut icon" href="../.resources/report.gif" type="image/gif"/><title>FlexRequestMakeup.java</title><link rel="stylesheet" href="../.resources/prettify.css" type="text/css"/><script type="text/javascript" src="../.resources/prettify.js"></script></head><body onload="window['PR_TAB_WIDTH']=4;prettyPrint()"><div class="breadcrumb" id="breadcrumb"><span class="info"><a href="../.sessions.html" class="el_session">Sessions</a></span><a href="../index.html" class="el_report">QA Code Coverage</a> &gt; <a href="index.source.html" class="el_package">com.bluepumpkin.ejb.rm.requests.timeoff.model</a> &gt; <span class="el_source">FlexRequestMakeup.java</span></div><h1>FlexRequestMakeup.java</h1><pre class="source lang-java linenums">package com.bluepumpkin.ejb.rm.requests.timeoff.model;

import java.util.ArrayList;
import java.util.Calendar;
import java.util.Collection;
import java.util.Collections;
import java.util.Date;
import java.util.List;

import com.bluepumpkin.common.datatypes.ID;
import com.bluepumpkin.common.datatypes.TimeRange;
import com.bluepumpkin.ejb.bbm.vo.FieldInfo;
import com.bluepumpkin.ejb.bbm.vo.ValueObjectNode;
import com.bluepumpkin.ejb.rm.requests.common.validation.Validatable;
import com.bluepumpkin.ejb.rm.requests.common.validation.ValidationCache;
import com.bluepumpkin.ejb.rm.requests.common.validation.ValidationResult;

public class FlexRequestMakeup extends ValueObjectNode implements Comparable&lt;FlexRequestMakeup&gt;, Validatable {

	private static final long serialVersionUID = 1L;
<span class="nc" id="L21">	private static FieldInfo m_fieldInfo = new FlexRequestMakeupFieldInfo();</span>

<span class="nc" id="L23">	private Collection&lt;ValidationResult&gt; m_validationResults = null;</span>

	public FlexRequestMakeup() {
<span class="nc" id="L26">		super();</span>
<span class="nc" id="L27">	}</span>

	@Override
	protected FieldInfo getFieldInfo() {
<span class="nc" id="L31">		return m_fieldInfo;</span>
	}

	// Getters &amp; Setters

	@Override
	public ID getID() {
<span class="nc" id="L38">		return getFieldValueID(FlexRequestMakeupFieldInfo.FLEXREQUESTMAKEUP_I_ID);</span>
	}

	@Override
	public void setID(ID id) {
<span class="nc" id="L43">		setFieldValue(FlexRequestMakeupFieldInfo.FLEXREQUESTMAKEUP_I_ID, id);</span>
<span class="nc" id="L44">	}</span>

	public ID getTORequestID() {
<span class="nc" id="L47">		return getFieldValueID(FlexRequestMakeupFieldInfo.FLEXREQUESTMAKEUP_I_TIMEOFFREQUESTID);</span>
	}

	public void setTORequestID(ID toRequestID) {
<span class="nc" id="L51">		setFieldValue(FlexRequestMakeupFieldInfo.FLEXREQUESTMAKEUP_I_TIMEOFFREQUESTID, toRequestID);</span>
<span class="nc" id="L52">	}</span>

	public ID getSPID() {
<span class="nc" id="L55">		return getFieldValueID(FlexRequestMakeupFieldInfo.FLEXREQUESTMAKEUP_I_SPID);</span>
	}

	public void setSPID(ID val) {
<span class="nc" id="L59">		setFieldValue(FlexRequestMakeupFieldInfo.FLEXREQUESTMAKEUP_I_SPID, val);</span>
<span class="nc" id="L60">	}</span>

	public Date getStartTime() {
<span class="nc" id="L63">		return getFieldValueDate(FlexRequestMakeupFieldInfo.FLEXREQUESTMAKEUP_D_STARTTIME);</span>
	}

	public void setStartTime(Date val) {
<span class="nc" id="L67">		setFieldValue(FlexRequestMakeupFieldInfo.FLEXREQUESTMAKEUP_D_STARTTIME, val);</span>
<span class="nc" id="L68">	}</span>

	public Date getEndTime() {
<span class="nc" id="L71">		return getFieldValueDate(FlexRequestMakeupFieldInfo.FLEXREQUESTMAKEUP_D_ENDTIME);</span>
	}

	public void setEndTime(Date val) {
<span class="nc" id="L75">		setFieldValue(FlexRequestMakeupFieldInfo.FLEXREQUESTMAKEUP_D_ENDTIME, val);</span>
<span class="nc" id="L76">	}</span>

	public ID getExtBeforeActivityID() {
<span class="nc" id="L79">		return getFieldValueID(FlexRequestMakeupFieldInfo.FLEXREQUESTMAKEUP_I_EXTBEFOREACTIVITYID);</span>
	}

	public void setExtBeforeActivityID(ID val) {
<span class="nc" id="L83">		setFieldValue(FlexRequestMakeupFieldInfo.FLEXREQUESTMAKEUP_I_EXTBEFOREACTIVITYID, val);</span>
<span class="nc" id="L84">	}</span>

	public int getExtBeforeGap() {
<span class="nc" id="L87">		return getFieldValueInt(FlexRequestMakeupFieldInfo.FLEXREQUESTMAKEUP_N_EXTBEFOREGAP);</span>
	}

	public void setExtBeforeGap(int val) {
<span class="nc" id="L91">		setFieldValue(FlexRequestMakeupFieldInfo.FLEXREQUESTMAKEUP_N_EXTBEFOREGAP, val);</span>
<span class="nc" id="L92">	}</span>

	public int getExtBeforeDuration() {
<span class="nc" id="L95">		return getFieldValueInt(FlexRequestMakeupFieldInfo.FLEXREQUESTMAKEUP_N_EXTBEFOREDURATION);</span>
	}

	public void setExtBeforeDuration(int val) {
<span class="nc" id="L99">		setFieldValue(FlexRequestMakeupFieldInfo.FLEXREQUESTMAKEUP_N_EXTBEFOREDURATION, val);</span>
<span class="nc" id="L100">	}</span>

	public ID getExtAfterActivityID() {
<span class="nc" id="L103">		return getFieldValueID(FlexRequestMakeupFieldInfo.FLEXREQUESTMAKEUP_I_EXTAFTERACTIVITYID);</span>
	}

	public void setExtAfterActivityID(ID val) {
<span class="nc" id="L107">		setFieldValue(FlexRequestMakeupFieldInfo.FLEXREQUESTMAKEUP_I_EXTAFTERACTIVITYID, val);</span>
<span class="nc" id="L108">	}</span>

	public void setExtAfterGap(int val) {
<span class="nc" id="L111">		setFieldValue(FlexRequestMakeupFieldInfo.FLEXREQUESTMAKEUP_N_EXTAFTERGAP, val);</span>
<span class="nc" id="L112">	}</span>

	public int getExtAfterGap() {
<span class="nc" id="L115">		return getFieldValueInt(FlexRequestMakeupFieldInfo.FLEXREQUESTMAKEUP_N_EXTAFTERGAP);</span>
	}

	public void setExtAfterDuration(int val) {
<span class="nc" id="L119">		setFieldValue(FlexRequestMakeupFieldInfo.FLEXREQUESTMAKEUP_N_EXTAFTERDURATION, val);</span>
<span class="nc" id="L120">	}</span>

	public int getExtAfterDuration() {
<span class="nc" id="L123">		return getFieldValueInt(FlexRequestMakeupFieldInfo.FLEXREQUESTMAKEUP_N_EXTAFTERDURATION);</span>
	}

	/**
	 * Main shift start time (i.e. excluded extensions)
	 * @return
	 */
	public Date getShiftStartTime() {
<span class="nc" id="L131">		return getFieldValueDate(FlexRequestMakeupFieldInfo.FLEXREQUESTMAKEUP_D_SHIFTSTARTTIME);</span>
	}

	public void setShiftStartTime(Date val) {
<span class="nc" id="L135">		setFieldValue(FlexRequestMakeupFieldInfo.FLEXREQUESTMAKEUP_D_SHIFTSTARTTIME, val);</span>
<span class="nc" id="L136">	}</span>

	/**
	 * Main shift end time (i.e. excluded extensions)
	 * @return
	 */
	public Date getShiftEndTime() {
<span class="nc" id="L143">		return getFieldValueDate(FlexRequestMakeupFieldInfo.FLEXREQUESTMAKEUP_D_SHIFTENDTIME);</span>
	}

	public void setShiftEndTime(Date val) {
<span class="nc" id="L147">		setFieldValue(FlexRequestMakeupFieldInfo.FLEXREQUESTMAKEUP_D_SHIFTENDTIME, val);</span>
<span class="nc" id="L148">	}</span>

	public ID getShiftAssignmentID() {
<span class="nc" id="L151">		return getFieldValueID(FlexRequestMakeupFieldInfo.FLEXREQUESTMAKEUP_I_SHIFTASSIGNMENTID);</span>
	}

	public void setShiftAssignmentID(ID val) {
<span class="nc" id="L155">		setFieldValue(FlexRequestMakeupFieldInfo.FLEXREQUESTMAKEUP_I_SHIFTASSIGNMENTID, val);</span>
<span class="nc" id="L156">	}</span>

	// Child objects

	/**
	 * Returns a list of FlexRequestMakeups associated with this request, sorted by their STARTTIME.
	 */
	@SuppressWarnings(&quot;unchecked&quot;)
	public Collection&lt;FlexReqMakeupGap&gt; getFlexReqMakeupGaps() {
<span class="nc" id="L165">		List&lt;FlexReqMakeupGap&gt; flexReqMakeupGaps = new ArrayList&lt;FlexReqMakeupGap&gt;(getChildObjects(FlexRequestMakeupFieldInfo.FLEX_GAP_CHILD_TYPE));</span>
<span class="nc" id="L166">		Collections.sort(flexReqMakeupGaps);</span>

<span class="nc" id="L168">		return flexReqMakeupGaps;</span>
	}
	public void setFlexReqMakeupGaps(Collection&lt;FlexReqMakeupGap&gt; gaps) {
<span class="nc" id="L171">		deleteAllChildren(FlexRequestMakeupFieldInfo.FLEX_GAP_CHILD_TYPE);</span>
<span class="nc bnc" id="L172" title="All 2 branches missed.">		for (FlexReqMakeupGap gap : gaps) {</span>
<span class="nc" id="L173">			createChildObject(FlexRequestMakeupFieldInfo.FLEX_GAP_CHILD_TYPE, gap);</span>
<span class="nc" id="L174">		}</span>
<span class="nc" id="L175">	}</span>

	public void addFlexReqMakeupGap(FlexReqMakeupGap gap) {
<span class="nc" id="L178">		createChildObject(FlexRequestMakeupFieldInfo.FLEX_GAP_CHILD_TYPE, gap);</span>
<span class="nc" id="L179">	}</span>
	public void updateFlexReqMakeupGap(FlexReqMakeupGap gap) {
<span class="nc" id="L181">		updateChildObject(FlexRequestMakeupFieldInfo.FLEX_GAP_CHILD_TYPE, gap);</span>
<span class="nc" id="L182">	}</span>
	public void deleteFlexReqMakeupGap(FlexReqMakeupGap gap) {
<span class="nc" id="L184">		deleteChildObject(FlexRequestMakeupFieldInfo.FLEX_GAP_CHILD_TYPE, gap);</span>
<span class="nc" id="L185">	}</span>


	// Validatable implementation

	/**
	 * @see com.bluepumpkin.ejb.rm.requests.common.validation.Validatable#getValidationResults()
	 */
	@Override
	public Collection&lt;ValidationResult&gt; getValidationResults(boolean entireBranch) {
<span class="nc bnc" id="L195" title="All 2 branches missed.">		if (m_validationResults == null) {</span>
<span class="nc" id="L196">			m_validationResults = new ArrayList&lt;ValidationResult&gt;();</span>
		}
<span class="nc" id="L198">		return m_validationResults;</span>
	}

	/**
	 * @see com.bluepumpkin.ejb.rm.requests.common.validation.Validatable#addValidationResult()
	 */
	@Override
	public void addValidationResult(ValidationResult pValidationResult) {
<span class="nc" id="L206">		getValidationResults(true).add(pValidationResult);</span>
<span class="nc" id="L207">	}</span>

	/**
	 * @see com.bluepumpkin.ejb.rm.requests.common.validation.Validatable#clearValidationResults()
	 */
	@Override
	public void clearValidationResults(boolean entireBranch) {
<span class="nc bnc" id="L214" title="All 2 branches missed.">		if (m_validationResults != null)</span>
<span class="nc" id="L215">			m_validationResults.clear();</span>
<span class="nc" id="L216">	}</span>

	/**
	 * @see com.bluepumpkin.ejb.rm.requests.common.validation.Validatable#getValidationCache()
	 */
	@Override
	public ValidationCache getValidationCache() {
<span class="nc" id="L223">		throw new UnsupportedOperationException();</span>
	}

	/**
	 * @see com.bluepumpkin.ejb.rm.requests.common.validation.Validatable#getValidationTimeRanges()
	 */
	@Override
	public Collection&lt;TimeRange&gt; getValidationTimeRanges() {
<span class="nc" id="L231">		return Collections.singleton(new TimeRange(getStartTime(), getEndTime()));</span>
	}

	public TimeRange getExtBeforeTimeRange() {
<span class="nc bnc" id="L235" title="All 2 branches missed.">		if (this.getExtBeforeActivityID() != null) {</span>
<span class="nc" id="L236">			Calendar cal = Calendar.getInstance();</span>
<span class="nc" id="L237">			cal.setTime(this.getShiftStartTime());</span>
<span class="nc" id="L238">			cal.add(Calendar.MINUTE, -(this.getExtBeforeGap()));</span>
<span class="nc" id="L239">			Date extBeforeEnd = cal.getTime();</span>
<span class="nc" id="L240">			cal.add(Calendar.MINUTE, -(this.getExtBeforeDuration()));</span>
<span class="nc" id="L241">			Date extBeforeStart = cal.getTime();</span>

<span class="nc" id="L243">			return new TimeRange(extBeforeStart, extBeforeEnd);</span>
		}

<span class="nc" id="L246">		return null;</span>
	}

	public TimeRange getExtAfterTimeRange() {
<span class="nc bnc" id="L250" title="All 2 branches missed.">		if (this.getExtAfterActivityID() != null) {</span>
<span class="nc" id="L251">			Calendar cal = Calendar.getInstance();</span>
<span class="nc" id="L252">			cal.setTime(this.getShiftEndTime());</span>
<span class="nc" id="L253">			cal.add(Calendar.MINUTE, this.getExtAfterGap());</span>
<span class="nc" id="L254">			Date extAfterStart = cal.getTime();</span>
<span class="nc" id="L255">			cal.add(Calendar.MINUTE, this.getExtAfterDuration());</span>
<span class="nc" id="L256">			Date extAfterEnd = cal.getTime();</span>

<span class="nc" id="L258">			return new TimeRange(extAfterStart, extAfterEnd);</span>
		}

<span class="nc" id="L261">		return null;</span>
	}

	/**
	 * Compare only the start dates of the two makeups.
	 */
	@Override
	public int compareTo(FlexRequestMakeup obj) {
<span class="nc" id="L269">		FlexRequestMakeup flexRequestMakeup = (FlexRequestMakeup) obj;</span>

<span class="nc bnc" id="L271" title="All 4 branches missed.">		if (flexRequestMakeup == null || flexRequestMakeup.getStartTime() == null) {</span>
<span class="nc bnc" id="L272" title="All 2 branches missed.">			if (getStartTime() == null) {</span>
<span class="nc" id="L273">				return 0;</span>
			} else {
<span class="nc" id="L275">				return 1;</span>
			}
		}

<span class="nc bnc" id="L279" title="All 2 branches missed.">		if (getStartTime() == null) {</span>
<span class="nc bnc" id="L280" title="All 4 branches missed.">			if (flexRequestMakeup == null || flexRequestMakeup.getStartTime() == null) {</span>
<span class="nc" id="L281">				return 0;</span>
			} else {
<span class="nc" id="L283">				return -1;</span>
			}
		}

<span class="nc" id="L287">		long diff = (getStartTime().getTime() - flexRequestMakeup.getStartTime().getTime());</span>
<span class="nc bnc" id="L288" title="All 2 branches missed.">		if (diff == 0) {</span>
<span class="nc" id="L289">			return 0;</span>
<span class="nc bnc" id="L290" title="All 2 branches missed.">		} else if (diff &lt; 0) {</span>
<span class="nc" id="L291">			return -1;</span>
		} else {
<span class="nc" id="L293">			return 1;</span>
		}
	}
}
</pre><div class="footer"><span class="right">Created with <a href="http://www.eclemma.org/jacoco">JaCoCo</a> 0.7.5.201505241946</span></div></body></html>