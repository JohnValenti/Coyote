<?xml version="1.0" encoding="UTF-8"?><!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd"><html xmlns="http://www.w3.org/1999/xhtml" lang="en"><head><meta http-equiv="Content-Type" content="text/html;charset=UTF-8"/><link rel="stylesheet" href="../.resources/report.css" type="text/css"/><link rel="shortcut icon" href="../.resources/report.gif" type="image/gif"/><title>MyTimeAction.java</title><link rel="stylesheet" href="../.resources/prettify.css" type="text/css"/><script type="text/javascript" src="../.resources/prettify.js"></script></head><body onload="window['PR_TAB_WIDTH']=4;prettyPrint()"><div class="breadcrumb" id="breadcrumb"><span class="info"><a href="../.sessions.html" class="el_session">Sessions</a></span><a href="../index.html" class="el_report">QA Code Coverage</a> &gt; <a href="index.source.html" class="el_package">com.bluepumpkin.web.am.timecollection</a> &gt; <span class="el_source">MyTimeAction.java</span></div><h1>MyTimeAction.java</h1><pre class="source lang-java linenums">package com.bluepumpkin.web.am.timecollection;

import com.bluepumpkin.web.am.keys.AmJavaScriptFileID;
import com.bluepumpkin.web.am.l10n.AmWebBundleKey;
import com.witness.web.uif.base.Message;
import com.witness.web.uif.pagecomponent.message.MessagePC;
import com.witness.web.uif.system.RequestContext;

/**
 * Title:        Blue Pumpkin Software Activity Management
 * Description:  My Time page model
 * Copyright:    Copyright (c) 2001
 * Company:      Blue Pumpkin Software, inc
 * @author       Swati Tewari
 * @version      1.0
 */
public class MyTimeAction extends MyTimeModel{
<span class="fc" id="L18">	protected static int subsequentTimeoutLength = -1;</span>
	private static final int maxPullCount = 24;
<span class="nc" id="L20">	private boolean m_bInitialized = false;</span>



	public MyTimeAction(RequestContext context) throws Exception {
<span class="nc" id="L25">		super(context,MyTimeModel.GET_STATUS_MODEL);</span>
<span class="nc" id="L26">		setName(&quot;hiddenIframeMediator&quot;);</span>
<span class="nc" id="L27">		setJSMediator(AmJavaScriptFileID.MEDIATOR_HIDDENIFRAME);</span>
<span class="nc" id="L28">	}</span>

	public static MyTimeAction getInstance(RequestContext context)throws Exception{
<span class="nc" id="L31">		MyTimeAction model = (MyTimeAction) context.getAttribute(RequestContext.REQUEST_SCOPE,</span>
							MyTimeModel.MODEL_KEY);
<span class="nc bnc" id="L33" title="All 2 branches missed.">		if (model==null){</span>
			//create a new model
<span class="nc" id="L35">			model = new MyTimeAction(context);</span>
			// Cache model
<span class="nc" id="L37">			context.setAttribute(RequestContext.REQUEST_SCOPE, MyTimeModel.MODEL_KEY, model);</span>
		}
<span class="nc" id="L39">		model.populateModel(context);</span>

<span class="nc" id="L41">		return model;</span>
	}

	/**
	 * Make sure that the model is populated
	 */
	private void populateModel(RequestContext context) {
<span class="nc bnc" id="L48" title="All 2 branches missed.">		if ( m_bInitialized )</span>
<span class="nc" id="L49">			return;</span>
<span class="nc" id="L50">		m_bInitialized = true;</span>

<span class="nc bnc" id="L52" title="All 9 branches missed.">		switch ( m_errorCode ) {</span>
			case MyTimeModel.NO_START_SHIFT:
<span class="nc" id="L54">				addPageMessage(Message.ERROR_TYPE,</span>
						AmWebBundleKey.MSG_NO_OPENSHIFT, AmWebBundleKey.BUNDLE_NAME);
<span class="nc" id="L56">				break;</span>
			case MyTimeModel.ERROR_ENDING_SHIFT:
<span class="nc" id="L58">				addPageMessage(Message.ERROR_TYPE,</span>
					AmWebBundleKey.MSG_ERRENDINGSHIFT, AmWebBundleKey.BUNDLE_NAME);
<span class="nc" id="L60">				break;</span>
			case MyTimeModel.ERROR_CHANGING_SHIFT:
<span class="nc" id="L62">				addPageMessage(Message.ERROR_TYPE,</span>
					AmWebBundleKey.MSG_ERRCHANGINGSHIFT, AmWebBundleKey.BUNDLE_NAME);
<span class="nc" id="L64">				break;</span>
			case MyTimeModel.SHIFT_ENDED:
<span class="nc" id="L66">				addPageMessage(Message.RESPONSE_TYPE,</span>
					AmWebBundleKey.MSG_ENDSHIFT, AmWebBundleKey.BUNDLE_NAME);
<span class="nc" id="L68">				break;</span>
			case MyTimeModel.NO_ACTIVITY:
<span class="nc" id="L70">				addPageMessage(Message.ERROR_TYPE,</span>
					AmWebBundleKey.MSG_NO_ACTIVITY, AmWebBundleKey.BUNDLE_NAME);
<span class="nc" id="L72">				break;</span>
			case MyTimeModel.ACTIVITY_CHANGED:
<span class="nc" id="L74">				addPageMessage(Message.RESPONSE_TYPE,</span>
					AmWebBundleKey.MSG_SHIFTCHANGED, AmWebBundleKey.BUNDLE_NAME);
<span class="nc" id="L76">				break;</span>
			case MyTimeModel.ACTIVITY_STARTED:
<span class="nc" id="L78">				addPageMessage(Message.RESPONSE_TYPE,</span>
					AmWebBundleKey.MSG_SHIFTSTARTED, AmWebBundleKey.BUNDLE_NAME);
<span class="nc" id="L80">				break;</span>
			case MyTimeModel.ACTIVITY_DELETED:
<span class="nc" id="L82">				addPageMessage(Message.RESPONSE_TYPE,</span>
					AmWebBundleKey.MSG_ERRACTIVITYDELETED, AmWebBundleKey.BUNDLE_NAME);
				break;
		}
<span class="nc" id="L86">		m_errorCode = 0;</span>
<span class="nc" id="L87">	}</span>

	/**
	 * Set the pull count.
	 */
	public void setPullCount(int cnt) {
<span class="nc" id="L93">		m_iPullCount = cnt + 1;</span>
<span class="nc" id="L94">	}</span>

	public int getPullCount() {
<span class="nc" id="L97">		return m_iPullCount;</span>
	}

	/**
	 * Override parent in order to render the messages without inner scrollbar
	 */
	protected MessagePC getMessagePC() {
<span class="nc" id="L104">		MessagePC msgPC = super.getMessagePC();</span>
<span class="nc" id="L105">		msgPC.setUseWrapper(false);</span>
<span class="nc" id="L106">		return msgPC;</span>
	}

	/**
	 * Return the JavaScript init code required by Page model.
	 *
	 * Default behavior is to retrieve sub-component JavaScript Init code
	 */
	public String getJavaScriptInitCode() {

		/*StringBuffer jsInitCode = new StringBuffer(512);

		// Add sub-component JavaScript code first
		jsInitCode.append(super.getJavaScriptInitCode()).append(&quot;\n&quot;);*/
<span class="nc" id="L120">		return &quot;hiddenIframeMediator = new HiddenIframeMediator( \&quot;hiddenIframeMediator\&quot; );\n&quot; +</span>
					&quot;top.hiddenIframeMediator = hiddenIframeMediator;\n&quot; +
					&quot;top.hiddenIframeMediator.bind();\n&quot;;

		//return jsInitCode.toString();
	}

	/**
	 * Return URL for HTML Form Action
	 */
	public String getFormAction() {
<span class="nc" id="L131">		return &quot;hiddenform&quot;;</span>
	}

	/**
	 * Returns the html string which renders all the page messages
	 * in a formatted table.
	 *
	 * @param context is the Request Context object, used to get the locale for
	 * localizing the message text.
	 */

	public String displayAllMessages(RequestContext context) {
<span class="nc" id="L143">		MessagePC msgPC = getMessagePC();</span>
<span class="nc" id="L144">		msgPC.setWidth(&quot;100%&quot;);</span>
<span class="nc" id="L145">		msgPC.setHeight(&quot;100%&quot;);</span>
<span class="nc" id="L146">		return super.displayAllMessages(context);</span>
	}
}
</pre><div class="footer"><span class="right">Created with <a href="http://www.eclemma.org/jacoco">JaCoCo</a> 0.7.5.201505241946</span></div></body></html>