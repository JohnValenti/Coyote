<?xml version="1.0" encoding="UTF-8"?><!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd"><html xmlns="http://www.w3.org/1999/xhtml" lang="en"><head><meta http-equiv="Content-Type" content="text/html;charset=UTF-8"/><link rel="stylesheet" href="../.resources/report.css" type="text/css"/><link rel="shortcut icon" href="../.resources/report.gif" type="image/gif"/><title>TOSummaryPM.java</title><link rel="stylesheet" href="../.resources/prettify.css" type="text/css"/><script type="text/javascript" src="../.resources/prettify.js"></script></head><body onload="window['PR_TAB_WIDTH']=4;prettyPrint()"><div class="breadcrumb" id="breadcrumb"><span class="info"><a href="../.sessions.html" class="el_session">Sessions</a></span><a href="../index.html" class="el_report">QA Code Coverage</a> &gt; <a href="index.source.html" class="el_package">com.bluepumpkin.web.rm.people.timeoffsummary</a> &gt; <span class="el_source">TOSummaryPM.java</span></div><h1>TOSummaryPM.java</h1><pre class="source lang-java linenums">package com.bluepumpkin.web.rm.people.timeoffsummary;

import java.util.Calendar;
import java.util.Collection;
import java.util.Collections;
import java.util.Date;
import java.util.HashMap;
import java.util.HashSet;
import java.util.List;
import java.util.Map;
import java.util.ResourceBundle;

import com.bluepumpkin.common.datatypes.ID;
import com.bluepumpkin.ejb.bbm.BbmManagerFactory;
import com.bluepumpkin.ejb.bbm.workresource.model.EmployeeName;
import com.bluepumpkin.ejb.rm.requests.timeoff.requiredpayperiodhours.RequiredPayPeriodHours;
import com.bluepumpkin.ejb.rm.requests.timeoff.requiredpayperiodhours.RequiredPayPeriodHoursUtil;
import com.bluepumpkin.web.bbm.employee.EmployeeModelHandler;
import com.bluepumpkin.web.bbm.people.PeoplePM;
import com.bluepumpkin.web.bbm.people.PeopleUtil;
import com.bluepumpkin.web.fs.l10n.FsWebBundleKey;
import com.bluepumpkin.web.fs.schedule.summary.FlexTimeSummaryData;
import com.bluepumpkin.web.fs.schedule.summary.FlexTimeSummaryPC;
import com.bluepumpkin.web.fs.schedule.summary.OneWayShiftSwapSummaryData;
import com.bluepumpkin.web.fs.schedule.summary.OneWayShiftSwapSummaryPC;
import com.bluepumpkin.web.fs.schedule.summary.RequiredPayPeriodHoursSummaryPC;
import com.bluepumpkin.web.fs.schedule.summary.ScheduleSummaryMH;
import com.bluepumpkin.web.fs.schedule.summary.TimeBankSummaryData;
import com.bluepumpkin.web.fs.schedule.summary.TimeBankSummaryPC;
import com.bluepumpkin.web.fs.schedule.summary.TimeOffSummaryPC;
import com.bluepumpkin.web.rm.l10n.RmWebBundleKey;
import com.witness.ejb.core.licensing.LicenseKeys;
import com.witness.ejb.core.security.PrivilegeKeys;
import com.witness.ejb.core.security.model.User;
import com.witness.web.uif.pagecomponent.container.CollapsibleContainerPC;
import com.witness.web.uif.pagecomponent.picker.date.DatePickerPC;
import com.witness.web.uif.pagecomponent.toolbar.ToolbarUtil;
import com.witness.web.uif.pagemodel.ContainersInRowsPM;
import com.witness.web.uif.pagemodel.PageModel;
import com.witness.web.uif.pagemodel.WorkpaneMultiColPM;
import com.witness.web.uif.pagemodel.WorkpanePageModel;
import com.witness.web.uif.system.RequestContext;
import com.witness.web.uif.util.ContainerList;
import com.witness.web.uif.util.HtmlUtil;
import com.witness.web.uif.util.js.JSUtil;

/**
 * People Time-off Summary Page
 * To check each employee's Time-off summary
 * @author rsun
 */
public class TOSummaryPM extends WorkpanePageModel implements ContainersInRowsPM, PeoplePM {
	private final ResourceBundle m_bundle;
	private final ContainerList m_containerList;
	private final boolean m_showTimeBank;
	private final boolean m_showTOSummary;
	private final boolean m_showFlexTimeSummary;
	private final boolean m_showOneWayShiftSwapSummary;
	private final DatePickerPC m_inputDatePicker;
	private List&lt;RequiredPayPeriodHours&gt; payPeriods;

	public TOSummaryPM(RequestContext context) {
<span class="nc" id="L63">		super(context, PageModel.FRAMED_MODEL);</span>
<span class="nc" id="L64">		m_bundle = m_localizer.getBundle(RmWebBundleKey.BUNDLE_NAME);</span>
<span class="nc" id="L65">		m_containerList = new ContainerList(this, 10);//default initialCapacity of ArrayList</span>
<span class="nc" id="L66">		m_showTimeBank = ScheduleSummaryMH.checkLicense(LicenseKeys.APP_TIME_BANK);</span>
<span class="nc" id="L67">		m_showTOSummary = m_context.getUser().isAuthorized(PrivilegeKeys.TOM_VIEWAVAILABLETIMEOFF);</span>
<span class="nc" id="L68">		m_showFlexTimeSummary = m_context.getUser().isAuthorized(PrivilegeKeys.FT_VIEWREQUESTSFOREMPLOYEE);</span>
<span class="nc" id="L69">		m_showOneWayShiftSwapSummary = m_context.getUser().isAuthorized(PrivilegeKeys.SS_VIEWREQUESTSFOREMPLOYEE);</span>
<span class="nc" id="L70">		m_inputDatePicker = new DatePickerPC(m_context, &quot;inputDate&quot;);</span>
<span class="nc" id="L71">		addChildComponent(m_inputDatePicker);//for extraction</span>
<span class="nc" id="L72">        setDefaultPageIDSize(10);</span>
<span class="nc" id="L73">	}</span>

	/**
	 * Return Page Model Instance
	 */
	public static PageModel getInstance(RequestContext context) {
<span class="nc" id="L79">		return getInstance(context, TOSummaryPM.class);</span>
	}

	@Override
	protected void loadData() throws Exception {
		//loadData() is after PageModel.extractParameters() where it gets SelectedIDs

<span class="nc" id="L86">        Collection&lt;ID&gt; empIDs = getPageIDs();</span>
<span class="nc" id="L87">		ID firstEmpID = null;</span>
<span class="nc bnc" id="L88" title="All 4 branches missed.">		if (empIDs != null &amp;&amp; !empIDs.isEmpty()) {</span>
<span class="nc" id="L89">			firstEmpID = empIDs.iterator().next();</span>
		}

<span class="nc bnc" id="L92" title="All 2 branches missed.">		boolean isMultiSelection = empIDs.size() &gt; 1;</span>
		Map empNames;
<span class="nc bnc" id="L94" title="All 2 branches missed.">		if (isMultiSelection) {//Multi-selection, show Names for each selected employee</span>
<span class="nc" id="L95">			empNames = EmployeeModelHandler.getEmployeeNamesByIDs(m_context, empIDs);</span>
		} else {//Single-selection, do not show Name, put it null
<span class="nc" id="L97">			empNames = Collections.emptyMap();</span>
		}

<span class="nc bnc" id="L100" title="All 2 branches missed.">		if (isMultiSelection) {</span>
			//When multi-selection, the user inputs 1 date picker instead of
			// many toYear drop down list boxes for each employee.
<span class="nc" id="L103">			m_inputDatePicker.setOnChangeJS(JSUtil.REFRESH_PAGE);</span>
<span class="nc bnc" id="L104" title="All 2 branches missed.">			if (m_inputDatePicker.getDate() == null) {</span>
<span class="nc" id="L105">				m_inputDatePicker.setDate(new Date());</span>
			}
			//m_containerList.add(m_inputDatePicker);
<span class="nc" id="L108">			m_contentTitlePC.setActiveComponent(m_inputDatePicker);</span>
<span class="nc bnc" id="L109" title="All 2 branches missed.">		} else if (firstEmpID != null) {</span>
			// Required Pay Period Hours should get the list of pay periods as of now
<span class="nc" id="L111">			User user = m_context.getUser();</span>
<span class="nc" id="L112">			payPeriods = RequiredPayPeriodHoursUtil.getListRequiredPayPeriodHoursTimeRangeFuturePastForDisplay(user, firstEmpID,</span>
					new Date(), RequiredPayPeriodHoursSummaryPC.NUMBER_OF_PERIODS_PAST_AND_FUTURE);
		}

<span class="nc" id="L116">		HashMap tbSummaries=null;</span>
<span class="nc bnc" id="L117" title="All 2 branches missed.">		if (empIDs.size() &gt; 0) {</span>
<span class="nc" id="L118">			tbSummaries = ScheduleSummaryMH.getTimeBankingSummaries(m_context, empIDs);</span>
		}
<span class="nc" id="L120">		HashMap empTOSummaryMap = null;</span>
<span class="nc bnc" id="L121" title="All 4 branches missed.">		if (m_showTOSummary &amp;&amp; isMultiSelection) {</span>
<span class="nc" id="L122">			empTOSummaryMap = ScheduleSummaryMH.getTimeOffSummary(m_context, empIDs, m_inputDatePicker.getDate(), false);</span>
		}

<span class="nc" id="L125">		Date rpphAsOfDate = getRequiredPayPeriodHoursAsOfDate(empIDs, payPeriods);</span>
<span class="nc" id="L126">		Map&lt;ID, RequiredPayPeriodHours&gt; requiredPayPeriodHoursMap =</span>
<span class="nc" id="L127">				RequiredPayPeriodHoursUtil.getListRequiredPayPeriodHoursForEmployeeList(m_context.getUser(), empIDs, rpphAsOfDate);</span>

<span class="nc" id="L129">		Map&lt;ID, OneWayShiftSwapSummaryData&gt; oneWayShiftSwapEmpCountMap = null;</span>
<span class="nc bnc" id="L130" title="All 2 branches missed.">		if(m_showOneWayShiftSwapSummary) {</span>
<span class="nc" id="L131">			oneWayShiftSwapEmpCountMap = ScheduleSummaryMH.getOneWayShiftSwapSummary(m_context, new HashSet&lt;ID&gt;(empIDs));</span>
		}
<span class="nc" id="L133">		Map&lt;ID, FlexTimeSummaryData&gt; flexTimeEmpCountMap = null;</span>
<span class="nc bnc" id="L134" title="All 2 branches missed.">		if(m_showFlexTimeSummary) {</span>
<span class="nc" id="L135">			flexTimeEmpCountMap = ScheduleSummaryMH.getFlexTimeSummary(m_context, new HashSet&lt;ID&gt;(empIDs));</span>
		}

		TimeOffSummaryPC toSummaryPC;
		FlexTimeSummaryPC flexTimeSummaryPC;
		OneWayShiftSwapSummaryPC oneWayShiftSwapSummaryPC;
		TimeBankSummaryPC tbSummaryPC;

<span class="nc bnc" id="L143" title="All 2 branches missed.">		for (ID empID: empIDs) {</span>
<span class="nc" id="L144">			EmployeeName empName = (EmployeeName) empNames.get(empID);</span>
<span class="nc bnc" id="L145" title="All 2 branches missed.">			String nameStr = empName == null ? null : m_localizer.formatName(empName);</span>

			//Add the Time Off Summary container
<span class="nc" id="L148">			toSummaryPC = null;</span>
<span class="nc bnc" id="L149" title="All 2 branches missed.">			if (m_showTOSummary) {</span>
<span class="nc" id="L150">				toSummaryPC = new TimeOffSummaryPC(m_context, empID, nameStr, false);</span>
<span class="nc" id="L151">				toSummaryPC.extractParameters(m_context.getRequest());</span>
<span class="nc bnc" id="L152" title="All 2 branches missed.">				if (isMultiSelection) {//When multi-selection, set the input date</span>
<span class="nc" id="L153">					toSummaryPC.setInputDate(m_inputDatePicker.getDate());</span>
<span class="nc" id="L154">					Calendar timeOffYearStart = ScheduleSummaryMH.getEmployeeYearStart(m_context, empID, m_inputDatePicker.getDate(), toSummaryPC.getTimeOffYear());</span>
<span class="nc" id="L155">					toSummaryPC.init((Collection) empTOSummaryMap.get(empID), timeOffYearStart);</span>
<span class="nc" id="L156">				}else{</span>
<span class="nc" id="L157">					toSummaryPC.init();</span>
				}
			}

			// Add the Required Pay Period Hours Summary container
<span class="nc" id="L162">			RequiredPayPeriodHoursSummaryPC requiredPayPeriodHoursSummaryPC = createRequiredPayPeriodHoursSummaryForEmployee(</span>
					empID, nameStr, requiredPayPeriodHoursMap, isMultiSelection, rpphAsOfDate);

			//Add the Flex Time Summary container
<span class="nc" id="L166">			flexTimeSummaryPC = null;</span>
<span class="nc bnc" id="L167" title="All 4 branches missed.">			if(flexTimeEmpCountMap != null &amp;&amp; m_showFlexTimeSummary) {</span>
<span class="nc" id="L168">				FlexTimeSummaryData flexTimeSumData = flexTimeEmpCountMap.get(empID);</span>
<span class="nc bnc" id="L169" title="All 2 branches missed.">				if(flexTimeSumData != null) {</span>
<span class="nc" id="L170">					flexTimeSummaryPC = new FlexTimeSummaryPC(m_context, empID, nameStr, flexTimeSumData);</span>
				}
			}

			//Add the One Way Shift Swap Summary container
<span class="nc" id="L175">			oneWayShiftSwapSummaryPC = null;</span>
<span class="nc bnc" id="L176" title="All 4 branches missed.">			if(oneWayShiftSwapEmpCountMap != null &amp;&amp; m_showOneWayShiftSwapSummary) {</span>
<span class="nc" id="L177">				OneWayShiftSwapSummaryData oneWayShiftSwapSumData = oneWayShiftSwapEmpCountMap.get(empID);</span>
<span class="nc bnc" id="L178" title="All 2 branches missed.">				if(oneWayShiftSwapSumData != null) {</span>
<span class="nc" id="L179">					oneWayShiftSwapSummaryPC = new OneWayShiftSwapSummaryPC(m_context, empID, nameStr, oneWayShiftSwapSumData);</span>
				}
			}

			//Add the Time Bank Summary container
<span class="nc" id="L184">			TimeBankSummaryData tbSummaryData = (TimeBankSummaryData)tbSummaries.get(empID);</span>
<span class="nc bnc" id="L185" title="All 4 branches missed.">			boolean hasTimeBank = m_showTimeBank &amp;&amp; (tbSummaryData!=null);</span>
<span class="nc" id="L186">			tbSummaryPC = null;</span>
<span class="nc bnc" id="L187" title="All 2 branches missed.">			if (hasTimeBank) {</span>
<span class="nc" id="L188">				tbSummaryPC = new TimeBankSummaryPC(m_context, empID, nameStr, false, tbSummaryData);</span>
<span class="nc" id="L189">				tbSummaryPC.extractParameters(m_context.getRequest());</span>
			}

			//multi-selection requires an additional container to wrap the page components
<span class="nc bnc" id="L193" title="All 2 branches missed.">			if (isMultiSelection) {</span>
<span class="nc" id="L194">				IndentedCollapsibleContainerPC container = new IndentedCollapsibleContainerPC(m_context);</span>
<span class="nc" id="L195">				container.setName(&quot;container_&quot; + empID);</span>
<span class="nc" id="L196">				container.setTitle(nameStr);</span>
<span class="nc" id="L197">				container.setIsBorderEnabled(true);</span>
<span class="nc bnc" id="L198" title="All 2 branches missed.">				if (isAccessibilityComplianceMode()) {</span>
<span class="nc" id="L199">					String overflowHighlighting =  &quot;overflow:auto&quot;;</span>
<span class="nc" id="L200">					container.setWrapperStyle(overflowHighlighting);</span>
				}
				
<span class="nc bnc" id="L203" title="All 2 branches missed.">				if (toSummaryPC != null) {</span>
<span class="nc" id="L204">					toSummaryPC.setToggleable(false);</span>
<span class="nc" id="L205">					container.addComponent(toSummaryPC);</span>
				}
<span class="nc bnc" id="L207" title="All 2 branches missed.">				if (requiredPayPeriodHoursSummaryPC != null) {</span>
<span class="nc" id="L208">					requiredPayPeriodHoursSummaryPC.setToggleable(false);</span>
<span class="nc" id="L209">					container.addComponent(requiredPayPeriodHoursSummaryPC);</span>
				}
<span class="nc bnc" id="L211" title="All 2 branches missed.">				if(flexTimeSummaryPC != null) {</span>
<span class="nc" id="L212">					flexTimeSummaryPC.setToggleable(false);</span>
<span class="nc" id="L213">					container.addComponent(flexTimeSummaryPC);</span>
				}
<span class="nc bnc" id="L215" title="All 2 branches missed.">				if(oneWayShiftSwapSummaryPC != null) {</span>
<span class="nc" id="L216">					oneWayShiftSwapSummaryPC.setToggleable(false);</span>
<span class="nc" id="L217">					container.addComponent(oneWayShiftSwapSummaryPC);</span>
				}
<span class="nc bnc" id="L219" title="All 2 branches missed.">				if (tbSummaryPC != null) {</span>
<span class="nc" id="L220">					tbSummaryPC.setToggleable(false);</span>
<span class="nc" id="L221">					container.addComponent(tbSummaryPC);</span>
				}
<span class="nc" id="L223">				m_containerList.add(container);</span>
<span class="nc" id="L224">			} else {</span>
				//don't use additional container
<span class="nc bnc" id="L226" title="All 2 branches missed.">				if (toSummaryPC != null) {</span>
<span class="nc" id="L227">					m_containerList.add(toSummaryPC);</span>
				}
<span class="nc bnc" id="L229" title="All 2 branches missed.">				if (requiredPayPeriodHoursSummaryPC != null) {</span>
<span class="nc" id="L230">					m_containerList.add(requiredPayPeriodHoursSummaryPC);</span>
				}
<span class="nc bnc" id="L232" title="All 2 branches missed.">				if (flexTimeSummaryPC != null) {</span>
<span class="nc" id="L233">					m_containerList.add(flexTimeSummaryPC);</span>
				}
<span class="nc bnc" id="L235" title="All 2 branches missed.">				if (oneWayShiftSwapSummaryPC != null) {</span>
<span class="nc" id="L236">					m_containerList.add(oneWayShiftSwapSummaryPC);</span>
				}
<span class="nc bnc" id="L238" title="All 2 branches missed.">				if (tbSummaryPC != null) {</span>
<span class="nc" id="L239">					m_containerList.add(tbSummaryPC);</span>
				}
			}
<span class="nc" id="L242">		}</span>

		//init Common Msg &amp; Title ItemName when multi-selection
<span class="nc" id="L245">		PeopleUtil.initForDisplay(this);</span>
		//init Title ItemName when single selection
<span class="nc bnc" id="L247" title="All 2 branches missed.">		if (this.getSelectedIDSize() == 1) {</span>
<span class="nc" id="L248">			m_contentTitlePC.setItemName(m_localizer.formatName(</span>
<span class="nc" id="L249">					EmployeeModelHandler.getEmployeeNameByID(m_context, this.getSelectedIDObject())</span>
					));
		}
<span class="nc" id="L252">	}</span>

	private Date getRequiredPayPeriodHoursAsOfDate(Collection&lt;ID&gt; empIDs, List&lt;RequiredPayPeriodHours&gt; payPeriods) {
<span class="nc" id="L255">		Date asOfDate = null;</span>
		// single employee should use the posted pay period's date if it exists
<span class="nc bnc" id="L257" title="All 2 branches missed.">		if (empIDs.size() == 1) {</span>
<span class="nc" id="L258">			asOfDate = RequiredPayPeriodHoursSummaryPC.extractRequiredPayPeriod(m_context.getRequest());</span>
<span class="nc" id="L259">			asOfDate = RequiredPayPeriodHoursUtil.getSelectedPayPeriod(payPeriods, asOfDate);</span>
		}
<span class="nc bnc" id="L261" title="All 2 branches missed.">		if (asOfDate == null) {</span>
<span class="nc" id="L262">			asOfDate = m_inputDatePicker.getDate();</span>
		}
<span class="nc bnc" id="L264" title="All 2 branches missed.">		if (asOfDate == null) {</span>
<span class="nc" id="L265">			asOfDate = new Date();</span>
		}
<span class="nc" id="L267">		return asOfDate;</span>
	}

	private RequiredPayPeriodHoursSummaryPC createRequiredPayPeriodHoursSummaryForEmployee(ID empID, String name,
			Map&lt;ID, RequiredPayPeriodHours&gt; requiredPayPeriodHoursMap, boolean isMultiSelection, Date rpphAsOfDate) {
<span class="nc" id="L272">		RequiredPayPeriodHoursSummaryPC summaryPC = null;</span>
<span class="nc bnc" id="L273" title="All 2 branches missed.">		if (requiredPayPeriodHoursMap == null) {</span>
<span class="nc" id="L274">			return summaryPC;</span>
		}
<span class="nc" id="L276">		RequiredPayPeriodHours requiredPayPeriodData = requiredPayPeriodHoursMap.get(empID);</span>
<span class="nc bnc" id="L277" title="All 4 branches missed.">		boolean hasPayPeriods = payPeriods != null &amp;&amp; !payPeriods.isEmpty();</span>
		// it is possible to have no data on rpphAsOfDate but we still want to show the drop down
<span class="nc bnc" id="L279" title="All 4 branches missed.">		if (requiredPayPeriodData != null || hasPayPeriods) {</span>
<span class="nc" id="L280">			summaryPC = new RequiredPayPeriodHoursSummaryPC(m_context, empID, name, requiredPayPeriodData, rpphAsOfDate, payPeriods);</span>
		}
<span class="nc" id="L282">		return summaryPC;</span>
	}

	/**
	 * Initialize Content Title
	 */
	@Override
	public void initContentTitle() {
<span class="nc" id="L290">		String pageTitle = i18n(m_bundle, RmWebBundleKey.PEOPLE_TIMEOFF_SUMMARY);</span>
<span class="nc" id="L291">		m_contentTitlePC.setPageTitle(pageTitle);</span>
<span class="nc bnc" id="L292" title="All 4 branches missed.">		if (isAccessibilityComplianceMode() &amp;&amp; getPageIDs().size() &gt; 1) {</span>
<span class="nc" id="L293">			m_contentTitlePC.setAriaRegion(true);</span>
		}
<span class="nc" id="L295">	}</span>

	/**
	 * Initialize Toolbar
	 */
	@Override
	protected void initToolbar()	{
<span class="nc" id="L302">		ToolbarUtil.addRefreshBtn(m_toolbar, true);</span>
<span class="nc" id="L303">        initPagination();</span>
<span class="nc" id="L304">	}</span>

    /**
     * Inititalize pagination in the toolbar
     */
    protected void initPagination(){
<span class="nc" id="L310">        setPageIDResizeEnabled(true);</span>
<span class="nc" id="L311">        String itemTypeName = i18n(m_localizer.getBundle(FsWebBundleKey.BUNDLE_NAME), FsWebBundleKey.SV_PERSON);</span>
<span class="nc" id="L312">        m_toolbar.setPagination(itemTypeName, this, true, JSUtil.SUBMIT_FORM); //REFRESH_IGNORE_CHANGES);</span>
<span class="nc" id="L313">    }//initPagination</span>




	@Override
	public Collection getContainers() {
<span class="nc" id="L320">		return m_containerList;</span>
	}

	@Override
<span class="nc" id="L324">	public boolean isCommonMsgEnabled() { return true; }</span>

	@Override
<span class="nc" id="L327">	public boolean isCreateMode() { return false; }</span>

	@Override
<span class="nc" id="L330">	public boolean isMultiEdit() { return false; }</span>

	@Override
<span class="nc" id="L333">	public boolean isPeopleSelectable() { return false; }</span>


	public class IndentedCollapsibleContainerPC extends CollapsibleContainerPC
	{
		public IndentedCollapsibleContainerPC( RequestContext context)
<span class="nc" id="L339">		{</span>
<span class="nc" id="L340">			super(context);</span>
<span class="nc" id="L341">		}</span>

		/**
		 * Get the class name to be used for the content div
		 */
		@Override
		public String getCollapsibleContentClass()
		{
<span class="nc bnc" id="L349" title="All 4 branches missed.">			if (getCollapsed() &amp;&amp; isToggleable())</span>
			{
<span class="nc" id="L351">				return &quot;invisibleDivObject&quot;;</span>
			}
			else
			{
<span class="nc" id="L355">				return &quot;visibleDivObjectIndented&quot;; //&quot;visibleDivObject&quot;;</span>
			}
		}
	}

    /**
     * These hidden variables are required for pagination support.
     * Only needed because this is not a list page.
     */
    @Override
	public String getRequiredHTML()
    {
<span class="nc" id="L367">        StringBuffer sb = new StringBuffer(super.getRequiredHTML());</span>
<span class="nc" id="L368">        sb.append(HtmlUtil.makeHiddenInput(WorkpaneMultiColPM.SELECTED_ID_FN, this.getSelectedID()));</span>
<span class="nc" id="L369">        sb.append(HtmlUtil.makeHiddenInput(WorkpaneMultiColPM.PERFORM_ACTION_ON_ID_FN, this.getPerformActionOnID()));</span>
<span class="nc" id="L370">        sb.append(HtmlUtil.makeHiddenInput(WorkpaneMultiColPM.EDIT_INDEX_FN, this.getEditIndex()));</span>
<span class="nc" id="L371">        return sb.toString();</span>
    }

    //Just like in QA59182, we don't want to get Out Of Memory Error when Selecting many agents.
    //Overriding the method for WorkpanePageModel as hack to restrict the number of records selected in a page.
    @Override
	public void setPageIDSize(int PageIDSize)
    {
        try
        {
<span class="nc" id="L381">            String configKey = &quot;bluepumpkin/People/TimeSummary/pageIDSizeLimit&quot;;</span>
<span class="nc" id="L382">            String pageIDSizeFetched = BbmManagerFactory.getDBConfigManager().getValue(configKey);</span>
<span class="nc bnc" id="L383" title="All 2 branches missed.">            if ( pageIDSizeFetched != null )</span>
            {
<span class="nc" id="L385">                int iPageIDSizeFetched = Integer.parseInt(pageIDSizeFetched);</span>
<span class="nc bnc" id="L386" title="All 6 branches missed.">                if ((PageIDSize &gt; iPageIDSizeFetched) || (PageIDSize&lt;0 &amp;&amp; iPageIDSizeFetched&gt;=0) )</span>
                {
<span class="nc" id="L388">                    PageIDSize = iPageIDSizeFetched;</span>
                }
            }
        }
<span class="nc" id="L392">        catch(Exception ex)</span>
        {
            //ignoring any exception caught.
<span class="nc" id="L395">        }</span>
<span class="nc" id="L396">        super.setPageIDSize(PageIDSize);</span>
<span class="nc" id="L397">    }</span>

}
</pre><div class="footer"><span class="right">Created with <a href="http://www.eclemma.org/jacoco">JaCoCo</a> 0.7.5.201505241946</span></div></body></html>