<?xml version="1.0" encoding="UTF-8"?><!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd"><html xmlns="http://www.w3.org/1999/xhtml" lang="en"><head><meta http-equiv="Content-Type" content="text/html;charset=UTF-8"/><link rel="stylesheet" href="../.resources/report.css" type="text/css"/><link rel="shortcut icon" href="../.resources/report.gif" type="image/gif"/><title>TimeOffBidEmployeesPM.java</title><link rel="stylesheet" href="../.resources/prettify.css" type="text/css"/><script type="text/javascript" src="../.resources/prettify.js"></script></head><body onload="window['PR_TAB_WIDTH']=4;prettyPrint()"><div class="breadcrumb" id="breadcrumb"><span class="info"><a href="../.sessions.html" class="el_session">Sessions</a></span><a href="../index.html" class="el_report">QA Code Coverage</a> &gt; <a href="index.source.html" class="el_package">com.bluepumpkin.web.rm.timeoffbid</a> &gt; <span class="el_source">TimeOffBidEmployeesPM.java</span></div><h1>TimeOffBidEmployeesPM.java</h1><pre class="source lang-java linenums">package com.bluepumpkin.web.rm.timeoffbid;

import java.util.ArrayList;
import java.util.Collection;
import java.util.Collections;
import java.util.HashSet;
import java.util.Iterator;
import java.util.List;
import java.util.ResourceBundle;
import java.util.Set;
import java.util.TimeZone;
import java.text.MessageFormat;
import java.util.Date;
import java.lang.Boolean;
import javax.servlet.http.HttpServletRequest;

import com.bluepumpkin.common.datatypes.ID;
import com.bluepumpkin.common.datatypes.Pair;
import com.bluepumpkin.common.util.StringUtil;
import com.bluepumpkin.common.util.BPMessageFormat;
import com.witness.ejb.core.security.PrivilegeKeys;
import com.witness.ejb.core.security.model.User;
import com.witness.web.uif.data.wrapper.DataWrapper;
import com.witness.web.uif.data.wrapper.NumberWrapper;
import com.witness.web.uif.data.wrapper.PersonNameWrapper;
import com.witness.web.uif.pagecomponent.DefaultMultiColumnNodeData;
import com.bluepumpkin.ejb.rm.setup.timeoffbid.model.TimeOffBid;
import com.bluepumpkin.web.rm.Log;
import com.bluepumpkin.common.logging.Category;
import com.bluepumpkin.web.rm.keys.RmPageAction;
import com.bluepumpkin.ejb.bbm.employeefilter.model.Filter;
import com.bluepumpkin.web.rm.l10n.RmWebBundleKey;
import com.bluepumpkin.web.rm.l10n.RmWebLogBundleKey;
import com.witness.web.uif.base.Message;
import com.witness.web.uif.pagecomponent.table.TableHeaderPC;
import com.witness.web.uif.pagemodel.PageModel;
import com.witness.web.uif.pagemodel.WorkpaneListPM;
import com.witness.web.uif.system.RequestContext;
import com.witness.web.uif.util.HtmlUtil;
import com.witness.web.uif.keys.UserPreferenceKeys;
import com.witness.web.uif.l10n.UIFWebBundleKey;
import com.witness.web.uif.pagemodel.WorkpaneFieldNames;
import com.witness.web.uif.keys.PageAction;
import com.witness.web.uif.util.html.CSSUtil;
import com.bluepumpkin.web.bbm.l10n.BbmWebBundleKey;
import com.bluepumpkin.ejb.rm.setup.timeoffbid.model.TimeOffBidder;
import com.bluepumpkin.web.bbm.people.filter.PeopleFilterSelectorPC;
import com.bluepumpkin.web.bbm.activity.ActivityFields;
import com.bluepumpkin.web.bbm.organization.OrganizationModelHandler;
import com.bluepumpkin.ejb.bbm.workresource.model.Employee;
import com.bluepumpkin.web.bbm.employee.EmployeeModelHandler;
import com.witness.web.uif.validator.IsEnteredFieldValidator;
import com.bluepumpkin.ejb.bbm.employeefilter.ejb.EmployeeFilter;
import com.bluepumpkin.ejb.bbm.BbmManagerFactory;
import com.witness.web.uif.util.js.JSUtil;
import com.bluepumpkin.web.core.keys.PageKeys;
import com.bluepumpkin.web.rm.timeoffbid.filter.TimeOffBidEmployeePeopleFilterSelectorPC;
import com.bluepumpkin.ejb.rm.setup.timeoffbid.model.TimeOffBid;
import com.witness.web.uif.pagecomponent.toolbar.ToolbarTextButton;

/**
 * File: TimeOffBidEmployeesPM Description: Page model for the list of employees in time off bids Copyright: Copyright (c) 2016
 * Company: Verint System, inc
 */
public class TimeOffBidEmployeesPM extends WorkpaneListPM { // NOSONAR
<span class="nc" id="L66">	private static final Category LOG = Log.initCategory(TimeOffBidEmployeesPM.class.getName());</span>

	private static final long serialVersionUID = 1L;
	private static final String FORM_ACTION = &quot;rm_tb_employees&quot;;
	private static final String EMPL_IDS_FN = &quot;emplIDs&quot;;
	private static final String MAX_APPROVE_COLUMN_WIDTH = &quot;350px&quot;;
	private static final String ORG_IDS_FN = &quot;orgIDs&quot;;
	private static final String BID_STATUS_FN = &quot;bidStatus&quot;;
	private static final String BID_PREV_ID_FN = &quot;previousBidID&quot;;
	private static final String BID_StartDate_FN = &quot;bidstartdate&quot;;
	private static final String BID_EndDate_FN = &quot;bidenddate&quot;;
	private static final String BID_AMVVBE_FN = &quot;bidAMVVBE&quot;;
	private static final String BID_MUA_FN = &quot;bidMaxUnitApproval&quot;;
	private static final String BID_MVA_FN = &quot;bidMaxValueApproval&quot;;
	private static final String BID_ID_FN = &quot;timeOffBidID&quot;;
	private static final String BID_NAME_FN = &quot;timeOffBidName&quot;;
	private static final String ONE = &quot;1&quot;;
	private static final String DELIM = &quot;,&quot;;
<span class="nc" id="L84">	private String filterName = &quot;&quot;;</span>
<span class="nc" id="L85">	private String emplIDsStr = &quot;&quot;;</span>
<span class="nc" id="L86">	private String orgIDsStr = &quot;&quot;;</span>
<span class="nc" id="L87">	private String bidStatus = &quot;&quot;;</span>
<span class="nc" id="L88">	private String previousBidIDStr = &quot;&quot;;</span>
<span class="nc" id="L89">	private String startDateStr = &quot;&quot;;</span>
<span class="nc" id="L90">	private String endDateStr = &quot;&quot;;</span>
<span class="nc" id="L91">	private String bidIDStr = &quot;&quot;;</span>
<span class="nc" id="L92">	private String bidNameStr = &quot;&quot;;</span>
<span class="nc" id="L93">	private String bidAMVVBEStr = &quot;&quot;;</span>
<span class="nc" id="L94">	private String bidMaxUnitApprovalStr = &quot;&quot;;</span>
<span class="nc" id="L95">	private String bidMaxValueApprovalStr = &quot;&quot;;</span>
<span class="nc" id="L96">	private Date startDate = null;</span>
<span class="nc" id="L97">	private Date endDate = null;</span>
<span class="nc" id="L98">	private ID employeeFilterID = null;</span>
<span class="nc" id="L99">	private ID timeOffBidID = null;</span>
<span class="nc" id="L100">	private ID previousBidID = null;</span>
	private Collection&lt;ID&gt; emplIDs;
<span class="nc" id="L102">	private Collection&lt;ID&gt; orgIDs = null;</span>
<span class="nc" id="L103">	private int totalBidderCount = 0;</span>
<span class="nc" id="L104">	private int bidMaxUnitApproval = 0;</span>
<span class="nc" id="L105">	private int bidMaxValueApproval = 0;</span>
<span class="nc" id="L106">	private boolean fetchPage = false;</span>
<span class="nc" id="L107">	private boolean bidAMVVBE = false;</span>
<span class="nc" id="L108">	private boolean addedToBid = false;</span>
<span class="nc" id="L109">	private TimeOffBid timeOffBid = null;</span>
<span class="nc" id="L110">	private ToolbarTextButton addButton = null;</span>
<span class="nc" id="L111">	private ToolbarTextButton removeButton = null;</span>
<span class="nc" id="L112">	private ToolbarTextButton importButton = null;</span>
<span class="nc" id="L113">	private User viewingUser = null;</span>

	protected Collection&lt;TimeOffBidder&gt; timeOffBidders;
	protected ResourceBundle rmBundle;
	protected ResourceBundle bbmBundle;
	protected TimeOffBidEmployeePeopleFilterSelectorPC peopleFilterSelector;
	protected TimeZone tz;
<span class="nc" id="L120">	protected Collection listData = Collections.emptyList();</span>
<span class="nc" id="L121">	protected boolean isPageEnabled = true;</span>

	/**
	 * Constructor
	 */
	public TimeOffBidEmployeesPM(RequestContext context) {
<span class="nc" id="L127">		super(context, FRAMED_MODEL);</span>
<span class="nc" id="L128">		rmBundle = m_localizer.getBundle(RmWebBundleKey.BUNDLE_NAME);</span>
<span class="nc" id="L129">		bbmBundle = m_localizer.getBundle(BbmWebBundleKey.BUNDLE_NAME);</span>
<span class="nc" id="L130">		m_list.setIsZebra(true);</span>
<span class="nc" id="L131">		tz = m_context.getViewingTimeZone();</span>
<span class="nc" id="L132">		viewingUser = context.getUser();</span>

		// Set Pagination and Sorting
<span class="nc" id="L135">		setIsSortSupported(true);</span>
<span class="nc" id="L136">		setDefaultPageIDSize(20);</span>
<span class="nc" id="L137">		setIsPaginatingSelectedIDs(false);</span>
<span class="nc" id="L138">	}</span>

	/**
	 * Return an instance of the model that is ready for rendering
	 */
	public static PageModel getInstance(RequestContext context) throws Exception { // NOSONAR
<span class="nc" id="L144">		return getInstance(context, TimeOffBidEmployeesPM.class);</span>
	}

	/**
	 * Initialize Content Title
	 */
	@Override
	protected void initContentTitle() {
<span class="nc" id="L152">		String pageTitle = i18n(rmBundle, RmWebBundleKey.RM_SA_EMPLOYEES);</span>
<span class="nc" id="L153">		Object[] arg = { String.valueOf(totalBidderCount) };</span>
<span class="nc" id="L154">		String sTemplate = i18n(bbmBundle, BbmWebBundleKey.PEOPLE_SUMMARY_TITLE_PEOPLE);</span>
<span class="nc" id="L155">		String itemName = MessageFormat.format(sTemplate, arg);</span>

<span class="nc" id="L157">		m_contentTitlePC.setPageTitle(pageTitle);</span>
<span class="nc bnc" id="L158" title="All 2 branches missed.">		if (isPageEnabled) {</span>
<span class="nc" id="L159">			m_contentTitlePC.setItemName(itemName);</span>

			// Employee Filter
<span class="nc" id="L162">			peopleFilterSelector = getPeopleFilterSelectorPC();</span>
<span class="nc" id="L163">			addChildComponent(peopleFilterSelector);</span>

			// Add Employee Filter to Title
<span class="nc" id="L166">			m_contentTitlePC.setActiveComponent(peopleFilterSelector.getLabel(), peopleFilterSelector, true);</span>
		}
<span class="nc" id="L168">	}</span>

	@Override
	public String getFormAction() {
<span class="nc" id="L172">		return FORM_ACTION;</span>
	}

	/**
	 * Load Data
	 * 
	 * @throws Exception
	 */
	@Override
	protected void loadData() throws Exception {
		// If not an employee, don't Load Data
<span class="nc bnc" id="L183" title="All 2 branches missed.">		if (m_context.getUser().getEmployeeID() == null) {</span>
<span class="nc" id="L184">			addPageMessage(Message.INFO_TYPE, UIFWebBundleKey.SCREEN_DISABLED_FOR_NON_EMP, UIFWebBundleKey.BUNDLE_NAME);</span>
<span class="nc" id="L185">			setIsSortSupported(false);</span>
<span class="nc" id="L186">			isPageEnabled = false;</span>
<span class="nc" id="L187">			return;</span>
		}

		try {
<span class="nc bnc" id="L191" title="All 2 branches missed.">			if (hasSelectedID()) {</span>
<span class="nc" id="L192">				String sortColumn = &quot;&quot;;</span>

				// Reset indicator for determining if a user has been added to a Bid
<span class="nc" id="L195">				addedToBid = false;</span>

				// Get the Bid and Orgs (Children) when a new Bid is selected
<span class="nc bnc" id="L198" title="All 4 branches missed.">				if (previousBidID == null || !previousBidID.equals(getSelectedIDObject())) {</span>
<span class="nc" id="L199">					setTimeOffBidID(getSelectedIDObject());</span>
<span class="nc" id="L200">					getTimeOffBid(timeOffBidID);</span>
<span class="nc" id="L201">					getOrgAndChildOrgs(timeOffBid.getOrganizationId());</span>
<span class="nc" id="L202">					setPreviousBidID(timeOffBidID.toString());</span>
<span class="nc" id="L203">					extractBidState();</span>
				}

				// Sort by the column selected. If the column selected for sorting is Max Period to Approve,
				// check to see if the Bid Approval Max varies by Employee. If so, use the column to sort. If not,
				// use the Name column as the Max Period to Approve column will be filled with the setting from the Bid.
<span class="nc" id="L209">				sortColumn = getSortColumn();</span>
<span class="nc bnc" id="L210" title="All 8 branches missed.">				if (sortColumn == null || (sortColumn != null &amp;&amp; !timeOffBid.getIsApprovalMaxValueVariesByEmp() &amp;&amp; sortColumn.equals(String.valueOf(TimeOffBidder.SORTBY_MAXNUMBEROFPERIODS)))) {</span>
<span class="nc" id="L211">					sortColumn = String.valueOf(TimeOffBidder.SORTBY_NAME);</span>
				}

				// Get Employees to Add to the selected Bid
<span class="nc bnc" id="L215" title="All 4 branches missed.">				if (isPaginationNavPressed() || isFetchPage()) {</span>
<span class="nc" id="L216">					listData = TimeOffBidModelHandler.getNextTimeOffBidders(getTimeOffBidID(), getPageIDs(), orgIDs, sortColumn, isSortAscending());</span>
<span class="nc" id="L217">					setFetchPage(false);</span>
				} else {
					Pair timeOffBiddersPair;
<span class="nc" id="L220">					emplIDs = getEmployeeIDs();</span>

					// If All Current or No Filter, return employees in the Bid's Org and below.
<span class="nc bnc" id="L223" title="All 6 branches missed.">					if ((emplIDs == null || emplIDs.isEmpty()) &amp;&amp; employeeFilterID == null) {</span>
<span class="nc" id="L224">						timeOffBiddersPair = TimeOffBidModelHandler.getTimeOffBiddersForBidID(getTimeOffBidID(), orgIDs, sortColumn, isSortAscending(), getPageIDSize());</span>
					} else {
<span class="nc bnc" id="L226" title="All 2 branches missed.">						if (employeeFilterID.toString().equals(PageKeys.DEFAULT_NONE)) {</span>
<span class="nc" id="L227">							timeOffBiddersPair = TimeOffBidModelHandler.getTimeOffBiddersForBidID(getTimeOffBidID(), orgIDs, sortColumn, isSortAscending(), getPageIDSize());</span>
						} else {
<span class="nc" id="L229">							timeOffBiddersPair = TimeOffBidModelHandler.getTimeOffBiddersForBidIDAndEmployeeIDs(getTimeOffBidID(), emplIDs, orgIDs, getSortColumn(), isSortAscending(), getPageIDSize());</span>
						}
					}
<span class="nc" id="L232">					listData = (Collection&lt;TimeOffBidder&gt;) timeOffBiddersPair.getSecond();</span>
<span class="nc" id="L233">					initPaginationIDs((Collection&lt;ID&gt;) timeOffBiddersPair.getFirst());</span>
				}
<span class="nc" id="L235">				totalBidderCount = listData.size();</span>
<span class="nc" id="L236">			} else {</span>
<span class="nc" id="L237">				addSelectBidderMsg();</span>
			}
<span class="nc" id="L239">		} catch (Exception ex) {</span>
<span class="nc" id="L240">			Message msg = handleUnableToLoadDataErrorAndLogAsDebug(log, ex);</span>
<span class="nc" id="L241">			msg.setAssociatedMessage(ex.getLocalizedMessage());</span>
<span class="nc" id="L242">		}</span>
<span class="nc" id="L243">	}</span>

	/**
	 * Initialize Header
	 */
	@Override
	protected void initHeader() {
<span class="nc" id="L250">		TableHeaderPC header = m_list.getHeader();</span>

<span class="nc" id="L252">		header.setDefaultSortColumn(String.valueOf(TimeOffBidder.SORTBY_NAME));</span>
<span class="nc" id="L253">		header.addColumnHeaderData(String.valueOf(TimeOffBidder.SORTBY_NAME), i18n(m_common_bundle, UIFWebBundleKey.NAME));</span>

<span class="nc" id="L255">		header.addColumnHeaderData(String.valueOf(TimeOffBidder.SORTBY_STATUS), i18n(m_common_bundle, UIFWebBundleKey.STATUS));</span>

<span class="nc" id="L257">		header.addColumnHeaderData(String.valueOf(TimeOffBidder.SORTBY_SENIORITY), i18n(m_common_bundle, UIFWebBundleKey.SENIORITY));</span>

<span class="nc" id="L259">		header.addColumnHeaderData(String.valueOf(TimeOffBidder.SORTBY_RANK), i18n(m_common_bundle, UIFWebBundleKey.RANK));</span>

<span class="nc" id="L261">		header.addColumnHeaderData(String.valueOf(TimeOffBidder.SORTBY_MAXNUMBEROFPERIODS), i18n(rmBundle, RmWebBundleKey.MAX_PERIOD_TO_APPROVE)).setColumnWidth(MAX_APPROVE_COLUMN_WIDTH);</span>
<span class="nc" id="L262">	}</span>

	/**
	 * Initialize List
	 */
	@Override
	protected void initSelectableItems() {
		// If not an employee or list is empty, don't add rows to table.
<span class="nc bnc" id="L270" title="All 4 branches missed.">		if (listData.isEmpty() || !isPageEnabled) {</span>
<span class="nc" id="L271">			return;</span>
		}

<span class="nc" id="L274">		Set selectedIDSet = new HashSet(getPerfromActionOnIDsAsCollection());</span>
<span class="nc" id="L275">		List listModel = new ArrayList(listData.size());</span>

<span class="nc bnc" id="L277" title="All 2 branches missed.">		for (Iterator it = listData.iterator(); it.hasNext();) {</span>
<span class="nc" id="L278">			TimeOffBidder bidder = (TimeOffBidder) it.next();</span>
<span class="nc" id="L279">			ID bidderID = bidder.getEmployeeId();</span>
<span class="nc" id="L280">			String rowID = bidderID.toString();</span>

<span class="nc" id="L282">			addRowData(bidder, rowID, listModel);</span>

			// Mark selected IDs
<span class="nc bnc" id="L285" title="All 2 branches missed.">			if (selectedIDSet.contains(bidderID)) {</span>
<span class="nc" id="L286">				m_list.addSelectedRowID(rowID);</span>
			}
<span class="nc" id="L288">		}</span>

<span class="nc" id="L290">		m_list.setListModel(listModel);</span>
<span class="nc" id="L291">	}</span>

	/**
	 * Initialize Toolbar
	 */
	@Override
	protected void initToolbar() {
		// If not an employee, don't display buttons
<span class="nc bnc" id="L299" title="All 2 branches missed.">		if (!isPageEnabled) {</span>
<span class="nc" id="L300">			return;</span>
		}

<span class="nc" id="L303">		int itemCount = m_list.getSelectedRowIDCount();</span>

		// Get L10N labels for buttons
<span class="nc" id="L306">		String addToBidLbl = i18n(rmBundle, RmWebBundleKey.ADD_TO_BID);</span>
<span class="nc" id="L307">		String removeFromBidLbl = i18n(rmBundle, RmWebBundleKey.REMOVE_FROM_BID);</span>
<span class="nc" id="L308">		String importMaxWeeksPerEmplLbl = i18n(rmBundle, RmWebBundleKey.IMPORT_MAX_PERIOD_PER_EMPLOYEE);</span>

		// Add Buttons to ToolBar
<span class="nc" id="L311">		importButton = m_toolbar.addPopupWindowTextButton(RmPageAction.P0PUP_IMPORT_MAX_PERIOD_PER_EMPLOYEE, importMaxWeeksPerEmplLbl, false);</span>
<span class="nc" id="L312">		m_toolbar.addDivider();</span>
<span class="nc bnc" id="L313" title="All 2 branches missed.">		addButton = m_toolbar.addSubmitTextButton(RmPageAction.ADD_TO_BID, addToBidLbl, itemCount == 1);</span>
<span class="nc bnc" id="L314" title="All 2 branches missed.">		removeButton = m_toolbar.addSubmitTextButton(RmPageAction.REMOVE_FROM_BID, removeFromBidLbl, itemCount == 1);</span>

		// Set Button state
<span class="nc" id="L317">		setButtonsState(isAuthorizedToConfigure());</span>

		// Enable Pagination
<span class="nc" id="L320">		enableToolbarPagination();</span>

		//add upload
<span class="nc" id="L323">		String popupQueryString = BID_ID_FN + &quot;=&quot; + bidIDStr + &quot;&amp;&quot; + BID_NAME_FN + &quot;=&quot; + bidNameStr;</span>
<span class="nc" id="L324">		addPopupArgs(RmPageAction.P0PUP_IMPORT_MAX_PERIOD_PER_EMPLOYEE, &quot;time_off_period_import_popup&quot;, popupQueryString, null, &quot;620, 340, ctr, ctr&quot;, true, 1);</span>
<span class="nc" id="L325">	}</span>

	/**
	 * Return true if current user is authorized to configure entities in a page
	 *
	 * NOTE: To be overwritten by subclasses.
	 *
	 * Default return true
	 */
	@Override
	protected boolean isAuthorizedToConfigure() {
<span class="nc bnc" id="L336" title="All 4 branches missed.">		return isPageEnabled &amp;&amp; viewingUser.isAuthorized(PrivilegeKeys.FS_EDITTIMEOFFBIDDING_ID);</span>
	}

	/**
	 * Retrieve request parameters from request object to the page model object.
	 */
	@Override
	public boolean extractParameters(HttpServletRequest request) {
<span class="nc" id="L344">		boolean success = super.extractParameters(request);</span>

<span class="nc" id="L346">		setTimeOffBidID(getSelectedIDObject());</span>

<span class="nc" id="L348">		String value = request.getParameter(BID_NAME_FN);</span>
<span class="nc" id="L349">		setTimeOffBidName(value);</span>

<span class="nc" id="L351">		value = request.getParameter(EMPL_IDS_FN);</span>
<span class="nc" id="L352">		setEmployeeIDs(value);</span>

<span class="nc" id="L354">		value = request.getParameter(ORG_IDS_FN);</span>
<span class="nc" id="L355">		setOrgIDsAsString(value);</span>

<span class="nc" id="L357">		value = request.getParameter(BID_STATUS_FN);</span>
<span class="nc" id="L358">		setBidStatus(value);</span>

<span class="nc" id="L360">		value = request.getParameter(BID_PREV_ID_FN);</span>
<span class="nc" id="L361">		setPreviousBidID(value);</span>

<span class="nc" id="L363">		value = request.getParameter(BID_StartDate_FN);</span>
<span class="nc" id="L364">		setStartDate(value);</span>

<span class="nc" id="L366">		value = request.getParameter(BID_EndDate_FN);</span>
<span class="nc" id="L367">		setEndDate(value);</span>

<span class="nc" id="L369">		value = request.getParameter(BID_AMVVBE_FN);</span>
<span class="nc" id="L370">		setBidApprovalMaxValueVaries(value);</span>

<span class="nc" id="L372">		value = request.getParameter(BID_MUA_FN);</span>
<span class="nc" id="L373">		setBidMaxUnitApproval(value);</span>

<span class="nc" id="L375">		value = request.getParameter(BID_MVA_FN);</span>
<span class="nc" id="L376">		setBidMaxValueApproval(value);</span>

<span class="nc" id="L378">		setBidState();</span>

<span class="nc" id="L380">		return success;</span>
	}

	/**
	 * Return Required HTML for this component
	 */
	@Override
	public String getRequiredHTML() {
<span class="nc" id="L388">		return super.getRequiredHTML() + HtmlUtil.makeHiddenInput(EMPL_IDS_FN, emplIDsStr) </span>
<span class="nc" id="L389">		                               + HtmlUtil.makeHiddenInput(ORG_IDS_FN, orgIDsStr) </span>
<span class="nc" id="L390">		                               + HtmlUtil.makeHiddenInput(BID_STATUS_FN, bidStatus) </span>
<span class="nc" id="L391">		                               + HtmlUtil.makeHiddenInput(BID_StartDate_FN, startDateStr) </span>
<span class="nc" id="L392">		                               + HtmlUtil.makeHiddenInput(BID_EndDate_FN, endDateStr) </span>
<span class="nc" id="L393">		                               + HtmlUtil.makeHiddenInput(BID_AMVVBE_FN, bidAMVVBEStr) </span>
<span class="nc" id="L394">		                               + HtmlUtil.makeHiddenInput(BID_MUA_FN, bidMaxUnitApprovalStr) </span>
<span class="nc" id="L395">		                               + HtmlUtil.makeHiddenInput(BID_MVA_FN, bidMaxValueApprovalStr) </span>
<span class="nc" id="L396">		                               + HtmlUtil.makeHiddenInput(BID_PREV_ID_FN, previousBidIDStr) </span>
<span class="nc" id="L397">		                               + HtmlUtil.makeHiddenInput(BID_ID_FN, bidIDStr) </span>
<span class="nc" id="L398">		                               + HtmlUtil.makeHiddenInput(BID_NAME_FN, bidNameStr);</span>
	}

	/**
	 * Return JavaScript Init Code
	 */
	@Override
	public String getJavaScriptInitCode() {
<span class="nc" id="L406">		String superJS = super.getJavaScriptInitCode();</span>
<span class="nc bnc" id="L407" title="All 2 branches missed.">		if (!this.hasPerformActionOnID()) {</span>
<span class="nc" id="L408">			return superJS;</span>
		} else {
<span class="nc" id="L410">			return superJS + &quot;\n&quot; + &quot;top.workpaneMediator.handleCustomTableSelection();\n&quot;;</span>
		}
	}

	/**
	 * Adds a Bidder to the List
	 * 
	 * @param bidder Bidder Object
	 * @param rowID Employee ID
	 * @param listModel Collection of Bidders that are displayed in the list
	 */
	private void addRowData(TimeOffBidder bidder, String rowID, Collection listModel) {

<span class="nc" id="L423">		Employee emp = bidder.getOptMethods().getEmployee();</span>
<span class="nc" id="L424">		int rank = emp.getRank();</span>

<span class="nc" id="L426">		DefaultMultiColumnNodeData node = new DefaultMultiColumnNodeData(rowID);</span>
<span class="nc" id="L427">		node.add(new PersonNameWrapper(emp, m_localizer), CSSUtil.STYLE_NORMAL_LEFT); // 508</span>
<span class="nc" id="L428">		node.add(getStatus(bidder));</span>
<span class="nc" id="L429">		node.add(TimeOffBidUtil.getSeniority(emp, tz, m_localizer));</span>
<span class="nc" id="L430">		node.add(new NumberWrapper(rank, m_localizer), CSSUtil.STYLE_NORMAL_LEFT);</span>
<span class="nc" id="L431">		node.add(TimeOffBidUtil.formatMaxApprovalTime(timeOffBid, bidder, m_localizer), CSSUtil.STYLE_NORMAL_LEFT);</span>

<span class="nc" id="L433">		listModel.add(node);</span>
<span class="nc" id="L434">	}</span>

	/**
	 * Wrapper to display the status of an Employee for a Bid
	 * 
	 * @param bidder Bidder to determine the status
	 * @return wrapper with status fo the bidder
	 */
	private StatusWrapper getStatus(TimeOffBidder bidder) {
<span class="nc" id="L443">		int status = bidder.getStatus();</span>
<span class="nc" id="L444">		int bidsSubmitted = 0;</span>
<span class="nc" id="L445">		String sStatus = &quot;&quot;;</span>

<span class="nc bnc" id="L447" title="All 2 branches missed.">		switch (bidder.getStatus()) {</span>
		case TimeOffBidder.STATUS_NOT_IN_BID:
<span class="nc" id="L449">			sStatus = i18n(m_common_bundle, UIFWebBundleKey.STATUS_WAITING);</span>
<span class="nc" id="L450">			break;</span>
		default:
<span class="nc" id="L452">			bidsSubmitted = bidder.getStatus();</span>
<span class="nc" id="L453">			sStatus = getNumberOfBids(bidder);</span>
			break;
		}

<span class="nc" id="L457">		return new StatusWrapper(status, bidsSubmitted, sStatus);</span>
	}

	/**
	 * Formats the number of bids to the proper format.
	 * 
	 * @param bidder Employee added to the bid.
	 * @return The format number of bids the Employee submitted.
	 */
	private String getNumberOfBids(TimeOffBidder bidder) {
<span class="nc" id="L467">		String sStatus = &quot;&quot;;</span>
<span class="nc" id="L468">		int bidsSubmitted = 0;</span>

<span class="nc bnc" id="L470" title="All 4 branches missed.">		if (bidder.getTimeOffBidId() != null &amp;&amp; bidder.getTimeOffBidId().equals(getTimeOffBidID())) {</span>
<span class="nc" id="L471">			String msgFormat = i18n(rmBundle, RmWebBundleKey.STATUS_BID_SUMMITTED);</span>
<span class="nc" id="L472">			bidsSubmitted = bidder.getStatus();</span>
<span class="nc" id="L473">			Object[] args = new Object[] { m_localizer.formatNumber(bidsSubmitted) };</span>
<span class="nc" id="L474">			sStatus = BPMessageFormat.format(msgFormat, args);</span>
<span class="nc" id="L475">			addedToBid = true;</span>
<span class="nc" id="L476">		} else {</span>
<span class="nc" id="L477">			sStatus = i18n(m_common_bundle, UIFWebBundleKey.STATUS_WAITING);</span>
		}
		
<span class="nc" id="L480">		return sStatus;</span>
	}
	
	
	/**
	 * Add Select Auction Message
	 */
	protected void addSelectBidderMsg() {
<span class="nc" id="L488">		addPageMessage(Message.RESPONSE_TYPE, RmWebBundleKey.SELECT_BID_MSG, RmWebBundleKey.BUNDLE_NAME);</span>
<span class="nc" id="L489">	}</span>

	/**
	 * Add Select Auction Message
	 */
	protected void addNoBidderAdditonOrRemovalMsg() {
<span class="nc" id="L495">		addPageMessage(Message.INFO_TYPE, RmWebBundleKey.NO_ADD_REMOVE_BID_MSG, RmWebBundleKey.BUNDLE_NAME);</span>
<span class="nc" id="L496">	}</span>

	/**
	 * Creates the Employee Filter Component.
	 * 
	 * @return Employee Select Filter.
	 */
	protected TimeOffBidEmployeePeopleFilterSelectorPC getPeopleFilterSelectorPC() {
<span class="nc" id="L504">		TimeOffBidEmployeePeopleFilterSelectorPC employeeFilterPC = new TimeOffBidEmployeePeopleFilterSelectorPC(m_context);</span>

<span class="nc bnc" id="L506" title="All 2 branches missed.">		if (employeeFilterID == null) {</span>
<span class="nc" id="L507">			employeeFilterID = getSelectedFilterID();</span>
		}
<span class="nc" id="L509">		employeeFilterPC.setEnabled(true);</span>
<span class="nc" id="L510">		employeeFilterPC.setUseWrapper(false);</span>

		// Initialize Filter Box
<span class="nc" id="L513">		employeeFilterPC.initWithRequiredFilter(employeeFilterID);</span>
<span class="nc" id="L514">		return employeeFilterPC;</span>
	}

	/**
	 * This method is called via reflection to support the selected filter id, use by the employee filter component. The value of
	 * the selected filter id is stored as a session attribute. This implies that the last selection of the employee filter
	 * component, will remain the default whenever it entering the group form, within the current session.
	 * 
	 * @return the lastly selected employee filter id
	 */
	public ID getSelectedFilterID() {
<span class="nc" id="L525">		ID filterId = null;</span>
<span class="nc" id="L526">		filterName = (String) m_context.getUserProperty(UserPreferenceKeys.EMP_FILTER);</span>
<span class="nc bnc" id="L527" title="All 2 branches missed.">		if (filterName != null) {</span>
<span class="nc" id="L528">			Filter filter = EmployeeModelHandler.getFilterByName(m_context, filterName);</span>
<span class="nc bnc" id="L529" title="All 2 branches missed.">			if (filter != null) {</span>
<span class="nc" id="L530">				filterId = filter.getFilterID();</span>
			}
<span class="nc bnc" id="L532" title="All 4 branches missed.">			if (filterName != null &amp;&amp; filterName.equals(PageKeys.DEFAULT_NONE)) {</span>
<span class="nc" id="L533">				filterId = new ID(PageKeys.DEFAULT_NONE);</span>
<span class="nc bnc" id="L534" title="All 4 branches missed.">			} else if (filterName != null &amp;&amp; filterName.equals(PageKeys.DEFAULT_ALL)) {</span>
<span class="nc" id="L535">				filterId = new ID(PageKeys.DEFAULT_ALL);</span>
			}
		}
<span class="nc" id="L538">		return filterId;</span>
	}

	/**
	 * Returns a collection of Employee IDs based on the filter selected.
	 * 
	 * @return Collection of Employee IDs
	 */
	public Collection&lt;ID&gt; getEmployeeIDs() {
<span class="nc" id="L547">		Filter filter = null;</span>
		EmployeeFilter employeeFilter;
<span class="nc" id="L549">		Collection&lt;ID&gt; ids = Collections.emptyList();</span>

		try {
<span class="nc" id="L552">			employeeFilter = BbmManagerFactory.getEmployeeFilter(false);</span>
<span class="nc bnc" id="L553" title="All 2 branches missed.">			if (employeeFilterID == null) {</span>
<span class="nc" id="L554">				employeeFilterID = getSelectedFilterID();</span>
			}
<span class="nc bnc" id="L556" title="All 4 branches missed.">			if (employeeFilterID != null &amp;&amp; !EmployeeModelHandler.isAllFilter(employeeFilterID.toString())) {</span>
<span class="nc" id="L557">				filter = employeeFilter.getFilterByID(employeeFilterID);</span>
<span class="nc bnc" id="L558" title="All 2 branches missed.">			} else if (EmployeeModelHandler.isAllFilter(employeeFilterID.toString())) {</span>
<span class="nc bnc" id="L559" title="All 2 branches missed.">				if (employeeFilterID.toString().equals(PageKeys.DEFAULT_NONE)) {</span>
<span class="nc" id="L560">					filter = Filter.createAllFilterWithID(m_context.getUser().getID());</span>
<span class="nc" id="L561">					return ids;</span>
<span class="nc bnc" id="L562" title="All 2 branches missed.">				} else if (employeeFilterID.toString().equals(PageKeys.DEFAULT_ALL)) {</span>
<span class="nc" id="L563">					filter = Filter.createAllCurrentFilterWithID(m_context.getUser().getID());</span>
				}
			} else {
<span class="nc" id="L566">				filter = Filter.createAllFilter(m_context.getUser().getID());</span>
			}
<span class="nc" id="L568">			ids = employeeFilter.getEmployeeIDs(filter, m_context.getUser(), 0, true, 0, 9999999);</span>
<span class="nc" id="L569">			String[] strIDs = StringUtil.createStringArrayFromIDs(ids);</span>
<span class="nc" id="L570">			emplIDsStr = StringUtil.createDelimitedString(strIDs, DELIM);</span>
<span class="nc" id="L571">		} catch (Exception e) {</span>
<span class="nc" id="L572">			ids = Collections.emptyList();</span>
<span class="nc" id="L573">			LOG.l7dWarn(RmWebLogBundleKey.RM_TIMEOFF_BID_EMPLOYEE_RETRIEVE_ID_FAILURE, e);</span>
<span class="nc" id="L574">		}</span>
<span class="nc" id="L575">		return ids;</span>
	}

	/**
	 * Sets a string of Employee IDs. Also, converts the list into a collection.
	 * 
	 * @param value Comma delimited list of Employee IDs.
	 */
	public void setEmployeeIDs(String value) {
<span class="nc" id="L584">		emplIDsStr = value;</span>
<span class="nc" id="L585">		emplIDs = StringUtil.parseIDStringToCollection(value);</span>
<span class="nc" id="L586">	}</span>

	/**
	 * Sets whether to check for Pagination
	 * 
	 * @param bValue
	 */
	public void setIsPageEnabled(boolean bValue) {
<span class="nc" id="L594">		isPageEnabled = bValue;</span>
<span class="nc" id="L595">	}</span>

	/**
	 * Sets the Bid selected
	 * 
	 * @param timeOffBidID ID of Bid selected
	 */
	public void setTimeOffBidID(ID timeOffBidID) {
<span class="nc" id="L603">		this.timeOffBidID = timeOffBidID;</span>
<span class="nc bnc" id="L604" title="All 2 branches missed.">		if (timeOffBidID != null) {</span>
<span class="nc" id="L605">			bidIDStr = timeOffBidID.toString();</span>
		}
<span class="nc" id="L607">	}</span>

	/**
	 * Returns the ID of the selected Bid
	 * 
	 * @return ID of selected Bid
	 */
	public ID getTimeOffBidID() {
<span class="nc" id="L615">		return timeOffBidID;</span>
	}

	/**
	 * Sets the Bid Name
	 * 
	 * @param timeOffBidName Name of the Bid
	 */
	public void setTimeOffBidName(String timeOffBidName) {
<span class="nc" id="L624">		bidNameStr = timeOffBidName;</span>
<span class="nc" id="L625">	}</span>

	/**
	 * Returns the Bid Name
	 * 
	 * @return Name of the Bid
	 */
	public String getTimeOffBidName() {
<span class="nc" id="L633">		return bidNameStr;</span>
	}

	/**
	 * Retrieves whether to fetch a page or all employees into a Bid.
	 * 
	 * @return true to fetch, false otherwise
	 */
	public boolean isFetchPage() {
<span class="nc" id="L642">		return fetchPage;</span>
	}

	/**
	 * Sets whether to fetch a page or all employees into a Bid.
	 * 
	 * @param fecthPage true to fetch, false otherwise
	 */
	public void setFetchPage(boolean fetchPage) {
<span class="nc" id="L651">		this.fetchPage = fetchPage;</span>
<span class="nc" id="L652">	}</span>

	/**
	 * Retrieves a Time Off Bid Object.
	 * 
	 * @param bidID ID of Time Off Bid.
	 */
	public TimeOffBid getTimeOffBid() {
<span class="nc" id="L660">		return timeOffBid;</span>
	}

	/**
	 * Retrieves a Time Off Bid Object.
	 * 
	 * @param bidID ID of Time Off Bid.
	 */
	public TimeOffBid getTimeOffBid(ID bidID) {
		try {
<span class="nc" id="L670">			timeOffBid = TimeOffBidModelHandler.getTimeOffBidByID(bidID);</span>
<span class="nc" id="L671">			setBidStatus(timeOffBid.getStatus());</span>
<span class="nc" id="L672">		} catch (Exception ex) {</span>
<span class="nc" id="L673">			Message msg = handleUnableToLoadDataErrorAndLogAsDebug(log, ex);</span>
<span class="nc" id="L674">			msg.setAssociatedMessage(ex.getLocalizedMessage());</span>
<span class="nc" id="L675">		}</span>
<span class="nc" id="L676">		return timeOffBid;</span>
	}

	/**
	 * Retrieves Orgs and Sub Orgs from Org associated with the Time Off Bid
	 * 
	 * @param orgID
	 */
	public Collection&lt;ID&gt; getOrgAndChildOrgs() {
<span class="nc" id="L685">		return orgIDs;</span>
	}

	/**
	 * Retrieves Orgs and Sub Orgs from Org associated with the Time Off Bid
	 * 
	 * @param orgID
	 */
	public Collection&lt;ID&gt; getOrgAndChildOrgs(ID orgID) {
		try {
<span class="nc" id="L695">			orgIDs = OrganizationModelHandler.getSelfAndChildOrganizationIDs(m_context, orgID);</span>
<span class="nc" id="L696">			setOrgIDsAsString(orgIDs);</span>
<span class="nc" id="L697">		} catch (Exception ex) {</span>
<span class="nc" id="L698">			Message msg = handleUnableToLoadDataErrorAndLogAsDebug(log, ex);</span>
<span class="nc" id="L699">			msg.setAssociatedMessage(ex.getLocalizedMessage());</span>
<span class="nc" id="L700">		}</span>
<span class="nc" id="L701">		return orgIDs;</span>
	}

	/**
	 * Sets the Orgs associated with a Time Off Bid as a comma delimited string
	 * 
	 * @param orgIDs Collection of Org IDs.
	 */
	public void setOrgIDsAsString(Collection&lt;ID&gt; orgIDs) {
<span class="nc" id="L710">		orgIDsStr = StringUtil.createDelimitedString(orgIDs, DELIM);</span>
<span class="nc" id="L711">	}</span>

	/**
	 * Sets the Orgs associated with a Time Off Bid based on a comma delimited string
	 * 
	 * @param value String of comma separated Org IDs
	 */
	public void setOrgIDsAsString(String value) {
<span class="nc" id="L719">		orgIDsStr = value;</span>
<span class="nc" id="L720">		orgIDs = StringUtil.parseIDStringToCollection(value);</span>
<span class="nc" id="L721">	}</span>

	/**
	 * Sets the Orgs associated with a Time Off Bid as a comma delimited string
	 * 
	 * @return Orgs as a comma delimited string.
	 */
	public String getOrgIDsAsString() {
<span class="nc" id="L729">		return orgIDsStr;</span>
	}

	/**
	 * Sets the state of the Bid
	 * 
	 * @param value State of the current Bid
	 * @return
	 */
	public void setBidStatus(String value) {
<span class="nc bnc" id="L739" title="All 2 branches missed.">		if (value != null) {</span>
<span class="nc" id="L740">			bidStatus = String.valueOf(value);</span>
		}
<span class="nc" id="L742">	}</span>

	/**
	 * Sets the state of the Bid
	 * 
	 * @param value State of the current Bid
	 * @return
	 */
	public void setBidStatus(int value) {
<span class="nc" id="L751">		bidStatus = String.valueOf(value);</span>
<span class="nc" id="L752">	}</span>

	/**
	 * Gets the state of the bid
	 * 
	 * @return Returns the state of the Bid
	 */
	public String getBidStatus() {
<span class="nc" id="L760">		return bidStatus;</span>
	}

	/**
	 * Set the state of the Add to and Remove from bid buttons if the Bid is closed or not. Also, sets the state of the Import
	 * button if the Approve Max Value varies per Employee. Displays a message of buttons are disabled.
	 */
	public void setButtonsState(boolean isAuthorized) {
<span class="nc" id="L768">		Date currentUTCDateTime = TimeOffBidUtil.getUTCDateTime();</span>
		
<span class="nc bnc" id="L770" title="All 4 branches missed.">		if (isAuthorized &amp;&amp; timeOffBid != null) {</span>
<span class="nc bnc" id="L771" title="All 4 branches missed.">			importButton.setEnabled(timeOffBid.getIsApprovalMaxValueVariesByEmp() &amp;&amp; addedToBid);</span>
<span class="nc bnc" id="L772" title="All 2 branches missed.">			if (timeOffBid.isStatusOpen() &amp;&amp; </span>
<span class="nc bnc" id="L773" title="All 4 branches missed.">				((timeOffBid.getBidStartTime().getTime() &lt; currentUTCDateTime.getTime() &amp;&amp; currentUTCDateTime.getTime() &lt; timeOffBid.getBidEndTime().getTime()) || </span>
<span class="nc bnc" id="L774" title="All 2 branches missed.">				  timeOffBid.getBidStartTime().getTime() &gt; currentUTCDateTime.getTime())) {</span>
<span class="nc" id="L775">				addButton.setListButtonItems(-1, -1);</span>
<span class="nc" id="L776">				removeButton.setListButtonItems(-1, -1);</span>
			} else {
<span class="nc" id="L778">				addButton.setEnabled(false);</span>
<span class="nc" id="L779">				removeButton.setEnabled(false);</span>
<span class="nc" id="L780">				addButton.setListButtonItems(0, 0);</span>
<span class="nc" id="L781">				removeButton.setListButtonItems(0, 0);</span>
<span class="nc" id="L782">				addNoBidderAdditonOrRemovalMsg();</span>
			}
		} else {
<span class="nc" id="L785">			importButton.setEnabled(false);</span>
<span class="nc" id="L786">			addButton.setEnabled(false);</span>
<span class="nc" id="L787">			removeButton.setEnabled(false);</span>
<span class="nc" id="L788">			addButton.setListButtonItems(0, 0);</span>
<span class="nc" id="L789">			removeButton.setListButtonItems(0, 0);</span>
		}
<span class="nc" id="L791">	}</span>

	/**
	 * Sets the ID of the currently selected Bid. Used to determine whether to fetch the Bid data from the DB on Bid selections.
	 * 
	 * @param value ID of the Bid selected.
	 */
	protected void setPreviousBidID(String value) {
<span class="nc bnc" id="L799" title="All 2 branches missed.">		if (value != null) {</span>
<span class="nc" id="L800">			previousBidID = new ID(value);</span>
<span class="nc" id="L801">			previousBidIDStr = value;</span>
		}
<span class="nc" id="L803">	}</span>

	/**
	 * Sets the Bid End Date
	 * 
	 * @param value Long value that represents the end date of the Bid.
	 */
	protected void setStartDate(String value) {
<span class="nc bnc" id="L811" title="All 4 branches missed.">		if (value != null &amp;&amp; !&quot;&quot;.equals(value)) {</span>
			try {
<span class="nc" id="L813">				long lStartDate = Long.valueOf(value);</span>
<span class="nc" id="L814">				startDate = new Date();</span>
<span class="nc" id="L815">				startDate.setTime(lStartDate);</span>
<span class="nc" id="L816">				startDateStr = value;</span>
<span class="nc" id="L817">			} catch (Exception ex) {</span>
<span class="nc" id="L818">				addPageMessage(Message.ERROR_TYPE, RmWebBundleKey.EMPLOYEE_BID_START_DATE_BAD_FORMAT, RmWebBundleKey.BUNDLE_NAME);</span>
<span class="nc" id="L819">				LOG.l7dError(RmWebLogBundleKey.RM_TIMEOFF_BID_START_DATE_BAD_FORMAT, ex);</span>
<span class="nc" id="L820">			}</span>
		}
<span class="nc" id="L822">	}</span>

	/**
	 * Sets the Bid Start Date
	 * 
	 * @param value Long value that represents the start date of the Bid.
	 */
	protected void setEndDate(String value) {
<span class="nc bnc" id="L830" title="All 4 branches missed.">		if (value != null &amp;&amp; !&quot;&quot;.equals(value)) {</span>
			try {
<span class="nc" id="L832">				long lEndDate = Long.valueOf(value);</span>
<span class="nc" id="L833">				endDate = new Date();</span>
<span class="nc" id="L834">				endDate.setTime(lEndDate);</span>
<span class="nc" id="L835">				endDateStr = value;</span>
<span class="nc" id="L836">			} catch (Exception ex) {</span>
<span class="nc" id="L837">				addPageMessage(Message.ERROR_TYPE, RmWebBundleKey.EMPLOYEE_BID_END_DATE_BAD_FORMAT, RmWebBundleKey.BUNDLE_NAME);</span>
<span class="nc" id="L838">				LOG.l7dError(RmWebLogBundleKey.RM_TIMEOFF_BID_START_DATE_BAD_FORMAT, ex);</span>
<span class="nc" id="L839">			}</span>
		}
<span class="nc" id="L841">	}</span>

	/**
	 * Set the Bid's Approval Max varies by Employee
	 * 
	 * @param value Value of the Bids Maximum to Approve varies by Employee
	 */
	protected void setBidApprovalMaxValueVaries(String value) {
<span class="nc bnc" id="L849" title="All 4 branches missed.">		if (value != null &amp;&amp; !&quot;&quot;.equals(value)) {</span>
<span class="nc bnc" id="L850" title="All 2 branches missed.">			bidAMVVBE = value.equals(ONE) ? true : false;</span>
<span class="nc" id="L851">			bidAMVVBEStr = value;</span>
		}
<span class="nc" id="L853">	}</span>

	/**
	 * Sets the Bid's Max Unit to Approve to store in the Context. 0 - Days, 1 - Weeks
	 * 
	 * @param value Value of the Bids Maximum Unit to Approve
	 */
	protected void setBidMaxUnitApproval(String value) {
<span class="nc bnc" id="L861" title="All 4 branches missed.">		if (value != null &amp;&amp; !&quot;&quot;.equals(value)) {</span>
<span class="nc" id="L862">			bidMaxUnitApproval = Integer.valueOf(value).intValue();</span>
<span class="nc" id="L863">			bidMaxUnitApprovalStr = value;</span>
		}
<span class="nc" id="L865">	}</span>

	/**
	 * Sets the Bid's Max Value to Approve to store in the Context.
	 * 
	 * @param value Value of the Bids Maximum Value to Approve
	 */
	protected void setBidMaxValueApproval(String value) {
<span class="nc bnc" id="L873" title="All 4 branches missed.">		if (value != null &amp;&amp; !&quot;&quot;.equals(value)) {</span>
<span class="nc" id="L874">			bidMaxValueApproval = Integer.valueOf(value).intValue();</span>
<span class="nc" id="L875">			bidMaxValueApprovalStr = value;</span>
		}
<span class="nc" id="L877">	}</span>

	/**
	 * Extract the Bid state to save to the Context.
	 */
	protected void extractBidState() {
<span class="nc bnc" id="L883" title="All 2 branches missed.">		if (timeOffBidID != null) {</span>
<span class="nc" id="L884">			bidIDStr = previousBidIDStr = timeOffBid.getId().toString();</span>
<span class="nc" id="L885">			bidNameStr = timeOffBid.getName();</span>
<span class="nc" id="L886">			startDateStr = Long.toString(timeOffBid.getBidStartTime().getTime());</span>
<span class="nc" id="L887">			endDateStr = Long.toString(timeOffBid.getBidEndTime().getTime());</span>
<span class="nc" id="L888">			bidStatus = Integer.toString(timeOffBid.getStatus());</span>
<span class="nc bnc" id="L889" title="All 2 branches missed.">			bidAMVVBEStr = timeOffBid.getIsApprovalMaxValueVariesByEmp() ? &quot;1&quot; : &quot;0&quot;;</span>
<span class="nc" id="L890">			bidMaxUnitApprovalStr = Integer.toString(timeOffBid.getMaxUnitForApproval());</span>
<span class="nc" id="L891">			bidMaxValueApprovalStr = Integer.toString(timeOffBid.getMaxValueForApproval());</span>
		}
<span class="nc" id="L893">	}</span>

	/**
	 * Set the Bid state based on the value retrieved from the Context.
	 */
	protected void setBidState() {
<span class="nc bnc" id="L899" title="All 2 branches missed.">		if (!&quot;&quot;.equals(bidStatus)) {</span>
<span class="nc" id="L900">			timeOffBid = new TimeOffBid();</span>
<span class="nc" id="L901">			timeOffBid.setId(timeOffBidID);</span>
<span class="nc" id="L902">			timeOffBid.setName(bidNameStr);</span>
<span class="nc" id="L903">			timeOffBid.setBidStartTime(startDate);</span>
<span class="nc" id="L904">			timeOffBid.setBidEndTime(endDate);</span>
<span class="nc" id="L905">			timeOffBid.setStatus(Integer.valueOf(bidStatus).intValue());</span>
<span class="nc" id="L906">			timeOffBid.setIsApprovalMaxValueVariesByEmp(bidAMVVBE);</span>
<span class="nc" id="L907">			timeOffBid.setMaxUnitForApproval(bidMaxUnitApproval);</span>
<span class="nc" id="L908">			timeOffBid.setMaxValueForApproval(bidMaxValueApproval);</span>
		}
<span class="nc" id="L910">	}</span>

	// ////////////////////////////////////////////////////////////////////////////
	// Helper Classes
	// ////////////////////////////////////////////////////////////////////////////
	private static class StatusWrapper extends DataWrapper {
		private final int status;
		private final int submittedBids;
		private final String display;

<span class="nc" id="L920">		public StatusWrapper(int status, int submittedBids, String display) {</span>
<span class="nc" id="L921">			this.status = status;</span>
<span class="nc" id="L922">			this.submittedBids = submittedBids;</span>
<span class="nc" id="L923">			this.display = display;</span>
<span class="nc" id="L924">		}</span>

		/**
		 * Return String Representation of Data.
		 */
		public String getDisplay() {
<span class="nc" id="L930">			return display;</span>
		}

		public int compareTo(Object o) {
<span class="nc" id="L934">			return 1;</span>
		}
	}
}
</pre><div class="footer"><span class="right">Created with <a href="http://www.eclemma.org/jacoco">JaCoCo</a> 0.7.5.201505241946</span></div></body></html>