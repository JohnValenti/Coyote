<?xml version="1.0" encoding="UTF-8"?><!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd"><html xmlns="http://www.w3.org/1999/xhtml" lang="en"><head><meta http-equiv="Content-Type" content="text/html;charset=UTF-8"/><link rel="stylesheet" href="../.resources/report.css" type="text/css"/><link rel="shortcut icon" href="../.resources/report.gif" type="image/gif"/><title>TimeOffBidEmployeesPM.java</title><link rel="stylesheet" href="../.resources/prettify.css" type="text/css"/><script type="text/javascript" src="../.resources/prettify.js"></script></head><body onload="window['PR_TAB_WIDTH']=4;prettyPrint()"><div class="breadcrumb" id="breadcrumb"><span class="info"><a href="../.sessions.html" class="el_session">Sessions</a></span><a href="../index.html" class="el_report">QA Code Coverage</a> &gt; <a href="index.source.html" class="el_package">com.bluepumpkin.web.rm.timeoffbid</a> &gt; <span class="el_source">TimeOffBidEmployeesPM.java</span></div><h1>TimeOffBidEmployeesPM.java</h1><pre class="source lang-java linenums">package com.bluepumpkin.web.rm.timeoffbid;

import java.util.ArrayList;
import java.util.Collection;
import java.util.Collections;
import java.util.HashSet;
import java.util.Iterator;
import java.util.List;
import java.util.ResourceBundle;
import java.util.Set;
import java.util.TimeZone;
import java.text.MessageFormat;
import java.util.Date;
import javax.servlet.http.HttpServletRequest;

import com.bluepumpkin.common.datatypes.ID;
import com.bluepumpkin.common.datatypes.Pair;
import com.bluepumpkin.common.util.StringUtil;
import com.bluepumpkin.common.util.BPMessageFormat;
import com.witness.ejb.core.security.PrivilegeKeys;
import com.witness.ejb.core.security.model.User;
import com.witness.web.uif.data.wrapper.DataWrapper;
import com.witness.web.uif.data.wrapper.NumberWrapper;
import com.witness.web.uif.data.wrapper.PersonNameWrapper;
import com.witness.web.uif.pagecomponent.DefaultMultiColumnNodeData;
import com.bluepumpkin.web.rm.Log;
import com.bluepumpkin.common.logging.Category;
import com.bluepumpkin.web.rm.keys.RmPageAction;
import com.bluepumpkin.ejb.bbm.employeefilter.model.Filter;
import com.bluepumpkin.web.rm.l10n.RmWebBundleKey;
import com.bluepumpkin.web.rm.l10n.RmWebLogBundleKey;
import com.witness.web.uif.base.Message;
import com.witness.web.uif.pagecomponent.table.TableHeaderPC;
import com.witness.web.uif.pagemodel.PageModel;
import com.witness.web.uif.pagemodel.WorkpaneListPM;
import com.witness.web.uif.system.RequestContext;
import com.witness.web.uif.util.HtmlUtil;
import com.witness.web.uif.keys.UserPreferenceKeys;
import com.witness.web.uif.l10n.UIFWebBundleKey;
import com.witness.web.uif.util.html.CSSUtil;
import com.bluepumpkin.web.bbm.l10n.BbmWebBundleKey;
import com.bluepumpkin.ejb.rm.setup.timeoffbid.model.TimeOffBidder;
import com.bluepumpkin.web.bbm.organization.OrganizationModelHandler;
import com.bluepumpkin.ejb.bbm.workresource.model.Employee;
import com.bluepumpkin.web.bbm.employee.EmployeeModelHandler;
import com.bluepumpkin.ejb.bbm.employeefilter.ejb.EmployeeFilter;
import com.bluepumpkin.ejb.bbm.BbmManagerFactory;
import com.bluepumpkin.web.core.keys.PageKeys;
import com.bluepumpkin.web.rm.timeoffbid.filter.TimeOffBidEmployeePeopleFilterSelectorPC;
import com.bluepumpkin.ejb.rm.setup.timeoffbid.model.TimeOffBid;
import com.witness.web.uif.pagecomponent.toolbar.ToolbarTextButton;

/**
 * File: TimeOffBidEmployeesPM Description: Page model for the list of employees in time off bids Copyright: Copyright (c) 2016
 * Company: Verint System, inc
 */
public class TimeOffBidEmployeesPM extends WorkpaneListPM { // NOSONAR
<span class="fc" id="L58">	private static final Category LOG = Log.initCategory(TimeOffBidEmployeesPM.class.getName());</span>

	private static final long serialVersionUID = 1L;
	private static final String FORM_ACTION = &quot;rm_tb_employees&quot;;
	private static final String EMPL_IDS_FN = &quot;emplIDs&quot;;
	private static final String MAX_APPROVE_COLUMN_WIDTH = &quot;350px&quot;;
	private static final String ORG_IDS_FN = &quot;orgIDs&quot;;
	private static final String BID_STATUS_FN = &quot;bidStatus&quot;;
	private static final String BID_PREV_ID_FN = &quot;previousBidID&quot;;
	private static final String BID_StartDate_FN = &quot;bidstartdate&quot;;
	private static final String BID_EndDate_FN = &quot;bidenddate&quot;;
	private static final String BID_AMVVBE_FN = &quot;bidAMVVBE&quot;;
	private static final String BID_MUA_FN = &quot;bidMaxUnitApproval&quot;;
	private static final String BID_MVA_FN = &quot;bidMaxValueApproval&quot;;
	private static final String BID_ID_FN = &quot;timeOffBidID&quot;;
	private static final String BID_NAME_FN = &quot;timeOffBidName&quot;;
	private static final String ONE = &quot;1&quot;;
	private static final String DELIM = &quot;,&quot;;
<span class="nc" id="L76">	private String filterName = &quot;&quot;;</span>
<span class="nc" id="L77">	private String emplIDsStr = &quot;&quot;;</span>
<span class="nc" id="L78">	private String orgIDsStr = &quot;&quot;;</span>
<span class="nc" id="L79">	private String bidStatus = &quot;&quot;;</span>
<span class="nc" id="L80">	private String previousBidIDStr = &quot;&quot;;</span>
<span class="nc" id="L81">	private String startDateStr = &quot;&quot;;</span>
<span class="nc" id="L82">	private String endDateStr = &quot;&quot;;</span>
<span class="nc" id="L83">	private String bidIDStr = &quot;&quot;;</span>
<span class="nc" id="L84">	private String bidNameStr = &quot;&quot;;</span>
<span class="nc" id="L85">	private String bidAMVVBEStr = &quot;&quot;;</span>
<span class="nc" id="L86">	private String bidMaxUnitApprovalStr = &quot;&quot;;</span>
<span class="nc" id="L87">	private String bidMaxValueApprovalStr = &quot;&quot;;</span>
<span class="nc" id="L88">	private Date startDate = null;</span>
<span class="nc" id="L89">	private Date endDate = null;</span>
<span class="nc" id="L90">	private ID employeeFilterID = null;</span>
<span class="nc" id="L91">	private ID timeOffBidID = null;</span>
<span class="nc" id="L92">	private ID previousBidID = null;</span>
	private Collection&lt;ID&gt; emplIDs;
<span class="nc" id="L94">	private Collection&lt;ID&gt; orgIDs = null;</span>
<span class="nc" id="L95">	private int totalBidderCount = 0;</span>
<span class="nc" id="L96">	private int bidMaxUnitApproval = 0;</span>
<span class="nc" id="L97">	private int bidMaxValueApproval = 0;</span>
<span class="nc" id="L98">	private boolean fetchPage = false;</span>
<span class="nc" id="L99">	private boolean bidAMVVBE = false;</span>
<span class="nc" id="L100">	private boolean addedToBid = false;</span>
<span class="nc" id="L101">	private TimeOffBid timeOffBid = null;</span>
<span class="nc" id="L102">	private ToolbarTextButton addButton = null;</span>
<span class="nc" id="L103">	private ToolbarTextButton removeButton = null;</span>
<span class="nc" id="L104">	private ToolbarTextButton importButton = null;</span>
<span class="nc" id="L105">	private User viewingUser = null;</span>
    
	protected Collection&lt;TimeOffBidder&gt; timeOffBidders;
	protected ResourceBundle rmBundle;
	protected ResourceBundle bbmBundle;
	protected TimeOffBidEmployeePeopleFilterSelectorPC peopleFilterSelector;
	protected TimeZone tz;
<span class="nc" id="L112">	protected Collection listData = Collections.emptyList();</span>
<span class="nc" id="L113">	protected boolean isPageEnabled = true;</span>

	/**
	 * Constructor
	 */
	public TimeOffBidEmployeesPM(RequestContext context) {
<span class="nc" id="L119">		super(context, FRAMED_MODEL);</span>
<span class="nc" id="L120">		rmBundle = m_localizer.getBundle(RmWebBundleKey.BUNDLE_NAME);</span>
<span class="nc" id="L121">		bbmBundle = m_localizer.getBundle(BbmWebBundleKey.BUNDLE_NAME);</span>
<span class="nc" id="L122">		m_list.setIsZebra(true);</span>
<span class="nc" id="L123">		tz = m_context.getViewingTimeZone();</span>
<span class="nc" id="L124">		viewingUser = context.getUser();</span>
        
		// Set Pagination and Sorting
<span class="nc" id="L127">		setIsSortSupported(true);</span>
<span class="nc" id="L128">		setDefaultPageIDSize(20);</span>
<span class="nc" id="L129">		setIsPaginatingSelectedIDs(false);</span>
<span class="nc" id="L130">	}</span>

	/**
	 * Return an instance of the model that is ready for rendering
	 */
	public static PageModel getInstance(RequestContext context) throws Exception { // NOSONAR
<span class="nc" id="L136">		return getInstance(context, TimeOffBidEmployeesPM.class);</span>
	}

	/**
	 * Initialize Content Title
	 */
	@Override
	protected void initContentTitle() {
<span class="nc" id="L144">		String pageTitle = i18n(rmBundle, RmWebBundleKey.RM_SA_EMPLOYEES);</span>
<span class="nc" id="L145">		Object[] arg = { String.valueOf(totalBidderCount) };</span>
<span class="nc" id="L146">		String sTemplate = i18n(bbmBundle, BbmWebBundleKey.PEOPLE_SUMMARY_TITLE_PEOPLE);</span>
<span class="nc" id="L147">		String itemName = MessageFormat.format(sTemplate, arg);</span>

<span class="nc" id="L149">		m_contentTitlePC.setPageTitle(pageTitle);</span>
<span class="nc bnc" id="L150" title="All 2 branches missed.">		if (isPageEnabled) {</span>
<span class="nc" id="L151">			m_contentTitlePC.setItemName(itemName);</span>

			// Employee Filter
<span class="nc" id="L154">			peopleFilterSelector = getPeopleFilterSelectorPC();</span>
<span class="nc" id="L155">			addChildComponent(peopleFilterSelector);</span>

			// Add Employee Filter to Title
<span class="nc" id="L158">			m_contentTitlePC.setActiveComponent(peopleFilterSelector.getLabel(), peopleFilterSelector, true);</span>
		}
<span class="nc" id="L160">	}</span>

	@Override
	public String getFormAction() {
<span class="nc" id="L164">		return FORM_ACTION;</span>
	}

	/**
	 * Load Data
	 * 
	 * @throws Exception
	 */
	@Override
	protected void loadData() throws Exception {
		// If not an employee, don't Load Data
<span class="nc bnc" id="L175" title="All 2 branches missed.">		if (m_context.getUser().getEmployeeID() == null) {</span>
<span class="nc" id="L176">			addPageMessage(Message.INFO_TYPE, UIFWebBundleKey.SCREEN_DISABLED_FOR_NON_EMP, UIFWebBundleKey.BUNDLE_NAME);</span>
<span class="nc" id="L177">			setIsSortSupported(false);</span>
<span class="nc" id="L178">			isPageEnabled = false;</span>
<span class="nc" id="L179">			return;</span>
		}

		try {
<span class="nc bnc" id="L183" title="All 2 branches missed.">			if (hasSelectedID()) {</span>
<span class="nc" id="L184">				String sortColumn = &quot;&quot;;</span>

				// Reset indicator for determining if a user has been added to a Bid
<span class="nc" id="L187">				addedToBid = false;</span>

				// Get the Bid and Orgs (Children) when a new Bid is selected
<span class="nc bnc" id="L190" title="All 4 branches missed.">				if (previousBidID == null || !previousBidID.equals(getSelectedIDObject())) {</span>
<span class="nc" id="L191">					setTimeOffBidID(getSelectedIDObject());</span>
<span class="nc" id="L192">					getTimeOffBid(timeOffBidID);</span>
<span class="nc" id="L193">					getOrgAndChildOrgs(timeOffBid.getOrganizationId());</span>
<span class="nc" id="L194">					setPreviousBidID(timeOffBidID.toString());</span>
<span class="nc" id="L195">					extractBidState();</span>
				}

				// Sort by the column selected. If the column selected for sorting is Max Period to Approve,
				// check to see if the Bid Approval Max varies by Employee. If so, use the column to sort. If not,
				// use the Name column as the Max Period to Approve column will be filled with the setting from the Bid.
<span class="nc" id="L201">				sortColumn = getSortColumn();</span>
<span class="nc bnc" id="L202" title="All 8 branches missed.">				if (sortColumn == null || (sortColumn != null &amp;&amp; !timeOffBid.getIsApprovalMaxValueVariesByEmp() &amp;&amp; sortColumn.equals(String.valueOf(TimeOffBidder.SORTBY_MAXNUMBEROFPERIODS)))) {</span>
<span class="nc" id="L203">					sortColumn = String.valueOf(TimeOffBidder.SORTBY_NAME);</span>
				}

				// Get Employees to Add to the selected Bid
<span class="nc bnc" id="L207" title="All 4 branches missed.">				if (isPaginationNavPressed() || isFetchPage()) {</span>
<span class="nc" id="L208">					listData = TimeOffBidModelHandler.getNextTimeOffBidders(getTimeOffBidID(), getPageIDs(), orgIDs, sortColumn, isSortAscending());</span>
<span class="nc" id="L209">					setFetchPage(false);</span>
				} else {
					Pair timeOffBiddersPair;
<span class="nc" id="L212">					emplIDs = getEmployeeIDs();</span>

					// If All Current or No Filter, return employees in the Bid's Org and below.
<span class="nc bnc" id="L215" title="All 6 branches missed.">					if ((emplIDs == null || emplIDs.isEmpty()) &amp;&amp; employeeFilterID == null) {</span>
<span class="nc" id="L216">						timeOffBiddersPair = TimeOffBidModelHandler.getTimeOffBiddersForBidID(getTimeOffBidID(), orgIDs, sortColumn, isSortAscending(), getPageIDSize());</span>
					} else {
<span class="nc bnc" id="L218" title="All 2 branches missed.">						if (employeeFilterID.toString().equals(PageKeys.DEFAULT_NONE)) {</span>
<span class="nc" id="L219">							timeOffBiddersPair = TimeOffBidModelHandler.getTimeOffBiddersForBidID(getTimeOffBidID(), orgIDs, sortColumn, isSortAscending(), getPageIDSize());</span>
						} else {
<span class="nc" id="L221">							timeOffBiddersPair = TimeOffBidModelHandler.getTimeOffBiddersForBidIDAndEmployeeIDs(getTimeOffBidID(), emplIDs, orgIDs, getSortColumn(), isSortAscending(), getPageIDSize());</span>
						}
					}
<span class="nc" id="L224">					listData = (Collection&lt;TimeOffBidder&gt;) timeOffBiddersPair.getSecond();</span>
<span class="nc" id="L225">					initPaginationIDs((Collection&lt;ID&gt;) timeOffBiddersPair.getFirst());</span>
				}
<span class="nc" id="L227">				totalBidderCount = listData.size();</span>
<span class="nc" id="L228">			} else {</span>
<span class="nc" id="L229">				addSelectBidderMsg();</span>
			}
<span class="nc" id="L231">		} catch (Exception ex) {</span>
<span class="nc" id="L232">			Message msg = handleUnableToLoadDataErrorAndLogAsDebug(log, ex);</span>
<span class="nc" id="L233">			msg.setAssociatedMessage(ex.getLocalizedMessage());</span>
<span class="nc" id="L234">		}</span>
<span class="nc" id="L235">	}</span>

	/**
	 * Initialize Header
	 */
	@Override
	protected void initHeader() {
<span class="nc" id="L242">		TableHeaderPC header = m_list.getHeader();</span>

<span class="nc" id="L244">		header.setDefaultSortColumn(String.valueOf(TimeOffBidder.SORTBY_NAME));</span>
<span class="nc" id="L245">		header.addColumnHeaderData(String.valueOf(TimeOffBidder.SORTBY_NAME), i18n(m_common_bundle, UIFWebBundleKey.NAME));</span>

<span class="nc" id="L247">		header.addColumnHeaderData(String.valueOf(TimeOffBidder.SORTBY_STATUS), i18n(m_common_bundle, UIFWebBundleKey.STATUS));</span>

<span class="nc" id="L249">		header.addColumnHeaderData(String.valueOf(TimeOffBidder.SORTBY_SENIORITY), i18n(m_common_bundle, UIFWebBundleKey.SENIORITY));</span>

<span class="nc" id="L251">		header.addColumnHeaderData(String.valueOf(TimeOffBidder.SORTBY_RANK), i18n(m_common_bundle, UIFWebBundleKey.RANK));</span>

<span class="nc" id="L253">		header.addColumnHeaderData(String.valueOf(TimeOffBidder.SORTBY_MAXNUMBEROFPERIODS), i18n(rmBundle, RmWebBundleKey.MAX_PERIOD_TO_APPROVE)).setColumnWidth(MAX_APPROVE_COLUMN_WIDTH);</span>
<span class="nc" id="L254">	}</span>

	/**
	 * Initialize List
	 */
	@Override
	protected void initSelectableItems() {
		// If not an employee or list is empty, don't add rows to table.
<span class="nc bnc" id="L262" title="All 4 branches missed.">		if (listData.isEmpty() || !isPageEnabled) {</span>
<span class="nc" id="L263">			return;</span>
		}

<span class="nc" id="L266">		Set selectedIDSet = new HashSet(getPerfromActionOnIDsAsCollection());</span>
<span class="nc" id="L267">		List listModel = new ArrayList(listData.size());</span>

<span class="nc bnc" id="L269" title="All 2 branches missed.">		for (Iterator it = listData.iterator(); it.hasNext();) {</span>
<span class="nc" id="L270">			TimeOffBidder bidder = (TimeOffBidder) it.next();</span>
<span class="nc" id="L271">			ID bidderID = bidder.getEmployeeId();</span>
<span class="nc" id="L272">			String rowID = bidderID.toString();</span>

<span class="nc" id="L274">			addRowData(bidder, rowID, listModel);</span>

			// Mark selected IDs
<span class="nc bnc" id="L277" title="All 2 branches missed.">			if (selectedIDSet.contains(bidderID)) {</span>
<span class="nc" id="L278">				m_list.addSelectedRowID(rowID);</span>
			}
<span class="nc" id="L280">		}</span>

<span class="nc" id="L282">		m_list.setListModel(listModel);</span>
<span class="nc" id="L283">	}</span>

	/**
	 * Initialize Toolbar
	 */
	@Override
	protected void initToolbar() {
		// If not an employee, don't display buttons
<span class="nc bnc" id="L291" title="All 2 branches missed.">		if (!isPageEnabled) {</span>
<span class="nc" id="L292">			return;</span>
		}

<span class="nc" id="L295">		int itemCount = m_list.getSelectedRowIDCount();</span>

		// Get L10N labels for buttons
<span class="nc" id="L298">		String addToBidLbl = i18n(rmBundle, RmWebBundleKey.ADD_TO_BID);</span>
<span class="nc" id="L299">		String removeFromBidLbl = i18n(rmBundle, RmWebBundleKey.REMOVE_FROM_BID);</span>
<span class="nc" id="L300">		String importMaxWeeksPerEmplLbl = i18n(rmBundle, RmWebBundleKey.IMPORT_MAX_PERIOD_PER_EMPLOYEE);</span>

		// Add Buttons to ToolBar
<span class="nc" id="L303">		importButton = m_toolbar.addPopupWindowTextButton(RmPageAction.P0PUP_IMPORT_MAX_PERIOD_PER_EMPLOYEE, importMaxWeeksPerEmplLbl, false);</span>
<span class="nc" id="L304">		m_toolbar.addDivider();</span>
<span class="nc bnc" id="L305" title="All 2 branches missed.">		addButton = m_toolbar.addSubmitTextButton(RmPageAction.ADD_TO_BID, addToBidLbl, itemCount == 1);</span>
<span class="nc bnc" id="L306" title="All 2 branches missed.">		removeButton = m_toolbar.addSubmitTextButton(RmPageAction.REMOVE_FROM_BID, removeFromBidLbl, itemCount == 1);</span>

		// Set Button state
<span class="nc" id="L309">		setButtonsState(isAuthorizedToConfigure());</span>

		// Enable Pagination
<span class="nc" id="L312">		enableToolbarPagination();</span>

		//add upload
<span class="nc" id="L315">		String popupQueryString = BID_ID_FN + &quot;=&quot; + bidIDStr + &quot;&amp;&quot; + BID_NAME_FN + &quot;=&quot; + bidNameStr;</span>
<span class="nc" id="L316">		addPopupArgs(RmPageAction.P0PUP_IMPORT_MAX_PERIOD_PER_EMPLOYEE, &quot;time_off_period_import_popup&quot;, popupQueryString, null, &quot;620, 340, ctr, ctr&quot;, true, 1);</span>
<span class="nc" id="L317">	}</span>

	/**
	 * Return true if current user is authorized to configure entities in a page
	 *
	 * NOTE: To be overwritten by subclasses.
	 *
	 * Default return true
	 */
	@Override
	protected boolean isAuthorizedToConfigure() {
<span class="nc bnc" id="L328" title="All 4 branches missed.">		return isPageEnabled &amp;&amp; viewingUser.isAuthorized(PrivilegeKeys.FS_EDITTIMEOFFBIDDING_ID);</span>
	}

	/**
	 * Retrieve request parameters from request object to the page model object.
	 */
	@Override
	public boolean extractParameters(HttpServletRequest request) {
<span class="nc" id="L336">		boolean success = super.extractParameters(request);</span>

<span class="nc" id="L338">		setTimeOffBidID(getSelectedIDObject());</span>

<span class="nc" id="L340">		String value = request.getParameter(BID_NAME_FN);</span>
<span class="nc" id="L341">		setTimeOffBidName(value);</span>

<span class="nc" id="L343">		value = request.getParameter(EMPL_IDS_FN);</span>
<span class="nc" id="L344">		setEmployeeIDs(value);</span>

<span class="nc" id="L346">		value = request.getParameter(ORG_IDS_FN);</span>
<span class="nc" id="L347">		setOrgIDsAsString(value);</span>

<span class="nc" id="L349">		value = request.getParameter(BID_STATUS_FN);</span>
<span class="nc" id="L350">		setBidStatus(value);</span>

<span class="nc" id="L352">		value = request.getParameter(BID_PREV_ID_FN);</span>
<span class="nc" id="L353">		setPreviousBidID(value);</span>

<span class="nc" id="L355">		value = request.getParameter(BID_StartDate_FN);</span>
<span class="nc" id="L356">		setStartDate(value);</span>

<span class="nc" id="L358">		value = request.getParameter(BID_EndDate_FN);</span>
<span class="nc" id="L359">		setEndDate(value);</span>

<span class="nc" id="L361">		value = request.getParameter(BID_AMVVBE_FN);</span>
<span class="nc" id="L362">		setBidApprovalMaxValueVaries(value);</span>

<span class="nc" id="L364">		value = request.getParameter(BID_MUA_FN);</span>
<span class="nc" id="L365">		setBidMaxUnitApproval(value);</span>

<span class="nc" id="L367">		value = request.getParameter(BID_MVA_FN);</span>
<span class="nc" id="L368">		setBidMaxValueApproval(value);</span>

<span class="nc" id="L370">		setBidState();</span>

<span class="nc" id="L372">		return success;</span>
	}

	/**
	 * Return Required HTML for this component
	 */
	@Override
	public String getRequiredHTML() {
<span class="nc" id="L380">		return super.getRequiredHTML() + HtmlUtil.makeHiddenInput(EMPL_IDS_FN, emplIDsStr) </span>
<span class="nc" id="L381">		                               + HtmlUtil.makeHiddenInput(ORG_IDS_FN, orgIDsStr) </span>
<span class="nc" id="L382">		                               + HtmlUtil.makeHiddenInput(BID_STATUS_FN, bidStatus) </span>
<span class="nc" id="L383">		                               + HtmlUtil.makeHiddenInput(BID_StartDate_FN, startDateStr) </span>
<span class="nc" id="L384">		                               + HtmlUtil.makeHiddenInput(BID_EndDate_FN, endDateStr) </span>
<span class="nc" id="L385">		                               + HtmlUtil.makeHiddenInput(BID_AMVVBE_FN, bidAMVVBEStr) </span>
<span class="nc" id="L386">		                               + HtmlUtil.makeHiddenInput(BID_MUA_FN, bidMaxUnitApprovalStr) </span>
<span class="nc" id="L387">		                               + HtmlUtil.makeHiddenInput(BID_MVA_FN, bidMaxValueApprovalStr) </span>
<span class="nc" id="L388">		                               + HtmlUtil.makeHiddenInput(BID_PREV_ID_FN, previousBidIDStr) </span>
<span class="nc" id="L389">		                               + HtmlUtil.makeHiddenInput(BID_ID_FN, bidIDStr) </span>
<span class="nc" id="L390">		                               + HtmlUtil.makeHiddenInput(BID_NAME_FN, bidNameStr);</span>
	}

	/**
	 * Return JavaScript Init Code
	 */
	@Override
	public String getJavaScriptInitCode() {
<span class="nc" id="L398">		String superJS = super.getJavaScriptInitCode();</span>
<span class="nc bnc" id="L399" title="All 2 branches missed.">		if (!this.hasPerformActionOnID()) {</span>
<span class="nc" id="L400">			return superJS;</span>
		} else {
<span class="nc" id="L402">			return superJS + &quot;\n&quot; + &quot;top.workpaneMediator.handleCustomTableSelection();\n&quot;;</span>
		}
	}

	/**
	 * Adds a Bidder to the List
	 * 
	 * @param bidder Bidder Object
	 * @param rowID Employee ID
	 * @param listModel Collection of Bidders that are displayed in the list
	 */
	private void addRowData(TimeOffBidder bidder, String rowID, Collection listModel) {

<span class="nc" id="L415">		Employee emp = bidder.getOptMethods().getEmployee();</span>
<span class="nc" id="L416">		int rank = emp.getRank();</span>

<span class="nc" id="L418">		DefaultMultiColumnNodeData node = new DefaultMultiColumnNodeData(rowID);</span>
<span class="nc" id="L419">		node.add(new PersonNameWrapper(emp, m_localizer), CSSUtil.STYLE_NORMAL_LEFT); // 508</span>
<span class="nc" id="L420">		node.add(getStatus(bidder));</span>
<span class="nc" id="L421">		node.add(TimeOffBidUtil.getSeniority(emp, tz, m_localizer));</span>
<span class="nc" id="L422">		node.add(new NumberWrapper(rank, m_localizer), CSSUtil.STYLE_NORMAL_LEFT);</span>
<span class="nc" id="L423">		node.add(TimeOffBidUtil.formatMaxApprovalTime(timeOffBid, bidder, m_localizer), CSSUtil.STYLE_NORMAL_LEFT);</span>

<span class="nc" id="L425">		listModel.add(node);</span>
<span class="nc" id="L426">	}</span>

	/**
	 * Wrapper to display the status of an Employee for a Bid
	 * 
	 * @param bidder Bidder to determine the status
	 * @return wrapper with status fo the bidder
	 */
	private StatusWrapper getStatus(TimeOffBidder bidder) {
<span class="nc" id="L435">		int status = bidder.getStatus();</span>
<span class="nc" id="L436">		int bidsSubmitted = 0;</span>
<span class="nc" id="L437">		String sStatus = &quot;&quot;;</span>

<span class="nc bnc" id="L439" title="All 2 branches missed.">		switch (bidder.getStatus()) {</span>
		case TimeOffBidder.STATUS_NOT_IN_BID:
<span class="nc" id="L441">			sStatus = i18n(m_common_bundle, UIFWebBundleKey.STATUS_WAITING);</span>
<span class="nc" id="L442">			break;</span>
		default:
<span class="nc" id="L444">			bidsSubmitted = bidder.getStatus();</span>
<span class="nc" id="L445">			sStatus = getNumberOfBids(bidder);</span>
			break;
		}

<span class="nc" id="L449">		return new StatusWrapper(status, bidsSubmitted, sStatus);</span>
	}

	/**
	 * Formats the number of bids to the proper format.
	 * 
	 * @param bidder Employee added to the bid.
	 * @return The format number of bids the Employee submitted.
	 */
	private String getNumberOfBids(TimeOffBidder bidder) {
<span class="nc" id="L459">		String sStatus = &quot;&quot;;</span>
<span class="nc" id="L460">		int bidsSubmitted = 0;</span>

<span class="nc bnc" id="L462" title="All 4 branches missed.">		if (bidder.getTimeOffBidId() != null &amp;&amp; bidder.getTimeOffBidId().equals(getTimeOffBidID())) {</span>
<span class="nc" id="L463">			String msgFormat = i18n(rmBundle, RmWebBundleKey.STATUS_BID_SUMMITTED);</span>
<span class="nc" id="L464">			bidsSubmitted = bidder.getStatus();</span>
<span class="nc" id="L465">			Object[] args = new Object[] { m_localizer.formatNumber(bidsSubmitted) };</span>
<span class="nc" id="L466">			sStatus = BPMessageFormat.format(msgFormat, args);</span>
<span class="nc" id="L467">			addedToBid = true;</span>
<span class="nc" id="L468">		} else {</span>
<span class="nc" id="L469">			sStatus = i18n(m_common_bundle, UIFWebBundleKey.STATUS_WAITING);</span>
		}
		
<span class="nc" id="L472">		return sStatus;</span>
	}
	
	
	/**
	 * Add Select Auction Message
	 */
	protected void addSelectBidderMsg() {
<span class="nc" id="L480">		addPageMessage(Message.RESPONSE_TYPE, RmWebBundleKey.SELECT_BID_MSG, RmWebBundleKey.BUNDLE_NAME);</span>
<span class="nc" id="L481">	}</span>

	/**
	 * Add Select Auction Message
	 */
	protected void addNoBidderAdditonOrRemovalMsg() {
<span class="nc" id="L487">		addPageMessage(Message.INFO_TYPE, RmWebBundleKey.NO_ADD_REMOVE_BID_MSG, RmWebBundleKey.BUNDLE_NAME);</span>
<span class="nc" id="L488">	}</span>

	/**
	 * Creates the Employee Filter Component.
	 * 
	 * @return Employee Select Filter.
	 */
	protected TimeOffBidEmployeePeopleFilterSelectorPC getPeopleFilterSelectorPC() {
<span class="nc" id="L496">		TimeOffBidEmployeePeopleFilterSelectorPC employeeFilterPC = new TimeOffBidEmployeePeopleFilterSelectorPC(m_context);</span>

<span class="nc bnc" id="L498" title="All 2 branches missed.">		if (employeeFilterID == null) {</span>
<span class="nc" id="L499">			employeeFilterID = getSelectedFilterID();</span>
		}
<span class="nc" id="L501">		employeeFilterPC.setEnabled(true);</span>
<span class="nc" id="L502">		employeeFilterPC.setUseWrapper(false);</span>

		// Initialize Filter Box
<span class="nc" id="L505">		employeeFilterPC.initWithRequiredFilter(employeeFilterID);</span>
<span class="nc" id="L506">		return employeeFilterPC;</span>
	}

	/**
	 * This method is called via reflection to support the selected filter id, use by the employee filter component. The value of
	 * the selected filter id is stored as a session attribute. This implies that the last selection of the employee filter
	 * component, will remain the default whenever it entering the group form, within the current session.
	 * 
	 * @return the lastly selected employee filter id
	 */
	public ID getSelectedFilterID() {
<span class="nc" id="L517">		ID filterId = null;</span>
<span class="nc" id="L518">		filterName = (String) m_context.getUserProperty(UserPreferenceKeys.EMP_FILTER);</span>
<span class="nc bnc" id="L519" title="All 2 branches missed.">		if (filterName != null) {</span>
<span class="nc" id="L520">			Filter filter = EmployeeModelHandler.getFilterByName(m_context, filterName);</span>
<span class="nc bnc" id="L521" title="All 2 branches missed.">			if (filter != null) {</span>
<span class="nc" id="L522">				filterId = filter.getFilterID();</span>
			}
<span class="nc bnc" id="L524" title="All 4 branches missed.">			if (filterName != null &amp;&amp; filterName.equals(PageKeys.DEFAULT_NONE)) {</span>
<span class="nc" id="L525">				filterId = new ID(PageKeys.DEFAULT_NONE);</span>
<span class="nc bnc" id="L526" title="All 4 branches missed.">			} else if (filterName != null &amp;&amp; filterName.equals(PageKeys.DEFAULT_ALL)) {</span>
<span class="nc" id="L527">				filterId = new ID(PageKeys.DEFAULT_ALL);</span>
			}
		}
<span class="nc" id="L530">		return filterId;</span>
	}

	/**
	 * Returns a collection of Employee IDs based on the filter selected.
	 * 
	 * @return Collection of Employee IDs
	 */
	public Collection&lt;ID&gt; getEmployeeIDs() {
<span class="nc" id="L539">		Filter filter = null;</span>
		EmployeeFilter employeeFilter;
<span class="nc" id="L541">		Collection&lt;ID&gt; ids = Collections.emptyList();</span>

		try {
<span class="nc" id="L544">			employeeFilter = BbmManagerFactory.getEmployeeFilter(false);</span>
<span class="nc bnc" id="L545" title="All 2 branches missed.">			if (employeeFilterID == null) {</span>
<span class="nc" id="L546">				employeeFilterID = getSelectedFilterID();</span>
			}
<span class="nc bnc" id="L548" title="All 4 branches missed.">			if (employeeFilterID != null &amp;&amp; !EmployeeModelHandler.isAllFilter(employeeFilterID.toString())) {</span>
<span class="nc" id="L549">				filter = employeeFilter.getFilterByID(employeeFilterID);</span>
<span class="nc bnc" id="L550" title="All 2 branches missed.">			} else if (EmployeeModelHandler.isAllFilter(employeeFilterID.toString())) {</span>
<span class="nc bnc" id="L551" title="All 2 branches missed.">				if (employeeFilterID.toString().equals(PageKeys.DEFAULT_NONE)) {</span>
<span class="nc" id="L552">					filter = Filter.createAllFilterWithID(m_context.getUser().getID());</span>
<span class="nc" id="L553">					return ids;</span>
<span class="nc bnc" id="L554" title="All 2 branches missed.">				} else if (employeeFilterID.toString().equals(PageKeys.DEFAULT_ALL)) {</span>
<span class="nc" id="L555">					filter = Filter.createAllCurrentFilterWithID(m_context.getUser().getID());</span>
				}
			} else {
<span class="nc" id="L558">				filter = Filter.createAllFilter(m_context.getUser().getID());</span>
			}
<span class="nc" id="L560">			ids = employeeFilter.getEmployeeIDs(filter, m_context.getUser(), 0, true, 0, 9999999);</span>
<span class="nc" id="L561">			String[] strIDs = StringUtil.createStringArrayFromIDs(ids);</span>
<span class="nc" id="L562">			emplIDsStr = StringUtil.createDelimitedString(strIDs, DELIM);</span>
<span class="nc" id="L563">		} catch (Exception e) {</span>
<span class="nc" id="L564">			ids = Collections.emptyList();</span>
<span class="nc" id="L565">			LOG.l7dWarn(RmWebLogBundleKey.RM_TIMEOFF_BID_EMPLOYEE_RETRIEVE_ID_FAILURE, e);</span>
<span class="nc" id="L566">		}</span>
<span class="nc" id="L567">		return ids;</span>
	}

	/**
	 * Sets a string of Employee IDs. Also, converts the list into a collection.
	 * 
	 * @param value Comma delimited list of Employee IDs.
	 */
	public void setEmployeeIDs(String value) {
<span class="nc" id="L576">		emplIDsStr = value;</span>
<span class="nc" id="L577">		emplIDs = StringUtil.parseIDStringToCollection(value);</span>
<span class="nc" id="L578">	}</span>

	/**
	 * Sets whether to check for Pagination
	 * 
	 * @param bValue
	 */
	public void setIsPageEnabled(boolean bValue) {
<span class="nc" id="L586">		isPageEnabled = bValue;</span>
<span class="nc" id="L587">	}</span>

	/**
	 * Sets the Bid selected
	 * 
	 * @param timeOffBidID ID of Bid selected
	 */
	public void setTimeOffBidID(ID timeOffBidID) {
<span class="nc" id="L595">		this.timeOffBidID = timeOffBidID;</span>
<span class="nc bnc" id="L596" title="All 2 branches missed.">		if (timeOffBidID != null) {</span>
<span class="nc" id="L597">			bidIDStr = timeOffBidID.toString();</span>
		}
<span class="nc" id="L599">	}</span>

	/**
	 * Returns the ID of the selected Bid
	 * 
	 * @return ID of selected Bid
	 */
	public ID getTimeOffBidID() {
<span class="nc" id="L607">		return timeOffBidID;</span>
	}

	/**
	 * Sets the Bid Name
	 * 
	 * @param timeOffBidName Name of the Bid
	 */
	public void setTimeOffBidName(String timeOffBidName) {
<span class="nc" id="L616">		bidNameStr = timeOffBidName;</span>
<span class="nc" id="L617">	}</span>

	/**
	 * Returns the Bid Name
	 * 
	 * @return Name of the Bid
	 */
	public String getTimeOffBidName() {
<span class="nc" id="L625">		return bidNameStr;</span>
	}

	/**
	 * Retrieves whether to fetch a page or all employees into a Bid.
	 * 
	 * @return true to fetch, false otherwise
	 */
	public boolean isFetchPage() {
<span class="nc" id="L634">		return fetchPage;</span>
	}

	/**
	 * Sets whether to fetch a page or all employees into a Bid.
	 * 
	 * @param fecthPage true to fetch, false otherwise
	 */
	public void setFetchPage(boolean fetchPage) {
<span class="nc" id="L643">		this.fetchPage = fetchPage;</span>
<span class="nc" id="L644">	}</span>

	/**
	 * Retrieves a Time Off Bid Object.
	 * 
	 * @param bidID ID of Time Off Bid.
	 */
	public TimeOffBid getTimeOffBid() {
<span class="nc" id="L652">		return timeOffBid;</span>
	}

	/**
	 * Retrieves a Time Off Bid Object.
	 * 
	 * @param bidID ID of Time Off Bid.
	 */
	public TimeOffBid getTimeOffBid(ID bidID) {
		try {
<span class="nc" id="L662">			timeOffBid = TimeOffBidModelHandler.getTimeOffBidByID(bidID);</span>
<span class="nc" id="L663">			setBidStatus(timeOffBid.getStatus());</span>
<span class="nc" id="L664">		} catch (Exception ex) {</span>
<span class="nc" id="L665">			Message msg = handleUnableToLoadDataErrorAndLogAsDebug(log, ex);</span>
<span class="nc" id="L666">			msg.setAssociatedMessage(ex.getLocalizedMessage());</span>
<span class="nc" id="L667">		}</span>
<span class="nc" id="L668">		return timeOffBid;</span>
	}

	/**
	 * Retrieves Orgs and Sub Orgs from Org associated with the Time Off Bid
	 * 
	 * @param orgID
	 */
	public Collection&lt;ID&gt; getOrgAndChildOrgs() {
<span class="nc" id="L677">		return orgIDs;</span>
	}

	/**
	 * Retrieves Orgs and Sub Orgs from Org associated with the Time Off Bid
	 * 
	 * @param orgID
	 */
	public Collection&lt;ID&gt; getOrgAndChildOrgs(ID orgID) {
		try {
<span class="nc" id="L687">			orgIDs = OrganizationModelHandler.getSelfAndChildOrganizationIDs(m_context, orgID);</span>
<span class="nc" id="L688">			setOrgIDsAsString(orgIDs);</span>
<span class="nc" id="L689">		} catch (Exception ex) {</span>
<span class="nc" id="L690">			Message msg = handleUnableToLoadDataErrorAndLogAsDebug(log, ex);</span>
<span class="nc" id="L691">			msg.setAssociatedMessage(ex.getLocalizedMessage());</span>
<span class="nc" id="L692">		}</span>
<span class="nc" id="L693">		return orgIDs;</span>
	}

	/**
	 * Sets the Orgs associated with a Time Off Bid as a comma delimited string
	 * 
	 * @param orgIDs Collection of Org IDs.
	 */
	public void setOrgIDsAsString(Collection&lt;ID&gt; orgIDs) {
<span class="nc" id="L702">		orgIDsStr = StringUtil.createDelimitedString(orgIDs, DELIM);</span>
<span class="nc" id="L703">	}</span>

	/**
	 * Sets the Orgs associated with a Time Off Bid based on a comma delimited string
	 * 
	 * @param value String of comma separated Org IDs
	 */
	public void setOrgIDsAsString(String value) {
<span class="nc" id="L711">		orgIDsStr = value;</span>
<span class="nc" id="L712">		orgIDs = StringUtil.parseIDStringToCollection(value);</span>
<span class="nc" id="L713">	}</span>

	/**
	 * Sets the Orgs associated with a Time Off Bid as a comma delimited string
	 * 
	 * @return Orgs as a comma delimited string.
	 */
	public String getOrgIDsAsString() {
<span class="nc" id="L721">		return orgIDsStr;</span>
	}

	/**
	 * Sets the state of the Bid
	 * 
	 * @param value State of the current Bid
	 * @return
	 */
	public void setBidStatus(String value) {
<span class="nc bnc" id="L731" title="All 2 branches missed.">		if (value != null) {</span>
<span class="nc" id="L732">			bidStatus = String.valueOf(value);</span>
		}
<span class="nc" id="L734">	}</span>

	/**
	 * Sets the state of the Bid
	 * 
	 * @param value State of the current Bid
	 * @return
	 */
	public void setBidStatus(int value) {
<span class="nc" id="L743">		bidStatus = String.valueOf(value);</span>
<span class="nc" id="L744">	}</span>

	/**
	 * Gets the state of the bid
	 * 
	 * @return Returns the state of the Bid
	 */
	public String getBidStatus() {
<span class="nc" id="L752">		return bidStatus;</span>
	}

	/**
	 * Set the state of the Add to and Remove from bid buttons if the Bid is closed or not. Also, sets the state of the Import
	 * button if the Approve Max Value varies per Employee. Displays a message of buttons are disabled.
	 */
	public void setButtonsState(boolean isAuthorized) {
<span class="nc" id="L760">		Date currentUTCDateTime = TimeOffBidUtil.getUTCDateTime();</span>
		
<span class="nc bnc" id="L762" title="All 4 branches missed.">		if (isAuthorized &amp;&amp; timeOffBid != null) {</span>
<span class="nc bnc" id="L763" title="All 4 branches missed.">			importButton.setEnabled(timeOffBid.getIsApprovalMaxValueVariesByEmp() &amp;&amp; addedToBid);</span>
<span class="nc bnc" id="L764" title="All 2 branches missed.">			if (timeOffBid.isStatusOpen() &amp;&amp; </span>
<span class="nc bnc" id="L765" title="All 4 branches missed.">				((timeOffBid.getBidStartTime().getTime() &lt; currentUTCDateTime.getTime() &amp;&amp; currentUTCDateTime.getTime() &lt; timeOffBid.getBidEndTime().getTime()) || </span>
<span class="nc bnc" id="L766" title="All 2 branches missed.">				  timeOffBid.getBidStartTime().getTime() &gt; currentUTCDateTime.getTime())) {</span>
<span class="nc" id="L767">				addButton.setListButtonItems(-1, -1);</span>
<span class="nc" id="L768">				removeButton.setListButtonItems(-1, -1);</span>
			} else {
<span class="nc" id="L770">				addButton.setEnabled(false);</span>
<span class="nc" id="L771">				removeButton.setEnabled(false);</span>
<span class="nc" id="L772">				addButton.setListButtonItems(0, 0);</span>
<span class="nc" id="L773">				removeButton.setListButtonItems(0, 0);</span>
<span class="nc" id="L774">				addNoBidderAdditonOrRemovalMsg();</span>
			}
		} else {
<span class="nc" id="L777">			importButton.setEnabled(false);</span>
<span class="nc" id="L778">			addButton.setEnabled(false);</span>
<span class="nc" id="L779">			removeButton.setEnabled(false);</span>
<span class="nc" id="L780">			addButton.setListButtonItems(0, 0);</span>
<span class="nc" id="L781">			removeButton.setListButtonItems(0, 0);</span>
		}
<span class="nc" id="L783">	}</span>

	/**
	 * Sets the ID of the currently selected Bid. Used to determine whether to fetch the Bid data from the DB on Bid selections.
	 * 
	 * @param value ID of the Bid selected.
	 */
	protected void setPreviousBidID(String value) {
<span class="nc bnc" id="L791" title="All 2 branches missed.">		if (value != null) {</span>
<span class="nc" id="L792">			previousBidID = new ID(value);</span>
<span class="nc" id="L793">			previousBidIDStr = value;</span>
		}
<span class="nc" id="L795">	}</span>

	/**
	 * Sets the Bid End Date
	 * 
	 * @param value Long value that represents the end date of the Bid.
	 */
	protected void setStartDate(String value) {
<span class="nc bnc" id="L803" title="All 4 branches missed.">		if (value != null &amp;&amp; !&quot;&quot;.equals(value)) {</span>
			try {
<span class="nc" id="L805">				long lStartDate = Long.valueOf(value);</span>
<span class="nc" id="L806">				startDate = new Date();</span>
<span class="nc" id="L807">				startDate.setTime(lStartDate);</span>
<span class="nc" id="L808">				startDateStr = value;</span>
<span class="nc" id="L809">			} catch (Exception ex) {</span>
<span class="nc" id="L810">				addPageMessage(Message.ERROR_TYPE, RmWebBundleKey.EMPLOYEE_BID_START_DATE_BAD_FORMAT, RmWebBundleKey.BUNDLE_NAME);</span>
<span class="nc" id="L811">				LOG.l7dError(RmWebLogBundleKey.RM_TIMEOFF_BID_START_DATE_BAD_FORMAT, ex);</span>
<span class="nc" id="L812">			}</span>
		}
<span class="nc" id="L814">	}</span>

	/**
	 * Sets the Bid Start Date
	 * 
	 * @param value Long value that represents the start date of the Bid.
	 */
	protected void setEndDate(String value) {
<span class="nc bnc" id="L822" title="All 4 branches missed.">		if (value != null &amp;&amp; !&quot;&quot;.equals(value)) {</span>
			try {
<span class="nc" id="L824">				long lEndDate = Long.valueOf(value);</span>
<span class="nc" id="L825">				endDate = new Date();</span>
<span class="nc" id="L826">				endDate.setTime(lEndDate);</span>
<span class="nc" id="L827">				endDateStr = value;</span>
<span class="nc" id="L828">			} catch (Exception ex) {</span>
<span class="nc" id="L829">				addPageMessage(Message.ERROR_TYPE, RmWebBundleKey.EMPLOYEE_BID_END_DATE_BAD_FORMAT, RmWebBundleKey.BUNDLE_NAME);</span>
<span class="nc" id="L830">				LOG.l7dError(RmWebLogBundleKey.RM_TIMEOFF_BID_START_DATE_BAD_FORMAT, ex);</span>
<span class="nc" id="L831">			}</span>
		}
<span class="nc" id="L833">	}</span>

	/**
	 * Set the Bid's Approval Max varies by Employee
	 * 
	 * @param value Value of the Bids Maximum to Approve varies by Employee
	 */
	protected void setBidApprovalMaxValueVaries(String value) {
<span class="nc bnc" id="L841" title="All 4 branches missed.">		if (value != null &amp;&amp; !&quot;&quot;.equals(value)) {</span>
<span class="nc bnc" id="L842" title="All 2 branches missed.">			bidAMVVBE = value.equals(ONE) ? true : false;</span>
<span class="nc" id="L843">			bidAMVVBEStr = value;</span>
		}
<span class="nc" id="L845">	}</span>

	/**
	 * Sets the Bid's Max Unit to Approve to store in the Context. 0 - Days, 1 - Weeks
	 * 
	 * @param value Value of the Bids Maximum Unit to Approve
	 */
	protected void setBidMaxUnitApproval(String value) {
<span class="nc bnc" id="L853" title="All 4 branches missed.">		if (value != null &amp;&amp; !&quot;&quot;.equals(value)) {</span>
<span class="nc" id="L854">			bidMaxUnitApproval = Integer.valueOf(value).intValue();</span>
<span class="nc" id="L855">			bidMaxUnitApprovalStr = value;</span>
		}
<span class="nc" id="L857">	}</span>

	/**
	 * Sets the Bid's Max Value to Approve to store in the Context.
	 * 
	 * @param value Value of the Bids Maximum Value to Approve
	 */
	protected void setBidMaxValueApproval(String value) {
<span class="nc bnc" id="L865" title="All 4 branches missed.">		if (value != null &amp;&amp; !&quot;&quot;.equals(value)) {</span>
<span class="nc" id="L866">			bidMaxValueApproval = Integer.valueOf(value).intValue();</span>
<span class="nc" id="L867">			bidMaxValueApprovalStr = value;</span>
		}
<span class="nc" id="L869">	}</span>

	/**
	 * Extract the Bid state to save to the Context.
	 */
	protected void extractBidState() {
<span class="nc bnc" id="L875" title="All 2 branches missed.">		if (timeOffBidID != null) {</span>
<span class="nc" id="L876">			bidIDStr = previousBidIDStr = timeOffBid.getId().toString();</span>
<span class="nc" id="L877">			bidNameStr = timeOffBid.getName();</span>
<span class="nc" id="L878">			startDateStr = Long.toString(timeOffBid.getBidStartTime().getTime());</span>
<span class="nc" id="L879">			endDateStr = Long.toString(timeOffBid.getBidEndTime().getTime());</span>
<span class="nc" id="L880">			bidStatus = Integer.toString(timeOffBid.getStatus());</span>
<span class="nc bnc" id="L881" title="All 2 branches missed.">			bidAMVVBEStr = timeOffBid.getIsApprovalMaxValueVariesByEmp() ? &quot;1&quot; : &quot;0&quot;;</span>
<span class="nc" id="L882">			bidMaxUnitApprovalStr = Integer.toString(timeOffBid.getMaxUnitForApproval());</span>
<span class="nc" id="L883">			bidMaxValueApprovalStr = Integer.toString(timeOffBid.getMaxValueForApproval());</span>
		}
<span class="nc" id="L885">	}</span>

	/**
	 * Set the Bid state based on the value retrieved from the Context.
	 */
	protected void setBidState() {
<span class="nc bnc" id="L891" title="All 2 branches missed.">		if (!&quot;&quot;.equals(bidStatus)) {</span>
<span class="nc" id="L892">			timeOffBid = new TimeOffBid();</span>
<span class="nc" id="L893">			timeOffBid.setId(timeOffBidID);</span>
<span class="nc" id="L894">			timeOffBid.setName(bidNameStr);</span>
<span class="nc" id="L895">			timeOffBid.setBidStartTime(startDate);</span>
<span class="nc" id="L896">			timeOffBid.setBidEndTime(endDate);</span>
<span class="nc" id="L897">			timeOffBid.setStatus(Integer.valueOf(bidStatus).intValue());</span>
<span class="nc" id="L898">			timeOffBid.setIsApprovalMaxValueVariesByEmp(bidAMVVBE);</span>
<span class="nc" id="L899">			timeOffBid.setMaxUnitForApproval(bidMaxUnitApproval);</span>
<span class="nc" id="L900">			timeOffBid.setMaxValueForApproval(bidMaxValueApproval);</span>
		}
<span class="nc" id="L902">	}</span>

	// ////////////////////////////////////////////////////////////////////////////
	// Helper Classes
	// ////////////////////////////////////////////////////////////////////////////
	private static class StatusWrapper extends DataWrapper {
		private final int status;
		private final int submittedBids;
		private final String display;

<span class="nc" id="L912">		public StatusWrapper(int status, int submittedBids, String display) {</span>
<span class="nc" id="L913">			this.status = status;</span>
<span class="nc" id="L914">			this.submittedBids = submittedBids;</span>
<span class="nc" id="L915">			this.display = display;</span>
<span class="nc" id="L916">		}</span>

		/**
		 * Return String Representation of Data.
		 */
		public String getDisplay() {
<span class="nc" id="L922">			return display;</span>
		}

		public int compareTo(Object o) {
<span class="nc" id="L926">			return 1;</span>
		}
	}
}
</pre><div class="footer"><span class="right">Created with <a href="http://www.eclemma.org/jacoco">JaCoCo</a> 0.7.5.201505241946</span></div></body></html>