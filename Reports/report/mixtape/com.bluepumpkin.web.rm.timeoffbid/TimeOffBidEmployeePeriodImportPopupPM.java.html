<?xml version="1.0" encoding="UTF-8"?><!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd"><html xmlns="http://www.w3.org/1999/xhtml" lang="en"><head><meta http-equiv="Content-Type" content="text/html;charset=UTF-8"/><link rel="stylesheet" href="../.resources/report.css" type="text/css"/><link rel="shortcut icon" href="../.resources/report.gif" type="image/gif"/><title>TimeOffBidEmployeePeriodImportPopupPM.java</title><link rel="stylesheet" href="../.resources/prettify.css" type="text/css"/><script type="text/javascript" src="../.resources/prettify.js"></script></head><body onload="window['PR_TAB_WIDTH']=4;prettyPrint()"><div class="breadcrumb" id="breadcrumb"><span class="info"><a href="../.sessions.html" class="el_session">Sessions</a></span><a href="../index.html" class="el_report">QA Code Coverage</a> &gt; <a href="index.source.html" class="el_package">com.bluepumpkin.web.rm.timeoffbid</a> &gt; <span class="el_source">TimeOffBidEmployeePeriodImportPopupPM.java</span></div><h1>TimeOffBidEmployeePeriodImportPopupPM.java</h1><pre class="source lang-java linenums">package com.bluepumpkin.web.rm.timeoffbid;

import java.text.MessageFormat;
import java.util.ArrayList;
import java.util.List;
import java.util.Collection;
import java.util.ResourceBundle;

import com.bluepumpkin.common.datatypes.StringsPair;
import com.bluepumpkin.common.logging.Category;
import com.bluepumpkin.web.bbm.l10n.BbmWebBundleKey;
import com.bluepumpkin.web.rm.Log;
import com.bluepumpkin.web.rm.keys.RmJavaScriptFileID;
import com.bluepumpkin.web.rm.l10n.RmWebBundleKey;
import com.witness.web.uif.keys.JavaScriptFileID;
import com.witness.web.uif.keys.PageAction;
import com.witness.web.uif.l10n.UIFWebBundleKey;
import com.witness.web.uif.pagecomponent.DefaultMultiColumnNodeData;
import com.witness.web.uif.pagecomponent.form.FormTwoColumnPC;
import com.witness.web.uif.pagecomponent.list.MultiColListPC;
import com.witness.web.uif.pagecomponent.toolbar.ToolbarPC;
import com.witness.web.uif.pagemodel.PopupWindowPM;
import com.witness.web.uif.pagemodel.WorkpaneFieldNames;
import com.witness.web.uif.system.RequestContext;
import com.witness.web.uif.util.HtmlUtil;
import com.witness.web.uif.util.html.HtmlChoiceInput;
import com.witness.web.uif.util.js.JSUtil;

public class TimeOffBidEmployeePeriodImportPopupPM extends PopupWindowPM {
	private static final long serialVersionUID = 1L;
<span class="fc" id="L31">	private static Category logImportPage = Log.initCategory(TimeOffBidEmployeePeriodImportPopupPM.class.getName());</span>

	public static final String FIRST_NAME_FN = &quot;firstName&quot;;
	public static final String LAST_NAME_FN = &quot;lastName&quot;;
	public static final String PERIOD_TIME_FN = &quot;periodTime&quot;;
	public static final String IMPORT_UNIT_TYPE_FN = &quot;importUnitType&quot;;
	public static final String TIME_OFF_BID_NAME_FN = &quot;timeOffBidName&quot;;
	public static final String TIME_OFF_BID_ID_FN = &quot;timeOffBidID&quot;;
	public static final String DELIMITER_FN = &quot;delimiter&quot;;
	public static final String NUM_LINES_FN = &quot;numLines&quot;;

	public static final int WEEKS = 1;
	public static final int DAYS = 0;

	private final ResourceBundle bRMBundle;
	private final ResourceBundle bBBMBundle;
	private final FormTwoColumnPC formPC;
	private final FormTwoColumnPC formPC1;
	private final MultiColListPC list;

	private String timeOffBidName;
	private String timeOffBidID;
<span class="nc" id="L53">	private String valueDelimiter = &quot;&quot;;</span>
<span class="nc" id="L54">	private String ignoreNumLines = &quot;&quot;;</span>
<span class="nc" id="L55">	private String importUnitType = &quot;&quot;;</span>
<span class="nc" id="L56">	private String periodTime = &quot;&quot;;</span>
<span class="nc" id="L57">	private String lastName = &quot;&quot;;</span>
<span class="nc" id="L58">	private String firstName = &quot;&quot;;</span>

<span class="nc" id="L60">	private boolean isInitiated = false;</span>

	public TimeOffBidEmployeePeriodImportPopupPM(RequestContext context) {
<span class="nc" id="L63">		super(context);</span>

<span class="nc" id="L65">		bBBMBundle = m_localizer.getBundle(BbmWebBundleKey.BUNDLE_NAME);</span>
<span class="nc" id="L66">		bRMBundle = m_localizer.getBundle(RmWebBundleKey.BUNDLE_NAME);</span>

		// Initialize Form PC==
<span class="nc" id="L69">		formPC = new FormTwoColumnPC(context);</span>
<span class="nc" id="L70">		addChildComponent(formPC);</span>

		// Initialize second Form PC==
<span class="nc" id="L73">		formPC1 = new FormTwoColumnPC(context);</span>
<span class="nc" id="L74">		addChildComponent(formPC1);</span>

		// Initialize second Form PC==
<span class="nc" id="L77">		list = new MultiColListPC(context);</span>
<span class="nc" id="L78">		addChildComponent(list);</span>

		// --- Add Toolbar
<span class="nc" id="L81">		m_toolbar = new ToolbarPC(context);</span>
<span class="nc" id="L82">		addChildComponent(m_toolbar);</span>
<span class="nc" id="L83">		addRequiredJavaScriptFile(RmJavaScriptFileID.TIME_OFF_BID_EMPLOYEE_IMPORT_DIALOG_JS);</span>
<span class="nc" id="L84">	}</span>

	public static TimeOffBidEmployeePeriodImportPopupPM getInstance(RequestContext context) throws Exception { // NOSONAR
<span class="nc" id="L87">		return (TimeOffBidEmployeePeriodImportPopupPM) getInstance(context, TimeOffBidEmployeePeriodImportPopupPM.class);</span>
	}

	/**
	 * Initialize the Model
	 */
	@Override
	protected void initializeModel() {
<span class="nc bnc" id="L95" title="All 2 branches missed.">		if (isInitiated) {</span>
<span class="nc" id="L96">			return;</span>
		} else {
<span class="nc" id="L98">			isInitiated = true;</span>
		}
<span class="nc" id="L100">		setFormEncType(HtmlUtil.FORM_ENCTYPE_MULTIPART);</span>

<span class="nc" id="L102">		initTitle();</span>
<span class="nc" id="L103">		initForm();</span>
<span class="nc" id="L104">		initToolbar();</span>
<span class="nc" id="L105">	}</span>

	/**
	 * Initialize Component For Display
	 */
	@Override
	public void initForDisplay() {
<span class="nc bnc" id="L112" title="All 2 branches missed.">		if (m_isInitializedForDisplay) {</span>
<span class="nc" id="L113">			return;</span>
		} else {
<span class="nc" id="L115">			super.initForDisplay();</span>

			// Component specific required JavaScript Files
<span class="nc" id="L118">			addRequiredJavaScriptFile(JavaScriptFileID.MEDIATOR_WORKPANE_GENERIC);</span>
<span class="nc" id="L119">			addRequiredJavaScriptFile(JavaScriptFileID.JQUERY);</span>

		}
<span class="nc" id="L122">	}</span>

	/**
	 * Prepare content title for rendering
	 */
	private void initTitle() {
<span class="nc" id="L128">		m_contentTitlePC.setPageTitle(i18n(RmWebBundleKey.TIME_OFF_EMPLOYEE_MAXIMUM_PERIOD_TO_APPROVE_IMPORT_PAGE_TITLE));</span>
<span class="nc" id="L129">		m_contentTitlePC.setItemName(timeOffBidName);</span>
<span class="nc" id="L130">	}</span>

	/**
	 * Initialize Form Display
	 */
	protected void initForm() {
		try {
			// set list to ne unselectable
<span class="nc" id="L138">			list.setRowSelectable(false);</span>
<span class="nc" id="L139">			List listModel = new ArrayList();</span>

			// suffix and manager
<span class="nc" id="L142">			listModel.add(getNodeData(LAST_NAME_FN, getLastNameLabel(), FIRST_NAME_FN, getFirstNameLabel(), PERIOD_TIME_FN, getMaxPeriodLabel()));</span>

<span class="nc" id="L144">			list.setListModel(listModel);</span>
<span class="nc" id="L145">		} catch (Exception ex) {</span>
<span class="nc" id="L146">			handleUnableToLoadDataError(logImportPage, ex);</span>
<span class="nc" id="L147">		}</span>
<span class="nc" id="L148">	}</span>

	/**
	 * Initialize Toolbar
	 */
	@Override
	protected void initToolbar() {
<span class="nc" id="L155">		m_toolbar.setAlignment(ToolbarPC.ALIGN_RIGHT);</span>
		// save
<span class="nc" id="L157">		m_toolbar.addSubmitTextButton(PageAction.IMPORT, i18n(bBBMBundle, BbmWebBundleKey.SAVE), true);</span>
<span class="nc" id="L158">		m_toolbar.addCloseWindowTextButton(PageAction.DONE, i18n(bBBMBundle, BbmWebBundleKey.CANCEL), true);</span>
<span class="nc" id="L159">	}</span>

	/**
	 * Return the form Component associated with Page Model
	 */
	@Override
	public String getHtmlDisplay() {
<span class="nc" id="L166">		StringBuilder aBuf = new StringBuilder();</span>

<span class="nc" id="L168">		Object[] arg = { timeOffBidName };</span>
<span class="nc" id="L169">		String sTemplate = i18n(RmWebBundleKey.TIME_OFF_EMPLOYEE_MAXIMUM_PERIOD_TO_APPROVE_IMPORT_REQUIREMENT);</span>
<span class="nc" id="L170">		String requirement = MessageFormat.format(sTemplate, arg);</span>

<span class="nc" id="L172">		aBuf.append(&quot;&lt;table width=\&quot;100%\&quot;&gt;&quot;);</span>
		// append the Info Panel
<span class="nc" id="L174">		aBuf.append(&quot;&lt;tr&gt;&lt;td class=\&quot;boldTextLg \&quot; style=\&quot;height:22px;font-weight:bold\&quot; colspan=\&quot;2\&quot; &gt;&quot;);</span>
<span class="nc" id="L175">		aBuf.append(requirement);</span>
<span class="nc" id="L176">		aBuf.append(&quot;&lt;/td&gt;&lt;/tr&gt;&quot;);</span>
		// append the Import Units
<span class="nc" id="L178">		aBuf.append(&quot;&lt;tr&gt;&lt;td class=\&quot;normalText \&quot;&gt;&quot;);</span>
<span class="nc" id="L179">		aBuf.append(i18n(RmWebBundleKey.IMPORT_UNITS));</span>
<span class="nc" id="L180">		aBuf.append(&quot;&lt;/td&gt;&lt;td class=\&quot;normalText \&quot;&gt;&quot;);</span>
<span class="nc" id="L181">		aBuf.append(getImportUnitTypeOptions());</span>
<span class="nc" id="L182">		aBuf.append(&quot;&lt;/td&gt;&lt;/tr&gt;&quot;);</span>
		// append the file dialog
<span class="nc" id="L184">		aBuf.append(&quot;&lt;tr&gt;&lt;td class=\&quot;normalText \&quot;&gt;&quot;);</span>
<span class="nc" id="L185">		aBuf.append(i18n(bBBMBundle, BbmWebBundleKey.FileToImport));</span>
<span class="nc" id="L186">		aBuf.append(&quot;&lt;/td&gt;&lt;td&gt;&quot;);</span>
<span class="nc" id="L187">		aBuf.append(&quot;&lt;INPUT name=\&quot;file\&quot; type=\&quot;file\&quot; value=\&quot;&quot;);</span>
<span class="nc" id="L188">		aBuf.append(i18n(bBBMBundle, BbmWebBundleKey.Browse));</span>
<span class="nc" id="L189">		aBuf.append(&quot;\&quot; size=\&quot;25\&quot;&gt;&quot;);</span>
<span class="nc" id="L190">		aBuf.append(&quot;&lt;/td&gt;&lt;/tr&gt;&quot;);</span>
		// append delimiter picker
<span class="nc" id="L192">		aBuf.append(&quot;&lt;tr&gt;&lt;td class=\&quot;normalText \&quot;&gt;&quot;);</span>
<span class="nc" id="L193">		aBuf.append(i18n(bBBMBundle, BbmWebBundleKey.Delimiter));</span>
<span class="nc" id="L194">		aBuf.append(&quot;&lt;/td&gt;&lt;td&gt;&quot;);</span>
<span class="nc" id="L195">		aBuf.append(getDelimiterDropDown());</span>
<span class="nc" id="L196">		aBuf.append(&quot;&lt;/td&gt;&lt;/tr&gt;&quot;);</span>
		// append number of lines selection
<span class="nc" id="L198">		aBuf.append(&quot;&lt;tr&gt;&lt;td class=\&quot;normalText \&quot;&gt;&quot;);</span>
<span class="nc" id="L199">		aBuf.append(i18n(bBBMBundle, BbmWebBundleKey.LinesToIgnore));</span>
<span class="nc" id="L200">		aBuf.append(&quot;&lt;/td&gt;&lt;td&gt;&quot;);</span>
<span class="nc" id="L201">		aBuf.append(HtmlUtil.makeTextInput(NUM_LINES_FN, 3, 8, &quot;&quot;, &quot;&quot;, true));</span>
<span class="nc" id="L202">		aBuf.append(&quot;&lt;/td&gt;&lt;/tr&gt;&quot;);</span>
		// row with text for fields below
<span class="nc" id="L204">		aBuf.append(&quot;&lt;tr&gt;&lt;td class=\&quot;normalText \&quot; style=\&quot;height:22px\&quot; colspan=\&quot;2\&quot; bgcolor=\&quot;#A5BAE7\&quot;&gt;&quot;);</span>
<span class="nc" id="L205">		aBuf.append(i18n(bBBMBundle, BbmWebBundleKey.CheckFields));</span>
<span class="nc" id="L206">		aBuf.append(&quot;&lt;/td&gt;&lt;/tr&gt;&quot;);</span>
<span class="nc" id="L207">		aBuf.append(&quot;&lt;/table&gt;&quot;);</span>
<span class="nc" id="L208">		aBuf.append(list.getHtmlDisplay());</span>
<span class="nc" id="L209">		return aBuf.toString();</span>
	}

	/**
	 * Returns the node that sets the input order for the Last Name, First Name, and Max Period to Approve.
	 * 
	 * @param lStr Name of the first component
	 * @param lLabel Label of the first component
	 * @param cStr Name of the second component
	 * @param cLabel Label of the second component
	 * @param r1Str Name of the third component
	 * @param r1Label Label of the third component
	 * @return Data node that contains the HMTL to display the input order
	 */
	private DefaultMultiColumnNodeData getNodeData(String lStr, String lLabel, String cStr, String cLabel, String r1Str, String r1Label) {
		// Create the row data
<span class="nc" id="L225">		DefaultMultiColumnNodeData rowData = new DefaultMultiColumnNodeData(&quot;periodRow&quot;);</span>

		// left column
<span class="nc" id="L228">		rowData.add(HtmlUtil.makeChkBoxInput(lStr + &quot;Cb&quot;, lStr + &quot;Cb&quot;, null, true, true) + &quot;&amp;nbsp;&quot; + lLabel);</span>
<span class="nc" id="L229">		rowData.add(HtmlUtil.makeTextInput(lStr, 1, 5, &quot;1&quot;, null, &quot;changeTextField('&quot; + lStr + &quot;');&quot;, true));</span>

		// center column
<span class="nc" id="L232">		rowData.add(HtmlUtil.makeChkBoxInput(cStr + &quot;Cb&quot;, cStr + &quot;Cb&quot;, null, true, true) + &quot;&amp;nbsp;&quot; + cLabel);</span>
<span class="nc" id="L233">		rowData.add(HtmlUtil.makeTextInput(cStr, 1, 5, &quot;2&quot;, null, &quot;changeTextField('&quot; + cStr + &quot;');&quot;, true));</span>

		// right column
<span class="nc" id="L236">		rowData.add(HtmlUtil.makeChkBoxInput(r1Str + &quot;Cb&quot;, r1Str + &quot;Cb&quot;, null, true, true) + &quot;&amp;nbsp;&quot; + r1Label);</span>
<span class="nc" id="L237">		rowData.add(HtmlUtil.makeTextInput(r1Str, 1, 5, &quot;3&quot;, null, &quot;changeTextField('&quot; + r1Str + &quot;');&quot;, true));</span>

<span class="nc" id="L239">		return rowData;</span>
	}

	/**
	 * Creates the UI elements for Weeks or Days applied to the period imported.
	 * 
	 * @return HTML that represents the input element for weeks or days applied the the period for the import.
	 */
	private String getImportUnitTypeOptions() {
<span class="nc" id="L248">		StringBuilder sb = new StringBuilder();</span>

<span class="nc" id="L250">		sb.append(HtmlChoiceInput.makeRadioInput(IMPORT_UNIT_TYPE_FN, Integer.toString(WEEKS), i18n(RmWebBundleKey.WEEKS), true, JSUtil.ON_CHANGE));</span>
<span class="nc" id="L251">		sb.append(HtmlUtil.NBSP);</span>
<span class="nc" id="L252">		sb.append(HtmlChoiceInput.makeRadioInput(IMPORT_UNIT_TYPE_FN, Integer.toString(DAYS), i18n(RmWebBundleKey.DAYS), false, JSUtil.ON_CHANGE));</span>
<span class="nc" id="L253">		return sb.toString();</span>
	}

	/**
	 * Return the DropDown display of sets
	 */
	private String getDelimiterDropDown() {
<span class="nc" id="L260">		Collection&lt;StringsPair&gt; delimiterStringsPair = new ArrayList&lt;StringsPair&gt;();</span>

		// add \t
<span class="nc" id="L263">		delimiterStringsPair.add(new StringsPair(&quot;tab&quot;, i18n(bBBMBundle, BbmWebBundleKey.ImportTab)));</span>
<span class="nc" id="L264">		delimiterStringsPair.add(new StringsPair(&quot;,&quot;, i18n(bBBMBundle, BbmWebBundleKey.ImportComma)));</span>
<span class="nc" id="L265">		delimiterStringsPair.add(new StringsPair(&quot;;&quot;, i18n(bBBMBundle, BbmWebBundleKey.ImportSemiColon)));</span>
<span class="nc" id="L266">		return HtmlUtil.makeSelectInput(DELIMITER_FN, &quot;&quot;, &quot;&quot;, JSUtil.ON_CHANGE, delimiterStringsPair);</span>
	}

	/**
	 * Setter for Bid Name. Automatically extracted.
	 *
	 * @param poolName
	 */
	public void setTimeOffBidName(String timeOffBidName) {
<span class="nc" id="L275">		this.timeOffBidName = timeOffBidName;</span>
<span class="nc" id="L276">	}</span>

	/**
	 * Getter for Bid Name.
	 *
	 * @return the time off pool name
	 */
	public String getTimeOffBidName() {
<span class="nc" id="L284">		return timeOffBidName;</span>
	}

	/**
	 * Setter for Bid ID. Automatically extracted.
	 *
	 * @param ID
	 */
	public void setTimeOffBidID(String timeOffBidID) {
<span class="nc" id="L293">		this.timeOffBidID = timeOffBidID;</span>
<span class="nc" id="L294">	}</span>

	/**
	 * Getter for Bid ID.
	 *
	 * @return the time off pool ID
	 */
	public String getTimeOffBidID() {
<span class="nc" id="L302">		return timeOffBidID;</span>
	}

	/**
	 * Return the Required HTML for this component.
	 */
	@Override
	public String getRequiredHTML() {
		// store poolID, poolName
<span class="nc" id="L311">		return super.getRequiredHTML() + HtmlUtil.makeHiddenInput(WorkpaneFieldNames.PERFORM_ACTION_ON_ID_FN, timeOffBidID) + HtmlUtil.makeHiddenInput(TIME_OFF_BID_ID_FN, timeOffBidID) + HtmlUtil.makeHiddenInput(TIME_OFF_BID_NAME_FN, timeOffBidName);</span>
	}

	/**
	 * Gets the localized version of a Key parameter
	 * 
	 * @param key Key String to obtain the localized string.
	 * @return Localized string based on the Key parameter
	 */
	public String i18n(String key) {
<span class="nc" id="L321">		return i18n(bRMBundle, key);</span>
	}

	/**
	 * Return Localized First Name Label
	 * 
	 * @return String of localized version First Name
	 */
	private String getFirstNameLabel() {
<span class="nc" id="L330">		return i18n(m_common_bundle, UIFWebBundleKey.FIRST_NAME);</span>
	}

	/**
	 * Return Localized Last Name Label
	 * 
	 * @return String of localized version Last Name
	 */
	private String getLastNameLabel() {
<span class="nc" id="L339">		return i18n(m_common_bundle, UIFWebBundleKey.LAST_NAME);</span>
	}

	/**
	 * Return Localized Max Period to Approve Label
	 * 
	 * @return String of localized version Max Period to Approve
	 */
	private String getMaxPeriodLabel() {
<span class="nc" id="L348">		return i18n(RmWebBundleKey.MAX_PERIOD_TO_APPROVE);</span>
	}

	/**
	 * Returns the Delimiter selected
	 * 
	 * @return  String representing the delimeter selected
	 */
	public String getDelimiter() {
<span class="nc" id="L357">		return valueDelimiter;</span>
	}

	/**
	 * Sets the delimiter selected
	 * 
	 * @param delimiter value selected for the delimiter
	 */
	public void setDelimiter(String delimiter) {
<span class="nc" id="L366">		this.valueDelimiter = delimiter;</span>
<span class="nc" id="L367">	}</span>

	/**
	 * Returns the entered number of lines to skip
	 *  
	 * @return value for the number of lines to skip
	 */
	public String getNumLines() {
<span class="nc" id="L375">		return ignoreNumLines;</span>
	}

	/**
	 * Sets the number of lines to skip
	 * 
	 * @param numLines value selected for the number of lines to skip
	 */
	public void setNumLines(String numLines) {
<span class="nc" id="L384">		ignoreNumLines = numLines;</span>
<span class="nc" id="L385">	}</span>

	/**
	 * Returns the Import Unit Type
	 * 
	 * @return 0 - Weeks and 1 - Days
	 */
	public String getImportUnitType() {
<span class="nc" id="L393">		return this.importUnitType;</span>
	}

	/**
	 * Sets the Import Unit Type
	 * 
	 * @param importUnitType 0 - Weeks and 1 - Days 
	 */
	public void setImportUnitType(String importUnitType) {
<span class="nc" id="L402">		this.importUnitType = importUnitType;</span>
<span class="nc" id="L403">	}</span>

	/**
	 * Returns the Import Period Max.
	 * 
	 * @return value of the maximum period to approve
	 */
	public String getPeriodTime() {
<span class="nc" id="L411">		return periodTime;</span>
	}

	/**
	 * Sets the max period to approve 
	 * 
	 * @param periodTime max period to approve
	 */
	public void setPeriodTime(String periodTime) {
<span class="nc" id="L420">		this.periodTime = periodTime;</span>
<span class="nc" id="L421">	}</span>

	/**
	 * Return the User's last name
	 * 
	 * @return User's last name
	 */
	public String getLastName() {
<span class="nc" id="L429">		return lastName;</span>
	}

	/**
	 * Sets the User's last name.
	 * 
	 * @param lastName User's last name
	 */
	public void setLastName(String lastName) {
<span class="nc" id="L438">		this.lastName = lastName;</span>
<span class="nc" id="L439">	}</span>

	/**
	 * Return the User's first name
	 * 
	 * @return User's first name
	 */
	public String getFirstName() {
<span class="nc" id="L447">		return firstName;</span>
	}

	/**
	 * Sets the User's first name.
	 * 
	 * @param lastName User's first name
	 */
	public void setFirstName(String firstName) {
<span class="nc" id="L456">		this.firstName = firstName;</span>
<span class="nc" id="L457">	}</span>
}
</pre><div class="footer"><span class="right">Created with <a href="http://www.eclemma.org/jacoco">JaCoCo</a> 0.7.5.201505241946</span></div></body></html>