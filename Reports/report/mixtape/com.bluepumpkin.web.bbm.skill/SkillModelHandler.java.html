<?xml version="1.0" encoding="UTF-8"?><!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd"><html xmlns="http://www.w3.org/1999/xhtml" lang="en"><head><meta http-equiv="Content-Type" content="text/html;charset=UTF-8"/><link rel="stylesheet" href="../.resources/report.css" type="text/css"/><link rel="shortcut icon" href="../.resources/report.gif" type="image/gif"/><title>SkillModelHandler.java</title><link rel="stylesheet" href="../.resources/prettify.css" type="text/css"/><script type="text/javascript" src="../.resources/prettify.js"></script></head><body onload="window['PR_TAB_WIDTH']=4;prettyPrint()"><div class="breadcrumb" id="breadcrumb"><span class="info"><a href="../.sessions.html" class="el_session">Sessions</a></span><a href="../index.html" class="el_report">QA Code Coverage</a> &gt; <a href="index.source.html" class="el_package">com.bluepumpkin.web.bbm.skill</a> &gt; <span class="el_source">SkillModelHandler.java</span></div><h1>SkillModelHandler.java</h1><pre class="source lang-java linenums">package com.bluepumpkin.web.bbm.skill;

import java.rmi.RemoteException;
import java.util.Collection;
import java.util.Collections;
import java.util.Date;
import java.util.Iterator;

import com.bluepumpkin.common.datatypes.ID;
import com.bluepumpkin.ejb.bbm.BbmEJBCreateException;
import com.bluepumpkin.ejb.bbm.BbmManagerFactory;
import com.bluepumpkin.ejb.bbm.base.BbmException;
import com.bluepumpkin.ejb.bbm.base.BbmFinderException;
import com.bluepumpkin.ejb.bbm.base.FacadeException;
import com.bluepumpkin.ejb.bbm.skill.model.Skill;
import com.bluepumpkin.ejb.bbm.skill.model.SkillAssignment;
import com.bluepumpkin.ejb.bbm.workload.model.Media;
import com.bluepumpkin.ejb.bbm.workresource.model.Employee;
import com.bluepumpkin.ejb.core.base.MultiUserException;
import com.bluepumpkin.web.core.base.ModelHandler;
import com.verint.ejb.wfm.WfmManagerFactory;
import com.witness.web.uif.system.RequestContext;
import com.witness.web.uif.util.HtmlUtil;

/**
 * Title:        SkillModelHandler
 * Description:  Handle interaction with Skill EJB
 * Copyright:    Copyright (c) 2002
 * Company:      Blue Pumpkin Software, Inc
 *
 * @author Shimon Kakon
 * @version 1.0
 */
<span class="nc" id="L34">public class SkillModelHandler extends ModelHandler {</span>

  /**
   * Return All Skills for the specified list of orgIDs and it's parents
   */
  public static Collection getAllSkills() throws RemoteException, BbmException {
<span class="nc" id="L40">    Collection results = Collections.emptyList();</span>
<span class="nc" id="L41">    results = WfmManagerFactory.getSkillManager().getSkills();</span>
<span class="nc" id="L42">    return results;</span>
  }

  /**
   * Return All Skills for the specified orgID
   */
  public static Collection getSkills(RequestContext context, ID orgID)
      throws RemoteException, BbmException {
<span class="nc" id="L50">    return WfmManagerFactory.getSkillManager().getSkillsInOrg(orgID);</span>
  }

  /**
   * get skills in an org and all its parent orgs
   */
  public static Collection getAvailableSkillsInOrg(RequestContext context, ID orgID)
      throws RemoteException, BbmException {
<span class="nc" id="L58">    return WfmManagerFactory.getSkillManager().getAvailableSkillsInOrg(orgID);</span>
  }

  /**
   * get skills in a list of given orgs and all their parent orgs
   */
  public static Collection getAvailableSkillsInOrg(RequestContext context, Collection colOrgIDs)
      throws RemoteException, BbmException {
<span class="fc" id="L66">    return WfmManagerFactory.getSkillManager().getAvailableSkillsInOrg(colOrgIDs);</span>
  }

  /**
   * Return the Skill specified by id
   */
  public static Skill getSkillByID(ID id) throws RemoteException, BbmException {
<span class="nc" id="L73">    return WfmManagerFactory.getSkillManager().getSkillByID(id);</span>
  }

  /**
   * Return the Skill specified by the ID
   * &lt;p&gt;
   * If skillID is null and orgID is specified then it will return a new Skill
   * Object with the organization name set to the Organization specified by orgID.
   */
  public static Skill getSkill(RequestContext context, ID skillID, ID orgID)
      throws RemoteException, BbmException {
<span class="nc" id="L84">    Skill skill = null;</span>
<span class="nc bnc" id="L85" title="All 2 branches missed.">    if (skillID != null) {</span>
<span class="nc" id="L86">      skill = WfmManagerFactory.getSkillManager().getSkillByID(skillID);</span>
    } else {
<span class="nc" id="L88">      skill = new Skill();</span>
<span class="nc" id="L89">      skill.setOrganizationID(orgID);</span>
    }

<span class="nc" id="L92">    return skill;</span>
  }

  /**
   * Return the Skill specified by the DE string ID.
   * &lt;p&gt;
   * If skillID is null and orgID is specified then it will return a new Skill
   * Object with the organization name set to the Organization specified by orgID.
   */
  public static Skill getSkillByStringID(RequestContext context, ID skillID, ID orgID)
      throws RemoteException, BbmException {
<span class="fc" id="L103">    Skill skill = null;</span>
<span class="pc bpc" id="L104" title="1 of 2 branches missed.">    if (skillID != null) {</span>
<span class="fc" id="L105">      skill = WfmManagerFactory.getSkillManager().getSkillByStringID(skillID);</span>
    } else {
<span class="nc" id="L107">      skill = new Skill();</span>
      //String orgName = OrganizationModelHandler.getOrganizationName(context, orgID);
<span class="nc" id="L109">      skill.setOrganizationID(orgID);</span>
    }

<span class="fc" id="L112">    return skill;</span>
  }


  /**
   * Return All Skills for the given collection of IDs
   */
  public static Collection getSkillsByIDs(Collection skillIDs) throws RemoteException, BbmException {
<span class="fc" id="L120">    return WfmManagerFactory.getSkillManager().getSkillsByIDs(skillIDs);</span>
  }

  /**
   * Get skill IDs by name
   *
   public static HashMap getSkillIDsByNames(RequestContext context, HashSet skillNames)
   throws BbmException, RemoteException {
   return BbmManagerFactory.getSkillManager().getSkillIDsByNames(skillNames);
   }
   */

  /**
   * creates a delimited string of skills names
   *
   * @param skillsCollection Collection of Skill VO
   * @return a delimited string of skills names
   */
  public static String getSkillsDisplay(Collection skillsCollection) {
<span class="nc bnc" id="L139" title="All 4 branches missed.">    if (skillsCollection == null || skillsCollection.isEmpty()) {</span>
<span class="nc" id="L140">      return HtmlUtil.NBSP;</span>
    }
<span class="nc" id="L142">    Skill skill = null;</span>
<span class="nc" id="L143">    StringBuffer sb = new StringBuffer(64);</span>
<span class="nc bnc" id="L144" title="All 2 branches missed.">    for (Iterator it = skillsCollection.iterator(); it.hasNext(); ) {</span>
<span class="nc" id="L145">      skill = (Skill) it.next();</span>
<span class="nc" id="L146">      sb.append(skill.getName());</span>
<span class="nc bnc" id="L147" title="All 2 branches missed.">      if (it.hasNext()) sb.append(&quot;, &quot;);</span>
    }
<span class="nc" id="L149">    return sb.toString();</span>
  }

  /**
   * Get a given work resource's skill assignment
   *
   * @return a collection of SkillAssignment objects which hold the assignment information
   * @idWorkResource work resource id
   * @dtStart, @dtEnd: the time period, null date means a open period
   */
	public static Collection&lt;SkillAssignment&gt; getSkillAssignments(RequestContext context, ID idWorkResource, Date dtStart, Date dtEnd)
      throws BbmFinderException, RemoteException, BbmEJBCreateException {
<span class="nc" id="L161">    return WfmManagerFactory.getSkillManager(context.isInWhatIfMode()).getSkillAssignments(idWorkResource, dtStart, dtEnd);</span>
  }

  /**
   * Create Skill
   */
  public static ID createSkill(Skill obj)
      throws RemoteException, BbmException {
<span class="fc" id="L169">    return WfmManagerFactory.getSkillManager().createSkill(obj);</span>
  }

  /**
   * Create multiple Skills (used when Importing)
   */
  public static Collection createSkills(Collection skills)
      throws RemoteException, BbmException {
<span class="nc" id="L177">    return WfmManagerFactory.getSkillManager().createSkills(skills);</span>
  }


  /**
   * Save Skill
   */
  public static Skill saveSkill(RequestContext context, Skill obj)
      throws RemoteException, MultiUserException, BbmException {
<span class="fc" id="L186">    WfmManagerFactory.getSkillManager().updateSkillByStringID(obj);</span>
<span class="fc" id="L187">    return WfmManagerFactory.getSkillManager().getSkillByStringID(obj.getID());</span>
  }

  public static Media getMedia(ID mediaID)
      throws RemoteException, BbmFinderException, BbmEJBCreateException {
<span class="fc" id="L192">    return WfmManagerFactory.getWorkloadManager().getMediaByID(mediaID);</span>
  }

  /**
   * Get Employee object for secure field data
   *
   * @param orgID
   */
  public static Employee getUserEmployeePrivilege(ID orgID)
      throws BbmEJBCreateException, FacadeException, RemoteException {
<span class="nc" id="L202">    return BbmManagerFactory.getPeopleFacade().getUserEmployeePrivilege(orgID);</span>
  }

  /**
   * When you get a duplicate key exception while trying to create/update a skill, you should call this
   * method to tell you the name of the organization where the original Skill with the duplicate name
   * and media type was created. Putting the org name in a page message will let the user know where
   * they can find the original skill, in case they need to modify or delete it.
   *
   * @param skill - The Skill that the user is trying to create or update.
   * @return The organization name for the org where the original skill with the desired name and media
   * type was created.
   */
  public static String getOrgNameForDuplicateSkill(RequestContext context, Skill skill)
      throws BbmEJBCreateException, BbmFinderException, RemoteException {
<span class="nc" id="L217">    Skill originalSkill = WfmManagerFactory.getSkillManager().getSkillByNameAndMedia(skill.getName(), skill.getMediaID());</span>
<span class="nc bnc" id="L218" title="All 2 branches missed.">    return originalSkill == null ? &quot;&quot; : originalSkill.getOrganizationName();</span>
  }

}
</pre><div class="footer"><span class="right">Created with <a href="http://www.eclemma.org/jacoco">JaCoCo</a> 0.7.5.201505241946</span></div></body></html>