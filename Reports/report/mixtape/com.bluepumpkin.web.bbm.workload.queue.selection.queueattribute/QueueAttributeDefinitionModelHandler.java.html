<?xml version="1.0" encoding="UTF-8"?><!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd"><html xmlns="http://www.w3.org/1999/xhtml" lang="en"><head><meta http-equiv="Content-Type" content="text/html;charset=UTF-8"/><link rel="stylesheet" href="../.resources/report.css" type="text/css"/><link rel="shortcut icon" href="../.resources/report.gif" type="image/gif"/><title>QueueAttributeDefinitionModelHandler.java</title><link rel="stylesheet" href="../.resources/prettify.css" type="text/css"/><script type="text/javascript" src="../.resources/prettify.js"></script></head><body onload="window['PR_TAB_WIDTH']=4;prettyPrint()"><div class="breadcrumb" id="breadcrumb"><span class="info"><a href="../.sessions.html" class="el_session">Sessions</a></span><a href="../index.html" class="el_report">QA Code Coverage</a> &gt; <a href="index.source.html" class="el_package">com.bluepumpkin.web.bbm.workload.queue.selection.queueattribute</a> &gt; <span class="el_source">QueueAttributeDefinitionModelHandler.java</span></div><h1>QueueAttributeDefinitionModelHandler.java</h1><pre class="source lang-java linenums">package com.bluepumpkin.web.bbm.workload.queue.selection.queueattribute;

/**
 * Title:
 * Description:
 * Copyright:    Copyright (c) 2001
 * Company:      Blue Pumpkin Software, Inc
 * @author		Sankar Nair
 * @version 1.0
 */

import java.rmi.RemoteException;
import java.util.Collection;
import java.util.HashSet;

import com.bluepumpkin.common.datatypes.ID;
import com.bluepumpkin.ejb.bbm.base.BbmCreateException;
import com.bluepumpkin.ejb.bbm.base.BbmException;
import com.bluepumpkin.ejb.bbm.workload.ejb.WorkloadManager;
import com.bluepumpkin.ejb.bbm.workload.model.queueattribute.QueueAttributeDefintion;
import com.bluepumpkin.ejb.bbm.workload.model.queueattribute.QueueAttributePairDateValue;
import com.bluepumpkin.ejb.bbm.workload.model.queueattribute.QueueAttributePairDropDownValue;
import com.bluepumpkin.ejb.bbm.workload.model.queueattribute.QueueAttributePairNumericValue;
import com.bluepumpkin.ejb.bbm.workload.model.queueattribute.QueueAttributePairTextValue;
import com.bluepumpkin.ejb.bbm.workload.model.queueattribute.QueueAttributeType;
import com.bluepumpkin.ejb.core.base.MultiUserException;
import com.bluepumpkin.web.bbm.workresource.WorkResourceModelHandler;
import com.verint.ejb.wfm.WfmManagerFactory;
import com.verint.web.wfm.WfmModelHandler;
import com.witness.web.uif.system.RequestContext;


/**
 * Model handler for model &quot;OrganizationPageModel&quot;.
 * This class is used to retrieve a model from the cache, and use EJB managers to get value objects
 * into the model, and update the database by building value objects from the model data.
 * If you wish to automate model pre-loading via the xml &quot;load-model&quot; mapping,
 * you must include the getModel() method.
 * The page model contains certain members which correspond to jsp page data elements, like a pagebean.
 * It is vital that all of these members are set properly in the model either via getModel() the first
 * time the model is created, or via extractParameters() from the request handler, because the
 * model data is loaded from the EJB facade by using the model's &quot;pagebean-like&quot; members.
 * For example, the model data may include a list of all organizations which are children of an org id
 * entered from the jsp page.  When getModel() is called and finds that a new model must be created,
 * the value of &quot;selectedOrgId&quot; could be set to ROOT_ORG_ID via the setModelPageDefaults() method,
 * and to the value of &quot;selectedOrgId&quot; from the jsp page when its request handler executed the
 * extractParameters() method.  When getting a model from the request cache, it is assumed that a
 * request handler has already populated the model with the jsp pagebean elements from the request.&lt;br&gt;&lt;br&gt;
 * EJB accessors:
 *  Get Value Object: Collection of Organizations
 *  Put Value Object: Organization
 *  Delete Value Object: List of Org Ids
 * todo exceptions and errors need proper handling or direction back to mainservlet.
 * todo handle BbmCreateException and BbmDeleteException here.
 * todo Possible synchronization of tree on root node, since it is not thread-safe(?)
 */
<span class="nc" id="L57">public class QueueAttributeDefinitionModelHandler extends WorkResourceModelHandler {</span>
	
<span class="nc" id="L59">	public static final HashSet&lt;Integer&gt; SPECIAL_UDF_IDS = new HashSet&lt;Integer&gt;();</span>
	
	static{
<span class="nc" id="L62">		SPECIAL_UDF_IDS.add(0);</span>
<span class="nc" id="L63">		SPECIAL_UDF_IDS.add(1);</span>
<span class="nc" id="L64">		SPECIAL_UDF_IDS.add(2);</span>
<span class="nc" id="L65">		SPECIAL_UDF_IDS.add(3);</span>
<span class="nc" id="L66">		SPECIAL_UDF_IDS.add(4);</span>
<span class="nc" id="L67">		SPECIAL_UDF_IDS.add(5);</span>
<span class="nc" id="L68">		SPECIAL_UDF_IDS.add(6);</span>
<span class="nc" id="L69">		SPECIAL_UDF_IDS.add(7);</span>
<span class="nc" id="L70">		SPECIAL_UDF_IDS.add(8);</span>
<span class="nc" id="L71">		SPECIAL_UDF_IDS.add(9);</span>
<span class="nc" id="L72">		SPECIAL_UDF_IDS.add(10);</span>
<span class="nc" id="L73">	}</span>
	
	
	public Collection&lt;QueueAttributeDefintion&gt; getQueueAttributeDefinitions(RequestContext context, ID organizationID) throws BbmException, RemoteException {
<span class="nc" id="L77">		return getQueueAttributeDefinitions (context, organizationID, new ID (QueueAttributeDefintion.DEFAULT_MODULE_ID));</span>
	}
	
	public static Collection&lt;QueueAttributeDefintion&gt; getQueueAttributeDefinitions(RequestContext context, ID organizationID, ID moduleID) throws BbmException, RemoteException {
		//TODO: move method from WfmModelHandler to this class once workload code has been completely decoupled from foundation
<span class="nc" id="L82">		return WfmModelHandler.getQueueAttributeDefinitions(context, organizationID, moduleID);</span>
	}

	
	public Collection&lt;QueueAttributeDefintion&gt; getQueueAttributeDefinitions(RequestContext context, Collection&lt;ID&gt; organizationIDs, ID moduleID) throws BbmException, RemoteException {
		//TODO: move method from WfmModelHandler to this class once workload code has been completely decoupled from foundation
<span class="nc" id="L88">		return WfmModelHandler.getQueueAttributeDefinitions(context, organizationIDs, moduleID);</span>
	}
	
	public void createQueueAttributes(RequestContext context,  QueueAttributeDefintion attribute) throws BbmException, RemoteException {
<span class="nc bnc" id="L92" title="All 2 branches missed.">		if(attribute == null)</span>
<span class="nc" id="L93">			throw new BbmCreateException(&quot;Null object saved&quot;);</span>
		try {
<span class="nc bnc" id="L95" title="All 2 branches missed.">		if(attribute.getID() == null)</span>
<span class="nc" id="L96">			getWorkloadManager(context).createQueueAttributeDefinition(attribute);</span>
		else
<span class="nc" id="L98">			getWorkloadManager(context).updateQueueAttributeDefinition(attribute);</span>
<span class="nc" id="L99">		} catch(MultiUserException e) {</span>
<span class="nc" id="L100">			throw new BbmException(e);</span>
<span class="nc" id="L101">		}</span>
<span class="nc" id="L102">	}</span>
	
	public static Collection&lt;QueueAttributeType&gt; getQueueAttributeTypes(RequestContext context) throws BbmException, RemoteException {
<span class="nc" id="L105">		return getWorkloadManager(context).getQueueAttributeTypes();</span>
	}
	
	public static WorkloadManager getWorkloadManager(RequestContext context) throws BbmException {
<span class="nc" id="L109">		return 	WfmManagerFactory.getWorkloadManager(context.isInWhatIfMode());</span>
	}
	
	public static QueueAttributeDefintion getQueueAttributeByID(RequestContext context, ID attributeID) throws BbmException, RemoteException {
<span class="nc" id="L113">		return getWorkloadManager(context).getQueueAttributeByID(attributeID);</span>
	}

	public static void deleteDropDownValues(RequestContext context, Collection&lt;ID&gt; ids) throws BbmException, RemoteException {
<span class="nc" id="L117">		getWorkloadManager(context).deleteDropDownValues(ids);</span>
<span class="nc" id="L118">	}</span>
	
	public Collection&lt;QueueAttributePairDateValue&gt; getDateValues(RequestContext context, Collection&lt;ID&gt; queueID) throws BbmException, RemoteException {
<span class="nc" id="L121">		return getWorkloadManager(context).getQueueAttributePairDateValues(queueID);</span>
	}
	
	public Collection&lt;QueueAttributePairDropDownValue&gt; getDropDownValues(RequestContext context, Collection&lt;ID&gt; queueID) throws BbmException, RemoteException {
<span class="nc" id="L125">		return getWorkloadManager(context).getQueueAttributePairDropDownValues(queueID);</span>
	}
	
	public Collection&lt;QueueAttributePairTextValue&gt; getTextValues(RequestContext context, Collection&lt;ID&gt; queueID) throws BbmException, RemoteException {
<span class="nc" id="L129">		return getWorkloadManager(context).getQueueAttributePairTextValues(queueID);</span>
	}
	
	public Collection&lt;QueueAttributePairNumericValue&gt; getNumericValues(RequestContext context, Collection&lt;ID&gt; queueID) throws BbmException, RemoteException {
<span class="nc" id="L133">		return getWorkloadManager(context).getQueueAttributePairNumericValues(queueID);</span>
	}
	
	public void createTextValuePair(RequestContext context, Collection&lt;QueueAttributePairTextValue&gt; values) throws BbmException, RemoteException {
<span class="nc" id="L137">		getWorkloadManager(context).createQueueAttributePairTextValues(values);</span>
<span class="nc" id="L138">	}</span>
	
	public void createNumericValuePair(RequestContext context, Collection&lt;QueueAttributePairNumericValue&gt; values) throws BbmException, RemoteException {
<span class="nc" id="L141">		getWorkloadManager(context).createQueueAttributePairNumericValues(values);</span>
<span class="nc" id="L142">	}</span>
	
	public void createDropDownValuePair(RequestContext context, Collection&lt;QueueAttributePairDropDownValue&gt; values) throws BbmException, RemoteException {
<span class="nc" id="L145">		getWorkloadManager(context).createQueueAttributeDropDownTextValues(values);</span>
<span class="nc" id="L146">	}</span>
	
	public void createDateValuePair(RequestContext context, Collection&lt;QueueAttributePairDateValue&gt; values) throws BbmException, RemoteException {
<span class="nc" id="L149">		getWorkloadManager(context).createQueueAttributePairDateValues(values);</span>
<span class="nc" id="L150">	}</span>
	
	public void deleteQueueAttributePairValues(RequestContext context, Collection&lt;ID&gt; queueID, Collection&lt;ID&gt; attributesToBeRetained) throws BbmException, RemoteException {
<span class="nc" id="L153">		getWorkloadManager(context).deleteAllValuePair(queueID, attributesToBeRetained);</span>
<span class="nc" id="L154">	}</span>

	public void deleteQueueAttributeDefinition(RequestContext context, ID id) throws BbmException, RemoteException {
<span class="nc" id="L157">		getWorkloadManager(context).deleteQueueAttributeDefinition(id);</span>
<span class="nc" id="L158">	}</span>
}
</pre><div class="footer"><span class="right">Created with <a href="http://www.eclemma.org/jacoco">JaCoCo</a> 0.7.5.201505241946</span></div></body></html>