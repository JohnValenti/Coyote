<?xml version="1.0" encoding="UTF-8"?><!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd"><html xmlns="http://www.w3.org/1999/xhtml" lang="en"><head><meta http-equiv="Content-Type" content="text/html;charset=UTF-8"/><link rel="stylesheet" href="../.resources/report.css" type="text/css"/><link rel="shortcut icon" href="../.resources/report.gif" type="image/gif"/><title>Scenario.java</title><link rel="stylesheet" href="../.resources/prettify.css" type="text/css"/><script type="text/javascript" src="../.resources/prettify.js"></script></head><body onload="window['PR_TAB_WIDTH']=4;prettyPrint()"><div class="breadcrumb" id="breadcrumb"><span class="info"><a href="../.sessions.html" class="el_session">Sessions</a></span><a href="../index.html" class="el_report">QA Code Coverage</a> &gt; <a href="index.source.html" class="el_package">com.bluepumpkin.ejb.bbm.schedule.util.optimizeBreaks</a> &gt; <span class="el_source">Scenario.java</span></div><h1>Scenario.java</h1><pre class="source lang-java linenums">package com.bluepumpkin.ejb.bbm.schedule.util.optimizeBreaks;
import java.util.*;
import com.bluepumpkin.common.datatypes.Pair;

public class Scenario
{
	public Scenario(Date start, Date end)
<span class="nc" id="L8">	{</span>
<span class="nc" id="L9">		queues = new HashMap&lt;String, Queue&gt;();</span>
<span class="nc" id="L10">		activities = new HashMap&lt;String, Activity&gt;();</span>
<span class="nc" id="L11">		shiftEvents = new HashMap&lt;String, ShiftEvent&gt;();</span>
<span class="nc" id="L12">		this.intervalLength = 1; // 1 minute</span>
<span class="nc" id="L13">		objectiveFunction = new ObjectiveFunction();</span>
<span class="nc" id="L14">		this.start = start;</span>
<span class="nc" id="L15">		this.end = end;</span>
<span class="nc" id="L16">		numIntervals = (int)((new TimeSpan(start, end)).TotalMinutes / (double)intervalLength);</span>
<span class="nc" id="L17">		cal = new GregorianCalendar();</span>

<span class="nc" id="L19">	}</span>
	public void Initialize()
	{
<span class="nc bnc" id="L22" title="All 2 branches missed.">		for (Activity activity : activities.values())</span>
<span class="nc" id="L23">			activity.Initialize();</span>
<span class="nc" id="L24">		shift.Initialize();</span>
		
<span class="nc" id="L26">		Logger.Log(&quot;Model at start = &quot;);</span>
<span class="nc" id="L27">		Log();</span>
<span class="nc" id="L28">	}</span>
	public void SetAgent(Agent agent)
	{
<span class="nc" id="L31">		this.agent = agent;</span>
<span class="nc" id="L32">		Logger.Log(&quot;Set agent:&quot;);</span>
<span class="nc" id="L33">		agent.Log();</span>
<span class="nc" id="L34">	}</span>
	public Pair&lt;Integer, Integer&gt; TimeSpanToInterval(Pair&lt;TimeSpan, TimeSpan&gt; pair)
	{
<span class="nc" id="L37">		return new Pair&lt;Integer, Integer&gt;(TimeSpanToInterval(pair.getFirst()), TimeSpanToInterval(pair.getSecond()));</span>
	}
	public int MinutesToInterval(int m)
	{
<span class="nc" id="L41">		return m;</span>
	}
	public int IntervalToMinutes(int i)
	{
<span class="nc" id="L45">		return i;</span>
	}
	public int TimeSpanToInterval(TimeSpan timespan)
	{
<span class="nc" id="L49">		return (int)timespan.TotalMinutes / intervalLength;</span>
	}
	public TimeSpan IntervalToTimeSpan(int interval)
	{
<span class="nc" id="L53">		return new TimeSpan(0, interval * intervalLength, 0);</span>
	}
	public Date IntervalToDateTime(int interval)
	{
<span class="nc" id="L57">		cal.setTime(start);</span>
<span class="nc" id="L58">		cal.add(Calendar.MINUTE, interval * intervalLength);</span>
<span class="nc" id="L59">		return cal.getTime();</span>
	}
	public Pair&lt;Date, Date&gt; IntervalPairToDateTime(Pair&lt;Integer, Integer&gt; intervalPair)
	{
<span class="nc" id="L63">		Pair&lt;Date, Date&gt; dtPair = new Pair&lt;Date, Date&gt;();</span>
<span class="nc" id="L64">		dtPair.setFirst(IntervalToDateTime(intervalPair.getFirst()));</span>
<span class="nc" id="L65">		dtPair.setSecond(IntervalToDateTime(intervalPair.getSecond()));</span>
<span class="nc" id="L66">		return dtPair;</span>
	}
	public Pair&lt;TimeSpan, TimeSpan&gt; IntervalPairToTimeSpan(Pair&lt;Integer, Integer&gt; intervalPair)
	{
<span class="nc" id="L70">		Pair&lt;TimeSpan, TimeSpan&gt; tsPair = new Pair&lt;TimeSpan, TimeSpan&gt;();</span>
<span class="nc" id="L71">		tsPair.setFirst(IntervalToTimeSpan(intervalPair.getFirst()));</span>
<span class="nc" id="L72">		tsPair.setSecond(IntervalToTimeSpan(intervalPair.getSecond()));</span>
<span class="nc" id="L73">		return tsPair;</span>
	}

	public Pair&lt;Integer, Integer&gt; DateTimeToInterval(Pair&lt;Date, Date&gt; pair)
	{
<span class="nc" id="L78">		return new Pair&lt;Integer, Integer&gt;(DateTimeToInterval(pair.getFirst()), DateTimeToInterval(pair.getSecond()));</span>
	}
	public int DateTimeToInterval(Date date)
	{
<span class="nc" id="L82">		return (int)new TimeSpan(start, date).TotalMinutes / intervalLength;</span>
	}
	public void Log()
	{
<span class="nc" id="L86">		Logger.Log(&quot;Start = &quot; + start + &quot;, End = &quot; + end + &quot;, IntervalLength = &quot; + intervalLength);</span>
<span class="nc" id="L87">		Logger.Tab();</span>
<span class="nc" id="L88">		Logger.Log(&quot;Activities&quot;);</span>
<span class="nc" id="L89">		Logger.Tab();</span>
<span class="nc bnc" id="L90" title="All 2 branches missed.">		for (Activity activity : activities.values())</span>
		{
<span class="nc" id="L92">			activity.Log();</span>
<span class="nc" id="L93">		}</span>
<span class="nc" id="L94">		Logger.Untab();</span>
<span class="nc" id="L95">		Logger.Log(&quot;Queues&quot;);</span>
<span class="nc" id="L96">		Logger.Tab();</span>
<span class="nc bnc" id="L97" title="All 2 branches missed.">		for (Queue queue : queues.values())</span>
		{
<span class="nc" id="L99">			queue.Log();</span>
<span class="nc" id="L100">		}</span>
<span class="nc" id="L101">		Logger.Untab();</span>
<span class="nc" id="L102">		Logger.Log(&quot;Shift events&quot;);</span>
<span class="nc" id="L103">		Logger.Tab();</span>
<span class="nc bnc" id="L104" title="All 2 branches missed.">		for (ShiftEvent shiftEvent : shiftEvents.values())</span>
		{
<span class="nc" id="L106">			shiftEvent.Log();</span>
<span class="nc" id="L107">		}</span>
<span class="nc" id="L108">		Logger.Untab();</span>
<span class="nc" id="L109">		Logger.Untab();</span>
<span class="nc" id="L110">		shift.Log();</span>
<span class="nc" id="L111">		agent.Log();</span>
<span class="nc" id="L112">	}</span>

	Calendar cal;
	public ObjectiveFunction objectiveFunction;
	public int intervalLength;
	public int numIntervals;
	public Date start, end;
	public Agent agent;
	// Diagnostic
	public HashMap&lt;String, ShiftEvent&gt; shiftEvents;
	public HashMap&lt;String, Activity&gt; activities;
	public HashMap&lt;String, Queue&gt; queues;
	public Shift shift;
}
</pre><div class="footer"><span class="right">Created with <a href="http://www.eclemma.org/jacoco">JaCoCo</a> 0.7.5.201505241946</span></div></body></html>