<?xml version="1.0" encoding="UTF-8"?><!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd"><html xmlns="http://www.w3.org/1999/xhtml" lang="en"><head><meta http-equiv="Content-Type" content="text/html;charset=UTF-8"/><link rel="stylesheet" href="../.resources/report.css" type="text/css"/><link rel="shortcut icon" href="../.resources/report.gif" type="image/gif"/><title>PoolingRulesPopupPM.java</title><link rel="stylesheet" href="../.resources/prettify.css" type="text/css"/><script type="text/javascript" src="../.resources/prettify.js"></script></head><body onload="window['PR_TAB_WIDTH']=4;prettyPrint()"><div class="breadcrumb" id="breadcrumb"><span class="info"><a href="../.sessions.html" class="el_session">Sessions</a></span><a href="../index.html" class="el_report">QA Code Coverage</a> &gt; <a href="index.source.html" class="el_package">com.verint.web.fs.workrules.assignment</a> &gt; <span class="el_source">PoolingRulesPopupPM.java</span></div><h1>PoolingRulesPopupPM.java</h1><pre class="source lang-java linenums">package com.verint.web.fs.workrules.assignment;

import com.bluepumpkin.common.datatypes.Duration;
import com.bluepumpkin.common.datatypes.ID;
import com.bluepumpkin.common.datatypes.LocalDate;
import com.bluepumpkin.common.l10n.RegionalFormatBundleKey;
import com.bluepumpkin.common.util.StringUtil;
import com.bluepumpkin.common.util.TimeZoneUtil;
import com.bluepumpkin.ejb.bbm.BbmManagerFactory;
import com.bluepumpkin.ejb.bbm.empworkrule.ejb.EmpWorkRuleManager;
import com.bluepumpkin.ejb.bbm.empworkrule.model.EmpPoolingRule;
import com.bluepumpkin.ejb.bbm.people.model.EmployeeLocal;
import com.bluepumpkin.ejb.bbm.workresource.ejb.WorkResourceManager;
import com.bluepumpkin.ejb.bbm.workresource.model.Employee;
import com.bluepumpkin.ejb.bbm.workresource.model.Organization;
import com.bluepumpkin.web.bbm.keys.BbmJavaScriptFileID;
import com.bluepumpkin.web.bbm.organization.selection.OrganizationSelectorPC;
import com.bluepumpkin.web.bbm.people.profile.ProfileModelHandler;
import com.bluepumpkin.web.bbm.people.profile.effectivedate.BasePageModel;
import com.bluepumpkin.web.bbm.people.profile.effectivedate.DataContainerPC;
import com.bluepumpkin.web.fs.l10n.FsWebBundleKey;
import com.verint.ejb.wfm.WfmManagerFactory;
import com.witness.web.uif.keys.JavaScriptFileID;
import com.witness.web.uif.pagecomponent.DefaultMultiColumnNodeData;
import com.witness.web.uif.pagecomponent.MultiColumnNodeData;
import com.witness.web.uif.pagecomponent.picker.time.DurationSpinnerPC;
import com.witness.web.uif.pagecomponent.table.TableHeaderPC;
import com.witness.web.uif.pagemodel.PageModel;
import com.witness.web.uif.system.RequestContext;

import javax.servlet.http.HttpServletRequest;
import java.util.*;

public class PoolingRulesPopupPM extends BasePageModel {
	private static final long serialVersionUID = 1L;

	// Param names
	public static final String PARAM_MIN_PAID_NAME = &quot;minName&quot;;
	public static final String PARAM_UPDATE_MODE_NAME = &quot;updateModeName&quot;;
	public static final String PARAM_DATES_MODIFIED_NAME = &quot;datesModifiedName&quot;;
	public static final String PARAM_START_NAME = &quot;startName&quot;;
	public static final String PARAM_END_NAME = &quot;endName&quot;;
	public static final String PARAM_SECOND_ORGIDs = &quot;secondaryOrgsName&quot;;
	public static final String PARAM_ORGIDs = &quot;orgIds&quot;;

	// RP prefix is for request parameters
	private String rp_minName, /*rp_maxName, rp_otDayName, rp_otWeekName, rp_vtoDayName, rp_vtoWeekName, */
			rp_secondaryOrgsName, rp_updateModeName, rp_startName, rp_endName;
	private String rp_updateMode, rp_datesModifiedName;
	private String orgIds;

<span class="fc" id="L52">	public static String POOLINGRULES_POPUP_ID = &quot;POOLINGRULES_POPUP_ID&quot;;</span>
<span class="fc" id="L53">	public static String PARAM_PERIOD_ONLY = &quot;periodOnly&quot;;</span>
<span class="fc" id="L54">	public static String PARAM_START = &quot;start&quot;;</span>
<span class="fc" id="L55">	public static String PARAM_END = &quot;end&quot;;</span>

	//key = employee ID
<span class="nc" id="L58">	private HashMap&lt;ID, Employee&gt; employeeMap = new HashMap&lt;ID, Employee&gt;();</span>
<span class="nc" id="L59">	private ID[] selectedIDs = new ID[0];</span>
<span class="nc" id="L60">	private boolean periodOnly = false;</span>
<span class="nc" id="L61">	private Date start = new Date(), end = new Date(start.getTime() + (24 * 60 * 60 * 1000));</span>

	// Page Components
	private DurationSpinnerPC pc_minPaid;

	private OrganizationSelectorPC pc_orgSelPC;

	private MyDataContainer pc_dataContainer;

<span class="nc" id="L70">	private HashMap&lt;ID, Collection&lt;EmpPoolingRule&gt;&gt; hoursAssignments = new HashMap&lt;ID, Collection&lt;EmpPoolingRule&gt;&gt;();</span>

	public PoolingRulesPopupPM(RequestContext context) {
<span class="nc" id="L73">		super(context, &quot;poolingRulesPopupPM_updateParent();&quot;);</span>
<span class="nc" id="L74">		extractParameters(context.getRequest());</span>
<span class="nc" id="L75">		addRequiredJavaScriptFile(JavaScriptFileID.JQUERY);</span>
<span class="nc" id="L76">		addRequiredJavaScriptFile(BbmJavaScriptFileID.EFFECTIVE_DATES_UTIL);</span>
<span class="nc" id="L77">	}</span>

	@Override
	public boolean extractParameters(HttpServletRequest request) {
		// The popup manager names dynamic parameters to be the same name as the
		// form input name in the parent page, so extract the name first to get the value
<span class="nc" id="L83">		String updateModeName = request.getParameter(PARAM_UPDATE_MODE_NAME);</span>
<span class="nc bnc" id="L84" title="All 2 branches missed.">		if (!StringUtil.isEmpty(updateModeName)) {</span>
<span class="nc" id="L85">			String updateMode = request.getParameter(updateModeName);</span>
<span class="nc bnc" id="L86" title="All 2 branches missed.">			if (!StringUtil.isEmpty(updateMode)) {</span>
<span class="nc" id="L87">				setUpdateMode(updateMode);</span>
			}
		}

<span class="nc" id="L91">		boolean retVal = super.extractParameters(request);</span>

<span class="nc bnc" id="L93" title="All 2 branches missed.">		if (!StringUtil.isEmpty(selectedID)) {</span>
<span class="nc" id="L94">			selectedIDs = StringUtil.parseIDString(selectedID);</span>
		}

<span class="nc bnc" id="L97" title="All 2 branches missed.">		if (selectedIDs.length &gt; 1) {</span>
<span class="nc" id="L98">			m_isMultiEdit = true;</span>
<span class="nc" id="L99">			pc_dataContainer.setIsMultiEdit(true);</span>
		}

<span class="nc" id="L102">		return retVal;</span>
	}

	@Override
	protected void initializeModel() {
<span class="nc" id="L107">		super.initializeModel();</span>
<span class="nc bnc" id="L108" title="All 2 branches missed.">		if (m_isInitialized) {</span>
<span class="nc" id="L109">			return;</span>
		} else {
<span class="nc" id="L111">			m_isInitialized = true;</span>
		}

<span class="nc" id="L114">		TableHeaderPC header = m_historyPC.getHeader();</span>
<span class="nc" id="L115">		header.addColumnHeaderData(&quot;startDate&quot;, m_localizer.i18n(FsWebBundleKey.BUNDLE_NAME, FsWebBundleKey.FS_START_DATE));</span>
<span class="nc" id="L116">		header.addColumnHeaderData(&quot;endDate&quot;, m_localizer.i18n(FsWebBundleKey.BUNDLE_NAME, FsWebBundleKey.FS_END_DATE));</span>
<span class="nc" id="L117">		header.addColumnHeaderData(&quot;secondorgs&quot;, m_localizer.i18n(FsWebBundleKey.BUNDLE_NAME, FsWebBundleKey.POOLING_RULES_MIN_HOURS));</span>
<span class="nc" id="L118">		header.addColumnHeaderData(&quot;minhours&quot;, m_localizer.i18n(FsWebBundleKey.BUNDLE_NAME, FsWebBundleKey.POOLING_RULES_SECOND_ORGS));</span>

		try {
<span class="nc bnc" id="L121" title="All 2 branches missed.">			if (selectedIDs.length &gt; 0) {</span>
<span class="nc" id="L122">				setIsNewPerson(false);</span>
<span class="nc" id="L123">				Date viewDate = pc_dataContainer.getShowAsDate();</span>
<span class="nc" id="L124">				m_employee = new ProfileModelHandler().getEmpWithHistoryData(m_empID, viewDate, m_context.isInWhatIfMode());</span>
<span class="nc" id="L125">				WorkResourceManager wrMgr = BbmManagerFactory.getWorkResourceManager(m_context.isInWhatIfMode());</span>
<span class="nc" id="L126">				Collection&lt;Employee&gt; employees = wrMgr.getEmployeesByIDs(Arrays.asList(selectedIDs),</span>
						viewDate,
						Employee.DETAIL_LEVEL_EMPLOYEE_BASIC |
								Employee.DETAIL_LEVEL_EMPLOYEE_TIMEBASEDPROPERTY_HISTORY);
<span class="nc bnc" id="L130" title="All 4 branches missed.">				if (employees != null &amp;&amp; employees.size() &gt; 0) {</span>
<span class="nc" id="L131">					m_employee = employees.iterator().next();</span>
				}
<span class="nc bnc" id="L133" title="All 2 branches missed.">				for (Employee emp : employees) {</span>
<span class="nc" id="L134">					EmployeeLocal.convertEffectivitiesToLocalDate(emp);    //This will populate the local start/termination dates for the employee</span>
<span class="nc" id="L135">					employeeMap.put(emp.getID(), emp);</span>
<span class="nc" id="L136">				}</span>

<span class="nc" id="L138">				EmpWorkRuleManager ewrm = WfmManagerFactory.getEmpWorkRuleManager(m_context.isInWhatIfMode());</span>
<span class="nc" id="L139">				Date historyStart = new Date(new Date().getTime() - (100L * 365 * 24 * 60 * 60 * 1000)), historyEnd = new Date(new Date().getTime() + (100L * 365 * 24 * 60 * 60 * 1000));</span>
<span class="nc" id="L140">				hoursAssignments = ewrm.getPoolingRuleAssignments(Arrays.asList(selectedIDs), historyStart, historyEnd);</span>

<span class="nc bnc" id="L142" title="All 2 branches missed.">				if (hoursAssignments.size() == 0) {</span>
<span class="nc bnc" id="L143" title="All 2 branches missed.">					if (periodOnly) {</span>
<span class="nc" id="L144">						pc_dataContainer.setShowAsDate(new LocalDate(start, TimeZoneUtil.GMT_TIMEZONE));</span>
					} else {
<span class="nc" id="L146">						EmployeeLocal.convertEffectivitiesToLocalDate(m_employee);    //This will populate the local start/termination dates for the employee</span>
<span class="nc" id="L147">						pc_dataContainer.setShowAsDate(m_employee.getStartTimeLocal());</span>
					}
				} else {
<span class="nc" id="L150">					LocalDate earliestEffectiveStartDate = getEffectiveStartDateForViewPeriod();</span>
<span class="nc bnc" id="L151" title="All 2 branches missed.">					if (earliestEffectiveStartDate != null) {</span>
<span class="nc bnc" id="L152" title="All 2 branches missed.">						if (periodOnly) {</span>
<span class="nc" id="L153">							pc_dataContainer.setShowAsDate(new LocalDate(start, TimeZoneUtil.GMT_TIMEZONE));</span>
						} else {
<span class="nc" id="L155">							pc_dataContainer.setShowAsDate(earliestEffectiveStartDate);</span>
						}
					}
				}
<span class="nc bnc" id="L159" title="All 2 branches missed.">				if (periodOnly) {</span>
<span class="nc" id="L160">					pc_dataContainer.setViewPeriodEndDate(new LocalDate(end, TimeZoneUtil.GMT_TIMEZONE));</span>
				}
<span class="nc bnc" id="L162" title="All 2 branches missed.">				if (hoursAssignments.size() != 1) {</span>
<span class="nc" id="L163">					getContainers().remove(m_historyPC);</span>
				} else {
<span class="nc" id="L165">					List&lt;MultiColumnNodeData&gt; historyList = m_historyPC.getListModel();</span>
<span class="nc bnc" id="L166" title="All 2 branches missed.">					for (EmpPoolingRule wrmmh : hoursAssignments.values().iterator().next()) {</span>
<span class="nc" id="L167">						DefaultMultiColumnNodeData mcnd = new DefaultMultiColumnNodeData();</span>
<span class="nc" id="L168">						mcnd.add(m_localizer.formatDate(wrmmh.getStartTime(), m_employee.getTimeZone(wrmmh.getStartTime()), RegionalFormatBundleKey.DATE_FORMAT));</span>
<span class="nc bnc" id="L169" title="All 2 branches missed.">						if (wrmmh.getEndTime() == null) {</span>
<span class="nc" id="L170">							mcnd.add(&quot;&quot;);</span>
						} else {
<span class="nc" id="L172">							LocalDate recordEndDateDisplay = new LocalDate(wrmmh.getEndTime(), m_employee.getTimeZone(wrmmh.getEndTime()));</span>
<span class="nc" id="L173">							recordEndDateDisplay.add(Calendar.DATE, -1);</span>
<span class="nc" id="L174">							mcnd.add(m_localizer.formatDate(recordEndDateDisplay, RegionalFormatBundleKey.DATE_FORMAT));</span>
						}
<span class="nc" id="L176">						mcnd.add(m_localizer.formatDurationInMins(wrmmh.getMinMinutes()));</span>
<span class="nc" id="L177">						Collection orgIDs = wrmmh.getSecondaryOgs();</span>
<span class="nc" id="L178">						Collection orgs = wrMgr.getOrganizationsByIDs(orgIDs);</span>

<span class="nc" id="L180">						String strArray = &quot;&quot;;</span>
						;
<span class="nc bnc" id="L182" title="All 2 branches missed.">						for (Object objorg : orgs) {</span>
<span class="nc" id="L183">							Organization org = (Organization) objorg;</span>
<span class="nc" id="L184">							String name = org.getName();</span>
<span class="nc bnc" id="L185" title="All 2 branches missed.">							if (!strArray.isEmpty()) {</span>
<span class="nc" id="L186">								strArray += &quot;, &quot; + name;</span>
							} else {
<span class="nc" id="L188">								strArray = name;</span>
							}
<span class="nc" id="L190">						}</span>

<span class="nc" id="L192">						mcnd.add(strArray);</span>

<span class="nc" id="L194">						historyList.add(mcnd);</span>
<span class="nc" id="L195">					}</span>
				}

<span class="nc" id="L198">				pc_dataContainer.setRows(initializePoolingRows());</span>
<span class="nc" id="L199">				pc_dataContainer.setOnlyViewPeriodEditable(periodOnly);</span>
<span class="nc bnc" id="L200" title="All 2 branches missed.">				if (!StringUtil.isEmpty(rp_updateMode)) {</span>
<span class="nc" id="L201">					pc_dataContainer.setUpdateMode(rp_updateMode);</span>
				}

			}
<span class="nc" id="L205">		} catch (Exception ex) {</span>
<span class="nc" id="L206">			handleUnableToLoadDataError(log, ex);</span>
		} finally {
<span class="nc" id="L208">			initContentTitle();</span>
<span class="nc" id="L209">			initToolbar();</span>
<span class="nc" id="L210">		}</span>
<span class="nc" id="L211">	}</span>


	@Override
	public String getJavaScriptInitCode() {
<span class="nc" id="L216">		StringBuffer jsInit = new StringBuffer(super.getJavaScriptInitCode());</span>
<span class="nc" id="L217">		jsInit.append(pc_minPaid.getName()).append(&quot;.setTime(&quot;).append(&quot;opener.window.&quot;).append(rp_minName).append(&quot;.getTime()); \n&quot;);</span>
<span class="nc" id="L218">		jsInit.append(pc_minPaid.getName()).append(&quot;.setEdited(false); \n&quot;);</span>
<span class="nc bnc" id="L219" title="All 2 branches missed.">		if (pc_minPaid.isMultiEdit()) {</span>
<span class="nc" id="L220">			jsInit.append(&quot;jQuery('#&quot; + pc_minPaid.getMultiEditIndicatorID() + &quot;').show(); \n&quot;);</span>
		}

<span class="nc" id="L223">		jsInit.append(&quot;document.getElementById('&quot;).append(pc_orgSelPC.getName()).append(&quot;HiddenValue')&quot;).append(&quot;.value=&quot;).append(&quot;opener.window.document.getElementById('&quot;).append(rp_secondaryOrgsName).append(&quot;HiddenValue')&quot;).append(&quot;.value; \n&quot;);</span>
<span class="nc" id="L224">		jsInit.append(&quot;document.getElementById('&quot;).append(pc_orgSelPC.getName()).append(&quot;DisplayValue')&quot;).append(&quot;.value=&quot;).append(&quot;opener.window.document.getElementById('&quot;).append(rp_secondaryOrgsName).append(&quot;DisplayValue')&quot;).append(&quot;.value; \n&quot;);</span>


<span class="nc" id="L227">		jsInit.append(&quot;\npoolingRulesPopupPM_updateParent = function () { \n&quot;)</span>

<span class="nc" id="L229">				.append(&quot;opener.window.&quot;).append(rp_minName).append(&quot;.setTime(&quot;).append(pc_minPaid.getName()).append(&quot;.getTime()); \n&quot;)</span>

<span class="nc" id="L231">				.append(&quot;opener.window.document.getElementById('&quot;).append(rp_secondaryOrgsName).append(&quot;HiddenValue')&quot;).append(&quot;.value=&quot;).append(&quot;document.getElementById('&quot;).append(pc_orgSelPC.getName()).append(&quot;HiddenValue')&quot;).append(&quot;.value; \n&quot;)</span>
<span class="nc" id="L232">				.append(&quot;opener.window.document.getElementById('&quot;).append(rp_secondaryOrgsName).append(&quot;DisplayValue')&quot;).append(&quot;.value=&quot;).append(&quot;document.getElementById('&quot;).append(pc_orgSelPC.getName()).append(&quot;DisplayValue')&quot;).append(&quot;.value; \n&quot;)</span>

<span class="nc" id="L234">				.append(&quot;var updateMode = jQuery('[name=&quot;).append(DataContainerPC.UPDATE_MODE_FN).append(&quot;][checked]').val(); \n&quot;)</span>

<span class="nc" id="L236">				.append(&quot;setParentElement('&quot;).append(rp_updateModeName).append(&quot;', updateMode); \n&quot;)</span>
<span class="nc" id="L237">				.append(&quot;setParentElement('&quot;).append(rp_datesModifiedName).append(&quot;', 'true'); \n&quot;)</span>
<span class="nc" id="L238">				.append(&quot;updateEffectiveDates(null, '&quot;).append(rp_startName).append(&quot;', '&quot;).append(rp_endName).append(&quot;'); \n&quot;)</span>

<span class="nc" id="L240">				.append(&quot;window.close();\n&quot;)</span>
<span class="nc" id="L241">				.append(&quot;};\n&quot;);</span>
<span class="nc" id="L242">		return jsInit.toString();</span>
	}

	private void initContentTitle() {
<span class="nc" id="L246">		m_contentTitlePC.setPageTitle(m_localizer.i18n(FsWebBundleKey.BUNDLE_NAME, FsWebBundleKey.FS_POOLINGRULES_TITLE));</span>
<span class="nc bnc" id="L247" title="All 2 branches missed.">		if (selectedIDs.length &gt; 1) {</span>
<span class="nc" id="L248">			m_contentTitlePC.setItemName(m_localizer.i18n(FsWebBundleKey.BUNDLE_NAME, FsWebBundleKey.N_PEOPLE, selectedIDs.length));</span>
<span class="nc bnc" id="L249" title="All 2 branches missed.">		} else if (m_employee != null) {</span>
<span class="nc" id="L250">			m_contentTitlePC.setItemName(m_localizer.formatName(m_employee));</span>
		}
<span class="nc" id="L252">	}</span>

	@Override
	protected DataContainerPC createDataContainerPC() {
<span class="nc" id="L256">		pc_dataContainer = new MyDataContainer(m_context);</span>
<span class="nc" id="L257">		return pc_dataContainer;</span>
	}

	public static PoolingRulesPopupPM getInstance(RequestContext context) {
<span class="nc" id="L261">		return (PoolingRulesPopupPM) PageModel.getInstance(context, PoolingRulesPopupPM.class);</span>
	}

	private Collection&lt;MultiColumnNodeData&gt; initializePoolingRows() {
<span class="nc" id="L265">		Duration biggestMinPaid = Duration.fromMinutes(0);</span>
<span class="nc" id="L266">		Duration smallestMaxPaid = Duration.fromMinutes(Integer.MAX_VALUE);</span>
<span class="nc" id="L267">		Duration biggestOTPerDay = Duration.fromMinutes(0);</span>
<span class="nc" id="L268">		Duration smallestOTPerWeek = Duration.fromMinutes(Integer.MAX_VALUE);</span>
<span class="nc" id="L269">		Duration biggestVTOPerDay = Duration.fromMinutes(0);</span>
<span class="nc" id="L270">		Duration smallestVTOPerWeek = Duration.fromMinutes(Integer.MAX_VALUE);</span>

<span class="nc" id="L272">		ArrayList&lt;MultiColumnNodeData&gt; retVal = new ArrayList&lt;MultiColumnNodeData&gt;();</span>

<span class="nc" id="L274">		pc_minPaid = new DurationSpinnerPC(m_context, &quot;minPaid&quot;);</span>
<span class="nc" id="L275">		pc_minPaid.setMaxTime(99, 45, 0);</span>
<span class="nc" id="L276">		pc_minPaid.setMinutesIncrement(15);</span>
<span class="nc" id="L277">		pc_minPaid.setValue(Duration.fromMinutes(45));</span>
<span class="nc" id="L278">		addChildComponent(pc_minPaid);</span>
<span class="nc" id="L279">		DefaultMultiColumnNodeData row = new DefaultMultiColumnNodeData();</span>
<span class="nc" id="L280">		row.add(m_localizer.i18n(FsWebBundleKey.BUNDLE_NAME, FsWebBundleKey.POOLING_RULES_MIN_HOURS));</span>
<span class="nc" id="L281">		row.add(pc_minPaid);</span>
<span class="nc" id="L282">		retVal.add(row);</span>

<span class="nc" id="L284">		pc_orgSelPC = new OrganizationSelectorPC(m_context, m_toolbar);</span>

<span class="nc" id="L286">		addChildComponent(pc_orgSelPC);</span>
<span class="nc" id="L287">		row = new DefaultMultiColumnNodeData();</span>
<span class="nc" id="L288">		row.add(m_localizer.i18n(FsWebBundleKey.BUNDLE_NAME, FsWebBundleKey.POOLING_RULES_SECOND_ORGS));</span>
<span class="nc" id="L289">		row.add(pc_orgSelPC);</span>
<span class="nc" id="L290">		retVal.add(row);</span>

<span class="nc" id="L292">		return retVal;</span>
	}

	/**
	 * Returns the effective start date to be displayed in the start date picker for the given
	 * date range.  This date is the view period start date, unless the employee has start date
	 * after that in which case the employee's start date will be used.
	 */
	private LocalDate getEffectiveStartDateForViewPeriod() {
<span class="nc bnc" id="L301" title="All 2 branches missed.">		if (m_isMultiEdit) {</span>
<span class="nc" id="L302">			return new LocalDate(start, TimeZoneUtil.GMT_TIMEZONE);</span>
<span class="nc bnc" id="L303" title="All 4 branches missed.">		} else if (employeeMap.get(m_empID).getStartTime() != null &amp;&amp; employeeMap.get(m_empID).getStartTime().after(start)) {</span>
<span class="nc" id="L304">			return new LocalDate(employeeMap.get(m_empID).getStartTime(),</span>
<span class="nc" id="L305">					employeeMap.get(m_empID).getTimeZone(employeeMap.get(m_empID).getStartTime()));</span>
		}
<span class="nc" id="L307">		return new LocalDate(start, TimeZoneUtil.GMT_TIMEZONE);</span>
	}

	private class MyDataContainer extends DataContainerPC {
<span class="nc" id="L311">		public MyDataContainer(RequestContext context) {</span>
<span class="nc" id="L312">			super(context);</span>
<span class="nc" id="L313">		}</span>

		private Collection&lt;MultiColumnNodeData&gt; rows;

		public void setRows(Collection&lt;MultiColumnNodeData&gt; rows) {
<span class="nc" id="L318">			this.rows = rows;</span>
<span class="nc" id="L319">		}</span>

		private static final long serialVersionUID = 1L;

		@Override
		protected void addCustomDataRow() {
<span class="nc bnc" id="L325" title="All 2 branches missed.">			if (rows != null) {</span>
<span class="nc bnc" id="L326" title="All 2 branches missed.">				for (MultiColumnNodeData mcnd : rows) {</span>
<span class="nc" id="L327">					this.addRowData(mcnd);</span>
<span class="nc" id="L328">				}</span>
			}
<span class="nc" id="L330">		}</span>

		//This is only used in campaign mode.  We need to force the end date to match the end date
		// of the scheduling period.
		public void setViewPeriodEndDate(LocalDate endDate) {
<span class="nc" id="L335">			this.endDate = endDate;</span>
<span class="nc" id="L336">		}</span>

		//This is the start date that is shown for the &quot;Insert value&quot; sections
		public void setShowAsDate(LocalDate showAsDate) {
<span class="nc" id="L340">			this.showAsDate = showAsDate;</span>
<span class="nc" id="L341">		}</span>
	}

	public void setPeriodOnly(boolean periodOnly) {
<span class="nc" id="L345">		this.periodOnly = periodOnly;</span>
<span class="nc" id="L346">	}</span>

	public void setStart(long start) {
<span class="nc" id="L349">		this.start = new Date(start);</span>
<span class="nc" id="L350">	}</span>

	public void setEnd(long end) {
<span class="nc" id="L353">		this.end = new Date(end);</span>
<span class="nc" id="L354">	}</span>

	public void setMinName(String minName) {
<span class="nc" id="L357">		this.rp_minName = minName;</span>
<span class="nc" id="L358">	}</span>

	public void setUpdateModeName(String updateModeName) {
<span class="nc" id="L361">		this.rp_updateModeName = updateModeName;</span>
<span class="nc" id="L362">	}</span>

	public void setUpdateMode(String updateMode) {
<span class="nc" id="L365">		this.rp_updateMode = updateMode;</span>
<span class="nc" id="L366">	}</span>

	public void setStartName(String startName) {
<span class="nc" id="L369">		this.rp_startName = startName;</span>
<span class="nc" id="L370">	}</span>

	public void setEndName(String endName) {
<span class="nc" id="L373">		this.rp_endName = endName;</span>
<span class="nc" id="L374">	}</span>

	public void setDatesModifiedName(String datesModifiedName) {
<span class="nc" id="L377">		this.rp_datesModifiedName = datesModifiedName;</span>
<span class="nc" id="L378">	}</span>

	public void setSecondaryOrgsName(String secondaryOrgsName) {
<span class="nc" id="L381">		this.rp_secondaryOrgsName = secondaryOrgsName;</span>
<span class="nc" id="L382">	}</span>

	public void setOrgIds(String orgIds) {
<span class="nc" id="L385">		this.orgIds = orgIds;</span>
<span class="nc" id="L386">	}</span>
}
</pre><div class="footer"><span class="right">Created with <a href="http://www.eclemma.org/jacoco">JaCoCo</a> 0.7.5.201505241946</span></div></body></html>