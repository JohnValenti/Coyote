<?xml version="1.0" encoding="UTF-8"?><!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd"><html xmlns="http://www.w3.org/1999/xhtml" lang="en"><head><meta http-equiv="Content-Type" content="text/html;charset=UTF-8"/><link rel="stylesheet" href="../.resources/report.css" type="text/css"/><link rel="shortcut icon" href="../.resources/report.gif" type="image/gif"/><title>ProfileEntry.java</title><link rel="stylesheet" href="../.resources/prettify.css" type="text/css"/><script type="text/javascript" src="../.resources/prettify.js"></script></head><body onload="window['PR_TAB_WIDTH']=4;prettyPrint()"><div class="breadcrumb" id="breadcrumb"><span class="info"><a href="../.sessions.html" class="el_session">Sessions</a></span><a href="../index.html" class="el_report">QA Code Coverage</a> &gt; <a href="index.source.html" class="el_package">com.verint.ejb.bbm.forecast.model.history</a> &gt; <span class="el_source">ProfileEntry.java</span></div><h1>ProfileEntry.java</h1><pre class="source lang-java linenums">/*
 * ï¿½ 2010-2012 Verint Systems, Inc.
 */
package com.verint.ejb.bbm.forecast.model.history;

import java.util.Date;
import java.util.List;

import com.bluepumpkin.common.datatypes.TimeContext;
import com.verint.ejb.bbm.forecast.ProfileComponentUtil;
import com.verint.ejb.bbm.forecast.model.ProfileComponent;
import com.verint.ejb.bbm.forecast.model.ProfileComponent.Type;

/**
 * ProfileEntry is a wrapper class for a {@link ProfileComponent} value object.
 */
public class ProfileEntry {
	private ProfileComponent m_profileComponent;
	private Date m_referenceDate;
	private TimeContext m_timeContext;
	private final String m_queueName;
	private final ProfileEntryHistoryPeriod m_historyPeriod;
	private Date m_absoluteDate;

	/**
	 * Copy constructor. Clones the underlying profile component and sets the ID and ParentID fields
	 * to null. Copies the reference date and time context.
	 * @param profileEntry
	 */
<span class="nc" id="L30">	public ProfileEntry(ProfileEntry profileEntry) {</span>
		try {
<span class="nc" id="L32">			this.m_profileComponent = (ProfileComponent) profileEntry.m_profileComponent.clone();</span>
<span class="nc" id="L33">			this.m_profileComponent.setParentID(null);</span>
<span class="nc" id="L34">			this.m_profileComponent.setID(null);</span>
			
<span class="nc" id="L36">			this.m_referenceDate = profileEntry.m_referenceDate;</span>
<span class="nc" id="L37">			this.m_timeContext = profileEntry.m_timeContext;</span>
<span class="nc" id="L38">			this.m_queueName = profileEntry.getQueueName();</span>
<span class="nc" id="L39">			this.m_historyPeriod = profileEntry.m_historyPeriod;</span>
<span class="nc" id="L40">		} catch (CloneNotSupportedException e) {</span>
<span class="nc" id="L41">			throw new RuntimeException(e);</span>
<span class="nc" id="L42">		}</span>
		
<span class="nc" id="L44">	}</span>

<span class="nc" id="L46">	public ProfileEntry(ProfileEntry entry, TimeContext timeContext, Date referenceDate, String queueName) {</span>
		try {
<span class="nc" id="L48">			this.m_profileComponent = (ProfileComponent)entry.getProfileComponent().clone();</span>
		}
<span class="nc" id="L50">		catch (CloneNotSupportedException cnse) {</span>
<span class="nc" id="L51">			throw new IllegalArgumentException(&quot;Tried to copy a ProfileEntry with an uncloneable ProfileComponent.&quot;);</span>
<span class="nc" id="L52">		}</span>
<span class="nc" id="L53">		this.m_referenceDate = referenceDate;</span>
<span class="nc" id="L54">		this.m_timeContext = timeContext;</span>
<span class="nc" id="L55">		this.m_queueName = queueName;</span>
<span class="nc" id="L56">		m_historyPeriod = HistoryPeriodFactory.createHistoryPeriodFromProfileComponent(entry.getProfileComponent(), referenceDate, timeContext);</span>
<span class="nc" id="L57">		setHistoryPeriodFieldsOnProfileComponent();</span>
<span class="nc" id="L58">	}</span>
	
	/**
	 * Constructs a Profile Entry from the given profileComponent.
	 * NOTE: If this component is relative, it may update the custom date fields of the profile component on
	 * creation of the Profile Entry (this will happen for components with monthly history periods upon loading
	 * of a relative forecast profile).
	 */
<span class="nc" id="L66">	public ProfileEntry(ProfileComponent profileComponent, TimeContext timeContext, Date referenceDate, String queueName) {</span>
<span class="nc" id="L67">		this.m_profileComponent = profileComponent;</span>
<span class="nc" id="L68">		this.m_referenceDate = referenceDate;</span>
<span class="nc" id="L69">		this.m_timeContext = timeContext;</span>
<span class="nc" id="L70">		this.m_queueName = queueName;</span>
<span class="nc" id="L71">		m_historyPeriod = HistoryPeriodFactory.createHistoryPeriodFromProfileComponent(profileComponent, referenceDate, timeContext);</span>
<span class="nc bnc" id="L72" title="All 2 branches missed.">		if (profileComponent.getType().equals(Type.Absolute)) {</span>
<span class="nc" id="L73">			setAbsoluteDate(m_historyPeriod.getAbsoluteStartDate());</span>
		}
<span class="nc" id="L75">		setHistoryPeriodFieldsOnProfileComponent();</span>
<span class="nc" id="L76">	}</span>
	
	/**
	 * Constructs a Profile Entry with the given history period, weight, and queue name.
	 */
<span class="nc" id="L81">	public ProfileEntry(ProfileEntryHistoryPeriod historyPeriod, float weight, String queueName) {</span>
<span class="nc" id="L82">		m_historyPeriod = historyPeriod;</span>
<span class="nc" id="L83">		m_timeContext = historyPeriod.getTimeContext();</span>
<span class="nc" id="L84">		m_referenceDate = historyPeriod.getSpWeekStartDate();</span>
<span class="nc" id="L85">		m_queueName = queueName;</span>
<span class="nc" id="L86">		m_profileComponent = new ProfileComponent();</span>
<span class="nc" id="L87">		ProfileComponentUtil.setAbsoluteDate(m_profileComponent, historyPeriod.getAbsoluteStartDate());</span>
<span class="nc" id="L88">		m_profileComponent.setWeight(weight);</span>
<span class="nc" id="L89">		setHistoryPeriodFieldsOnProfileComponent();</span>
<span class="nc" id="L90">	}</span>

	public ProfileEntryHistoryPeriod getHistoryPeriod() {
<span class="nc" id="L93">		return m_historyPeriod;</span>
	}
	
	public Float getWeight() {
<span class="nc" id="L97">		return m_profileComponent.getWeight();</span>
	}

	public void setWeight(float weight) {
<span class="nc" id="L101">		m_profileComponent.setWeight(weight);</span>
<span class="nc" id="L102">	}</span>

	public ProfileComponent getProfileComponent() {
<span class="nc" id="L105">		return m_profileComponent;</span>
	}
	
	public String getQueueName() {
<span class="nc" id="L109">		return m_queueName;</span>
	}

	public String getName() {
<span class="nc" id="L113">		return m_profileComponent.getName();</span>
	}

	public void setName(String name) {
<span class="nc" id="L117">		m_profileComponent.setName(name);</span>
<span class="nc" id="L118">	}</span>

	public Date getAbsoluteDate() {
<span class="nc" id="L121">		return m_absoluteDate;</span>
	}

	public void setAbsoluteDate(Date absoluteDate) {
<span class="nc" id="L125">		m_absoluteDate = absoluteDate;</span>
<span class="nc" id="L126">		ProfileComponentUtil.setAbsoluteDate(m_profileComponent, absoluteDate);</span>
<span class="nc" id="L127">	}</span>

	/**
	 * For relative profiles, returns an integer value representing the number
	 * of weeks or months for which the relative profile is offset.
	 *
	 * For weekly profiles, returns a positive number representing the number of
	 * weeks in the past this profile should be offset.
	 *
	 * For monthly profiles, returns a negative number representing the number of
	 * months in the past this profile should be offset.  This negative behavior is
	 * to match the behavior of the older FS client.
	 */
	public int getRelativeOffset() {
<span class="nc bnc" id="L141" title="All 2 branches missed.">		if (getProfileComponentType().equals(Type.Relative)) {</span>
<span class="nc" id="L142">			return Integer.parseInt(m_profileComponent.getValue());</span>
		} else {
<span class="nc" id="L144">			throw new IllegalArgumentException(&quot;ProfileEntry.getRelativeOffset is not valid for absolute profiles!&quot;);</span>
		}
	}

	public Date getDate(TimeContext timeContext, Date referenceDate) {
<span class="nc" id="L149">		return ProfileComponentUtil.getDate(m_profileComponent, timeContext, referenceDate);</span>
	}

	public Type getProfileComponentType() {
<span class="nc" id="L153">		return m_profileComponent.getType();</span>
	}

	public boolean isCustomWeek() {
<span class="nc" id="L157">		return m_profileComponent.isCustomWeek();</span>
	}

	public List&lt;Date&gt; getCustomDates() {
<span class="nc" id="L161">		return m_profileComponent.getCustomDates();</span>
	}

	public boolean isMonthly() {
<span class="nc" id="L165">		return m_profileComponent.isMonthly();</span>
	}

	public int getMonth() {
<span class="nc" id="L169">		return m_profileComponent.getMonth();</span>
	}

	public int getYear() {
<span class="nc" id="L173">		return m_profileComponent.getYear();</span>
	}

	@Override
	public boolean equals(Object obj) {
<span class="nc bnc" id="L178" title="All 2 branches missed.">		if (this == obj) {</span>
<span class="nc" id="L179">			return true;</span>
		}
<span class="nc bnc" id="L181" title="All 2 branches missed.">		if ( ! (obj instanceof ProfileEntry) ) {</span>
<span class="nc" id="L182">			return false;</span>
		}
<span class="nc" id="L184">		ProfileEntry other = (ProfileEntry)obj;</span>
<span class="nc" id="L185">		Float myWeight = getWeight();</span>
<span class="nc" id="L186">		Float otherWeight = other.getWeight();</span>
<span class="nc bnc" id="L187" title="All 4 branches missed.">		if (myWeight == null || otherWeight == null) {</span>
<span class="nc bnc" id="L188" title="All 2 branches missed.">			if (myWeight != otherWeight) {</span>
<span class="nc" id="L189">				return false;</span>
			}
<span class="nc bnc" id="L191" title="All 2 branches missed.">		} else if ( ! myWeight.equals(otherWeight) ) {</span>
<span class="nc" id="L192">			return false;	</span>
		}
<span class="nc bnc" id="L194" title="All 2 branches missed.">		if ( ! getHistoryPeriod().equals(other.getHistoryPeriod()) ) {</span>
<span class="nc" id="L195">			return false;</span>
		}
<span class="nc" id="L197">		return true;</span>
	}
	
	@Override
	public int hashCode() {
<span class="nc" id="L202">		return (&quot;&quot; + getWeight() + getHistoryPeriod()).hashCode();</span>
	}
	
	/**
	 * Sets the history period related fields of the backing profile component object
	 * (used if the history period type is monthly or custom week).
	 */
	private void setHistoryPeriodFieldsOnProfileComponent() {
<span class="nc bnc" id="L210" title="All 4 branches missed.">		switch (m_historyPeriod.getIntervalType()) {</span>
		case Week:
<span class="nc" id="L212">			break;</span>
		case Month:
<span class="nc" id="L214">			m_profileComponent.setIsMonthly(true);</span>
<span class="nc" id="L215">			m_profileComponent.setMonth(((MonthlyHistoryPeriod)m_historyPeriod).getMonth());</span>
<span class="nc" id="L216">			m_profileComponent.setYear(((MonthlyHistoryPeriod)m_historyPeriod).getYear());</span>
<span class="nc" id="L217">			m_profileComponent.setCustomDates(m_historyPeriod.getDatesInPeriod());</span>
<span class="nc" id="L218">			break;</span>
		case CustomWeek:
<span class="nc" id="L220">			m_profileComponent.setIsCustomWeek(true);</span>
<span class="nc" id="L221">			m_profileComponent.setCustomDates(m_historyPeriod.getDatesInPeriod());</span>
<span class="nc" id="L222">			break;</span>
		default:
			break;
		}
<span class="nc" id="L226">	}</span>
}
</pre><div class="footer"><span class="right">Created with <a href="http://www.eclemma.org/jacoco">JaCoCo</a> 0.7.5.201505241946</span></div></body></html>