<?xml version="1.0" encoding="UTF-8"?><!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd"><html xmlns="http://www.w3.org/1999/xhtml" lang="en"><head><meta http-equiv="Content-Type" content="text/html;charset=UTF-8"/><link rel="stylesheet" href="../.resources/report.css" type="text/css"/><link rel="shortcut icon" href="../.resources/report.gif" type="image/gif"/><title>RmSetupUtil.java</title><link rel="stylesheet" href="../.resources/prettify.css" type="text/css"/><script type="text/javascript" src="../.resources/prettify.js"></script></head><body onload="window['PR_TAB_WIDTH']=4;prettyPrint()"><div class="breadcrumb" id="breadcrumb"><span class="info"><a href="../.sessions.html" class="el_session">Sessions</a></span><a href="../index.html" class="el_report">QA Code Coverage</a> &gt; <a href="index.source.html" class="el_package">com.bluepumpkin.web.rm.setup</a> &gt; <span class="el_source">RmSetupUtil.java</span></div><h1>RmSetupUtil.java</h1><pre class="source lang-java linenums">package com.bluepumpkin.web.rm.setup;

import java.text.DateFormat;
import java.text.ParseException;
import java.text.ParsePosition;
import java.util.Arrays;
import java.util.Calendar;
import java.util.Date;
import java.util.Locale;
import java.util.Map;
import java.util.ResourceBundle;
import java.util.TimeZone;

import com.bluepumpkin.common.datatypes.ID;
import com.bluepumpkin.common.datatypes.LocalDate;
import com.bluepumpkin.common.l10n.RegionalFormatBundleKey;
import com.bluepumpkin.common.localization.Localizer;
import com.bluepumpkin.common.util.StringUtil;
import com.bluepumpkin.common.util.TimeZoneUtil;
import com.bluepumpkin.ejb.rm.l10n.RmEjbBundleKey;
import com.bluepumpkin.web.bbm.organization.OrganizationModelHandler;
import com.bluepumpkin.web.rm.l10n.RmWebBundleKey;
import com.bluepumpkin.web.rm.validation.ValidationRulesMap;
import com.witness.web.uif.pagecomponent.DefaultMultiColumnNodeData;
import com.witness.web.uif.pagemodel.WorkpaneListPageModel;
import com.witness.web.uif.system.RequestContext;
import com.witness.web.uif.util.HtmlUtil;
import com.witness.web.uif.util.html.HtmlChoiceInput;
import com.witness.web.uif.util.js.JSUtil;

/**
 * Title:        RmSetupUtil
 * Description:  Convenient Utilities to enable code reuse
 * Copyright:    Copyright (c) 2002
 * Company:      Blue Pumpkin Software, Inc
 * @author       David Su, dsu
 * @version      1.0
 *
 * Created on December 20, 2002, 4:33 PM
 */
<span class="nc" id="L41">public class RmSetupUtil {</span>
	/** field names */
	public static final String APPLIED_RULE_FN = &quot;appliedRuleIds&quot;;
	public static final String TOTAL_RULE_FN   = &quot;totalRuleIds&quot;;

	/** label keys */
	public static final String APPLY_LABEL               = &quot;APPLY_LABEL&quot;;
	public static final String REQ_TYPE_LABEL            = &quot;REQ_TYPE_LABEL&quot;;
	public static final String WHICH_REQUEST_LABEL       = &quot;WHICH_REQUEST_LABEL&quot;;
	public static final String ORGANIZATION_LABEL        = &quot;ORGANIZATION_LABEL&quot;;

	public static final String IS_EDITABLE = WorkpaneListPageModel.IS_EDITABLE;
	public static final String IS_DELETEABLE = WorkpaneListPageModel.IS_DELETEABLE;
	public static final String IS_COPYABLE = WorkpaneListPageModel.IS_COPYABLE;
	public static final String COPY_ITEM_NAME = WorkpaneListPageModel.COPY_ITEM_NAME;
	public static final String COPY_ITEM_OBJ_TYPE = WorkpaneListPageModel.COPY_ITEM_OBJ_TYPE;

	public static final String REQUEST_SUB_TYPE_REG_NEW_SHIFT_FN = &quot;requestSubTypeRegNewShift&quot;;
	public static final String REQUEST_SUB_TYPE_REG_SHIFT_CHANGE_FN = &quot;requestSubTypeRegShiftChange&quot;;
	public static final String REQUEST_SUB_TYPE_OT_NEW_SHIFT_FN = &quot;requestSubTypeOTNewShift&quot;;
	public static final String REQUEST_SUB_TYPE_OT_SHIFT_CHANGE_FN = &quot;requestSubTypeOTShiftChange&quot;;
	public static final String STORED_DATE_FORMAT_HAS_TIME = &quot;yyyy-MM-dd HH:mm:ss&quot;;
	public static final String STORED_DATE_FORMAT = &quot;yyyy-MM-dd&quot;;

	/**
	 * Add Row Attributes
	 */
	public static void addRowAttr(String sIsEditable, boolean isConfigEnabled,
			int copyObjType, DefaultMultiColumnNodeData row_data) {
<span class="nc" id="L70">		String sIsCopyable = String.valueOf(isConfigEnabled);</span>

<span class="nc" id="L72">		Map nodeAttr = row_data.getNodeAttributes();</span>
<span class="nc" id="L73">		nodeAttr.put(IS_EDITABLE, sIsEditable);</span>
<span class="nc" id="L74">		nodeAttr.put(IS_DELETEABLE, sIsEditable);</span>
<span class="nc" id="L75">		nodeAttr.put(IS_COPYABLE, sIsCopyable);</span>
<span class="nc" id="L76">		nodeAttr.put(COPY_ITEM_NAME, &quot;&quot;);</span>
<span class="nc" id="L77">		nodeAttr.put(COPY_ITEM_OBJ_TYPE, Integer.toString(copyObjType));</span>
<span class="nc" id="L78">	}</span>

    /**
     * Add Row Attributes
     */
    public static void addRowAttr(String sIsEditable, boolean isConfigEnabled,
            String copyObjType, DefaultMultiColumnNodeData row_data) {
<span class="fc" id="L85">        String sIsCopyable = String.valueOf(isConfigEnabled);</span>

<span class="fc" id="L87">        Map nodeAttr = row_data.getNodeAttributes();</span>
<span class="fc" id="L88">        nodeAttr.put(IS_EDITABLE, sIsEditable);</span>
<span class="fc" id="L89">        nodeAttr.put(IS_DELETEABLE, sIsEditable);</span>
<span class="fc" id="L90">        nodeAttr.put(IS_COPYABLE, sIsCopyable);</span>
<span class="fc" id="L91">        nodeAttr.put(COPY_ITEM_NAME, &quot;&quot;);</span>
<span class="fc" id="L92">        nodeAttr.put(COPY_ITEM_OBJ_TYPE, copyObjType);</span>
<span class="fc" id="L93">    }</span>

	/**
	 * Return Applied Rule Checkbox
	 */
	public static String createApplyChkBox(String rowID, boolean isApplied, boolean isConfigEnabled) {
<span class="pc bpc" id="L99" title="1 of 2 branches missed.">		return</span>
<span class="pc bpc" id="L100" title="1 of 2 branches missed.">				HtmlChoiceInput.makeChkBoxInput(APPLIED_RULE_FN, rowID, &quot;&quot;, isApplied, !isConfigEnabled, JSUtil.ON_CHANGE) +</span>
				// only if the user can configure the row should
				// we use the rule id when the save applied
				// button is pressed. Without this logic the
				// applied button could change the state of
				// rows the user doesn't have access to.
<span class="pc" id="L106">				(isConfigEnabled ? HtmlUtil.makeHiddenInput(TOTAL_RULE_FN,rowID) : &quot;&quot;);</span>
	}

	/**
	 * Return Localized Date Display
	 */
	public static String getDateDisplay(RequestContext context, Date date, TimeZone tz) {
<span class="nc" id="L113">		Localizer localizer = context.getLocalizer();</span>
<span class="nc" id="L114">		return localizer.formatDateTime(date, tz);</span>
	}

	public static TimeZone getOrgTimeZone(RequestContext context, ID orgID){
<span class="fc" id="L118">		TimeZone orgTimeZone = context.getViewingTimeZone();</span>
<span class="pc bpc" id="L119" title="1 of 2 branches missed.">		if (orgID != null){</span>
			try {
				//get the org id
<span class="fc" id="L122">				orgTimeZone = OrganizationModelHandler.getOrganization(context, orgID).getTimeZone();</span>
<span class="pc" id="L123">			} catch (Exception ex){}</span>
		}
<span class="fc" id="L125">		return orgTimeZone;</span>
	}

    /**
     * Return the four Custom Shift subtype checkboxes section for the Custom Shift Filing Rule and
     * Custom Shift Auto Processing rule edit pages.
     * @return String - html for the row
     */
    public static String geCustomShiftCheckboxesRow(ResourceBundle rmBundle, Localizer localizer,
    		boolean isNewShift, boolean isShiftChange, boolean isNewOTShift, boolean isOTShiftChange)
    {
<span class="nc" id="L136">        String regularLabel = localizer.i18n(rmBundle, RmWebBundleKey.ORG_RM_FILING_RULE_REGULAR);</span>
<span class="nc" id="L137">        String overtimeLabel = localizer.i18n(rmBundle, RmWebBundleKey.ORG_RM_FILING_RULE_OVERTIME);</span>

<span class="nc" id="L139">        ResourceBundle rmEjbBundle = localizer.getBundle(RmEjbBundleKey.BUNDLE_NAME);</span>
<span class="nc" id="L140">        String newShiftLabel = localizer.i18n(rmEjbBundle, RmEjbBundleKey.ORG_RM_FILING_RULE_REG_NEW_SHIFT);</span>
<span class="nc" id="L141">        String shiftChangeLabel = localizer.i18n(rmEjbBundle, RmEjbBundleKey.ORG_RM_FILING_RULE_REG_SHIFT_CHANGE);</span>

<span class="nc" id="L143">        String html = &quot;&lt;table&gt;&quot;;</span>

        //Header Row
<span class="nc" id="L146">        html += &quot;&lt;tr&gt;&quot;;</span>
<span class="nc" id="L147">        html += &quot;&lt;td class=\&quot;formRowLightNoBorderBottom2\&quot;&gt;&quot;;</span>
<span class="nc" id="L148">        html += &quot;&lt;b&gt;&quot; + regularLabel + &quot;&lt;/b&gt;&quot;;</span>
<span class="nc" id="L149">        html += &quot;&lt;/td&gt;&quot;;</span>
<span class="nc" id="L150">        html += &quot;&lt;td width='50'&gt;&amp;nbsp;&quot;;</span>
<span class="nc" id="L151">        html += &quot;&lt;/td&gt;&quot;;</span>
<span class="nc" id="L152">        html += &quot;&lt;td class=\&quot;formRowLightNoBorderBottom2\&quot;&gt;&quot;;</span>
<span class="nc" id="L153">        html += &quot;&lt;b&gt;&quot; + overtimeLabel + &quot;&lt;/b&gt;&quot;;</span>
<span class="nc" id="L154">        html += &quot;&lt;/td&gt;&quot;;</span>
<span class="nc" id="L155">        html += &quot;&lt;/tr&gt;&quot;;</span>

        //first checkbox Row
<span class="nc" id="L158">        html += &quot;&lt;tr&gt;&quot;;</span>
<span class="nc" id="L159">        html += &quot;&lt;td class=\&quot;formRowLightNoBorderBottom2\&quot;&gt;&quot;;</span>
<span class="nc" id="L160">        html += HtmlChoiceInput.makeChkBoxInput(REQUEST_SUB_TYPE_REG_NEW_SHIFT_FN,</span>
    			REQUEST_SUB_TYPE_REG_NEW_SHIFT_FN,
                &quot;&quot;, //label
                isNewShift, //isChecked
                false,  //isDisabled,
                JSUtil.ON_CHANGE) //onClickJS
            + newShiftLabel;
<span class="nc" id="L167">        html += &quot;&lt;/td&gt;&quot;;</span>
<span class="nc" id="L168">        html += &quot;&lt;td width='50'&gt;&amp;nbsp;&quot;;</span>
<span class="nc" id="L169">        html += &quot;&lt;/td&gt;&quot;;</span>
<span class="nc" id="L170">        html += &quot;&lt;td class=\&quot;formRowLightNoBorderBottom2\&quot;&gt;&quot;;</span>
<span class="nc" id="L171">        html += HtmlChoiceInput.makeChkBoxInput(REQUEST_SUB_TYPE_OT_NEW_SHIFT_FN,</span>
        		REQUEST_SUB_TYPE_OT_NEW_SHIFT_FN,
                &quot;&quot;, //label
                isNewOTShift, //isChecked
                false,  //isDisabled,
                JSUtil.ON_CHANGE) //onClickJS
            + newShiftLabel;
<span class="nc" id="L178">        html += &quot;&lt;/td&gt;&quot;;</span>
<span class="nc" id="L179">        html += &quot;&lt;/tr&gt;&quot;;</span>

        //second checkbox Row
<span class="nc" id="L182">        html += &quot;&lt;tr&gt;&quot;;</span>
<span class="nc" id="L183">        html += &quot;&lt;td class=\&quot;formRowLightNoBorderBottom2\&quot;&gt;&quot;;</span>
<span class="nc" id="L184">        html += HtmlChoiceInput.makeChkBoxInput(REQUEST_SUB_TYPE_REG_SHIFT_CHANGE_FN,</span>
        		REQUEST_SUB_TYPE_REG_SHIFT_CHANGE_FN,
                &quot;&quot;, //label
                isShiftChange, //isChecked
                false,  //isDisabled,
                JSUtil.ON_CHANGE) //onClickJS
            + shiftChangeLabel;
<span class="nc" id="L191">        html += &quot;&lt;/td&gt;&quot;;</span>
<span class="nc" id="L192">        html += &quot;&lt;td width='50'&gt;&amp;nbsp;&quot;;</span>
<span class="nc" id="L193">        html += &quot;&lt;/td&gt;&quot;;</span>
<span class="nc" id="L194">        html += &quot;&lt;td class=\&quot;formRowLightNoBorderBottom2\&quot;&gt;&quot;;</span>
<span class="nc" id="L195">        html += HtmlChoiceInput.makeChkBoxInput(REQUEST_SUB_TYPE_OT_SHIFT_CHANGE_FN,</span>
        		REQUEST_SUB_TYPE_OT_SHIFT_CHANGE_FN,
            &quot;&quot;, //label
            isOTShiftChange, //isChecked
            false,  //isDisabled,
            JSUtil.ON_CHANGE) //onClickJS
        + shiftChangeLabel;
<span class="nc" id="L202">        html += &quot;&lt;/td&gt;&quot;;</span>
<span class="nc" id="L203">        html += &quot;&lt;/tr&gt;&quot;;</span>

<span class="nc" id="L205">        html += &quot;&lt;/table&gt; &lt;p&gt;&amp;nbsp;&quot;;</span>
<span class="nc" id="L206">        return html;</span>
    }

	/**
	 * Return Custom JavaScript.  Requires that jQuery has been loaded onto the page.
	 */
	public static String getCustomJavaScriptBodyForCustShift(Localizer localizer, ResourceBundle bundle)
	{
<span class="nc" id="L214">		String str = (&quot;var regNewShift = jQuery('[name=&quot; + RmSetupUtil.REQUEST_SUB_TYPE_REG_NEW_SHIFT_FN + &quot;]').is(':checked'); \n&quot;);</span>
<span class="nc" id="L215">		str+=(&quot;var regShiftChange = jQuery('[name=&quot; + RmSetupUtil.REQUEST_SUB_TYPE_REG_SHIFT_CHANGE_FN + &quot;]').is(':checked'); \n&quot;);</span>
<span class="nc" id="L216">		str+=(&quot;var otNewShift = jQuery('[name=&quot; + RmSetupUtil.REQUEST_SUB_TYPE_OT_NEW_SHIFT_FN + &quot;]').is(':checked'); \n&quot;);</span>
<span class="nc" id="L217">		str+=(&quot;var otShiftChange = jQuery('[name=&quot; + RmSetupUtil.REQUEST_SUB_TYPE_OT_SHIFT_CHANGE_FN + &quot;]').is(':checked'); \n&quot;);</span>
<span class="nc" id="L218">		str+=(&quot;if (!regNewShift &amp;&amp; !regShiftChange &amp;&amp; !otNewShift &amp;&amp; !otShiftChange) { \n&quot;);</span>
<span class="nc" id="L219">		str+=(&quot;alert('&quot; + localizer.i18n(bundle, RmWebBundleKey.ORG_RM_FILING_RULE_SUBTYPE_VALIDATION) + &quot;'); \n&quot;);</span>
<span class="nc" id="L220">		str+=(&quot;return false;\n&quot;);</span>
<span class="nc" id="L221">		str+=(&quot;} \n&quot;);</span>
<span class="nc" id="L222">		return str;</span>
	}

	/**
	 * Return Custom JavaScript.  Requires that jQuery has been loaded onto the page.
	 */
	public static void getCustomJavaScriptForCustShift(StringBuffer sb, Localizer localizer, ResourceBundle bundle)
	{
		// Create Custom validation Function
<span class="nc" id="L231">		sb.append(&quot;function customValidateForm() {\n&quot;);</span>
<span class="nc" id="L232">		sb.append(getCustomJavaScriptBodyForCustShift(localizer, bundle));</span>
<span class="nc" id="L233">		sb.append(&quot;return true;\n&quot;);</span>
<span class="nc" id="L234">		sb.append(&quot;}\n&quot;);</span>
<span class="nc" id="L235">	}</span>
	/**
	 *Extract the string of hh:mm:ss to an array contains hour, minute, second in integer
	 */
	private static String[] extractHourMinuteFromStrTime(String strTime, Localizer localizer) {
<span class="nc" id="L240">		String result[] = null;</span>
<span class="nc" id="L241">		String durationSeparator = localizer.i18n(RegionalFormatBundleKey.BUNDLE_NAME, RegionalFormatBundleKey.DURATION_SEPARATOR);</span>
<span class="nc bnc" id="L242" title="All 4 branches missed.">		if(!StringUtil.isEmpty(strTime)&amp;&amp; strTime.contains(durationSeparator)) {</span>
<span class="nc" id="L243">			result = strTime.split(durationSeparator);</span>
		}
<span class="nc" id="L245">		return result;</span>
	}

	public static int[] getHourMinuteFromStrTime(String strTime, Localizer localizer) throws NumberFormatException{
<span class="nc" id="L249">		String[] strArray = extractHourMinuteFromStrTime(strTime, localizer);</span>
<span class="nc" id="L250">		int result[] = new int[2];</span>
<span class="nc bnc" id="L251" title="All 4 branches missed.">		if (strArray!=null &amp;&amp; strArray.length&gt;0) {</span>
<span class="nc" id="L252">			result[0]=Integer.parseInt(strArray[0]);</span>
<span class="nc" id="L253">			result[1]=Integer.parseInt(strArray[1]);</span>
		}
		else {
<span class="nc" id="L256">			result[0] =0;</span>
<span class="nc" id="L257">			result[1] =0;</span>
		}
<span class="nc" id="L259">		return result;</span>
	}
	/**
	 * Get the date given a string Use SimpleDateFormat to parse return Date
	 * It may return null if wrong locale
	 */
	public static Date getDateFromStr(String str, Locale locale) throws ParseException{
<span class="nc" id="L266">		DateFormat df = DateFormat.getDateInstance(DateFormat.SHORT, locale);</span>
<span class="nc" id="L267">		df.setTimeZone(TimeZoneUtil.GMT_TIMEZONE);</span>
<span class="nc" id="L268">		ParsePosition pp = new ParsePosition(0);</span>
<span class="nc" id="L269">		return df.parse(str, pp);</span>

	}
	public static LocalDate getLocaleDateFromStr(String str, Locale locale,int hour, int minute) throws ParseException{
<span class="nc" id="L273">		Date date= getDateFromStr(str,locale);</span>
<span class="nc" id="L274">		LocalDate localDate = null;</span>
<span class="nc bnc" id="L275" title="All 2 branches missed.">		if(date!=null) {</span>
<span class="nc" id="L276">			Calendar cal = Calendar.getInstance(TimeZoneUtil.GMT_TIMEZONE);</span>
<span class="nc" id="L277">			cal.clear();</span>
<span class="nc" id="L278">			cal.setTime(date);</span>
<span class="nc" id="L279">			localDate = new LocalDate(cal.get(Calendar.YEAR),cal.get(Calendar.MONTH),cal.get(Calendar.DATE), hour,minute);</span>
		}
<span class="nc" id="L281">		return localDate;</span>

	}
	public static Date getFullDate(String strTime, Locale locale,TimeZone tz,int hour, int minute) throws ParseException{
<span class="nc" id="L285">		LocalDate localDate = getLocaleDateFromStr(strTime,locale,hour,minute);</span>
<span class="nc" id="L286">		Date returnDate= null;</span>
<span class="nc bnc" id="L287" title="All 2 branches missed.">		if(localDate!=null) {</span>
			//Convert to GMT from LocalDateTime based on TimeZoneI
<span class="nc" id="L289">			returnDate = localDate.getTime(tz,false);</span>
		}
<span class="nc" id="L291">		return returnDate;</span>
	}

	public static final double convertLocalizedRealNumber(String value, Localizer localizer) {
<span class="nc" id="L295">		double result = 0;String tmpValue= value;</span>
<span class="nc" id="L296">		String DEFAULT_DEC_NUM_SEPARATOR = &quot;.&quot;;</span>
<span class="nc bnc" id="L297" title="All 2 branches missed.">		if (!StringUtil.isEmpty(value)) {</span>
<span class="nc" id="L298">			String dec_point = localizer.getDecimalNumberInputSeparator();</span>
<span class="nc bnc" id="L299" title="All 2 branches missed.">			if (value.indexOf(dec_point)!=-1) {</span>
<span class="nc" id="L300">				tmpValue = StringUtil.replace(value, dec_point, DEFAULT_DEC_NUM_SEPARATOR);</span>
			}
		}
<span class="nc bnc" id="L303" title="All 2 branches missed.">		if (tmpValue!=null) {</span>
			try {
<span class="nc" id="L305">				result = Double.parseDouble(tmpValue);</span>
<span class="nc" id="L306">			} catch(Exception ex) {</span>
				// ignore
<span class="nc" id="L308">			}</span>
		}
<span class="nc" id="L310">		return result;</span>
	}

	public static String[] getCustomShiftKeys() {
<span class="fc" id="L314">		return new String[] { ValidationRulesMap.VALIDATION_CS_FULFILLS_NET_STAFFING_SHORTAGE,</span>
				ValidationRulesMap.VALIDATION_CS_MAX_SHIFT_DURATION_PER_DAY,
				ValidationRulesMap.VALIDATION_CS_MIN_SHIFT_DURATION_PER_DAY,
				ValidationRulesMap.VALIDATION_CS_MAX_CONSECUTIVE_WORKING_DAYS,
				ValidationRulesMap.VALIDATION_CS_MIN_TIME_BETWEEN_SHIFT_ASSIGNMENTS,
				ValidationRulesMap.VALIDATION_CS_COMPLY_RULES,
				ValidationRulesMap.VALIDATION_CS_COMPLY_HRS,
				ValidationRulesMap.VALIDATION_CS_COMPLY_HOO,
				ValidationRulesMap.VALIDATION_CS_TIMEOFF_OVERLAP,
				ValidationRulesMap.VALIDATION_CS_UNAVAILABILITY_OVERLAP,
				ValidationRulesMap.VALIDATION_CS_PUBLISHED_PERIOD };
	}

	public static String[] getTimeOffKeys(boolean hasAdvancedLicense){
<span class="fc" id="L328">	    String[] toKeys =</span>
	    	new String[] { ValidationRulesMap.VALIDATION_AVAILABLE_TO_HRS,
	    			ValidationRulesMap.VALIDATION_AVOID_BLACKOUT,
	                ValidationRulesMap.VALIDATION_ENOUGH_TO_HRS,
	                ValidationRulesMap.VALIDATION_COMPLY_FILINGRULE,
	                ValidationRulesMap.VALIDATION_TO_NOT_SWAPPED,
	                ValidationRulesMap.VALIDATION_AVOID_CAL_EVENTS,
	                ValidationRulesMap.VALIDATION_REQ_MIN_DURATION,
	                ValidationRulesMap.VALIDATION_REQ_MAX_DURATION,
	                ValidationRulesMap.VALIDATION_REQUEST_IN_PAST,
	                ValidationRulesMap.VALIDATION_VTO_REDUCE_NET_STAFFING_SURPLUS,
	                ValidationRulesMap.VALIDATION_VTO_COMPLY_MAX_VTO_HRS
	                };
<span class="fc" id="L341">	    String[] newToKeys = toKeys;</span>
<span class="pc bpc" id="L342" title="1 of 2 branches missed.">	    if(hasAdvancedLicense){</span>
<span class="nc" id="L343">	    	newToKeys= addElement(newToKeys,ValidationRulesMap.VALIDATION_TOB_COMPLY_MAX_EMPLOYEE_APPROVAL);</span>
<span class="nc" id="L344">	    	newToKeys= addElement(newToKeys,ValidationRulesMap.VALIDATION_TOB_SUBMITTED_DATE);</span>
<span class="nc" id="L345">	    	newToKeys= addElement(newToKeys,ValidationRulesMap.VALIDATION_TOB_DONOT_APPROVE_OVERLAP_REQUEST);</span>
<span class="nc" id="L346">	    	return newToKeys;</span>
	    } else {
<span class="fc" id="L348">			return toKeys;</span>
		}
	}

	/**
	 * Get an array of all of the Time Off validations that also appear on the Flex Time auto processing page.
	 */
	public static String[] getTimeOffKeysForFlexTimeAutoProcessing() {
<span class="fc" id="L356">		String[] toKeys =</span>
				new String[] { ValidationRulesMap.VALIDATION_AVAILABLE_TO_HRS,
						ValidationRulesMap.VALIDATION_AVOID_BLACKOUT,
						ValidationRulesMap.VALIDATION_ENOUGH_TO_HRS,
						ValidationRulesMap.VALIDATION_TO_NOT_SWAPPED,
						ValidationRulesMap.VALIDATION_REQUEST_IN_PAST };

<span class="fc" id="L363">		return toKeys;</span>
	}

	public static String[] getTimeOffWithdrawKeys() {
<span class="fc" id="L367">		return new String[] {</span>
				ValidationRulesMap.VALIDATION_APPROVED_TO_WITHDRAW_COMPLY_FILINGRULE };
	}

	/**
	 * Get an array of all of the Flex Time request validation rules (no Time Off validations included).
	 */
	public static String[] getFlexTimeKeys() {
<span class="fc" id="L375">		String[] ftKeys =</span>
				new String[] { ValidationRulesMap.VALIDATION_FT_MAX_DURATION,
						ValidationRulesMap.VALIDATION_FT_MIN_DURATION,
						ValidationRulesMap.VALIDATION_FT_MAX_NUMBER_MAKEUP_PER_REQUEST,
						ValidationRulesMap.VALIDATION_FT_MAX_NUMBER_FLEX_REQ_PER_PERIOD,
						ValidationRulesMap.VALIDATION_FT_MUST_OCCUR_ASAP,
						ValidationRulesMap.VALIDATION_FT_AVOID_SCHEDULED_CALENDAR_EVENTS,
						ValidationRulesMap.VALIDATION_FT_COMPLYING_FILING_RULES,
						ValidationRulesMap.VALIDATION_FT_MAKEUP_COMPLYING_HOO,
						ValidationRulesMap.VALIDATION_FT_MIN_GAP_BETWEEN_CONSECUTIVE_SHIFTS,
						ValidationRulesMap.VALIDATION_FT_MAX_SHIFT_DURATION};
<span class="fc" id="L386">		return ftKeys;</span>
	}

	/**
	 * Get an array of all of the Flex Time request validation rules + all of the Time Off validation rules.
	 * This list is needed for the auto processing page for Flex Time requests.
	 */
	public static String[] getFlexTimeAutoProcessingKeys() {
<span class="fc" id="L394">		String[] ftKeys = getFlexTimeKeys();</span>
<span class="fc" id="L395">		String[] toKeys = getTimeOffKeysForFlexTimeAutoProcessing();</span>

<span class="fc bfc" id="L397" title="All 2 branches covered.">		for (int i=0; i &lt; toKeys.length; i++) {</span>
<span class="fc" id="L398">			ftKeys= addElement(ftKeys, toKeys[i]);</span>
		}
<span class="fc" id="L400">		return ftKeys;</span>
	}

	public static String[] getShiftBidKeys() {
<span class="fc" id="L404">		return new String[] { ValidationRulesMap.VALIDATION_SB_COMPLY_RULES,</span>
				ValidationRulesMap.VALIDATION_SB_COMPLY_HRS,
				ValidationRulesMap.VALIDATION_SB_COMPLY_SKILLS,
				ValidationRulesMap.VALIDATION_SB_COMPLY_AT_LEAST_SKILLS,
				ValidationRulesMap.VALIDATION_SB_COMPLY_HOO };
	}

	public static String[] getShiftSwapKeys(boolean hasAdvancedLicense) {
<span class="fc" id="L412">		String[] ssKeys =</span>
			new String[]{
				ValidationRulesMap.VALIDATION_SS_SAME_CALL_CENTER,
	            ValidationRulesMap.VALIDATION_SS_SAME_CAMPAIGN,
	            ValidationRulesMap.VALIDATION_SS_SAME_SKILLS,
	            ValidationRulesMap.VALIDATION_SS_AT_LEAST_SAME_SKILLS,
	            ValidationRulesMap.VALIDATION_SS_SAME_PROFICIENCY,
	            ValidationRulesMap.VALIDATION_SS_COMPLY_RULES,
	            ValidationRulesMap.VALIDATION_SS_COMPLY_HRS,
	            ValidationRulesMap.VALIDATION_SS_SHIFT_START,
	            ValidationRulesMap.VALIDATION_SS_PAID_HRS,
	            ValidationRulesMap.VALIDATION_SS_NO_EVENT_OVERLAP,
	            ValidationRulesMap.VALIDATION_SS_EVENT_MUST_OVERLAP,
	            ValidationRulesMap.VALIDATION_PSS_MIN_SHIFT_SWAP_DURATION,
	            ValidationRulesMap.VALIDATION_PSS_MIN_REMAINING_SHIFT_DURATION,
	            ValidationRulesMap.VALIDATION_PSS_MAX_SWAP_DURATION_PER_DAY,
	            ValidationRulesMap.VALIDATION_PSS_NON_SWAPPABLE_ACTIVITIES,
	            ValidationRulesMap.VALIDATION_PSS_SHIFT_GAP_CONDITIONS,
	            ValidationRulesMap.VALIDATION_PSS_MAX_ALLOWABLE_OVERLAP,
	            ValidationRulesMap.VALIDATION_SS_MAX_CONSECUTIVE_WORKING_DAYS,
	            ValidationRulesMap.VALIDATION_SS_MIN_TIME_BETWEEN_SHIFT_ASSIGNMENTS
		};
<span class="fc" id="L434">		String [] newKeys = ssKeys;</span>
<span class="pc bpc" id="L435" title="1 of 2 branches missed.">		if (hasAdvancedLicense) {</span>
<span class="nc" id="L436">			newKeys= addElement(newKeys, ValidationRulesMap.VALIDATION_SS_MAX_ONE_WAY_SWAP_PER_PERSON_PERIOD);</span>
<span class="nc" id="L437">			newKeys= addElement(newKeys, ValidationRulesMap.VALIDATION_SS_MAX_APPROVED_SWAP_PER_SHIFT);</span>
<span class="nc" id="L438">			newKeys= addElement(newKeys, ValidationRulesMap.VALIDATION_PSS_MAX_APPROVED_PARTIAL_SWAPS_PER_SHIFT);</span>
<span class="nc" id="L439">			newKeys= addElement(newKeys,ValidationRulesMap.VALIDATION_SS_MAX_HOURS_ALTERNATE_MAX_HOURS_PER_DAY);</span>
<span class="nc" id="L440">			return newKeys;</span>
		} else {
<span class="fc" id="L442">			return ssKeys;</span>
		}
	}

	public static String[] getShiftSwapAutoProcessingKeys(boolean hasAdvancedLicense) {
<span class="fc" id="L447">		return getShiftSwapKeys(hasAdvancedLicense);</span>
	}

	/**
	 * Get an array of all of the Shift Swap validations that also appear on the ShiftSwapWithdrawl auto processing page.
	 */
	public static String[] getShiftSwapKeysForShiftSwapWithdrawlAutoProcessing() {
<span class="fc" id="L454">		String[] ssKeys =</span>
				new String[]{
					ValidationRulesMap.VALIDATION_SS_SAME_CALL_CENTER,
					ValidationRulesMap.VALIDATION_SS_SAME_CAMPAIGN,
					ValidationRulesMap.VALIDATION_SS_SAME_SKILLS,
					ValidationRulesMap.VALIDATION_SS_AT_LEAST_SAME_SKILLS,
					ValidationRulesMap.VALIDATION_SS_SAME_PROFICIENCY,
					ValidationRulesMap.VALIDATION_SS_COMPLY_HRS,
					ValidationRulesMap.VALIDATION_SS_SHIFT_START,
					ValidationRulesMap.VALIDATION_SS_PAID_HRS,
					ValidationRulesMap.VALIDATION_SS_NO_EVENT_OVERLAP,
					ValidationRulesMap.VALIDATION_SS_EVENT_MUST_OVERLAP,
					ValidationRulesMap.VALIDATION_PSS_MIN_SHIFT_SWAP_DURATION,
					ValidationRulesMap.VALIDATION_PSS_MIN_REMAINING_SHIFT_DURATION,
					ValidationRulesMap.VALIDATION_PSS_MAX_SWAP_DURATION_PER_DAY,
					ValidationRulesMap.VALIDATION_PSS_NON_SWAPPABLE_ACTIVITIES,
					ValidationRulesMap.VALIDATION_PSS_SHIFT_GAP_CONDITIONS,
					ValidationRulesMap.VALIDATION_PSS_MAX_ALLOWABLE_OVERLAP,
					ValidationRulesMap.VALIDATION_SS_MAX_CONSECUTIVE_WORKING_DAYS,
					ValidationRulesMap.VALIDATION_SS_MIN_TIME_BETWEEN_SHIFT_ASSIGNMENTS,
					ValidationRulesMap.VALIDATION_SS_MAX_HOURS_ALTERNATE_MAX_HOURS_PER_DAY
			};
<span class="fc" id="L476">			return ssKeys;</span>
	}

	/**
	 * Get an array of all of the ShiftSwapWithdrawl request validation rules (regular Shift Swap rules included).
	 * Based on Advanced RM License
	 */
	public static String[] getShiftSwapWithdrawlKeys(boolean hasAdvancedLicense) {
<span class="nc" id="L484">		String[] sswKeys = new String[] {};</span>
<span class="nc bnc" id="L485" title="All 2 branches missed.">		if(hasAdvancedLicense) {</span>
<span class="nc" id="L486">			sswKeys= addElement(sswKeys, ValidationRulesMap.VALIDATION_APPROVED_SS_WITHDRAW_COMPLY_FILINGRULE);</span>
		}
<span class="nc" id="L488">		return sswKeys;</span>
	}

	/**
	 * Get an array of all of the ShiftSwapWithdrawl request validation rules (regular Shift Swap rules included).
	 */
	public static String[] getShiftSwapWithdrawlKeys() {
<span class="fc" id="L495">		String[] sswKeys =</span>
				new String[] { ValidationRulesMap.VALIDATION_APPROVED_SS_WITHDRAW_COMPLY_FILINGRULE };
<span class="fc" id="L497">		return sswKeys;</span>
	}

	/**
	 * Get an array of all of the ShiftSwapWithdrawl validation rules + all of the Shift Swap validation rules.
	 * This list is needed for the auto processing page for ShiftSwapWithdrawl requests.
	 */
	public static String[] getShiftSwapWithdrawlAutoProcessingKeys() {
<span class="fc" id="L505">		String[] sswKeys = getShiftSwapWithdrawlKeys();</span>
<span class="fc" id="L506">		String[] ssKeys = getShiftSwapKeysForShiftSwapWithdrawlAutoProcessing();</span>

<span class="fc bfc" id="L508" title="All 2 branches covered.">		for (int i=0; i &lt; ssKeys.length; i++) {</span>
<span class="fc" id="L509">			sswKeys= addElement(sswKeys, ssKeys[i]);</span>
		}
<span class="fc" id="L511">		return sswKeys;</span>
	}

	/**
	 * Returns whether the key is a validation rule that contains parameters.
	 */
	public static boolean isParamRule(String key) { // NOSONAR
<span class="fc bfc" id="L518" title="All 2 branches covered.">        return key.equals(ValidationRulesMap.VALIDATION_PSS_MIN_SHIFT_SWAP_DURATION) // NOSONAR</span>
<span class="fc bfc" id="L519" title="All 2 branches covered.">                || key.equals(ValidationRulesMap.VALIDATION_PSS_MIN_REMAINING_SHIFT_DURATION)</span>
<span class="fc bfc" id="L520" title="All 2 branches covered.">                || key.equals(ValidationRulesMap.VALIDATION_PSS_MAX_SWAP_DURATION_PER_DAY)</span>
<span class="fc bfc" id="L521" title="All 2 branches covered.">                || key.equals(ValidationRulesMap.VALIDATION_PSS_NON_SWAPPABLE_ACTIVITIES)</span>
<span class="fc bfc" id="L522" title="All 2 branches covered.">                || key.equals(ValidationRulesMap.VALIDATION_PSS_SHIFT_GAP_CONDITIONS)</span>
<span class="fc bfc" id="L523" title="All 2 branches covered.">                || key.equals(ValidationRulesMap.VALIDATION_PSS_MAX_ALLOWABLE_OVERLAP)</span>
<span class="fc bfc" id="L524" title="All 2 branches covered.">                || key.equals(ValidationRulesMap.VALIDATION_REQ_MIN_DURATION)</span>
<span class="fc bfc" id="L525" title="All 2 branches covered.">                || key.equals(ValidationRulesMap.VALIDATION_REQ_MAX_DURATION)</span>
<span class="fc bfc" id="L526" title="All 2 branches covered.">                || key.equals(ValidationRulesMap.VALIDATION_FT_MAX_DURATION)</span>
<span class="fc bfc" id="L527" title="All 2 branches covered.">                || key.equals(ValidationRulesMap.VALIDATION_FT_MIN_DURATION)</span>
<span class="fc bfc" id="L528" title="All 2 branches covered.">                || key.equals(ValidationRulesMap.VALIDATION_FT_MAX_NUMBER_MAKEUP_PER_REQUEST)</span>
<span class="fc bfc" id="L529" title="All 2 branches covered.">                || key.equals(ValidationRulesMap.VALIDATION_FT_MAX_NUMBER_FLEX_REQ_PER_PERIOD)</span>
<span class="fc bfc" id="L530" title="All 2 branches covered.">                || key.equals(ValidationRulesMap.VALIDATION_FT_AVOID_SCHEDULED_CALENDAR_EVENTS)</span>
<span class="fc bfc" id="L531" title="All 2 branches covered.">                || key.equals(ValidationRulesMap.VALIDATION_FT_MUST_OCCUR_ASAP)</span>
<span class="fc bfc" id="L532" title="All 2 branches covered.">                || key.equals(ValidationRulesMap.VALIDATION_FT_MAX_SHIFT_DURATION)</span>
<span class="fc bfc" id="L533" title="All 2 branches covered.">                || key.equals(ValidationRulesMap.VALIDATION_AVOID_CAL_EVENTS)</span>
<span class="fc bfc" id="L534" title="All 2 branches covered.">                || key.equals(ValidationRulesMap.VALIDATION_CS_MAX_SHIFT_DURATION_PER_DAY)</span>
<span class="fc bfc" id="L535" title="All 2 branches covered.">                || key.equals(ValidationRulesMap.VALIDATION_CS_MIN_SHIFT_DURATION_PER_DAY)</span>
<span class="fc bfc" id="L536" title="All 2 branches covered.">                || key.equals(ValidationRulesMap.VALIDATION_CS_FULFILLS_NET_STAFFING_SHORTAGE)</span>
<span class="fc bfc" id="L537" title="All 2 branches covered.">                || key.equals(ValidationRulesMap.VALIDATION_VTO_REDUCE_NET_STAFFING_SURPLUS)</span>
<span class="fc bfc" id="L538" title="All 2 branches covered.">                || key.equals(ValidationRulesMap.VALIDATION_SS_MAX_ONE_WAY_SWAP_PER_PERSON_PERIOD)</span>
<span class="fc bfc" id="L539" title="All 2 branches covered.">                || key.equals(ValidationRulesMap.VALIDATION_SS_MAX_APPROVED_SWAP_PER_SHIFT)</span>
<span class="fc bfc" id="L540" title="All 2 branches covered.">                || key.equals(ValidationRulesMap.VALIDATION_PSS_MAX_APPROVED_PARTIAL_SWAPS_PER_SHIFT)</span>
<span class="fc bfc" id="L541" title="All 2 branches covered.">				|| key.equals(ValidationRulesMap.VALIDATION_SS_MAX_HOURS_ALTERNATE_MAX_HOURS_PER_DAY);</span>
    }

	private static String[] addElement(String[] org, String added) {
<span class="fc" id="L545">	    String[] result = Arrays.copyOf(org, org.length +1);</span>
<span class="fc" id="L546">	    result[org.length] = added;</span>
<span class="fc" id="L547">	    return result;</span>
	}
}
</pre><div class="footer"><span class="right">Created with <a href="http://www.eclemma.org/jacoco">JaCoCo</a> 0.7.5.201505241946</span></div></body></html>