<?xml version="1.0" encoding="UTF-8"?><!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd"><html xmlns="http://www.w3.org/1999/xhtml" lang="en"><head><meta http-equiv="Content-Type" content="text/html;charset=UTF-8"/><link rel="stylesheet" href="../.resources/report.css" type="text/css"/><link rel="shortcut icon" href="../.resources/report.gif" type="image/gif"/><title>FilingRuleModelHandler.java</title><link rel="stylesheet" href="../.resources/prettify.css" type="text/css"/><script type="text/javascript" src="../.resources/prettify.js"></script></head><body onload="window['PR_TAB_WIDTH']=4;prettyPrint()"><div class="breadcrumb" id="breadcrumb"><span class="info"><a href="../.sessions.html" class="el_session">Sessions</a></span><a href="../index.html" class="el_report">QA Code Coverage</a> &gt; <a href="index.source.html" class="el_package">com.bluepumpkin.web.rm.setup.filingrules</a> &gt; <span class="el_source">FilingRuleModelHandler.java</span></div><h1>FilingRuleModelHandler.java</h1><pre class="source lang-java linenums">package com.bluepumpkin.web.rm.setup.filingrules;

import java.rmi.RemoteException;
import java.util.ArrayList;
import java.util.Collection;
import java.util.Iterator;
import java.util.Map;
import java.util.ResourceBundle;

import com.bluepumpkin.common.datatypes.ID;
import com.bluepumpkin.common.datatypes.StringsPair;
import com.bluepumpkin.common.localization.Localizer;
import com.bluepumpkin.ejb.bbm.activity.model.Activity;
import com.bluepumpkin.ejb.bbm.base.BbmCreateException;
import com.bluepumpkin.ejb.bbm.base.BbmFinderException;
import com.bluepumpkin.ejb.bbm.base.BbmRemoveException;
import com.bluepumpkin.ejb.bbm.base.BbmUpdateException;
import com.bluepumpkin.ejb.core.base.MultiUserException;
import com.bluepumpkin.ejb.rm.RmManagerFactory;
import com.bluepumpkin.ejb.rm.l10n.RmEjbBundleKey;
import com.bluepumpkin.ejb.rm.requests.common.ejb.RequestUtil;
import com.bluepumpkin.ejb.rm.requests.timeoff.model.TORequest;
import com.bluepumpkin.ejb.rm.setup.filingrules.model.RequestFilingRule;
import com.bluepumpkin.web.core.base.ModelHandler;
import com.witness.web.uif.l10n.UIFWebBundleKey;
import com.bluepumpkin.web.rm.l10n.*;
import com.bluepumpkin.web.rm.setup.filingrules.FilingRulePC;

/**
 * Title          FilingRuleModelHandler
 * Description    Model handler for Settings
 * Copyright      Copyright (c) 2002
 * Company        Blue Pumpkin Software, Inc
 * @author        Shubhangi Chavan
 * @version       1.0
 */
<span class="nc" id="L37">public class FilingRuleModelHandler extends ModelHandler { </span>

	/**
	 * Returns a list RequestFilingRule
	 * @param   orgID	ID	Identifes the organizationId
	 * @return  Collection	list of RequestFilingRule objects
	 */
	public static Collection getFilingRuleList(ID orgID)
		throws BbmFinderException, BbmCreateException, RemoteException{

		// Invoke the facade method here
<span class="fc" id="L48">		return RmManagerFactory.getInstance().getFilingRuleManager().</span>
<span class="fc" id="L49">					findFilingRulesByOrgId(orgID);</span>
	}

	/**
	 * Returns a list RequestFilingRule
	 * @param   orgID	ID	Identifes the organizationId
	 * @param   requestType	String	Identifes the Request Type
	 * @return  Collection	list of RequestFilingRule objects
	 */
	public static Collection getFilingRuleList(ID orgID,String requestType)
		throws BbmFinderException, BbmCreateException, RemoteException{

		// Invoke the facade method here
<span class="nc" id="L62">		return RmManagerFactory.getInstance().getFilingRuleManager().</span>
<span class="nc" id="L63">					findFilingRulesByOrgId(orgID,requestType);</span>
	}

	/**
	 * Find the RequestFilingRule for the ID
	 * @param	filingRuleId ID		Identifies the the RequestFilingRule object.
	 * @return	RequestFilingRule	A RequestFilingRule Object
	 */
	public static RequestFilingRule getFilingRule(ID filingRuleId)
		throws BbmFinderException, BbmCreateException, RemoteException {

<span class="nc" id="L74">		return RmManagerFactory.getInstance().getFilingRuleManager().</span>
<span class="nc" id="L75">			  findFilingRuleById(filingRuleId);</span>
		//return new RequestFilingRule();
	}

	/**
	 * Gets a collection of StringsPair objects that identify the TimeOff types
	 * @param   orgID	ID	Identifes the organizationId
	 * @return	Collection	list of StringsPair objects that contain the TimeOff types
	 */
	public static Collection getTimeOffTypes(ID orgID) 
	throws BbmFinderException, BbmCreateException, RemoteException {
		Collection timeOffActivities = 
<span class="nc" id="L87">			RmManagerFactory.getInstance().getTimeOffRequestManager().</span>
<span class="nc" id="L88">			getTimeOffTypes(orgID);</span>
<span class="nc" id="L89">		return getTimeOffTypeStringPairs(timeOffActivities);</span>
	}

	/**
	 * Gets a collection of StringsPair objects that identify the TimeOff types
	 * @param   orgID	ID	Identifes the organizationId
	 * @param   isFlex	true returns only flex time offs, false returns only non-flex time offs.
	 * @return	Collection	list of StringsPair objects that contain the TimeOff types
	 */
	public static Collection getTimeOffTypes(ID orgID, boolean isFlex) 
	throws BbmFinderException, BbmCreateException, RemoteException {
<span class="fc bfc" id="L100" title="All 2 branches covered.">		int flexType = isFlex ? TORequest.FLEXTYPE_FLEXWITHMAKEUP : TORequest.FLEXTYPE_NONE;</span>
		Collection timeOffActivities = 
<span class="fc" id="L102">			RmManagerFactory.getInstance().getTimeOffRequestManager().</span>
<span class="fc" id="L103">			getTimeOffTypes(orgID, flexType);</span>
<span class="fc" id="L104">		return getTimeOffTypeStringPairs(timeOffActivities);</span>
	}

	/** Gets a collection of StringsPair objects that identify the given TimeOff activities.
	 * @param timeOffActivities
	 * @return
	 */
	protected static Collection getTimeOffTypeStringPairs(Collection timeOffActivities) {
<span class="pc bpc" id="L112" title="1 of 2 branches missed.">		if (timeOffActivities == null) {</span>
<span class="nc" id="L113">			return null;</span>
		}
<span class="fc" id="L115">		int l = timeOffActivities.size();</span>
<span class="fc" id="L116">		ArrayList timeOffTypes = new ArrayList(l);</span>
<span class="fc" id="L117">		Iterator itr = timeOffActivities.iterator();</span>
<span class="fc bfc" id="L118" title="All 2 branches covered.">		while (itr.hasNext()) {</span>
<span class="fc" id="L119">			Activity activity = (Activity)itr.next();</span>
<span class="fc" id="L120">			timeOffTypes.add(new StringsPair(activity.getID().toString(), </span>
<span class="fc" id="L121">											activity.getName()));</span>
<span class="fc" id="L122">		}</span>
<span class="fc" id="L123">		return timeOffTypes;</span>
	}

	/**
	 * Updates the  RequestFilingRule
	 * @param requestFilingRule - RequestFilingRule object.
	 */
	public static void updateFilingRule(RequestFilingRule requestFilingRule)
		throws BbmUpdateException, MultiUserException, BbmCreateException, RemoteException {

<span class="nc" id="L133">		RmManagerFactory.getInstance().getFilingRuleManager().</span>
<span class="nc" id="L134">			updateFilingRule(requestFilingRule);</span>
<span class="nc" id="L135">	}</span>


	/**
	 * Deletes the RequestFilingRule
	 * @param requestFilingRuleId - Id for RequestFilingRule.
	 */
	public static void deleteFilingRule(ID requestFilingRuleId)
		throws BbmRemoveException, BbmCreateException, RemoteException {
<span class="nc" id="L144">		RmManagerFactory.getInstance().getFilingRuleManager().</span>
<span class="nc" id="L145">			deleteFilingRule(requestFilingRuleId);</span>
<span class="nc" id="L146">	}</span>


	/**
	 * Creates a new RequestFilingRule
	 * @param requestFilingRule	RequestFilingRule instance
	 */
	public static ID createFilingRule(RequestFilingRule requestFilingRule)
		throws BbmCreateException, RemoteException {
<span class="fc" id="L155">		return RmManagerFactory.getInstance().getFilingRuleManager().</span>
<span class="fc" id="L156">			createFilingRule(requestFilingRule);</span>
	}

	/**
	 * Updates the InheritanceStatus for the RequestFilingRule
	 * @param organizationId	ID	Identifies the organizationID
	 * @param requestFilingRuleIDStatus	Collection contains the filingrule Id 
	 *                                  and the applied status.
	 */
	public static void saveApplied(ID organizationId, 
								   Map requestFilingRuleIDStatus)
		throws BbmUpdateException, BbmCreateException, RemoteException {
<span class="nc" id="L168">		RmManagerFactory.getInstance().getFilingRuleManager().</span>
<span class="nc" id="L169">			saveApplied(organizationId,requestFilingRuleIDStatus);</span>
<span class="nc" id="L170">	}</span>

	/**
	 * Copies an existing RequestFilingRule to the organization specified
	 * @param requestFilingRuleId	ID	Identifies the RequestFilingRuleID
	 * @param organizationId		ID	Identifies the organizationID
	 */
	public ID copyRequestFilingRule(ID requestFilingRuleId, ID organizationId)
		throws BbmCreateException, BbmFinderException, RemoteException {
<span class="nc" id="L179">		return RmManagerFactory.getInstance().getFilingRuleManager().</span>
<span class="nc" id="L180">			copyRequestFilingRule(requestFilingRuleId,organizationId);</span>
	}

	/**
	 * @deprecated
	 */
	public static Collection getTimeOffType(Localizer localizer)
	{
<span class="nc" id="L188">		Collection timeOffTypeList = new ArrayList();</span>
<span class="nc" id="L189">		ResourceBundle coreBundle = localizer.getBundle(UIFWebBundleKey.BUNDLE_NAME);</span>

<span class="nc" id="L191">		timeOffTypeList.add(new StringsPair(&quot;all&quot;,</span>
<span class="nc" id="L192">						localizer.i18n(coreBundle, UIFWebBundleKey.ALL)));</span>
<span class="nc" id="L193">		timeOffTypeList.add(new StringsPair(&quot;vacation&quot;,</span>
<span class="nc" id="L194">						localizer.i18n(coreBundle, UIFWebBundleKey.VACATION)));</span>
<span class="nc" id="L195">		timeOffTypeList.add(new StringsPair(&quot;sickleave&quot;,</span>
<span class="nc" id="L196">						localizer.i18n(coreBundle, UIFWebBundleKey.SICK_LEAVE)));</span>

<span class="nc" id="L198">		return timeOffTypeList;</span>
	}
	
	/**
	 * Get a list of key/value StringsPair's for the Flex Time &quot;before&quot; and &quot;after&quot; options.
	 */
	public static Collection&lt;StringsPair&gt; getFlexBeforeAfterList(ResourceBundle rmBundle, Localizer localizer) {
<span class="fc" id="L205">		Collection&lt;StringsPair&gt; flexBeforeAfterList = new ArrayList&lt;StringsPair&gt;(2);</span>
<span class="fc" id="L206">		flexBeforeAfterList.add(new StringsPair(FilingRulePC.FLEX_REQUEST_SUBTYPE_BEFORE,</span>
<span class="fc" id="L207">						localizer.i18n(rmBundle, RmEjbBundleKey.ORG_RM_FILING_RULE_BEFORE)));</span>
<span class="fc" id="L208">		flexBeforeAfterList.add(new StringsPair(FilingRulePC.FLEX_REQUEST_SUBTYPE_AFTER,</span>
<span class="fc" id="L209">						localizer.i18n(rmBundle, RmEjbBundleKey.ORG_RM_FILING_RULE_AFTER)));</span>
<span class="fc" id="L210">		return flexBeforeAfterList;</span>
	}
	
	/**
	 * Return string pair collection for interval unit list drop down {days/hours}.
	 * @param localizer
	 * @param includeMinutes - whether to include minutes in the drop down list or not 
	 * @return collection of StringPair objects.
	 */
	public static Collection getIntervalUnitList(Localizer localizer, boolean includeMinutes) {
<span class="fc" id="L220">		Collection aList = new ArrayList(2);</span>
<span class="fc" id="L221">		ResourceBundle rmEjbBundle = localizer.getBundle(RmEjbBundleKey.BUNDLE_NAME);</span>
<span class="fc" id="L222">		aList.add(new StringsPair(RequestUtil.DAYS,</span>
<span class="fc" id="L223">						localizer.i18n(rmEjbBundle, RmEjbBundleKey.ORG_RM_FILING_RULE_DAYS)));</span>
<span class="fc" id="L224">		aList.add(new StringsPair(RequestUtil.HOURS,</span>
<span class="fc" id="L225">						localizer.i18n(rmEjbBundle, RmEjbBundleKey.ORG_RM_FILING_RULE_HOURS)));</span>
<span class="pc bpc" id="L226" title="1 of 2 branches missed.">		if (includeMinutes) {</span>
<span class="nc" id="L227">			aList.add(new StringsPair(RequestUtil.MINUTES,</span>
<span class="nc" id="L228">					localizer.i18n(rmEjbBundle, RmEjbBundleKey.ORG_RM_FILING_RULE_MINUTES)));</span>
		}
<span class="fc" id="L230">		return aList;</span>
	}

	/**
	 * Return string pair collection for interval unit list drop down {days/hours}.
	 * @param localizer
	 * @return collection of StringPair objects.
	 */
	public static Collection getIntervalUnitList(Localizer localizer) {
<span class="nc" id="L239">		return getIntervalUnitList(localizer, false);</span>
	}
	
}
</pre><div class="footer"><span class="right">Created with <a href="http://www.eclemma.org/jacoco">JaCoCo</a> 0.7.5.201505241946</span></div></body></html>