<?xml version="1.0" encoding="UTF-8"?><!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd"><html xmlns="http://www.w3.org/1999/xhtml" lang="en"><head><meta http-equiv="Content-Type" content="text/html;charset=UTF-8"/><link rel="stylesheet" href="../.resources/report.css" type="text/css"/><link rel="shortcut icon" href="../.resources/report.gif" type="image/gif"/><title>RmFilterChain.java</title><link rel="stylesheet" href="../.resources/prettify.css" type="text/css"/><script type="text/javascript" src="../.resources/prettify.js"></script></head><body onload="window['PR_TAB_WIDTH']=4;prettyPrint()"><div class="breadcrumb" id="breadcrumb"><span class="info"><a href="../.sessions.html" class="el_session">Sessions</a></span><a href="../index.html" class="el_report">QA Code Coverage</a> &gt; <a href="index.source.html" class="el_package">com.bluepumpkin.ejb.rm.util</a> &gt; <span class="el_source">RmFilterChain.java</span></div><h1>RmFilterChain.java</h1><pre class="source lang-java linenums">package com.bluepumpkin.ejb.rm.util;

import com.bluepumpkin.ejb.rm.RmManagerFactory;
import com.bluepumpkin.ejb.rm.requests.shiftbid.shiftbidauction.ejb.ShiftBidAuctionManager;
import com.bluepumpkin.ejb.rm.requests.shiftbid.shiftbidrequest.model.BiddableSchedule;

import java.io.Serializable;

import com.bluepumpkin.common.datatypes.ID;


<span class="nc" id="L12">abstract public class RmFilterChain implements Serializable</span>
{
	/**
	 * 
	 */
	private static final long serialVersionUID = 1L;
	final public static int UNDEFINED = -1;
	final public static int  MATCH_ANY = 0; 
	final public static int  MATCH_EXACT = 1;
	final public static int  MATCH_AT_LEAST = 2;
	final public static int  MATCH_AT_MOST = 3;

<span class="nc" id="L24">	transient protected ID m_auctionID = null; </span>
<span class="nc" id="L25">	transient protected ID m_orgID = null; </span>
<span class="nc" id="L26">	transient protected ID m_bidderID = null;</span>

<span class="nc" id="L28">	private boolean m_matchAllShifts = true;</span>
	/**
	  * The next chain member
	  */
<span class="nc" id="L32">	private RmFilterChain nextInChain = null;</span>
	  
	  /**
	  * Does filtering. Overridden in subclasses.
	  * Returns TRUE if next filter can be applied, FALSE if not (the item has been removed)
	  */
	  abstract protected boolean isScheduleValid(BiddableSchedule sched);

		public void setMatchAllShifts( boolean matchAllShifts )
		{
<span class="nc" id="L42">			this.m_matchAllShifts = matchAllShifts;</span>
<span class="nc" id="L43">		}</span>

		public boolean getMatchAllShifts()
		{
<span class="nc" id="L47">			return this.m_matchAllShifts;</span>
		}

	  public void setAuctionID( ID id )
	  {
<span class="nc" id="L52">		  this.m_auctionID = id; </span>
<span class="nc" id="L53">	  }</span>
	  
	  public void setOrgID( ID id )
	  {
<span class="nc" id="L57">		  this.m_orgID = id; </span>
<span class="nc" id="L58">	  }</span>

	  public void setBidderID( ID id )
	  {
<span class="nc" id="L62">		  this.m_bidderID = id; </span>
<span class="nc" id="L63">	  }</span>
	  
	  public void setParameters( ID auctionID, 
									ID orgID, 
									ID bidderID )
	  {
<span class="nc" id="L69">		  this.setAuctionID(auctionID);</span>
<span class="nc" id="L70">		  this.setBidderID(bidderID);</span>
<span class="nc" id="L71">		  this.setOrgID(orgID);</span>
		  
<span class="nc bnc" id="L73" title="All 2 branches missed.">		  if( this.nextInChain != null )</span>
<span class="nc" id="L74">			this.nextInChain.setParameters(auctionID, orgID, bidderID);</span>
<span class="nc" id="L75">	  }</span>

	  /**
	  * Append new member to the end of the chain
	  */
	  public void appendToChain( RmFilterChain member)
	  {
<span class="nc bnc" id="L82" title="All 2 branches missed.">	    if (this.nextInChain == null)</span>
<span class="nc" id="L83">	      this.nextInChain = member;</span>
	    else
<span class="nc" id="L85">	      this.nextInChain.appendToChain(member);</span>
<span class="nc" id="L86">	  }</span>

	  
	  public boolean filterSchedule( BiddableSchedule sched )
	  {
<span class="nc" id="L91">		  boolean retVal = this.isScheduleValid(sched);</span>
		  
<span class="nc bnc" id="L93" title="All 4 branches missed.">		  if( this.nextInChain != null &amp;&amp; retVal )</span>
<span class="nc" id="L94">			  retVal = this.nextInChain.filterSchedule(sched);</span>
		  
<span class="nc" id="L96">		  return retVal;</span>
	  }

	static public void main( String []args) throws Exception
	{
/**
		ID auctionID = new ID(554); // auction ID
		ID orgID = null; // org ID
		ID bidderID = new ID(700);
		
		ShiftFilterLink root = new ShiftFilterLink();
		//root.setShiftID( new ID(1) );
		root.setWorkPatternID( new ID(1) );

		// set the shift length
		SizeFilterLink sz = new SizeFilterLink();
		sz.setRange( 100, 600 );
		boolean paidOnly = true;
		root.setShiftLength(sz, paidOnly);

		// set number of bids 
		//SizeFilterLink numBids = new SizeFilterLink();
		//numBids.setRange( 0, 600 );
		//root.setBidAvailability(numBids);

		DateTimeFilterLink startDate = new DateTimeFilterLink();
		int sec = 10 * 3600;  // 10:00:00
		startDate.setAfter(sec);
		
		root.setShiftStartDate(startDate);
		
		// add skill
		SkillFilterLink skill = new SkillFilterLink();
		skill.addSkillID( new ID(&quot;000025b.0000094&quot;) );
		skill.addSkillID( new ID(&quot;000025b.0000097&quot;) );
		skill.setMatchType( MATCH_ANY );
		root.appendToChain(skill);

		
		// add activity
		ActivityFilterLink actv = new ActivityFilterLink();
		actv.setActivityID( new ID(-4101) );
	
		DateTimeFilterLink actvDate = new DateTimeFilterLink();
		SimpleDateFormat fmt = new SimpleDateFormat();
		fmt.setTimeZone( TimeZone.getTimeZone(&quot;GMT&quot;) );
		fmt.applyPattern(&quot;yyyy-MM-dd HH:mm:ss&quot;);
		Date start = fmt.parse(&quot;2004-03-01 14:15:00&quot;);
		Date end = fmt.parse(&quot;2005-03-01 14:15:00&quot;);
		actvDate.setBetween(start, end);

		actv.setActivityDate(actvDate);

		root.appendToChain(actv);
		
		
		root.setParameters(auctionID, orgID, bidderID ); 
		

		int []sortByList = {0};
		int []sortDirectionList = {0};
		
		ShiftBidAuctionManager mgr = RmManagerFactory.getInstance().getShiftBidAuctionManager();
	    mgr.getBiddableSchedulesForAuction(auctionID, 
	    									orgID, 
	    									bidderID, 
	    									sortByList,
	    									sortDirectionList, 
	    									Integer.MAX_VALUE, 
	    									0,
	    									root);

**/
		
<span class="nc" id="L170">	}</span>
	  
}
</pre><div class="footer"><span class="right">Created with <a href="http://www.eclemma.org/jacoco">JaCoCo</a> 0.7.5.201505241946</span></div></body></html>