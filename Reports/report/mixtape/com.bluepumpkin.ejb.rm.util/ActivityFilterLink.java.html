<?xml version="1.0" encoding="UTF-8"?><!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd"><html xmlns="http://www.w3.org/1999/xhtml" lang="en"><head><meta http-equiv="Content-Type" content="text/html;charset=UTF-8"/><link rel="stylesheet" href="../.resources/report.css" type="text/css"/><link rel="shortcut icon" href="../.resources/report.gif" type="image/gif"/><title>ActivityFilterLink.java</title><link rel="stylesheet" href="../.resources/prettify.css" type="text/css"/><script type="text/javascript" src="../.resources/prettify.js"></script></head><body onload="window['PR_TAB_WIDTH']=4;prettyPrint()"><div class="breadcrumb" id="breadcrumb"><span class="info"><a href="../.sessions.html" class="el_session">Sessions</a></span><a href="../index.html" class="el_report">QA Code Coverage</a> &gt; <a href="index.source.html" class="el_package">com.bluepumpkin.ejb.rm.util</a> &gt; <span class="el_source">ActivityFilterLink.java</span></div><h1>ActivityFilterLink.java</h1><pre class="source lang-java linenums">package com.bluepumpkin.ejb.rm.util;

import java.util.Collection;
import java.util.Iterator;
import java.util.List;

import com.bluepumpkin.common.datatypes.ID;
import com.bluepumpkin.ejb.bbm.activity.model.Event;
import com.bluepumpkin.ejb.bbm.schedule.model.ShiftAssignment;
import com.bluepumpkin.ejb.rm.requests.shiftbid.shiftbidrequest.model.BiddableSchedule;
import com.bluepumpkin.ejb.bbm.activity.model.Activity;

<span class="nc" id="L13">public class ActivityFilterLink  extends RmFilterChain</span>
{
	/**
	 * 
	 */
	private static final long serialVersionUID = 1L;
	private ID m_activityID;
	private SizeFilterLink m_time;
	private DateTimeFilterLink m_date;
	public void setActivityID( ID id )
	{
<span class="nc" id="L24">		this.m_activityID = id;</span>
<span class="nc" id="L25">	}</span>
	
	public void setActivityDuration(SizeFilterLink dt )
	{
<span class="nc" id="L29">		this.m_time = dt;</span>
<span class="nc" id="L30">	}</span>

	public void setActivityDate(DateTimeFilterLink dt )
	{
<span class="nc" id="L34">		this.m_date = dt;</span>
<span class="nc" id="L35">	}</span>

	protected boolean isScheduleValid(BiddableSchedule vo)
	{
<span class="nc" id="L39">	  List saList = vo.getOptMethods().getShiftAssignments();</span>
<span class="nc bnc" id="L40" title="All 4 branches missed.">	  if( saList == null || saList.size() &lt;= 0 )</span>
<span class="nc" id="L41">		  return false;</span>

<span class="nc" id="L43">	  int count = 0;</span>
<span class="nc" id="L44">      int saListSize = saList.size();</span>
	  
<span class="nc" id="L46">	  Iterator saIter = saList.iterator();</span>
<span class="nc bnc" id="L47" title="All 2 branches missed.">	  while( saIter.hasNext() )</span>
	  {
<span class="nc" id="L49">		  ShiftAssignment sa = (ShiftAssignment)saIter.next();</span>
<span class="nc" id="L50">		  boolean found = false;</span>
		  
<span class="nc" id="L52">          int i=0;</span>
<span class="nc" id="L53">		  Collection seaColl = sa.getChildren();</span>
<span class="nc bnc" id="L54" title="All 2 branches missed.">          for( Iterator seaIter = seaColl.iterator(); seaIter.hasNext(); i++) </span>
          {
<span class="nc" id="L56">              Event curEvent = (Event)seaIter.next();</span>
<span class="nc bnc" id="L57" title="All 4 branches missed.">              if (i==0 &amp;&amp; (curEvent.getActivityID().toInt() == Activity.NO_ACTIVITY))</span>
              {
<span class="nc" id="L59">                  saListSize--;</span>
              }
<span class="nc bnc" id="L61" title="All 2 branches missed.">              else if( this.isValidEvent( curEvent ) )</span>
        	  {
<span class="nc" id="L63">        		found = true;</span>
        	  }
          }
          
<span class="nc bnc" id="L67" title="All 2 branches missed.">          if( found )</span>
<span class="nc" id="L68">        	  ++count;</span>
<span class="nc" id="L69">	  }</span>

<span class="nc bnc" id="L71" title="All 2 branches missed.">	  if( this.getMatchAllShifts() )</span>
	  {
<span class="nc bnc" id="L73" title="All 2 branches missed.">		  return count == saListSize ? true : false;</span>
	  }
	  else
	  {
<span class="nc bnc" id="L77" title="All 2 branches missed.">		  return count &gt; 0 ? true : false; </span>
	  }

	}

	private boolean isValidEvent( Event sea )
	{
<span class="nc" id="L84">		boolean retVal = true;</span>
		
<span class="nc bnc" id="L86" title="All 4 branches missed.">	   if( this.m_activityID != null &amp;&amp; !this.m_activityID.equals(sea.getActivityID()) )</span>
	   {
<span class="nc" id="L88">		   retVal = false;</span>
	   }

<span class="nc bnc" id="L91" title="All 4 branches missed.">	   if( this.m_date != null &amp;&amp; !this.m_date.isValidDate(sea.getStartTime()) )</span>
	   {
<span class="nc" id="L93">		   retVal = false;</span>
	   }

<span class="nc bnc" id="L96" title="All 4 branches missed.">	   if( this.m_time != null &amp;&amp; !this.m_time.isValidSize(sea.getDuration()) )</span>
	   {
<span class="nc" id="L98">		   retVal = false;</span>
	   }
	   
<span class="nc" id="L101">	   return retVal;</span>
	}
	
}
</pre><div class="footer"><span class="right">Created with <a href="http://www.eclemma.org/jacoco">JaCoCo</a> 0.7.5.201505241946</span></div></body></html>