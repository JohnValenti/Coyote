<?xml version="1.0" encoding="UTF-8"?><!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd"><html xmlns="http://www.w3.org/1999/xhtml" lang="en"><head><meta http-equiv="Content-Type" content="text/html;charset=UTF-8"/><link rel="stylesheet" href="../.resources/report.css" type="text/css"/><link rel="shortcut icon" href="../.resources/report.gif" type="image/gif"/><title>RfsReportParametersModelHandler.java</title><link rel="stylesheet" href="../.resources/prettify.css" type="text/css"/><script type="text/javascript" src="../.resources/prettify.js"></script></head><body onload="window['PR_TAB_WIDTH']=4;prettyPrint()"><div class="breadcrumb" id="breadcrumb"><span class="info"><a href="../.sessions.html" class="el_session">Sessions</a></span><a href="../index.html" class="el_report">QA Code Coverage</a> &gt; <a href="index.source.html" class="el_package">com.verint.web.rfs.reports</a> &gt; <span class="el_source">RfsReportParametersModelHandler.java</span></div><h1>RfsReportParametersModelHandler.java</h1><pre class="source lang-java linenums">package com.verint.web.rfs.reports;

import java.rmi.RemoteException;
import java.util.ArrayList;
import java.util.Arrays;
import java.util.Collection;
import java.util.Collections;

import com.bluepumpkin.common.datatypes.ID;
import com.bluepumpkin.common.datatypes.StringsPair;
import com.bluepumpkin.common.localization.Localizer;
import com.bluepumpkin.common.util.StringUtil;
import com.bluepumpkin.ejb.bbm.base.BbmException;
import com.verint.ejb.rfs.RfsManagerFactory;
import com.verint.ejb.rfs.reports.model.RfsBranch;
import com.bluepumpkin.web.fs.l10n.FsWebBundleKey;
import com.verint.web.rfs.reports.util.RfsReportParameterUtil;
import com.witness.web.uif.system.RequestContext;

<span class="nc" id="L20">public class RfsReportParametersModelHandler {</span>
	
	
	public static ArrayList&lt;StringsPair&gt; getReportParamOptions(RequestContext context, String currentValue, String pickerName, String strReportID) throws Exception {

<span class="nc" id="L25">		String currentScenario = getCurrentScenario(context);;</span>
<span class="nc bnc" id="L26" title="All 4 branches missed.">		if(RfsReportParameterUtil.SCENARIO.equals(pickerName) &amp;&amp; currentValue != null) {</span>
<span class="nc" id="L27">			currentScenario = currentValue;</span>
		}	
<span class="nc" id="L29">		StringBuffer branchStr = new StringBuffer(&quot;&quot;);</span>
<span class="nc bnc" id="L30" title="All 2 branches missed.">		if(!RfsReportParameterUtil.SCENARIO.equals(pickerName) &amp;&amp; </span>
<span class="nc bnc" id="L31" title="All 2 branches missed.">			!RfsReportParameterUtil.BUSINESS_UNIT.equals(pickerName))	{</span>
<span class="nc" id="L32">			String branchIDsString = context.getRequest().getParameter(RfsReportParameterUtil.PARAM_BRANCH_SELECTOR);</span>
<span class="nc" id="L33">			branchStr = branchStr.append(StringUtil.join(getBranchesByIDs(context, StringUtil.parseIDStringToCollection(branchIDsString)), &quot;,&quot;));</span>
			
<span class="nc bnc" id="L35" title="All 2 branches missed.">			if(branchStr.length() == 0) {</span>
<span class="nc" id="L36">				branchIDsString = context.getRequest().getParameter(RfsReportParameterUtil.PARAM_BRANCHES);</span>
<span class="nc bnc" id="L37" title="All 2 branches missed.">				if (branchIDsString != null) </span>
<span class="nc" id="L38">					branchStr =  branchStr.append(branchIDsString);</span>
			}
<span class="nc bnc" id="L40" title="All 2 branches missed.">			if(branchStr.length() == 0)  {</span>
<span class="nc" id="L41">				branchIDsString = context.getRequest().getParameter(RfsReportParameterUtil.PARAM_BRANCH);</span>
<span class="nc bnc" id="L42" title="All 2 branches missed.">				if (branchIDsString != null) </span>
<span class="nc" id="L43">					branchStr =  branchStr.append(branchIDsString);</span>
			}						
		}
		
<span class="nc bnc" id="L47" title="All 2 branches missed.">		if (RfsReportParameterUtil.SCENARIO.equals(pickerName)) { </span>
			// Scenario picker
<span class="nc" id="L49">			return getScenarios(context);</span>
<span class="nc bnc" id="L50" title="All 2 branches missed.">		} else if (RfsReportParameterUtil.BRANCH_VIEW.equals(pickerName)) {   </span>
			// Branch view drop down in branch selector popup
<span class="nc" id="L52">			return getBranchViews(currentScenario);</span>
<span class="nc bnc" id="L53" title="All 2 branches missed.">		} else if (RfsReportParameterUtil.BUSINESS_UNIT.equals(pickerName)) { </span>
			// Branches list if used in a single or multiple selector pc
<span class="nc" id="L55">			return getBusinessUnits(currentScenario);</span>
<span class="nc bnc" id="L56" title="All 2 branches missed.">		} else if ( RfsReportParameterUtil.MONTH.equals(pickerName)) {  </span>
			// Month picker
<span class="nc" id="L58">			return getMonthsList(context);</span>
<span class="nc bnc" id="L59" title="All 2 branches missed.">		} else if ( RfsReportParameterUtil.YEAR.equals(pickerName)) {	</span>
			// Year picker
<span class="nc" id="L61">			return getYearsList();</span>
<span class="nc bnc" id="L62" title="All 2 branches missed.">		} else if( RfsReportParameterUtil.NUMBER_OF_INTERVALS.equals(pickerName)) {	</span>
			// Interval spinner ( 1- 13) 
<span class="nc" id="L64">			return getIntervalSpinner();</span>
<span class="nc bnc" id="L65" title="All 2 branches missed.">		} else if( RfsReportParameterUtil.HIERARCHY_GROUPBY.equals(pickerName)) {	</span>
			// Hierarchy to Group By for branches 
<span class="nc" id="L67">			return getHierarchyGroupByList(currentScenario);</span>
<span class="nc bnc" id="L68" title="All 2 branches missed.">		} else if ( RfsReportParameterUtil.ACTUAL_STAFFMIX.equals(pickerName)) { </span>
			// Actual Staff Mix
<span class="nc bnc" id="L70" title="All 2 branches missed.">			return getStaffMixes(currentScenario, branchStr.length() == 0 ? &quot;&quot; : branchStr.toString(), RfsReportParameterUtil.STAFFMIX_ACTUAL);</span>
<span class="nc bnc" id="L71" title="All 2 branches missed.">		} else if ( RfsReportParameterUtil.BUDGET_STAFFMIX.equals(pickerName)) { </span>
			// Budget Staff Mix
<span class="nc bnc" id="L73" title="All 2 branches missed.">			return getStaffMixes(currentScenario,branchStr.length() == 0 ? &quot;&quot; : branchStr.toString(), RfsReportParameterUtil.STAFFMIX_BUDGET);</span>
<span class="nc bnc" id="L74" title="All 2 branches missed.">		} else if ( RfsReportParameterUtil.PLANNED_STAFFMIX.equals(pickerName)) { </span>
			// Planned Staff Mix
<span class="nc bnc" id="L76" title="All 2 branches missed.">			return getStaffMixes(currentScenario, branchStr.length() == 0 ? &quot;&quot; : branchStr.toString(), RfsReportParameterUtil.STAFFMIX_PLANNED); </span>
<span class="nc bnc" id="L77" title="All 2 branches missed.">		} else if ( RfsReportParameterUtil.WORKGROUP.equals(pickerName)) { 		</span>
			// Workgroup
<span class="nc" id="L79">			return getWorkgroups(context);</span>
<span class="nc bnc" id="L80" title="All 2 branches missed.">		} else if ( RfsReportParameterUtil.FORECAST_RESOURCES.equals(pickerName) ||</span>
<span class="nc bnc" id="L81" title="All 2 branches missed.">					RfsReportParameterUtil.FORECAST_RESOURCES_FIRST.equals(pickerName) ||</span>
<span class="nc bnc" id="L82" title="All 2 branches missed.">					RfsReportParameterUtil.FORECAST_RESOURCES_SECOND.equals(pickerName)) { </span>
			// Forecast Resources
<span class="nc" id="L84">			return getResources(currentScenario,&quot;Resource&quot;,false);</span>
<span class="nc bnc" id="L85" title="All 2 branches missed.">		} else if ( RfsReportParameterUtil.HISTORY_RESOURCES.equals(pickerName)) {	</span>
			// History Resources
<span class="nc" id="L87">			return getResources(currentScenario,&quot;Actual&quot;,false);</span>
<span class="nc bnc" id="L88" title="All 2 branches missed.">		} else if ( RfsReportParameterUtil.VOLUME_FORECAST.equals(pickerName)) { </span>
			// Volume Forecast
<span class="nc" id="L90">			return getResources(currentScenario,&quot;Transaction&quot;,false);</span>
<span class="nc bnc" id="L91" title="All 2 branches missed.">		} else if ( RfsReportParameterUtil.DURATION_FORECAST.equals(pickerName)) {	</span>
			// Duration Forecast
<span class="nc" id="L93">			return getResources(currentScenario,&quot;Duration&quot;,false);</span>
<span class="nc bnc" id="L94" title="All 2 branches missed.">		} else if ( RfsReportParameterUtil.RESOURCE_CLASS.equals(pickerName)) { </span>
			// Position 
<span class="nc" id="L96">			return getResourceClasses(currentScenario,branchStr.toString());</span>
<span class="nc bnc" id="L97" title="All 2 branches missed.">		} else if ( RfsReportParameterUtil.RESOURCE_CLASS_MULTIPLE.equals(pickerName)) {</span>
			// Position to include option &quot;All&quot; 
<span class="nc bnc" id="L99" title="All 2 branches missed.">			return getResourceClassesForMultipleSelection(context, currentScenario,branchStr.length() == 0 ? &quot;&quot; : branchStr.toString());</span>
<span class="nc bnc" id="L100" title="All 2 branches missed.">		} else if( RfsReportParameterUtil.DAY_OF_WEEK.equals(pickerName)) { </span>
			// Day of Week
<span class="nc" id="L102">			return getDaysOfWeekList();</span>
<span class="nc bnc" id="L103" title="All 2 branches missed.">		} else if( RfsReportParameterUtil.EMPLOYEE_CATEGORIES.equals(pickerName)) { </span>
			// Employee Categories
<span class="nc" id="L105">			String staffMix = context.getRequest().getParameter(RfsReportParameterUtil.PARAM_PLANNED_STAFFMIX);</span>
<span class="nc bnc" id="L106" title="All 2 branches missed.">			return getEmployeeCategories(staffMix != null ? Integer.parseInt(staffMix) : -1 );</span>
<span class="nc bnc" id="L107" title="All 2 branches missed.">		} else if (RfsReportParameterUtil.RESOURCE_CATEGORY.equals(pickerName)) { </span>
			// Resource Categories
<span class="nc" id="L109">			return getResourceCategories(currentScenario);</span>
<span class="nc bnc" id="L110" title="All 2 branches missed.">		} else if (RfsReportParameterUtil.TRANSACTION_CATEGORY.equals(pickerName)) { </span>
			// Transaction Categories
<span class="nc" id="L112">			return getTransactionCategories(currentScenario);</span>
		} 
		
<span class="nc" id="L115">		return new ArrayList&lt;StringsPair&gt;();</span>
	}

	/**
	 * Get current scenario
	 * @param context
	 * @return
	 * @throws Exception
	 */
	public static String getCurrentScenario(RequestContext context) throws Exception {
<span class="nc" id="L125">		String currentScenario = context.getRequest().getParameter(&quot;Scenario&quot;);</span>
<span class="nc bnc" id="L126" title="All 4 branches missed.">		if(currentScenario == null || currentScenario.isEmpty()) {</span>
<span class="nc" id="L127">			currentScenario = (String) context.getAttribute(RequestContext.SESSION_SCOPE,&quot;CurrentScenario&quot;);</span>
		} 
<span class="nc bnc" id="L129" title="All 4 branches missed.">		if(currentScenario == null || currentScenario.isEmpty()) {</span>
<span class="nc" id="L130">			ArrayList&lt;StringsPair&gt; scenarios = getScenarios(context);</span>
<span class="nc bnc" id="L131" title="All 2 branches missed.">			currentScenario = scenarios != null ? scenarios.get(0).getKey() : &quot;&quot;;</span>
		}
<span class="nc" id="L133">		context.setAttribute(RequestContext.SESSION_SCOPE,&quot;CurrentScenario&quot;, currentScenario);</span>
		
<span class="nc" id="L135">		return currentScenario;</span>
	}
	
	public static String getCurrentBranchView(RequestContext context) throws Exception {
<span class="nc" id="L139">		String currentBranchView = context.getRequest().getParameter(RfsReportParameterUtil.BRANCH_VIEW);</span>
<span class="nc bnc" id="L140" title="All 4 branches missed.">		if(currentBranchView == null || currentBranchView.isEmpty()) {</span>
<span class="nc" id="L141">			currentBranchView = (String) context.getAttribute(RequestContext.SESSION_SCOPE,&quot;CurrentBranchView&quot;);</span>
		} 
<span class="nc bnc" id="L143" title="All 4 branches missed.">		if(currentBranchView == null || currentBranchView.isEmpty()) {</span>
<span class="nc" id="L144">			currentBranchView = RfsManagerFactory.getRfsReportsManager().getDefaultViewForScenario(getCurrentScenario(context));</span>
		}
<span class="nc" id="L146">		context.setAttribute(RequestContext.SESSION_SCOPE,&quot;CurrentBranchView&quot;, currentBranchView);</span>
		
<span class="nc" id="L148">		return currentBranchView;</span>
	}
	
	public static String getDefaultValue(RequestContext context,String picker) throws Exception {
<span class="nc" id="L152">		String defaultValue = null;</span>
<span class="nc bnc" id="L153" title="All 2 branches missed.">		if(RfsReportParameterUtil.BRANCH_VIEW.equals(picker)) {</span>
<span class="nc" id="L154">			defaultValue = getCurrentBranchView(context);</span>
		}
<span class="nc" id="L156">		return defaultValue;</span>
	}
	/**
	 * Get all branches in current scenario and selected view in branch picker
	 * @param context
	 * @return
	 * @throws Exception
	 */
	public static Collection getBranches(RequestContext context) throws Exception {
<span class="nc" id="L165">		Collection branches = Collections.EMPTY_LIST;</span>
<span class="nc" id="L166">		String currentScenario = getCurrentScenario(context);</span>
		
<span class="nc" id="L168">		String branchView = context.getRequest().getParameter(RfsReportParameterUtil.BRANCH_VIEW);</span>
<span class="nc bnc" id="L169" title="All 2 branches missed.">		if(branchView == null) {</span>
<span class="nc" id="L170">			branchView = getDefaultValue(context, RfsReportParameterUtil.BRANCH_VIEW);</span>
		}
<span class="nc bnc" id="L172" title="All 4 branches missed.">		if(branchView == null || branchView.equals(&quot;-1&quot;)) {</span>
<span class="nc" id="L173">			branches = RfsManagerFactory.getRfsReportsManager().getBranchesInCurrentScenario(currentScenario);</span>
		} else {
<span class="nc" id="L175">			branches = RfsManagerFactory.getRfsReportsManager().getBranchesInCurrentView(branchView);</span>
		}		
<span class="nc" id="L177">		return branches;</span>
	}
	
	/**
	 * Get branch views for dropdown in branch selector
	 * @param scenario
	 * @return
	 * @throws Exception
	 */
	public static ArrayList&lt;StringsPair&gt; getBranchViews(String scenario) throws Exception {
<span class="nc" id="L187">		ArrayList&lt;StringsPair&gt; colBranchViews = new ArrayList&lt;StringsPair&gt;();</span>
<span class="nc" id="L188">		colBranchViews = RfsManagerFactory.getRfsReportsManager().getBranchViews(scenario);</span>
<span class="nc" id="L189">		return colBranchViews;</span>
	}
	
	/**
	 * Get scenarios
	 * @return
	 * @throws Exception
	 */
	public static ArrayList&lt;StringsPair&gt; getScenarios(RequestContext context) throws Exception {

<span class="nc" id="L199">		ArrayList&lt;StringsPair&gt; colScenarios = new ArrayList&lt;StringsPair&gt;();</span>
<span class="nc" id="L200">		colScenarios = RfsManagerFactory.getRfsReportsManager().getScenarios();</span>

<span class="nc bnc" id="L202" title="All 4 branches missed.">		if (colScenarios == null || colScenarios.isEmpty()) {</span>
<span class="nc" id="L203">			return null;</span>
		}
<span class="nc" id="L205">		context.setAttribute(RequestContext.SESSION_SCOPE,&quot;CurrentScenario&quot;, colScenarios.get(0).getKey());</span>
<span class="nc" id="L206">		return colScenarios;</span>
	}

	/**
	 * Get business units
	 * @param scenario
	 * @return
	 * @throws Exception
	 */
	private static ArrayList&lt;StringsPair&gt; getBusinessUnits(String scenario) throws Exception {
		
<span class="nc" id="L217">		ArrayList&lt;StringsPair&gt; colBu = new ArrayList&lt;StringsPair&gt;();</span>
<span class="nc" id="L218">		colBu = RfsManagerFactory.getRfsReportsManager().getBusinessUnits(scenario);</span>

<span class="nc bnc" id="L220" title="All 4 branches missed.">		if (colBu == null || colBu.isEmpty()) {</span>
<span class="nc" id="L221">			return null;</span>
		}

<span class="nc" id="L224">		return colBu;</span>
	}
		
		private static ArrayList&lt;StringsPair&gt; getIntervalSpinner() throws Exception {
			
<span class="nc" id="L229">			ArrayList&lt;StringsPair&gt; lNumOfIntervals = new ArrayList&lt;StringsPair&gt;();	   </span>
<span class="nc" id="L230">				lNumOfIntervals.add(new StringsPair(&quot;1&quot;,&quot;1&quot;));</span>
<span class="nc" id="L231">				lNumOfIntervals.add(new StringsPair(&quot;2&quot;,&quot;2&quot;));</span>
<span class="nc" id="L232">				lNumOfIntervals.add(new StringsPair(&quot;3&quot;,&quot;3&quot;));</span>
<span class="nc" id="L233">				lNumOfIntervals.add(new StringsPair(&quot;4&quot;,&quot;4&quot;));</span>
<span class="nc" id="L234">				lNumOfIntervals.add(new StringsPair(&quot;5&quot;,&quot;5&quot;));</span>
<span class="nc" id="L235">				lNumOfIntervals.add(new StringsPair(&quot;6&quot;,&quot;6&quot;));</span>
<span class="nc" id="L236">				lNumOfIntervals.add(new StringsPair(&quot;7&quot;,&quot;7&quot;));</span>
<span class="nc" id="L237">				lNumOfIntervals.add(new StringsPair(&quot;8&quot;,&quot;8&quot;));</span>
<span class="nc" id="L238">				lNumOfIntervals.add(new StringsPair(&quot;9&quot;,&quot;9&quot;));</span>
<span class="nc" id="L239">				lNumOfIntervals.add(new StringsPair(&quot;10&quot;,&quot;10&quot;));</span>
<span class="nc" id="L240">				lNumOfIntervals.add(new StringsPair(&quot;11&quot;,&quot;11&quot;));</span>
<span class="nc" id="L241">				lNumOfIntervals.add(new StringsPair(&quot;12&quot;,&quot;12&quot;));</span>
<span class="nc" id="L242">				lNumOfIntervals.add(new StringsPair(&quot;13&quot;,&quot;13&quot;));</span>
<span class="nc" id="L243">				lNumOfIntervals.add(new StringsPair(&quot;14&quot;,&quot;14&quot;));</span>
<span class="nc" id="L244">			return lNumOfIntervals;</span>
		}
		
		private static ArrayList&lt;StringsPair&gt; getMonthsList(RequestContext context) throws Exception {
			
<span class="nc" id="L249">			Localizer localizer = context.getLocalizer();</span>
			
<span class="nc" id="L251">			ArrayList&lt;StringsPair&gt; lMonths = new ArrayList&lt;StringsPair&gt;();	   </span>
<span class="nc" id="L252">			  lMonths.add(new StringsPair(&quot;1&quot;,localizer.i18n(FsWebBundleKey.BUNDLE_NAME,FsWebBundleKey.JANUARY)));</span>
<span class="nc" id="L253">			  lMonths.add(new StringsPair(&quot;2&quot;,localizer.i18n(FsWebBundleKey.BUNDLE_NAME,FsWebBundleKey.FEBRUARY)));</span>
<span class="nc" id="L254">			  lMonths.add(new StringsPair(&quot;3&quot;,localizer.i18n(FsWebBundleKey.BUNDLE_NAME,FsWebBundleKey.MARCH)));</span>
<span class="nc" id="L255">			  lMonths.add(new StringsPair(&quot;4&quot;,localizer.i18n(FsWebBundleKey.BUNDLE_NAME,FsWebBundleKey.APRIL)));</span>
<span class="nc" id="L256">			  lMonths.add(new StringsPair(&quot;5&quot;,localizer.i18n(FsWebBundleKey.BUNDLE_NAME,FsWebBundleKey.MAY)));</span>
<span class="nc" id="L257">			  lMonths.add(new StringsPair(&quot;6&quot;,localizer.i18n(FsWebBundleKey.BUNDLE_NAME,FsWebBundleKey.JUNE)));</span>
<span class="nc" id="L258">			  lMonths.add(new StringsPair(&quot;7&quot;,localizer.i18n(FsWebBundleKey.BUNDLE_NAME,FsWebBundleKey.JULY)));</span>
<span class="nc" id="L259">			  lMonths.add(new StringsPair(&quot;8&quot;,localizer.i18n(FsWebBundleKey.BUNDLE_NAME,FsWebBundleKey.AUGUST)));</span>
<span class="nc" id="L260">			  lMonths.add(new StringsPair(&quot;9&quot;,localizer.i18n(FsWebBundleKey.BUNDLE_NAME,FsWebBundleKey.SEPTEMBER)));</span>
<span class="nc" id="L261">			  lMonths.add(new StringsPair(&quot;10&quot;,localizer.i18n(FsWebBundleKey.BUNDLE_NAME,FsWebBundleKey.OCTOBER)));</span>
<span class="nc" id="L262">			  lMonths.add(new StringsPair(&quot;11&quot;,localizer.i18n(FsWebBundleKey.BUNDLE_NAME,FsWebBundleKey.NOVEMBER)));</span>
<span class="nc" id="L263">			  lMonths.add(new StringsPair(&quot;12&quot;,localizer.i18n(FsWebBundleKey.BUNDLE_NAME,FsWebBundleKey.DECEMBER)));</span>

<span class="nc" id="L265">			return lMonths;</span>
		}
		
		private static ArrayList&lt;StringsPair&gt; getDaysOfWeekList() throws Exception {
			
<span class="nc" id="L270">			ArrayList&lt;StringsPair&gt; lMonths = new ArrayList&lt;StringsPair&gt;();	   </span>
<span class="nc" id="L271">			  lMonths.add(new StringsPair(&quot;0&quot;,&quot;All&quot;)); </span>
<span class="nc" id="L272">			  lMonths.add(new StringsPair(&quot;1&quot;,&quot;Sunday&quot;));</span>
<span class="nc" id="L273">			  lMonths.add(new StringsPair(&quot;2&quot;,&quot;Monday&quot;));</span>
<span class="nc" id="L274">			  lMonths.add(new StringsPair(&quot;3&quot;,&quot;Tuesday&quot;));</span>
<span class="nc" id="L275">			  lMonths.add(new StringsPair(&quot;4&quot;,&quot;Wednesday&quot;));</span>
<span class="nc" id="L276">			  lMonths.add(new StringsPair(&quot;5&quot;,&quot;Thursday&quot;));</span>
<span class="nc" id="L277">			  lMonths.add(new StringsPair(&quot;6&quot;,&quot;Friday&quot;));</span>
<span class="nc" id="L278">			  lMonths.add(new StringsPair(&quot;7&quot;,&quot;Saturday&quot;));			  </span>

<span class="nc" id="L280">			return lMonths;</span>
		}
		
		private static ArrayList&lt;StringsPair&gt; getResourceClasses(String scenario, String businessUnits) throws Exception {
<span class="nc" id="L284">			ArrayList&lt;StringsPair&gt; colPositions = new ArrayList&lt;StringsPair&gt;();</span>
<span class="nc" id="L285">			colPositions = RfsManagerFactory.getRfsReportsManager().getResourceClasses(scenario,businessUnits,false);</span>

<span class="nc bnc" id="L287" title="All 4 branches missed.">			if (colPositions == null || colPositions.isEmpty()) {</span>
<span class="nc" id="L288">				return null;</span>
			}
<span class="nc" id="L290">			return colPositions;</span>
		}
		
		private static ArrayList&lt;StringsPair&gt; getResourceClassesForMultipleSelection(RequestContext context, String scenario, String businessUnits) throws Exception {
<span class="nc" id="L294">			ArrayList&lt;StringsPair&gt; colPositions = new ArrayList&lt;StringsPair&gt;();</span>
<span class="nc" id="L295">			colPositions = RfsManagerFactory.getRfsReportsManager().getResourceClasses(scenario,businessUnits,true);</span>

<span class="nc bnc" id="L297" title="All 4 branches missed.">			if (colPositions == null || colPositions.isEmpty()) {</span>
<span class="nc" id="L298">				return null;</span>
			}
<span class="nc" id="L300">			String allPositionsKey = &quot;&quot;;</span>
<span class="nc bnc" id="L301" title="All 2 branches missed.">			for(int i =1; i &lt; colPositions.size(); i++) {</span>
<span class="nc bnc" id="L302" title="All 2 branches missed.">				if(i &gt; 1)</span>
<span class="nc" id="L303">					allPositionsKey += &quot;|&quot;;</span>
<span class="nc" id="L304">				allPositionsKey += colPositions.get(i).getKey();				</span>
			}
<span class="nc" id="L306">			colPositions.set(0,new StringsPair(allPositionsKey,context.getLocalizer().i18n(FsWebBundleKey.BUNDLE_NAME,FsWebBundleKey.OPTION_VALUE_ALL)));</span>
<span class="nc" id="L307">			return colPositions;</span>
		}
		
		public static Collection&lt;RfsBranch&gt; getBranchObjectsByIDs(RequestContext context, Collection&lt;ID&gt; branchIDs)
				throws BbmException, RemoteException {
<span class="nc" id="L312">			return RfsManagerFactory.getRfsReportsManager().getBranchObjectsByIDs(branchIDs);</span>
		}
		
		public static Collection&lt;String&gt; getBranchesByIDs(RequestContext context, Collection&lt;ID&gt; branchIDs)
				throws BbmException, RemoteException {
<span class="nc" id="L317">			return RfsManagerFactory.getRfsReportsManager().getBranchesByIDs(branchIDs);</span>
		}
		
		public static Collection&lt;String&gt; getBranchesByIDString(String branchIDs)
				throws BbmException, RemoteException {
<span class="nc" id="L322">			return RfsManagerFactory.getRfsReportsManager().getBranchesByIDString(branchIDs);</span>
		}
		
		private static ArrayList&lt;StringsPair&gt; getYearsList() throws Exception {
			
<span class="nc" id="L327">			ArrayList&lt;StringsPair&gt; colYears = new ArrayList&lt;StringsPair&gt;();</span>
<span class="nc" id="L328">			colYears = RfsManagerFactory.getRfsReportsManager().getYearsList();</span>

<span class="nc bnc" id="L330" title="All 4 branches missed.">			if (colYears == null || colYears.isEmpty()) {</span>
<span class="nc" id="L331">				return null;</span>
			}

<span class="nc" id="L334">			return colYears;</span>
		}
		private static ArrayList&lt;StringsPair&gt; getStaffMixes(String scenario, String businessUnits, int staffMixType) throws Exception {
			
<span class="nc" id="L338">			ArrayList&lt;StringsPair&gt; colStaffMixes = new ArrayList&lt;StringsPair&gt;();</span>
<span class="nc" id="L339">			colStaffMixes = RfsManagerFactory.getRfsReportsManager().getStaffMixes(scenario,businessUnits,staffMixType);</span>

<span class="nc bnc" id="L341" title="All 2 branches missed.">			if(colStaffMixes != null) {</span>
<span class="nc" id="L342">				colStaffMixes.add(0,new StringsPair(&quot;&quot;,&quot;&quot;));</span>
			}
<span class="nc bnc" id="L344" title="All 4 branches missed.">			if (colStaffMixes == null || colStaffMixes.isEmpty()) {</span>
<span class="nc" id="L345">				return null;</span>
			}

<span class="nc" id="L348">			return colStaffMixes;</span>
		}

		private static ArrayList&lt;StringsPair&gt; getWorkgroups(RequestContext context) throws Exception {
			
<span class="nc" id="L353">			ArrayList&lt;StringsPair&gt; colWorkgroups = new ArrayList&lt;StringsPair&gt;();</span>
<span class="nc" id="L354">			colWorkgroups = RfsManagerFactory.getRfsReportsManager().getWorkgroups(context.getRequest().getParameter(RfsReportParameterUtil.PARAM_PLANNED_STAFFMIX));</span>

<span class="nc bnc" id="L356" title="All 4 branches missed.">			if (colWorkgroups == null || colWorkgroups.isEmpty()) {</span>
<span class="nc" id="L357">				return null;</span>
			}

<span class="nc" id="L360">			String allWorkgroupsKey = &quot;&quot;;</span>
<span class="nc bnc" id="L361" title="All 2 branches missed.">			for(int i =1; i &lt; colWorkgroups.size(); i++) {</span>
<span class="nc bnc" id="L362" title="All 2 branches missed.">				if(i &gt; 1)</span>
<span class="nc" id="L363">					allWorkgroupsKey += &quot;,&quot;;</span>
<span class="nc" id="L364">				allWorkgroupsKey += colWorkgroups.get(i).getKey();				</span>
			}
<span class="nc" id="L366">			colWorkgroups.add(0,new StringsPair(allWorkgroupsKey,context.getLocalizer().i18n(FsWebBundleKey.BUNDLE_NAME,FsWebBundleKey.OPTION_VALUE_ALL)));</span>
<span class="nc" id="L367">			return colWorkgroups;</span>
		}
		
		private static ArrayList&lt;StringsPair&gt; getResources(String scenario, String resourceType, boolean useProdForecasts) throws Exception {
			
<span class="nc" id="L372">			ArrayList&lt;StringsPair&gt; colResources = new ArrayList&lt;StringsPair&gt;();</span>
<span class="nc" id="L373">			colResources = RfsManagerFactory.getRfsReportsManager().getResources(scenario,resourceType, useProdForecasts);</span>

<span class="nc bnc" id="L375" title="All 4 branches missed.">			if (colResources == null || colResources.isEmpty()) {</span>
<span class="nc" id="L376">				return null;</span>
			}

<span class="nc" id="L379">			return colResources;</span>
		}
		
		public static ArrayList&lt;StringsPair&gt; getEmployeeCategories(int staffMix) throws Exception {
<span class="nc" id="L383">			ArrayList&lt;StringsPair&gt; empCategories = new ArrayList&lt;StringsPair&gt;();</span>
<span class="nc" id="L384">			empCategories = RfsManagerFactory.getRfsReportsManager().getEmployeeCategories(staffMix);</span>
<span class="nc" id="L385">			return empCategories;</span>
		}
		
		private static ArrayList&lt;StringsPair&gt; getResourceCategories(String scenario) throws Exception {
<span class="nc" id="L389">			ArrayList&lt;StringsPair&gt; colPositions = new ArrayList&lt;StringsPair&gt;();</span>
<span class="nc" id="L390">			colPositions = RfsManagerFactory.getRfsReportsManager().getResourceCategories(scenario);</span>

<span class="nc bnc" id="L392" title="All 4 branches missed.">			if (colPositions == null || colPositions.isEmpty()) {</span>
<span class="nc" id="L393">				return null;</span>
			}

<span class="nc" id="L396">			return colPositions;</span>
		}
		
		private static ArrayList&lt;StringsPair&gt; getTransactionCategories(String scenario) throws Exception {
<span class="nc" id="L400">			ArrayList&lt;StringsPair&gt; colPositions = new ArrayList&lt;StringsPair&gt;();</span>
<span class="nc" id="L401">			colPositions = RfsManagerFactory.getRfsReportsManager().getTransactionCategories(scenario);</span>

<span class="nc bnc" id="L403" title="All 4 branches missed.">			if (colPositions == null || colPositions.isEmpty()) {</span>
<span class="nc" id="L404">				return null;</span>
			}

<span class="nc" id="L407">			return colPositions;</span>
		}

		private static ArrayList&lt;StringsPair&gt; getHierarchyGroupByList(String scenario) throws Exception {
<span class="nc" id="L411">			ArrayList&lt;StringsPair&gt; colGroupBy = new ArrayList&lt;StringsPair&gt;();</span>
<span class="nc" id="L412">			colGroupBy = RfsManagerFactory.getRfsReportsManager().getHierarchyGroupByList(scenario);</span>

<span class="nc bnc" id="L414" title="All 4 branches missed.">			if (colGroupBy == null || colGroupBy.isEmpty()) {</span>
<span class="nc" id="L415">				colGroupBy = new ArrayList&lt;StringsPair&gt;();</span>
			}
			else {
<span class="nc" id="L418">				colGroupBy.add(new StringsPair(&quot;-1&quot;,&quot;Workgroup&quot;));</span>
			}
			
<span class="nc" id="L421">			return colGroupBy;</span>
		}
		
		public static ArrayList&lt;StringsPair&gt; getRadioInputOptions(String pickerName, String filter) {
			
<span class="nc" id="L426">			ArrayList&lt;StringsPair&gt; lOptions = new ArrayList&lt;StringsPair&gt;();			</span>
			
<span class="nc bnc" id="L428" title="All 2 branches missed.">			if(RfsReportParameterUtil.INTERVAL.equals(pickerName))  {</span>
				// Options for Interval - Monthly/Daily
<span class="nc" id="L430">				lOptions.add(new StringsPair(RfsReportParameterUtil.PERIODTYPE_MONTHLY,FsWebBundleKey.INTERVALTYPE_MONTHLY)); </span>
<span class="nc" id="L431">				lOptions.add(new StringsPair(RfsReportParameterUtil.PERIODTYPE_DAILY,FsWebBundleKey.INTERVALTYPE_DAILY));</span>
<span class="nc bnc" id="L432" title="All 2 branches missed.">			} else if(RfsReportParameterUtil.CATEGORY.equals(pickerName))  {</span>
				// Options for Category - Resource Category / Transaction Category
<span class="nc" id="L434">				lOptions.add(new StringsPair(RfsReportParameterUtil.CATEGORYTYPE_RESOURCE,FsWebBundleKey.RESOURCE_CATEGORY));</span>
<span class="nc" id="L435">				lOptions.add(new StringsPair(RfsReportParameterUtil.CATEGORYTYPE_TRANSACTION,FsWebBundleKey.TRANSACTION_CATEGORY));</span>
<span class="nc bnc" id="L436" title="All 2 branches missed.">			} else if(RfsReportParameterUtil.TRANSACTIONSOURCE.equals(pickerName))  { </span>
				// Options for Transaction Source - Actual vs Forecasted / Actual vs Merged / Actual vs Merged vs Forecasted
<span class="nc" id="L438">				lOptions.add(new StringsPair(RfsReportParameterUtil.TRANSACTIONSOURCE_ACTUALVSFORECAST,FsWebBundleKey.TRANSACTIONSOURCE_ACTUALVSFORECAST)); </span>
<span class="nc" id="L439">				lOptions.add(new StringsPair(RfsReportParameterUtil.TRANSACTIONSOURCE_ACTUALVSMERGED,FsWebBundleKey.TRANSACTIONSOURCE_ACTUALVSMERGED));</span>
<span class="nc" id="L440">				lOptions.add(new StringsPair(RfsReportParameterUtil.TRANSACTIONSOURCE_ACTUALVSMERGEDVSFORECAST,FsWebBundleKey.TRANSACTIONSOURCE_ACTUALVSMERGEDVSFORECAST));</span>
<span class="nc bnc" id="L441" title="All 4 branches missed.">			}  else if(RfsReportParameterUtil.RESOURCE_TYPE.equals(pickerName) &amp;&amp; RfsReportParameterUtil.FILTER_VOLUME_FORECAST.equals(filter))  { </span>
				// Volume Forecast , History Resources - for untracked
<span class="nc" id="L443">				lOptions.add(new StringsPair(RfsReportParameterUtil.RESOURCE_TYPE_VOLUME,FsWebBundleKey.VOLUME_FORECAST)); </span>
<span class="nc" id="L444">				lOptions.add(new StringsPair(RfsReportParameterUtil.RESOURCE_TYPE_HISTORY,FsWebBundleKey.HISTORY_RESOURCES));</span>
<span class="nc bnc" id="L445" title="All 2 branches missed.">			} else if(RfsReportParameterUtil.RESOURCE_TYPE.equals(pickerName))  { </span>
				// Options for resources - Forecast Resources / History Resources
<span class="nc" id="L447">				lOptions.add(new StringsPair(RfsReportParameterUtil.RESOURCE_TYPE_FORECAST,FsWebBundleKey.FORECAST_RESOURCES)); </span>
<span class="nc" id="L448">				lOptions.add(new StringsPair(RfsReportParameterUtil.RESOURCE_TYPE_HISTORY,FsWebBundleKey.HISTORY_RESOURCES));</span>
			}
			
<span class="nc" id="L451">			return lOptions;</span>
		}

		public static String getBranchNames(RequestContext context, Object [] branchIds) throws Exception {
<span class="nc" id="L455">			ArrayList&lt;String&gt; branchNames = new ArrayList&lt;String&gt;();</span>
<span class="nc" id="L456">			String brNames = &quot;&quot;;</span>
<span class="nc" id="L457">			branchNames = RfsManagerFactory.getRfsReportsManager().getBranchNames(context.getRequest().getParameter(&quot;Scenario&quot;),</span>
<span class="nc" id="L458">					Arrays.copyOf(branchIds, branchIds.length, String[].class));</span>
			
<span class="nc bnc" id="L460" title="All 2 branches missed.">			int branchNamesDisplayLength = branchIds.length &gt; 3 ? 3 : branchIds.length;</span>
			
<span class="nc bnc" id="L462" title="All 2 branches missed.">			if (branchNames != null) {</span>
<span class="nc bnc" id="L463" title="All 2 branches missed.">				for(int i=0; i &lt; branchNamesDisplayLength; i++ ) {</span>
<span class="nc" id="L464">					brNames += branchNames.get(i);</span>
<span class="nc bnc" id="L465" title="All 2 branches missed.">					if(i &lt; branchNamesDisplayLength - 1)</span>
<span class="nc" id="L466">					brNames += &quot;,&quot;;</span>
				}
<span class="nc bnc" id="L468" title="All 2 branches missed.">				if(branchIds.length &gt; 3)</span>
<span class="nc" id="L469">					brNames += &quot;...&quot;;</span>
			}
<span class="nc" id="L471">			return brNames;</span>
		}
}
</pre><div class="footer"><span class="right">Created with <a href="http://www.eclemma.org/jacoco">JaCoCo</a> 0.7.5.201505241946</span></div></body></html>