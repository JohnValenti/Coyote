<?xml version="1.0" encoding="UTF-8"?><!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd"><html xmlns="http://www.w3.org/1999/xhtml" lang="en"><head><meta http-equiv="Content-Type" content="text/html;charset=UTF-8"/><link rel="stylesheet" href="../.resources/report.css" type="text/css"/><link rel="shortcut icon" href="../.resources/report.gif" type="image/gif"/><title>CalendarTimeOffDay.java</title><link rel="stylesheet" href="../.resources/prettify.css" type="text/css"/><script type="text/javascript" src="../.resources/prettify.js"></script></head><body onload="window['PR_TAB_WIDTH']=4;prettyPrint()"><div class="breadcrumb" id="breadcrumb"><span class="info"><a href="../.sessions.html" class="el_session">Sessions</a></span><a href="../index.html" class="el_report">QA Code Coverage</a> &gt; <a href="index.source.html" class="el_package">com.bluepumpkin.ejb.rm.setup.calendartimeoff.model</a> &gt; <span class="el_source">CalendarTimeOffDay.java</span></div><h1>CalendarTimeOffDay.java</h1><pre class="source lang-java linenums">/*
 * CalendarTimeOffDay.java
 * Copyright (c) 2002, Blue Pumpkin Software, Inc
 * All rights reserved.
 */
package com.bluepumpkin.ejb.rm.setup.calendartimeoff.model;

import java.util.Date;
import java.util.TimeZone;

import com.bluepumpkin.common.datatypes.ID;
import com.bluepumpkin.common.datatypes.LocalDate;
import com.bluepumpkin.ejb.bbm.vo.FieldInfo;
import com.bluepumpkin.ejb.bbm.vo.ValueObjectBase;

/**
 * Represents the amount of hours available for agents to use for time off for a
 * given day and in the context of an organization or a branch of the
 * orgnization tree.
 * &lt;p/&gt;
 * NOTE: The column ALLOCATEDHOURS (misnamed) should be called AVAILABLEHOURS!
 */
public class CalendarTimeOffDay extends ValueObjectBase {

<span class="nc" id="L25">	private static FieldInfo m_fieldInfo = new CalendarTimeOffDayFieldInfo();</span>
	// TODO: Remove these fields completely
	// available time off hours apply only to the current org
	public static final String INHERITANCERULE_CURRENT = &quot;current&quot;;
	// available time off hours apply only to the children orgs
	public static final String INHERITANCERULE_CHILDREN = &quot;children&quot;;
	// available time off hours apply to the current and children orgs
	public static final String INHERITANCERULE_BOTH = &quot;both&quot;;

	// flag value true if this date is Blackout day, otherwise false
	private boolean m_BlackoutDay;

<span class="nc" id="L37">	private static TimeZone s_gmt = TimeZone.getTimeZone(&quot;GMT&quot;);</span>

	public CalendarTimeOffDay() {
<span class="nc" id="L40">		super();</span>
<span class="nc" id="L41">	}</span>

	protected FieldInfo getFieldInfo() {
<span class="nc" id="L44">		return m_fieldInfo;</span>
	}

	// getters
	public ID getTOPoolID() {
<span class="nc" id="L49">		return getFieldValueID(CalendarTimeOffDayFieldInfo.CALENDARTIMEOFFDAY_I_TOPOOLID);</span>
	}

	/**
	 * @return returned date is set to 12:00AM GMT for the day for which TO
	 *         allocation is specified. See code in
	 *         {@link com.bluepumpkin.web.rm.setup.allocations.AvailableTimeOffPageModel#extractParameters()
	 *         extractParameters()} for further details.
	 *         &lt;p/&gt;
	 *         &lt;p&gt;
	 *         Only the year, month and day fields of the date are used. The
	 *         fields for hour, minutes etc are not. For instance if the date is
	 *         set to 1/1/2004 12:00AM GMT, then it means the TO allocation
	 *         specified applies to 1/1/2004 in the org's (for which the
	 *         allocation is specified) TZ.
	 *         &lt;p/&gt;
	 *         &lt;p&gt;
	 *         To extract the year, month and day fields for this date, always
	 *         use a calendar initialized to GMT TZ.
	 */
	public Date getTimeOffDate() {
<span class="nc" id="L70">		return getFieldValueDate(CalendarTimeOffDayFieldInfo.CALENDARTIMEOFFDAY_D_DAYDATE);</span>
	}

	/**
	 * see {@link #getTimeOffDate() getTimeOffDate()} for doc.
	 *
	 * @return
	 */
	public LocalDate getTimeOffLocalDate() {
		// To maintain compatibility with the original Date interface, convert
		// the date stored in the value object to a LocalDate on the fly. The
		// date stored on the interface is always in GMT.
<span class="nc" id="L82">		Date d = getFieldValueDate(CalendarTimeOffDayFieldInfo.CALENDARTIMEOFFDAY_D_DAYDATE);</span>
<span class="nc bnc" id="L83" title="All 2 branches missed.">		if (d != null)</span>
<span class="nc" id="L84">			return new LocalDate(d, s_gmt);</span>
		else
<span class="nc" id="L86">			return null;</span>
	}

	public double getAllocatedHours() {
<span class="nc" id="L90">		return (double) getFieldValueFloat(CalendarTimeOffDayFieldInfo.CALENDARTIMEOFFDAY_F_ALLOCATEDHOURS);</span>
	}

	public boolean isBlackOutDay() {
<span class="nc" id="L94">		return m_BlackoutDay;</span>
	}

	// setters
	public void setTOPoolID(ID id) {
<span class="nc" id="L99">		setFieldValue(CalendarTimeOffDayFieldInfo.CALENDARTIMEOFFDAY_I_TOPOOLID, id);</span>
<span class="nc" id="L100">	}</span>

	/**
	 * see {@link #getTimeOffDate() getTimeOffDate()} for doc.
	 */
	public void setTimeOffDate(Date pDate) {
<span class="nc" id="L106">		setFieldValue(CalendarTimeOffDayFieldInfo.CALENDARTIMEOFFDAY_D_DAYDATE, pDate);</span>
<span class="nc" id="L107">	}</span>

	/**
	 * see {@link #getTimeOffDate() getTimeOffDate()} for doc.
	 *
	 * @param pDate
	 */
	public void setTimeOffDate(LocalDate pDate) {
		// To maintain compatibility with the original Date interface, convert
		// the input local date to a date using GMT
<span class="nc bnc" id="L117" title="All 2 branches missed.">		if (pDate == null) {</span>
<span class="nc" id="L118">			setFieldValue(CalendarTimeOffDayFieldInfo.CALENDARTIMEOFFDAY_D_DAYDATE, (Date) null);</span>
		} else {
<span class="nc" id="L120">			setFieldValue(CalendarTimeOffDayFieldInfo.CALENDARTIMEOFFDAY_D_DAYDATE, pDate.getTime(s_gmt));</span>
		}
<span class="nc" id="L122">	}</span>

	public void setAllocatedHours(double pAllocatedHours) {
<span class="nc" id="L125">		setFieldValue(CalendarTimeOffDayFieldInfo.CALENDARTIMEOFFDAY_F_ALLOCATEDHOURS, (float) pAllocatedHours);</span>
<span class="nc" id="L126">	}</span>

	public void setBlackOutDay(boolean pIsBlackoutDay) {
<span class="nc" id="L129">		m_BlackoutDay = pIsBlackoutDay;</span>
<span class="nc" id="L130">	}</span>

	@Override
	public boolean equals(Object otherObj) {
<span class="nc bnc" id="L134" title="All 2 branches missed.">		if (this == otherObj) {</span>
<span class="nc" id="L135">			return true;</span>
		}

<span class="nc bnc" id="L138" title="All 2 branches missed.">		if (!(otherObj instanceof CalendarTimeOffDay)) {</span>
<span class="nc" id="L139">			return false;</span>
		}

<span class="nc" id="L142">		CalendarTimeOffDay otherTimeOffDay = (CalendarTimeOffDay) otherObj;</span>
		//FIXME: Doubles should be compared using Double.compare
<span class="nc bnc" id="L144" title="All 2 branches missed.">		if (getAllocatedHours() != otherTimeOffDay.getAllocatedHours()) {</span>
<span class="nc" id="L145">			return false;</span>
		}
<span class="nc" id="L147">		return false;</span>
	}
	
	@Override
	public int hashCode() {
<span class="nc" id="L152">		return 31 * 17 + (int) Double.doubleToLongBits(getAllocatedHours());</span>
	}
}
</pre><div class="footer"><span class="right">Created with <a href="http://www.eclemma.org/jacoco">JaCoCo</a> 0.7.5.201505241946</span></div></body></html>