<?xml version="1.0" encoding="UTF-8"?><!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd"><html xmlns="http://www.w3.org/1999/xhtml" lang="en"><head><meta http-equiv="Content-Type" content="text/html;charset=UTF-8"/><link rel="stylesheet" href="../.resources/report.css" type="text/css"/><link rel="shortcut icon" href="../.resources/report.gif" type="image/gif"/><title>FilingRuleModelHandler.java</title><link rel="stylesheet" href="../.resources/prettify.css" type="text/css"/><script type="text/javascript" src="../.resources/prettify.js"></script></head><body onload="window['PR_TAB_WIDTH']=4;prettyPrint()"><div class="breadcrumb" id="breadcrumb"><span class="info"><a href="../.sessions.html" class="el_session">Sessions</a></span><a href="../index.html" class="el_report">QA Code Coverage</a> &gt; <a href="index.source.html" class="el_package">com.bluepumpkin.web.rm.setup.filingrules</a> &gt; <span class="el_source">FilingRuleModelHandler.java</span></div><h1>FilingRuleModelHandler.java</h1><pre class="source lang-java linenums">package com.bluepumpkin.web.rm.setup.filingrules;

import java.rmi.RemoteException;
import java.util.ArrayList;
import java.util.Collection;
import java.util.Collections;
import java.util.List;
import java.util.Map;
import java.util.ResourceBundle;

import com.bluepumpkin.common.datatypes.ID;
import com.bluepumpkin.common.datatypes.StringsPair;
import com.bluepumpkin.common.localization.Localizer;
import com.bluepumpkin.ejb.bbm.activity.model.Activity;
import com.bluepumpkin.ejb.bbm.base.BbmCreateException;
import com.bluepumpkin.ejb.bbm.base.BbmFinderException;
import com.bluepumpkin.ejb.bbm.base.BbmRemoveException;
import com.bluepumpkin.ejb.bbm.base.BbmUpdateException;
import com.bluepumpkin.ejb.core.base.MultiUserException;
import com.bluepumpkin.ejb.rm.RmManagerFactory;
import com.bluepumpkin.ejb.rm.base.RmRuntimeException;
import com.bluepumpkin.ejb.rm.l10n.RmEjbBundleKey;
import com.bluepumpkin.ejb.rm.requests.common.ejb.RequestUtil;
import com.bluepumpkin.ejb.rm.requests.timeoff.model.TORequest;
import com.bluepumpkin.ejb.rm.setup.filingrules.model.RequestFilingRule;
import com.bluepumpkin.web.core.base.ModelHandler;
import com.witness.web.uif.l10n.UIFWebBundleKey;

/**
 * Title          FilingRuleModelHandler
 * Description    Model handler for Settings
 * Copyright      Copyright (c) 2002
 * Company        Blue Pumpkin Software, Inc
 * @author        Shubhangi Chavan
 * @version       1.0
 */
<span class="nc" id="L37">public class FilingRuleModelHandler extends ModelHandler { </span>

	/**
	 * Returns a list RequestFilingRule
	 * @param   orgID	ID	Identifes the organizationId
	 * @return  Collection	list of RequestFilingRule objects
	 */
	public static Collection&lt;RequestFilingRule&gt; getFilingRuleList(ID orgID)
		throws BbmFinderException, BbmCreateException, RemoteException{

		// Invoke the facade method here
<span class="nc" id="L48">		return RmManagerFactory.getInstance().getFilingRuleManager().</span>
<span class="nc" id="L49">					findFilingRulesByOrgId(orgID);</span>
	}

	/**
	 * Returns a list RequestFilingRule
	 * @param   orgID	ID	Identifes the organizationId
	 * @param   requestType	String	Identifes the Request Type
	 * @return  Collection	list of RequestFilingRule objects
	 */
	public static Collection&lt;RequestFilingRule&gt; getFilingRuleList(ID orgID, String requestType)
		throws BbmFinderException, BbmCreateException, RemoteException{

		// Invoke the facade method here
<span class="nc" id="L62">		return RmManagerFactory.getInstance().getFilingRuleManager().</span>
<span class="nc" id="L63">					findFilingRulesByOrgId(orgID,requestType);</span>
	}

	/**
	 * Find the RequestFilingRule for the ID
	 * @param	filingRuleId ID		Identifies the the RequestFilingRule object.
	 * @return	RequestFilingRule	A RequestFilingRule Object
	 */
	public static RequestFilingRule getFilingRule(ID filingRuleId)
		throws BbmFinderException, BbmCreateException, RemoteException {

<span class="nc" id="L74">		return RmManagerFactory.getInstance().getFilingRuleManager().</span>
<span class="nc" id="L75">			  findFilingRuleById(filingRuleId);</span>
		//return new RequestFilingRule();
	}

	/**
	 * Gets a collection of StringsPair objects that identify the TimeOff types
	 * @param   orgID	ID	Identifes the organizationId
	 * @return	Collection	list of StringsPair objects that contain the TimeOff types
	 */
	public static Collection&lt;StringsPair&gt; getTimeOffTypes(ID orgID)
			throws BbmFinderException, BbmCreateException, RemoteException {
		Collection&lt;Activity&gt; timeOffActivities = 
<span class="nc" id="L87">			RmManagerFactory.getInstance().getTimeOffRequestManager().</span>
<span class="nc" id="L88">			getTimeOffTypes(orgID);</span>
<span class="nc" id="L89">		return getTimeOffTypeStringPairs(timeOffActivities);</span>
	}



	/**
	 * Gets a collection of StringsPair objects that identify the TimeOff types
	 * @param   orgID	ID	Identifes the organizationId
	 * @param   isFlex	true returns only flex time offs, false returns only non-flex time offs.
	 * @return	Collection	list of StringsPair objects that contain the TimeOff types
	 */
	public static Collection&lt;StringsPair&gt; getTimeOffTypes(ID orgID, boolean isFlex)
			throws BbmFinderException, BbmCreateException, RemoteException {
<span class="nc bnc" id="L102" title="All 2 branches missed.">		int flexType = isFlex ? TORequest.FLEXTYPE_FLEXWITHMAKEUP : TORequest.FLEXTYPE_NONE;</span>
<span class="nc" id="L103">		Collection&lt;Activity&gt; timeOffActivities = RmManagerFactory.getInstance().getTimeOffRequestManager().getTimeOffTypes(orgID, flexType);</span>
<span class="nc" id="L104">		return getTimeOffTypeStringPairs(timeOffActivities);</span>
	}

	public static Collection&lt;StringsPair&gt; getTimeOffTypesExcludingVto(ID orgID, boolean isFlex) {
<span class="nc bnc" id="L108" title="All 2 branches missed.">		int flexType = isFlex ? TORequest.FLEXTYPE_FLEXWITHMAKEUP : TORequest.FLEXTYPE_NONE;</span>
		try {
<span class="nc" id="L110">			Collection&lt;Activity&gt; timeOffActivities = RmManagerFactory.getInstance().getTimeOffRequestManager()</span>
<span class="nc" id="L111">					.getTimeOffTypesExcludingVto(orgID, flexType);</span>
<span class="nc" id="L112">			return getTimeOffTypeStringPairs(timeOffActivities);</span>
<span class="nc" id="L113">		} catch (Exception e) {</span>
<span class="nc" id="L114">			throw RmRuntimeException.toRuntimeException(e);</span>
		}
	}

	/** Gets a collection of StringsPair objects that identify the given TimeOff activities.
	 * @param timeOffActivities
	 * @return
	 */
	protected static Collection&lt;StringsPair&gt; getTimeOffTypeStringPairs(Collection&lt;Activity&gt; timeOffActivities) {
<span class="nc bnc" id="L123" title="All 2 branches missed.">		if (timeOffActivities == null) {</span>
<span class="nc" id="L124">			return Collections.emptyList();</span>
		}

<span class="nc" id="L127">		List&lt;StringsPair&gt; timeOffTypes = new ArrayList&lt;StringsPair&gt;(timeOffActivities.size());</span>
<span class="nc bnc" id="L128" title="All 2 branches missed.">		for (Activity activity: timeOffActivities) {</span>

<span class="nc" id="L130">			timeOffTypes.add(new StringsPair(activity.getID().toString(), activity.getName()));</span>
<span class="nc" id="L131">		}</span>
<span class="nc" id="L132">		return timeOffTypes;</span>
	}

	/**
	 * Updates the  RequestFilingRule
	 * @param requestFilingRule - RequestFilingRule object.
	 */
	public static void updateFilingRule(RequestFilingRule requestFilingRule)
		throws BbmUpdateException, MultiUserException, BbmCreateException, RemoteException {

<span class="nc" id="L142">		RmManagerFactory.getInstance().getFilingRuleManager().</span>
<span class="nc" id="L143">			updateFilingRule(requestFilingRule);</span>
<span class="nc" id="L144">	}</span>


	/**
	 * Deletes the RequestFilingRule
	 * @param requestFilingRuleId - Id for RequestFilingRule.
	 */
	public static void deleteFilingRule(ID requestFilingRuleId)
		throws BbmRemoveException, BbmCreateException, RemoteException {
<span class="nc" id="L153">		RmManagerFactory.getInstance().getFilingRuleManager().</span>
<span class="nc" id="L154">			deleteFilingRule(requestFilingRuleId);</span>
<span class="nc" id="L155">	}</span>


	/**
	 * Creates a new RequestFilingRule
	 * @param requestFilingRule	RequestFilingRule instance
	 */
	public static ID createFilingRule(RequestFilingRule requestFilingRule)
		throws BbmCreateException, RemoteException {
<span class="nc" id="L164">		return RmManagerFactory.getInstance().getFilingRuleManager().</span>
<span class="nc" id="L165">			createFilingRule(requestFilingRule);</span>
	}

	/**
	 * Updates the InheritanceStatus for the RequestFilingRule
	 * @param organizationId	ID	Identifies the organizationID
	 * @param requestFilingRuleIDStatus	Collection contains the filingrule Id 
	 *                                  and the applied status.
	 */
	public static void saveApplied(ID organizationId, 
								   Map requestFilingRuleIDStatus)
		throws BbmUpdateException, BbmCreateException, RemoteException {
<span class="nc" id="L177">		RmManagerFactory.getInstance().getFilingRuleManager().</span>
<span class="nc" id="L178">			saveApplied(organizationId,requestFilingRuleIDStatus);</span>
<span class="nc" id="L179">	}</span>

	/**
	 * Copies an existing RequestFilingRule to the organization specified
	 * @param requestFilingRuleId	ID	Identifies the RequestFilingRuleID
	 * @param organizationId		ID	Identifies the organizationID
	 */
	public ID copyRequestFilingRule(ID requestFilingRuleId, ID organizationId)
		throws BbmCreateException, BbmFinderException, RemoteException {
<span class="nc" id="L188">		return RmManagerFactory.getInstance().getFilingRuleManager().</span>
<span class="nc" id="L189">			copyRequestFilingRule(requestFilingRuleId,organizationId);</span>
	}

	/**
	 * @deprecated
	 */
	@Deprecated
	public static Collection&lt;StringsPair&gt; getTimeOffType(Localizer localizer) {
<span class="nc" id="L197">		Collection&lt;StringsPair&gt; timeOffTypeList = new ArrayList&lt;&gt;();</span>
<span class="nc" id="L198">		ResourceBundle coreBundle = localizer.getBundle(UIFWebBundleKey.BUNDLE_NAME);</span>

<span class="nc" id="L200">		timeOffTypeList.add(new StringsPair(&quot;all&quot;,</span>
<span class="nc" id="L201">						localizer.i18n(coreBundle, UIFWebBundleKey.ALL)));</span>
<span class="nc" id="L202">		timeOffTypeList.add(new StringsPair(&quot;vacation&quot;,</span>
<span class="nc" id="L203">						localizer.i18n(coreBundle, UIFWebBundleKey.VACATION)));</span>
<span class="nc" id="L204">		timeOffTypeList.add(new StringsPair(&quot;sickleave&quot;,</span>
<span class="nc" id="L205">						localizer.i18n(coreBundle, UIFWebBundleKey.SICK_LEAVE)));</span>

<span class="nc" id="L207">		return timeOffTypeList;</span>
	}
	
	/**
	 * Get a list of key/value StringsPair's for the Flex Time &quot;before&quot; and &quot;after&quot; options.
	 */
	public static Collection&lt;StringsPair&gt; getFlexBeforeAfterList(ResourceBundle rmBundle, Localizer localizer) {
<span class="nc" id="L214">		Collection&lt;StringsPair&gt; flexBeforeAfterList = new ArrayList&lt;StringsPair&gt;(2);</span>
<span class="nc" id="L215">		flexBeforeAfterList.add(new StringsPair(FilingRulePC.FLEX_REQUEST_SUBTYPE_BEFORE,</span>
<span class="nc" id="L216">						localizer.i18n(rmBundle, RmEjbBundleKey.ORG_RM_FILING_RULE_BEFORE)));</span>
<span class="nc" id="L217">		flexBeforeAfterList.add(new StringsPair(FilingRulePC.FLEX_REQUEST_SUBTYPE_AFTER,</span>
<span class="nc" id="L218">						localizer.i18n(rmBundle, RmEjbBundleKey.ORG_RM_FILING_RULE_AFTER)));</span>
<span class="nc" id="L219">		return flexBeforeAfterList;</span>
	}
	
	/**
	 * Return string pair collection for interval unit list drop down {days/hours}.
	 * @param localizer
	 * @param includeMinutes - whether to include minutes in the drop down list or not 
	 * @return collection of StringPair objects.
	 */
	public static Collection&lt;StringsPair&gt; getIntervalUnitList(Localizer localizer, boolean includeMinutes) {
<span class="nc" id="L229">		Collection&lt;StringsPair&gt; aList = new ArrayList&lt;&gt;(2);</span>
<span class="nc" id="L230">		ResourceBundle rmEjbBundle = localizer.getBundle(RmEjbBundleKey.BUNDLE_NAME);</span>
<span class="nc" id="L231">		aList.add(new StringsPair(RequestUtil.DAYS,</span>
<span class="nc" id="L232">						localizer.i18n(rmEjbBundle, RmEjbBundleKey.ORG_RM_FILING_RULE_DAYS)));</span>
<span class="nc" id="L233">		aList.add(new StringsPair(RequestUtil.HOURS,</span>
<span class="nc" id="L234">						localizer.i18n(rmEjbBundle, RmEjbBundleKey.ORG_RM_FILING_RULE_HOURS)));</span>
<span class="nc bnc" id="L235" title="All 2 branches missed.">		if (includeMinutes) {</span>
<span class="nc" id="L236">			aList.add(new StringsPair(RequestUtil.MINUTES,</span>
<span class="nc" id="L237">					localizer.i18n(rmEjbBundle, RmEjbBundleKey.ORG_RM_FILING_RULE_MINUTES)));</span>
		}
<span class="nc" id="L239">		return aList;</span>
	}

	/**
	 * Return string pair collection for interval unit list drop down {days/hours}.
	 * @param localizer
	 * @return collection of StringPair objects.
	 */
	public static Collection&lt;StringsPair&gt; getIntervalUnitList(Localizer localizer) {
<span class="nc" id="L248">		return getIntervalUnitList(localizer, false);</span>
	}
}
</pre><div class="footer"><span class="right">Created with <a href="http://www.eclemma.org/jacoco">JaCoCo</a> 0.7.5.201505241946</span></div></body></html>