<?xml version="1.0" encoding="UTF-8"?><!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd"><html xmlns="http://www.w3.org/1999/xhtml" lang="en"><head><meta http-equiv="Content-Type" content="text/html;charset=UTF-8"/><link rel="stylesheet" href="../.resources/report.css" type="text/css"/><link rel="shortcut icon" href="../.resources/report.gif" type="image/gif"/><title>ShiftSwapPosting.java</title><link rel="stylesheet" href="../.resources/prettify.css" type="text/css"/><script type="text/javascript" src="../.resources/prettify.js"></script></head><body onload="window['PR_TAB_WIDTH']=4;prettyPrint()"><div class="breadcrumb" id="breadcrumb"><span class="info"><a href="../.sessions.html" class="el_session">Sessions</a></span><a href="../index.html" class="el_report">QA Code Coverage</a> &gt; <a href="index.source.html" class="el_package">com.bluepumpkin.ejb.rm.requests.swap.posting.model</a> &gt; <span class="el_source">ShiftSwapPosting.java</span></div><h1>ShiftSwapPosting.java</h1><pre class="source lang-java linenums">package com.bluepumpkin.ejb.rm.requests.swap.posting.model;


/**
 * Title:        ShiftSwapPosting
 * Description:  Class represents ShiftSwapPostings.
 * Copyright:    Copyright (c) 2002
 * Company:      Blue Pumpkin Software, Inc.
 * @author       Zhibo Wang
 * @version 1.0
 */
import java.util.ArrayList;
import java.util.Collection;
import java.util.Collections;
import java.util.Date;

import com.bluepumpkin.common.datatypes.ID;
import com.bluepumpkin.common.datatypes.TimeRange;
import com.bluepumpkin.ejb.bbm.vo.FieldInfo;
import com.bluepumpkin.ejb.bbm.vo.ValueObjectNode;
import com.bluepumpkin.ejb.rm.requests.common.model.RequestDetailLevel;
import com.bluepumpkin.ejb.rm.requests.common.validation.Validatable;
import com.bluepumpkin.ejb.rm.requests.common.validation.ValidationCache;
import com.bluepumpkin.ejb.rm.requests.common.validation.ValidationResult;
import com.bluepumpkin.ejb.rm.requests.swap.shiftitem.model.ShiftSwapItem;
import com.bluepumpkin.ejb.rm.requests.swap.shiftitem.model.ShiftSwapItemFieldInfo;


public class ShiftSwapPosting extends ValueObjectNode implements Validatable {
    public static final String SWAPTYPE_ONEWAY = &quot;one-way&quot;;
    public static final String SWAPTYPE_TWOWAY = &quot;two-way&quot;;

    public static final long   DL_BASIC = RequestDetailLevel.DL_BASIC;
    public static final long   DL_SHIFTSWAP_ITEMS = RequestDetailLevel.DL_SHIFTSWAP_ITEMS;
    public static final long   DL_ALL = DL_BASIC | DL_SHIFTSWAP_ITEMS;

<span class="nc" id="L37">    private static final FieldInfo m_fieldInfo = new ShiftSwapPostingFieldInfo();</span>

<span class="nc" id="L39">    protected long m_detailLevel = DL_BASIC;</span>

    // Any failing validations are added to this
<span class="nc" id="L42">    private Collection m_validationResults = new ArrayList(10);</span>

    // ValidationCache stores objects which may be needed by multiple
    // Validatable objects. It's transient, so it's not serialized with the
    // Request.
    //private transient ValidationCache m_validationCache = null;

<span class="nc" id="L49">    public ShiftSwapPosting(long detailLevel) {</span>
<span class="nc" id="L50">        m_detailLevel = detailLevel;</span>
<span class="nc" id="L51">    }</span>

    public FieldInfo getFieldInfo() {
<span class="nc" id="L54">        return m_fieldInfo;</span>
    }

    //Get ShiftSwapItem ValueObject.
    public ShiftSwapItem getShiftSwapItem() {
        //todo: can this return null?
<span class="nc" id="L60">        Collection col = getChildObjects(ShiftSwapPostingFieldInfo.ITEM_CHILD_TYPE);</span>
<span class="nc bnc" id="L61" title="All 2 branches missed.">        if ( !col.isEmpty() )</span>
<span class="nc" id="L62">            return (ShiftSwapItem) col.iterator().next();</span>

<span class="nc" id="L64">        return null;</span>
    }

    public Date getStartDate() {
<span class="nc" id="L68">        return this.getShiftSwapItem().getStartDate();</span>
    }

    public Date getDisplayStartDate() {
<span class="nc" id="L72">        return this.getShiftSwapItem().getDisplayStartDate();</span>
    }

    public Date getEndDate() {
<span class="nc" id="L76">        return this.getShiftSwapItem().getEndDate();</span>
    }

    public Date getExpirationDate() {
<span class="nc" id="L80">        return this.getShiftSwapItem().getExpirationDate();</span>
    }

    public boolean getNegotiation() {
<span class="nc" id="L84">        return this.getShiftSwapItem().getNegotiation();</span>
    }

    public boolean getIsPartial() {
<span class="nc" id="L88">        return this.getShiftSwapItem().getIsPartial();</span>
    }

    public boolean getAllowPartial() {
<span class="nc" id="L92">        return this.getShiftSwapItem().getAllowPartial();</span>
    }

    public Date getPostingDate() {
<span class="nc" id="L96">        return getFieldValueDate(ShiftSwapPostingFieldInfo.SHIFTSWAPPOSTING_D_POSTINGTIME);</span>
    }

    public String getSwapType() {
<span class="nc" id="L100">        return this.getFormattedFieldValue(ShiftSwapPostingFieldInfo.SHIFTSWAPPOSTING_S_SWAPTYPE);</span>
    }

    public String getComment() {
<span class="nc" id="L104">        return this.getFormattedFieldValue(ShiftSwapPostingFieldInfo.SHIFTSWAPPOSTING_S_POSTINGCOMMENT);</span>
    }

    public int getItemID() {
<span class="nc" id="L108">        return this.getFieldValueInt(ShiftSwapPostingFieldInfo.SHIFTSWAPPOSTING_I_SHIFTSWAPITEMID);</span>
    }

    public long getDetailLevel()  {
<span class="nc" id="L112">        return m_detailLevel;</span>
    }

    // setters
    //Set ShiftSwapItem ValueObject
    public void setShiftSwapItem(ShiftSwapItem item) {
<span class="nc" id="L118">        createChildObject(ShiftSwapPostingFieldInfo.ITEM_CHILD_TYPE, item);</span>
<span class="nc" id="L119">    }</span>

    public void updateShiftSwapItem(ShiftSwapItem item) {
        // Note: adding an existing persisted child object to the updated child list is ok.
        // A subsequent call to ValueObjectNode.getChildObjects(childType) will not return
        // 2 child objects (the persisted and updated) but only 1 since ValueObjectNode.getChildObjects()
        // is smart enough to replace the  persisted child with the udpated child in the returned list.
<span class="nc" id="L126">        updateChildObject(ShiftSwapPostingFieldInfo.ITEM_CHILD_TYPE, item);</span>
<span class="nc" id="L127">    }</span>

    public void setItemID(ID id) {
<span class="nc" id="L130">        setFieldValue(ShiftSwapPostingFieldInfo.SHIFTSWAPPOSTING_I_SHIFTSWAPITEMID, id);</span>
<span class="nc" id="L131">    }</span>

    public void setPostingDate(Date date) {
<span class="nc" id="L134">        setFieldValue(ShiftSwapPostingFieldInfo.SHIFTSWAPPOSTING_D_POSTINGTIME, date);</span>
<span class="nc" id="L135">    }</span>

    public void setComment(String comment) {
<span class="nc" id="L138">        setFieldValue(ShiftSwapPostingFieldInfo.SHIFTSWAPPOSTING_S_POSTINGCOMMENT, comment);</span>
<span class="nc" id="L139">    }</span>

    /**
     *
     * @param type either
     * {@link com.bluepumpkin.ejb.rm.requests.swap.request.model.ShiftSwapRequest#SHIFTSWAP_TYPE_ONEWAY SHIFTSWAP_TYPE_ONEWAY} or
     * {@link com.bluepumpkin.ejb.rm.requests.swap.request.model.ShiftSwapRequest#SHIFTSWAP_TYPE_TWOWAY SHIFTSWAP_TYPE_TWOWAY}
     */
    public void setSwapType(String type) {
<span class="nc" id="L148">        setFieldValue(ShiftSwapPostingFieldInfo.SHIFTSWAPPOSTING_S_SWAPTYPE, type);</span>
<span class="nc" id="L149">    }</span>

    public void setStartDate(Date date) {
        //moveChildrenFromPersistedToUpdated(false);
<span class="nc" id="L153">        this.getShiftSwapItem().setFieldValue(ShiftSwapItemFieldInfo.SHIFTSWAPITEM_D_STARTTIME, date);</span>
<span class="nc" id="L154">    }</span>

    public void setEndDate(Date date) {
        //moveChildrenFromPersistedToUpdated(false);
<span class="nc" id="L158">        this.getShiftSwapItem().setFieldValue(ShiftSwapItemFieldInfo.SHIFTSWAPITEM_D_ENDTIME, date);</span>
<span class="nc" id="L159">    }</span>

    public void setExpiration(Date date) {
        //moveChildrenFromPersistedToUpdated(false);
<span class="nc" id="L163">        this.getShiftSwapItem().setFieldValue(ShiftSwapItemFieldInfo.SHIFTSWAPITEM_D_EXPIRATIONDATE, date);</span>
<span class="nc" id="L164">    }</span>

    public void setNegotiation(boolean boo) {
        //moveChildrenFromPersistedToUpdated(false);
<span class="nc" id="L168">        this.getShiftSwapItem().setFieldValue(ShiftSwapItemFieldInfo.SHIFTSWAPITEM_B_ISNEGOTIATIONREQUIRED,</span>
            boo);
<span class="nc" id="L170">    }</span>

    /**
     * Implements a method from the Validatable interface.
     * @return the ValidationCache associated with this object.
     */
    public ValidationCache getValidationCache() {
<span class="nc" id="L177">        return null;</span>
    }

    /** Add a validation result to the list maintained in this object
    * @param result result to add
    */
    public void addValidationResult(ValidationResult result) {
<span class="nc bnc" id="L184" title="All 2 branches missed.">        if (result != null) { // ignore null results</span>
<span class="nc" id="L185">            this.m_validationResults.add(result);</span>
        }
<span class="nc" id="L187">    }</span>

    /**
     * Clear the validation results in the object.
     */
    public void clearValidationResults(boolean entireBranch) {
<span class="nc" id="L193">            m_validationResults.clear();</span>
<span class="nc" id="L194">    }</span>

    /** Return the collection of validation results stored in this
    * validatable object.
    * @return collection of ValidationResults
    * @see ValidationResult
    */
    public Collection getValidationResults(boolean entireBranch) {
<span class="nc" id="L202">        return this.m_validationResults;</span>
    }

    /**
     * Implement a method from Validatable interface.
     * Return the TimeRange for the ShiftSwapItem of this posting.
     */
    public Collection getValidationTimeRanges() {
<span class="nc" id="L210">        ShiftSwapItem item = getShiftSwapItem();</span>
<span class="nc bnc" id="L211" title="All 2 branches missed.">        if (item == null) {</span>
<span class="nc" id="L212">            return Collections.emptyList();</span>
        }

<span class="nc" id="L215">        Collection result = new ArrayList();</span>
<span class="nc" id="L216">        result.add(new TimeRange(item.getStartDate(), item.getEndDate()));</span>
<span class="nc" id="L217">        return result;</span>
    }


    //Implementing without unit test yet..
    //For validation
    public ID getEmployeeID() {
//        try {
<span class="nc" id="L225">            ShiftSwapItem item = getShiftSwapItem();</span>

<span class="nc" id="L227">            return item.getEmployeeID();</span>
//        } c_atch (Exception e) {
//            //todo: log error
//            e.printStackTrace();
//        }
    }

    /*
    // Add the child object (ShiftSwapPostingItem) to the map of children to
    // be updated.
    public void updateChildObject() {
        super.updateChildObject(ShiftSwapPostingFieldInfo.ITEM_CHILD_TYPE, this.getShiftSwapItem());
    }
     */
}
</pre><div class="footer"><span class="right">Created with <a href="http://www.eclemma.org/jacoco">JaCoCo</a> 0.7.5.201505241946</span></div></body></html>