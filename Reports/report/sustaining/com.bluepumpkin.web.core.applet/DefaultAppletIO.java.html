<?xml version="1.0" encoding="UTF-8"?><!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd"><html xmlns="http://www.w3.org/1999/xhtml" lang="en"><head><meta http-equiv="Content-Type" content="text/html;charset=UTF-8"/><link rel="stylesheet" href="../.resources/report.css" type="text/css"/><link rel="shortcut icon" href="../.resources/report.gif" type="image/gif"/><title>DefaultAppletIO.java</title><link rel="stylesheet" href="../.resources/prettify.css" type="text/css"/><script type="text/javascript" src="../.resources/prettify.js"></script></head><body onload="window['PR_TAB_WIDTH']=4;prettyPrint()"><div class="breadcrumb" id="breadcrumb"><span class="info"><a href="../.sessions.html" class="el_session">Sessions</a></span><a href="../index.html" class="el_report">QA Code Coverage</a> &gt; <a href="index.source.html" class="el_package">com.bluepumpkin.web.core.applet</a> &gt; <span class="el_source">DefaultAppletIO.java</span></div><h1>DefaultAppletIO.java</h1><pre class="source lang-java linenums">package com.bluepumpkin.web.core.applet;

import java.io.IOException;
import java.io.InputStream;
import java.io.ObjectInputStream;
import java.io.ObjectOutputStream;
import java.io.OutputStream;
import java.util.Map;
import java.util.zip.GZIPInputStream;
import java.util.zip.GZIPOutputStream;

/**
 * Title:        DefaultAppletIO
 * Description:  The default implementation of communication between the applet and the server.  
 *   This implementation uses Java Zipped Objects to communicate for BOTH the requests and the 
 *   responses.
 *
 * Copyright:    Copyright (c) 2004
 * Company:      Blue Pumpkin Software, Inc
 * @author       David Su, Alvin Cham
 * @version      1.0
 *
 * Created on Apr 15, 2003, 4:05:33 PM
 */
public class DefaultAppletIO implements AppletIO {

	/**
	 *  Retrieves the singleton instance of this object.
	 */
	public static DefaultAppletIO getInstance() {
<span class="nc" id="L31">		return m_instance;</span>
	}


<span class="nc" id="L35">	private static DefaultAppletIO m_instance = new DefaultAppletIO();</span>

<span class="nc" id="L37">	private DefaultAppletIO() {}</span>

	// -------------------------------------------------------
	// public methods
	// -------------------------------------------------------


	/**
	 * Write specified Map to the OutputStream
	 *
	 * @param out - OutputStream to be written to
	 * @param data - The data to be writen
	 * @throws IOException
	 */
	public void write(OutputStream out, Map data) throws IOException {
<span class="nc" id="L52">		writeObject(out, data);</span>
<span class="nc" id="L53">	}</span>

	/**
	 * Read Map from specified InputStream
	 *
	 * @param in - InputStream where Map resides
	 * @return Map
	 * @throws IOException
	 * @throws ClassNotFoundException
	 */
	public Map read(InputStream in) throws IOException, ClassNotFoundException {
<span class="nc" id="L64">		return (Map)readObject(in);</span>
	}

	// -------------------------------------------------------
	// private methods
	// -------------------------------------------------------

	/**
	 * Write specified Object to specified OutputStream
	 *
	 * @param out - OutputStream to write Object to
	 * @param obj - The Object to write to OutputStream
	 * @throws IOException
	 */
	private void writeObject(OutputStream out, Object obj) throws IOException {
<span class="nc" id="L79">		ObjectOutputStream objOut = null;</span>
		try {
<span class="nc" id="L81">			objOut = new ObjectOutputStream(new GZIPOutputStream(out));</span>
<span class="nc" id="L82">			objOut.writeObject(obj);</span>
<span class="nc" id="L83">			objOut.flush();</span>
		}	finally {
<span class="nc bnc" id="L85" title="All 4 branches missed.">			if (objOut != null) {</span>
				try {
<span class="nc" id="L87">					objOut.close();</span>
<span class="nc" id="L88">				} catch( Exception e) {</span>
					// we don't care about the exception
<span class="nc" id="L90">				}</span>
			}
		}
<span class="nc" id="L93">	}</span>

	/**
	 * Read Object from specified InputStream
	 *
	 * @param in - The InputStream to read Object From
	 * @return Object read from specified InputStream
	 */
	private Object readObject(InputStream in) throws IOException, ClassNotFoundException {
<span class="nc" id="L102">		Object data = null;</span>
<span class="nc" id="L103">		ObjectInputStream objIn = null;</span>
		try {
<span class="nc" id="L105">			objIn = new ObjectInputStream(new GZIPInputStream(in));</span>
<span class="nc" id="L106">			data = objIn.readObject();</span>
		}	finally {
<span class="nc bnc" id="L108" title="All 4 branches missed.">			if ( objIn != null ) {</span>
				try {
<span class="nc" id="L110">					objIn.close();</span>
<span class="nc" id="L111">				} catch ( Exception ie) {</span>
					// we don't care for this exception
<span class="nc" id="L113">				}</span>
			}
		}
<span class="nc" id="L116">		return data;</span>
	}
}
</pre><div class="footer"><span class="right">Created with <a href="http://www.eclemma.org/jacoco">JaCoCo</a> 0.7.5.201505241946</span></div></body></html>