<?xml version="1.0" encoding="UTF-8"?><!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd"><html xmlns="http://www.w3.org/1999/xhtml" lang="en"><head><meta http-equiv="Content-Type" content="text/html;charset=UTF-8"/><link rel="stylesheet" href="../.resources/report.css" type="text/css"/><link rel="shortcut icon" href="../.resources/report.gif" type="image/gif"/><title>Shift.java</title><link rel="stylesheet" href="../.resources/prettify.css" type="text/css"/><script type="text/javascript" src="../.resources/prettify.js"></script></head><body onload="window['PR_TAB_WIDTH']=4;prettyPrint()"><div class="breadcrumb" id="breadcrumb"><span class="info"><a href="../.sessions.html" class="el_session">Sessions</a></span><a href="../index.html" class="el_report">QA Code Coverage</a> &gt; <a href="index.source.html" class="el_package">com.bluepumpkin.ejb.bbm.workrules.model</a> &gt; <span class="el_source">Shift.java</span></div><h1>Shift.java</h1><pre class="source lang-java linenums">package com.bluepumpkin.ejb.bbm.workrules.model;

import java.util.ArrayList;
import java.util.Collection;
import java.util.Date;
import java.util.HashMap;
import java.util.HashSet;
import java.util.Map;

import com.bluepumpkin.common.datatypes.ID;
import com.bluepumpkin.common.datatypes.TimeOfDay;
import com.bluepumpkin.ejb.bbm.vo.FieldInfo;
import com.bluepumpkin.ejb.bbm.vo.ValueObjectRich;

<span class="nc" id="L15">public class Shift extends ValueObjectRich {</span>
	private static final long serialVersionUID = 1L;

<span class="nc" id="L18">	public static String SHIFT_EVENT_RELATIONSHIP_KEY = &quot;SHIFTEVENTSHIFT|SHIFTID&quot;;</span>
<span class="nc" id="L19">	public static String SHIFT_START_RELATIONSHIP_KEY = &quot;SHIFTSTART|SHIFTID&quot;;</span>
	
	// meta data information
<span class="nc" id="L22">	private static FieldInfo m_fieldInfo = new ShiftFieldInfo();</span>
<span class="nc" id="L23">	protected FieldInfo getFieldInfo() { return m_fieldInfo; }</span>
	
	public ID getDEID() {
<span class="nc" id="L26">		return getFieldValueID(ShiftFieldInfo.SHIFT_ID);</span>
	}
	
	public void setDEID(ID deID) {
<span class="nc" id="L30">		setFieldValue(ShiftFieldInfo.SHIFT_ID, deID);</span>
<span class="nc" id="L31">	}</span>
	
	public ID getCampaignID() {
<span class="nc" id="L34">		return getFieldValueID(ShiftFieldInfo.SHIFT_CAMPAIGNID);</span>
	}
	
<span class="nc" id="L37">	public void setCampaignID(ID campaignID) { setFieldValue(ShiftFieldInfo.SHIFT_CAMPAIGNID, campaignID); }</span>
	
	public ID getActivityID() {
<span class="nc" id="L40">		return this.getFieldValueID(ShiftFieldInfo.SHIFT_ACTIVITYID);</span>
	}
	
	public void setActivityID(ID activityID) {
<span class="nc" id="L44">		setFieldValue(ShiftFieldInfo.SHIFT_ACTIVITYID, activityID);</span>
<span class="nc" id="L45">	}</span>
	
	public String getName() {
<span class="nc" id="L48">		return this.getFormattedFieldValue(ShiftFieldInfo.SHIFT_NAME);</span>
	}
	
<span class="nc" id="L51">	public void setName(String name) { setFieldValue(ShiftFieldInfo.SHIFT_NAME, name); }</span>
	
	public String getDescription() {
<span class="nc" id="L54">		return this.getFormattedFieldValue(ShiftFieldInfo.SHIFT_DESCRIPTION);</span>
	}
	
	public void setDescription(String description) {
<span class="nc" id="L58">		setFieldValue(ShiftFieldInfo.SHIFT_DESCRIPTION, description);</span>
<span class="nc" id="L59">	}</span>
	
	public int getDuration() {
<span class="nc" id="L62">		return this.getFieldValueInt(ShiftFieldInfo.SHIFT_SHIFTLENGTH);</span>
	}
	
	public void setDuration(int duration) {
<span class="nc" id="L66">		setFieldValue(ShiftFieldInfo.SHIFT_SHIFTLENGTH, duration);</span>
<span class="nc" id="L67">	}</span>
	
	public int getMinSpacing() {
<span class="nc" id="L70">		return this.getFieldValueInt(ShiftFieldInfo.SHIFT_MINSPACING);</span>
	}
	
	public void setMinSpacing(int minSpacing) {
<span class="nc" id="L74">		setFieldValue(ShiftFieldInfo.SHIFT_MINSPACING, minSpacing);</span>
<span class="nc" id="L75">	}</span>
	
	public int getMaxSpacing() {
<span class="nc" id="L78">		return this.getFieldValueInt(ShiftFieldInfo.SHIFT_MAXSPACING);</span>
	}
	
	public void setMaxSpacing(int maxSpacing) {
<span class="nc" id="L82">		setFieldValue(ShiftFieldInfo.SHIFT_MAXSPACING, maxSpacing);</span>
<span class="nc" id="L83">	}</span>
	
	public ID getOrganizationID() {
<span class="nc" id="L86">		return this.getFieldValueID(ShiftFieldInfo.SHIFT_ORGANIZATIONID);</span>
	}
	
<span class="nc" id="L89">	public void setOrganizationID(ID organizationID) { setFieldValue(ShiftFieldInfo.SHIFT_ORGANIZATIONID, organizationID); }</span>
	
	public boolean isDeleted() {
<span class="nc" id="L92">		Date deleteOnDate = this.getFieldValueDate(ShiftFieldInfo.SHIFT_DELETEONDATE);</span>
<span class="nc bnc" id="L93" title="All 4 branches missed.">		if (deleteOnDate != null &amp;&amp; (deleteOnDate.getTime() &lt; System.currentTimeMillis()))</span>
<span class="nc" id="L94">			return true;</span>
<span class="nc" id="L95">		return false;</span>
	}
	
	public void setShiftEvents(Collection&lt;ShiftEvent&gt; events) {
<span class="nc" id="L99">		setRelatedObjects(SHIFT_EVENT_RELATIONSHIP_KEY, events);</span>
<span class="nc" id="L100">	}</span>
	
	/**
	 * Returns an unmodifiable collection of ShiftEvents linked to this shift.
	 */
	public Collection&lt;ShiftEvent&gt; getShiftEvents() {
<span class="nc" id="L106">		return getRelatedObjects(SHIFT_EVENT_RELATIONSHIP_KEY);</span>
	}
	
	public void addShiftEvents(Collection&lt;ShiftEvent&gt; col) {
<span class="nc" id="L110">		addRelatedObjects(SHIFT_EVENT_RELATIONSHIP_KEY, col);</span>
<span class="nc" id="L111">	}</span>
	
	public void removeShiftEvents(Collection&lt;ShiftEvent&gt; col) {
<span class="nc" id="L114">		removeRelatedObjects(SHIFT_EVENT_RELATIONSHIP_KEY, col);</span>
<span class="nc" id="L115">	}</span>
	
	/**
	 * 
	 * @return
	 * @deprecated Start Times are specified as offsets from the day boundary, not necessarily midnight. Not as specific times of the day. The data type returned by this method is misleading. Use getShiftStarts instead.
	 */
	@Deprecated
	public Collection&lt;TimeOfDay&gt; getStartTimes() {
<span class="nc" id="L124">		Collection&lt;ShiftStart&gt; shiftStarts = getShiftStarts();</span>
<span class="nc" id="L125">		Collection&lt;TimeOfDay&gt; timeOfDays = new ArrayList&lt;TimeOfDay&gt;();</span>
		
<span class="nc bnc" id="L127" title="All 2 branches missed.">		for (ShiftStart shiftStart : shiftStarts) {</span>
<span class="nc" id="L128">			timeOfDays.add(new TimeOfDay(shiftStart.getPossibleStartTime()));</span>
<span class="nc" id="L129">		}</span>
<span class="nc" id="L130">		return timeOfDays;</span>
	}
	
	/**
	 * Returns an unmodifiable collection of ShiftStarts linked to this shift.
	 */
	public Collection&lt;ShiftStart&gt; getShiftStarts() {
<span class="nc" id="L137">		return getRelatedObjects(SHIFT_START_RELATIONSHIP_KEY);</span>
	}
	
	public void setShiftStarts(Collection&lt;ShiftStart&gt; col) {
<span class="nc" id="L141">		setRelatedObjects(SHIFT_START_RELATIONSHIP_KEY, new HashSet&lt;ShiftStart&gt;(col));</span>
<span class="nc" id="L142">	}</span>
	
	public void addShiftStarts(Collection&lt;ShiftStart&gt; col) {
<span class="nc" id="L145">		addRelatedObjects(SHIFT_START_RELATIONSHIP_KEY, col);</span>
<span class="nc" id="L146">	}</span>
	
	public void removeShiftStarts(Collection&lt;ShiftStart&gt; col) {
<span class="nc" id="L149">		removeRelatedObjects(SHIFT_START_RELATIONSHIP_KEY, col);</span>
<span class="nc" id="L150">	}</span>
	
    public int getNumOfShiftEvents() {
<span class="nc" id="L153">    	int number = 0;</span>
<span class="nc bnc" id="L154" title="All 2 branches missed.">    	for (ShiftEvent shiftEvent : getShiftEvents() ) {</span>
<span class="nc bnc" id="L155" title="All 2 branches missed.">    		if (!shiftEvent.isDeleted()){</span>
<span class="nc bnc" id="L156" title="All 2 branches missed.">    			if (shiftEvent.isFlexible())</span>
<span class="nc" id="L157">    				number += shiftEvent.getMinCount();</span>
    			else
<span class="nc" id="L159">    				number ++;</span>
    		}
<span class="nc" id="L161">    	}</span>
<span class="nc" id="L162">    	return number;</span>
    }
    
    public Map&lt;ID,Integer&gt; getMandatoryShiftEventsID(){
<span class="nc" id="L166">    	Map&lt;ID,Integer&gt; mandatoryIdMap = new HashMap&lt;ID,Integer&gt;();</span>
<span class="nc bnc" id="L167" title="All 2 branches missed.">    	for (ShiftEvent shiftEvent : getShiftEvents() ) {</span>
<span class="nc bnc" id="L168" title="All 2 branches missed.">    		if (!shiftEvent.isDeleted()){</span>
<span class="nc bnc" id="L169" title="All 2 branches missed.">    			if (shiftEvent.isFlexible()){</span>
<span class="nc bnc" id="L170" title="All 2 branches missed.">    				if(shiftEvent.getMinCount() &gt; 0)</span>
<span class="nc" id="L171">    					mandatoryIdMap.put(shiftEvent.getID(),shiftEvent.getMinCount());</span>
    			}else
<span class="nc" id="L173">    				mandatoryIdMap.put(shiftEvent.getID(),1);</span>
    		}
<span class="nc" id="L175">    	}</span>
<span class="nc" id="L176">    	return mandatoryIdMap;</span>
    }
    
    public ShiftEvent getShiftEvent(ID shiftEventID) {
<span class="nc bnc" id="L180" title="All 2 branches missed.">    	for (ShiftEvent shiftEvent : getShiftEvents() ) {</span>
<span class="nc bnc" id="L181" title="All 2 branches missed.">    		if (shiftEvent.getID().equals(shiftEventID))</span>
<span class="nc" id="L182">    			return shiftEvent;</span>
<span class="nc" id="L183">    	}</span>
<span class="nc" id="L184">    	return null;</span>
    }
    
	public Date getCreatedDate() {
<span class="nc" id="L188">		return getFieldValueDate(ShiftFieldInfo.SHIFT_CREATED);</span>
	}
	public void setCreatedDate(Date createdDate) {
<span class="nc" id="L191">		setFieldValue(ShiftFieldInfo.SHIFT_CREATED, createdDate);</span>
<span class="nc" id="L192">	}</span>
	
	public String getCreatedBy() {
<span class="nc" id="L195">		return getFormattedFieldValue(ShiftFieldInfo.SHIFT_CREATEDBY);</span>
	}
	public void setCreatedBy(String createdBy) {
<span class="nc" id="L198">		setFieldValue(ShiftFieldInfo.SHIFT_CREATEDBY, createdBy);</span>
<span class="nc" id="L199">	}</span>
	
	public Date getModifiedDate() {
<span class="nc" id="L202">		return getFieldValueDate(ShiftFieldInfo.SHIFT_MODIFIED);</span>
	}
	public void setModifiedDate(Date modifiedDate) {
<span class="nc" id="L205">		setFieldValue(ShiftFieldInfo.SHIFT_MODIFIED, modifiedDate);</span>
<span class="nc" id="L206">	}</span>
	
	public String getModifiedBy() {
<span class="nc" id="L209">		return getFormattedFieldValue(ShiftFieldInfo.SHIFT_MODIFIEDBY);</span>
	}
	public void setModifiedBy(String modifiedBy) {
<span class="nc" id="L212">		setFieldValue(ShiftFieldInfo.SHIFT_MODIFIEDBY, modifiedBy);</span>
<span class="nc" id="L213">	}</span>
	
	/**
	 * Returns the work type shift events linked to this shift.  Work type events are those events
	 * that have their activity's &quot;is used in shift&quot; flag set.
	 */
	public Collection&lt;ShiftEvent&gt; getWorkTypeShiftEvents() {
<span class="nc" id="L220">		Collection&lt;ShiftEvent&gt; retVal = new ArrayList&lt;ShiftEvent&gt;();</span>
<span class="nc bnc" id="L221" title="All 2 branches missed.">		for (ShiftEvent se : getShiftEvents()) {</span>
<span class="nc bnc" id="L222" title="All 2 branches missed.">			if (se.isWorkType()) retVal.add(se);</span>
<span class="nc" id="L223">		}</span>
<span class="nc" id="L224">		return retVal;</span>
	}
	
	/**
	 * Returns the break type shift events linked to this shift.  Break type events are those events
	 * that do not have their activity's &quot;is used in shift&quot; flag set.
	 */
	public Collection&lt;ShiftEvent&gt; getBreakTypeShiftEvents() {
<span class="nc" id="L232">		Collection&lt;ShiftEvent&gt; retVal = new ArrayList&lt;ShiftEvent&gt;();</span>
<span class="nc bnc" id="L233" title="All 2 branches missed.">		for (ShiftEvent se : getShiftEvents()) {</span>
<span class="nc bnc" id="L234" title="All 2 branches missed.">			if (!se.isWorkType()) retVal.add(se);</span>
<span class="nc" id="L235">		}</span>
<span class="nc" id="L236">		return retVal;</span>
	}
}
</pre><div class="footer"><span class="right">Created with <a href="http://www.eclemma.org/jacoco">JaCoCo</a> 0.7.5.201505241946</span></div></body></html>